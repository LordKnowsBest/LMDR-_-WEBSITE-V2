# Dependency Vulnerability Check Report

**Date:** 2026-10-18
**Analyst:** Jules (Supply Chain Security Analyst)
**Status:** FAIL (Critical Lockfile Integrity Failure)

## Executive Summary

The dependency audit has identified **36 vulnerabilities** (31 High, 5 Moderate). More critically, the project's `package-lock.json` is severely compromised and out of sync with `package.json`, containing invalid version references (e.g., `uuid@13.0.0`) and missing production dependencies. Remediation is currently blocked by missing authentication credentials for private `@marketpushapps` packages.

## 1. Vulnerability Summary

| Severity | Count | Primary Culprits |
| :--- | :--- | :--- |
| **Critical** | 0 | - |
| **High** | 31 | `minimatch` (ReDoS), `tar` (Arbitrary File Overwrite) via `@wix/cli` |
| **Moderate** | 5 | `ajv` (ReDoS), `undici` (DoS), `vite` (Bypass) |
| **Low** | 0 | - |

### Key High Severity Findings

1.  **Package:** `minimatch` (<10.2.1)
    -   **Issue:** ReDoS via repeated wildcards.
    -   **Source:** `eslint`, `jest`, `@wix/cli` dependency chain.
    -   **Remediation:** Requires `npm audit fix --force` (breaking change for `eslint`), or upgrading `eslint` to v9+.
2.  **Package:** `tar` (<=7.5.7)
    -   **Issue:** Arbitrary File Creation/Overwrite via symlinks.
    -   **Source:** `@wix/cli` -> `node-gyp` -> `tar`.
    -   **Remediation:** Update `@wix/cli`.

## 2. Supply Chain Integrity

### Lockfile Status: CRITICAL FAIL
The `package-lock.json` file is corrupt and dangerously out of sync with `package.json`.
-   **Invalid Versions:** The lockfile defines `uuid` at version `^13.0.0` (which does not exist), while `package.json` specifies `^9.0.1`.
-   **Missing Dependencies:** The lockfile completely lacks entries for production dependencies listed in `package.json`:
    -   `@marketpushapps/calendly-embed-backend`
    -   `@marketpushapps/airtable-connector`
    -   `@marketpushapps/airtable-connector-backend`
    -   `@marketpushapps/calendly-embed`
-   **Implication:** Builds are non-deterministic and the current vulnerability scan may not reflect the actual production environment state.

### Key Component Analysis

| Component | Status | Method | Risk |
| :--- | :--- | :--- | :--- |
| **Stripe** | **Secure** | Direct REST API (`fetch`) | No SDK supply chain risk. |
| **Twilio** | **Secure** | Direct REST API (`fetch`) | No SDK supply chain risk. |
| **OpenAI / Anthropic** | **Secure** | Direct REST API (`fetch`) | No SDK supply chain risk. |
| **Wix SDK** | **Vulnerable** | `@wix/cli` (DevDependency) | Contains vulnerable transitive dependencies (`tar`, `minimatch`). |

### Phantom Dependencies
-   **Finding:** No unlisted phantom dependencies detected in source code.
-   **Observation:** The project correctly uses environment globals for Velo/Wix modules (`wix-secrets-backend`, etc.) without needing them in `package.json`.

## 3. Installation & Remediation Obstacles

-   **Private Packages:** The project depends on `@marketpushapps` scoped packages.
-   **Blocker:** `npm install` and `npm audit fix` fail with `404 Not Found` because the environment lacks authentication credentials for the registry hosting these private packages.
-   **Dependency Confusion Risk:** If the `@marketpushapps` scope is not reserved on the public npm registry, an attacker could publish malicious packages with these names to substitute the private ones (Dependency Confusion Attack). Since the install returns 404 (and not a public package), no collision currently exists, but the risk remains if the scope is unclaimed.

## 4. Actionable Remediation Plan

1.  **Configure Authentication:**
    -   Obtain a valid NPM Token or `.npmrc` configuration for the `@marketpushapps` registry.
    -   Place `.npmrc` in the project root (ensure it is git-ignored or uses environment variables for tokens).

2.  **Regenerate Lockfile:**
    -   Once authenticated, run:
        ```bash
        rm package-lock.json
        npm install
        ```
    -   This will fix the `uuid` version mismatch and restore the missing private dependency trees.

3.  **Remediate Vulnerabilities:**
    -   Run `npm audit fix` to resolve non-breaking issues.
    -   For `minimatch` and `eslint`, plan a migration to `eslint` v9 or wait for a patch in `eslint` v8 dependencies.
    -   Ensure `@wix/cli` is updated to the latest version.

4.  **Isolate Dev Dependencies:**
    -   Verify that `@wix/cli` and `jest` remain strictly in `devDependencies` so their vulnerabilities do not impact the production runtime.
