# Dependency Vulnerability Check Report
**Date:** 2026-10-18
**Status:** FAIL (Critical Integrity Issues)

## Executive Summary

The dependency audit has identified critical failures in supply chain security integrity. The project's `package-lock.json` is significantly out of sync with `package.json`, missing private dependencies entirely and containing version mismatches for core libraries. Additionally, the lack of `.npmrc` configuration for private scopes creates a high-risk vector for dependency confusion attacks.

While `npm audit` reports 36 vulnerabilities (mostly High severity in dev dependencies), the primary risk stems from the broken lockfile state which prevents accurate auditing of production dependencies.

## Vulnerability Summary

| Severity | Count | Primary Affected Packages |
| :--- | :--- | :--- |
| **Critical** | 0 | - |
| **High** | 31 | `minimatch`, `tar` (via `@wix/cli`, `node-gyp`) |
| **Moderate** | 5 | `ajv`, `undici`, `vite` |
| **Low** | 0 | - |

**Total Findings:** 36

## Critical Integrity Failures

### 1. Lockfile Desynchronization (FAIL)
The `package-lock.json` file does not reflect the project's intended dependencies declared in `package.json`.
*   **Missing Dependencies:** All 4 private `@marketpushapps/*` packages are absent from the lockfile. This means `npm audit` completely skipped scanning these dependencies.
*   **Version Mismatch:** `uuid` is locked at version `13.0.0` in `package-lock.json`, while `package.json` requests `^9.0.1`. This major version discrepancy indicates a corrupted or manually edited lockfile.
*   **Scope Mismatch:** `@wix/cli` is listed as a production dependency in the lockfile, but a dev dependency in `package.json`.

### 2. Dependency Confusion Risk (FAIL)
The project relies on private scoped packages (`@marketpushapps/calendy-embed`, etc.) but lacks a `.npmrc` file to configure the private registry.
*   **Risk:** An attacker could register these package names on the public npm registry. Since no private registry is configured, `npm install` would default to fetching the public (malicious) packages, potentially executing arbitrary code during installation.
*   **Status:** High Risk. The names are currently unclaimed (404) on public npm, making them available for squatting.

### 3. Missing Credentials
Installation and verification failed due to missing authentication tokens for `@marketpushapps` packages.

## Audit Findings Detail

### High Severity
*   **`minimatch` (<3.0.5)**: ReDoS vulnerability. Introduced via `eslint`, `glob`, `jest`, and `@wix/cli`.
    *   *Remediation:* Update `eslint` and `@wix/cli` to latest versions.
*   **`tar` (<6.2.1)**: Arbitrary File Overwrite. Introduced via `node-gyp` -> `@wix/cli`.
    *   *Remediation:* Update `@wix/cli` which likely bumps `node-gyp` or `tar`.

### Moderate Severity
*   **`undici`**: Denial of Service via unbounded decompression. Used by `miniflare` -> `@wix/cli-app`.
*   **`vite`**: Directory Traversal / Bypass. Used by `@wix/cli-app`.

## Remediation Plan

### Immediate Actions Required
1.  **Configure Registry:** Create a `.npmrc` file in the project root to securely map the `@marketpushapps` scope to the correct private registry (e.g., GitHub Packages, Wix private registry).
    ```ini
    @marketpushapps:registry=https://npm.pkg.github.com/
    //npm.pkg.github.com/:_authToken=${NPM_TOKEN}
    ```
2.  **Regenerate Lockfile:** Once credentials are set, delete `package-lock.json` and `node_modules`, then run `npm install` to generate a fresh, correct lockfile that includes all dependencies.
    ```bash
    rm -rf node_modules package-lock.json
    npm install
    ```
3.  **Fix Vulnerabilities:** Run `npm audit fix` on the fresh lockfile to resolve the 36 identified issues.
    ```bash
    npm audit fix
    ```

### Strategic Improvements
*   **Pin Dependencies:** Pin `uuid` to a specific version (e.g., `9.0.1`) to avoid accidental major version jumps.
*   **Automated Scanning:** Integrate `npm audit` into the CI/CD pipeline to block builds with Critical/High vulnerabilities.

## Verdict
**FAIL**. The project requires immediate remediation of the lockfile and registry configuration before it can be considered secure.
