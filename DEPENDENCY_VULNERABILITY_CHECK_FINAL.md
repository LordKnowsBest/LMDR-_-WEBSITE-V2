# Dependency Vulnerability Audit Report

## 1. Executive Summary

- **Date:** 2026-02-26
- **Tool:** `npm audit` (v10.8.2)
- **Status:** **FAIL**
- **Findings:** 12 Total Vulnerabilities
  - **Critical:** 0
  - **High:** 7
  - **Moderate:** 5
  - **Low:** 0

## 2. Key Findings

### 2.1. Critical Lockfile Inconsistency
The `package-lock.json` file is critically out of sync with `package.json`.
- **Inconsistency:** `package.json` specifies `uuid: ^9.0.1`, but `package-lock.json` lists `uuid: ^13.0.0`. Version 13.0.0 exists, but creates a major version conflict.
- **Missing Dependencies:** The private scoped packages `@marketpushapps/*` are completely missing from `package-lock.json`, creating a significant blind spot as they cannot be scanned for vulnerabilities.

### 2.2. Dependency Confusion Risk
The project lacks a root `.npmrc` file configuration for the `@marketpushapps` scope.
- **Risk:** Without explicit registry configuration, `npm` attempts to fetch these private packages from the public registry (resulting in 404s). This exposes the project to **Dependency Confusion** attacks if an attacker registers these package names on the public npm registry.

### 2.3. High Severity Vulnerabilities
The following high-severity vulnerabilities were identified in `devDependencies` (via `@wix/cli` and transitive dependencies):

| Package | Severity | Vulnerability ID | Affected Versions | Vulnerability Type | Path | Remediation |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **tar** | High | GHSA-r6q2-hw4h-h46w, GHSA-34x7-hfp2-rc4v, GHSA-8qq5-rm4j-mr97, GHSA-83g3-92jg-28cx | <=7.5.7 | Arbitrary File Overwrite/Creation | `node_modules/tar` | `npm audit fix` |
| **minimatch** | High | GHSA-3ppc-4f35-3m26 | <3.1.3 | ReDoS | `node_modules/minimatch` | `npm audit fix` |
| **rollup** | High | GHSA-mw96-cpmx-2vgc | 4.0.0 - 4.58.0 | Arbitrary File Write | `node_modules/rollup` | `npm audit fix` |

*Note: These vulnerabilities primarily affect the build/development environment (`@wix/cli`), not the production runtime directly, but still pose a risk to developer machines and CI/CD pipelines.*

### 2.4. Integration Security (Stripe, Twilio, AI)
- **Stripe:** No official Stripe SDK (`stripe`) is installed. The integration uses direct `fetch` calls, which avoids supply chain risks associated with the SDK but requires manual implementation of security controls (e.g., signature verification), which has been verified in separate audits.
- **Twilio:** No Twilio SDK (`twilio`) is installed. The specific package `@velo/wix-members-twilio-otp` is **NOT installed**. Integration is via direct API calls.
- **AI Clients:** No OpenAI/Anthropic SDKs are installed. Integration is via direct API calls.
- **Wix SDK:** `@wix/cli` is present in `devDependencies` and contains vulnerabilities (see above).

## 3. Actionable Remediation Plan

### 3.1. Immediate Actions (Requires Credentials)
1. **Configure Private Registry:** Create a `.npmrc` file in the project root to securely route `@marketpushapps` packages to the correct private registry.
   ```ini
   @marketpushapps:registry=https://npm.pkg.github.com/
   //npm.pkg.github.com/:_authToken=${GITHUB_TOKEN}
   ```
2. **Fix Lockfile & Install Dependencies:** Run a clean install to regenerate `package-lock.json` with correct versions and include private packages.
   ```bash
   rm package-lock.json
   npm install
   ```
   *Verify that `uuid` resolves to `^9.0.1` and `@marketpushapps` packages are present in the new lockfile.*

### 3.2. Resolve Vulnerabilities
Once the lockfile is fixed and dependencies are installed:
1. **Run Audit Fix:**
   ```bash
   npm audit fix
   ```
   This should resolve the vulnerabilities in `tar`, `minimatch`, and `rollup` by updating `@wix/cli` and other dev dependencies to safe versions.

### 3.3. Verify React Version
- The project is pinned to `react@16.14.0`. This is a legacy version. Verify if this is a strict requirement for the Wix Velo platform. If not, consider upgrading to React 17 or 18 to benefit from security patches, though this may require code changes.

## 4. Verdict
**FAIL**. The project fails the dependency check due to:
1.  Critical `package-lock.json` inconsistency (`uuid` mismatch).
2.  Missing private dependencies in lockfile (blind spot).
3.  High-severity vulnerabilities in dev dependencies.
4.  Missing `.npmrc` configuration (supply chain risk).
