<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
    <title>VelocityMatch Admin - Email Templates</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
    
    <!-- Quill.js for WYSIWYG -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        lmdr: {
                            dark: '#0f172a',
                            blue: '#2563eb',
                            yellow: '#fbbf24',
                            canvas: '#f8fafc',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #1e293b; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
        
        .bg-background-dark { background-color: #0f172a; }
        .bg-surface-dark { background-color: #1e293b; }
        .bg-surface-darker { background-color: #0f172a; }
        .border-border-dark { border-color: #334155; }
        
        .toast { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .modal-backdrop { background-color: rgba(15, 23, 42, 0.8); backdrop-filter: blur(4px); }
        
        /* Quill custom styling */
        .ql-toolbar.ql-snow { border-color: #334155; background: #1e293b; border-radius: 8px 8px 0 0; }
        .ql-container.ql-snow { border-color: #334155; background: #0f172a; border-radius: 0 0 8px 8px; font-family: 'Inter', sans-serif; font-size: 14px; }
        .ql-snow .ql-stroke { stroke: #94a3b8; }
        .ql-snow .ql-fill { fill: #94a3b8; }
        .ql-snow .ql-picker { color: #94a3b8; }
        .ql-editor { min-height: 300px; color: #f8fafc; }
        .ql-editor.ql-blank::before { color: #475569; }

        /* Preview styles */
        .preview-container { background: #f1f5f9; border-radius: 8px; overflow: auto; }
        .preview-mobile { width: 375px; height: 667px; margin: 0 auto; border: 12px solid #1e293b; border-radius: 32px; background: white; }
        .preview-desktop { width: 100%; min-height: 500px; background: white; }
    </style>
</head>

<body class="font-display antialiased bg-background-dark text-white">

    <!-- Toast Container -->
    <div id="toastContainer" class="fixed top-4 right-4 left-4 md:left-auto z-[100] space-y-2"></div>

    <!-- Main Container -->
    <div class="flex flex-col h-full">

        <!-- Header -->
        <header class="flex-shrink-0 border-b border-border-dark bg-surface-darker px-4 md:px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <button onclick="LMDRBridge.navigateTo('admin-dashboard')" class="p-2 hover:bg-slate-800 rounded-lg transition-colors">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <div>
                        <h1 class="text-xl md:text-2xl font-black tracking-tight text-white">Email Templates</h1>
                        <p class="text-xs md:text-sm text-slate-400 mt-0.5">Manage and customize transactional emails</p>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="openCreateModal()" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-blue-900/20">
                        <span class="material-symbols-outlined text-[20px]">add</span>
                        <span class="hidden md:inline">Create Template</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Filters Bar -->
        <div class="flex-shrink-0 bg-surface-dark border-b border-border-dark px-4 md:px-6 py-3">
            <div class="flex flex-col md:flex-row gap-3">
                <div class="relative flex-1">
                    <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-[20px]">search</span>
                    <input type="text" id="templateSearch" oninput="filterTemplates()" placeholder="Search templates..." 
                        class="w-full bg-surface-darker border-border-dark rounded-lg pl-10 pr-4 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 text-white">
                </div>
                <div class="flex gap-2">
                    <select id="filterCategory" onchange="filterTemplates()" class="bg-surface-darker border-border-dark rounded-lg text-sm py-2 pl-3 pr-10 focus:ring-blue-500 focus:border-blue-500 text-white">
                        <option value="all">All Categories</option>
                        <option value="onboarding">Onboarding</option>
                        <option value="transactional">Transactional</option>
                        <option value="notification">Notification</option>
                        <option value="marketing">Marketing</option>
                    </select>
                    <button onclick="refreshTemplates()" class="p-2 bg-surface-darker border-border-dark border rounded-lg hover:bg-slate-800 transition-colors">
                        <span class="material-symbols-outlined text-[20px] text-slate-400">refresh</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Scrollable Content -->
        <div class="flex-1 overflow-y-auto scrollbar-thin">
            <div class="px-4 md:px-6 py-6">
                <!-- Template Grid -->
                <div id="templateGrid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                    <!-- Templates rendered here -->
                    <div class="col-span-full py-20 text-center">
                        <div class="inline-block w-8 h-8 border-4 border-blue-600/20 border-t-blue-600 rounded-full animate-spin mb-4"></div>
                        <p class="text-slate-400">Loading email templates...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Template Editor Modal -->
    <div id="editorModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop absolute inset-0" onclick="confirmCloseModal()"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4 pointer-events-none">
            <div class="bg-surface-dark border border-border-dark rounded-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden flex flex-col pointer-events-auto shadow-2xl">
                <div class="flex-shrink-0 bg-surface-dark border-b border-border-dark px-6 py-4 flex items-center justify-between">
                    <h2 id="modalTitle" class="text-lg font-bold text-white">Edit Template</h2>
                    <div class="flex items-center gap-2">
                        <button onclick="togglePreview()" id="previewBtn" class="flex items-center gap-2 px-3 py-1.5 text-xs font-bold text-slate-400 hover:text-white transition-colors">
                            <span class="material-symbols-outlined text-[18px]">visibility</span>
                            <span>Preview</span>
                        </button>
                        <button onclick="confirmCloseModal()" class="p-2 hover:bg-slate-800 rounded-lg transition-colors text-slate-400">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                </div>
                
                <div class="flex-1 overflow-y-auto scrollbar-thin flex flex-col lg:flex-row">
                    <!-- Editor Panel -->
                    <div id="editorPanel" class="flex-1 p-6 space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-1.5">
                                <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Template Key</label>
                                <input type="text" id="formKey" required placeholder="e.g. welcome_driver" 
                                    class="w-full bg-surface-darker border-border-dark rounded-lg px-4 py-2 text-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div class="space-y-1.5">
                                <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Name</label>
                                <input type="text" id="formName" required placeholder="e.g. Welcome Email"
                                    class="w-full bg-surface-darker border-border-dark rounded-lg px-4 py-2 text-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-1.5">
                                <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Category</label>
                                <select id="formCategory" class="w-full bg-surface-darker border-border-dark rounded-lg px-4 py-2 text-sm">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="transactional">Transactional</option>
                                    <option value="notification">Notification</option>
                                    <option value="marketing">Marketing</option>
                                </select>
                            </div>
                            <div class="flex items-center gap-4 pt-6">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="formActive" class="text-blue-600 bg-surface-darker border-border-dark rounded focus:ring-blue-500">
                                    <span class="text-sm font-medium">Active (In Use)</span>
                                </label>
                            </div>
                        </div>

                        <div class="space-y-1.5">
                            <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Email Subject</label>
                            <input type="text" id="formSubject" required placeholder="Use {{user.firstName}} for variables"
                                class="w-full bg-surface-darker border-border-dark rounded-lg px-4 py-2.5 text-sm font-medium focus:ring-blue-500 focus:border-blue-500">
                        </div>

                        <div class="space-y-1.5">
                            <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Preheader (Preview Text)</label>
                            <input type="text" id="formPreheader" placeholder="Short summary for inbox preview"
                                class="w-full bg-surface-darker border-border-dark rounded-lg px-4 py-2 text-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>

                        <div class="space-y-1.5">
                            <div class="flex items-center justify-between">
                                <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Email Content (HTML)</label>
                                <div class="flex gap-2">
                                    <button type="button" onclick="insertVariable('user.firstName')" class="text-[10px] bg-slate-800 px-2 py-1 rounded text-slate-300 hover:text-white">user.firstName</button>
                                    <button type="button" onclick="insertVariable('carrier.name')" class="text-[10px] bg-slate-800 px-2 py-1 rounded text-slate-300 hover:text-white">carrier.name</button>
                                </div>
                            </div>
                            <div id="quillEditor" class="h-80"></div>
                        </div>
                    </div>

                    <!-- Preview Panel (Hidden on Mobile by default) -->
                    <div id="previewPanel" class="hidden lg:flex w-full lg:w-[400px] border-l border-border-dark bg-surface-darker p-6 flex-col space-y-4">
                        <div class="flex items-center justify-between">
                            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest">Live Preview</h3>
                            <div class="flex bg-slate-800 rounded-lg p-1">
                                <button onclick="setPreviewSize('desktop')" id="prevDesktopBtn" class="p-1.5 rounded-md bg-blue-600 text-white">
                                    <span class="material-symbols-outlined text-[18px]">desktop_windows</span>
                                </button>
                                <button onclick="setPreviewSize('mobile')" id="prevMobileBtn" class="p-1.5 rounded-md text-slate-400 hover:text-white">
                                    <span class="material-symbols-outlined text-[18px]">smartphone</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="flex-1 preview-container p-4">
                            <div id="emailPreview" class="preview-desktop shadow-lg overflow-y-auto">
                                <!-- Rendered HTML here -->
                            </div>
                        </div>

                        <div class="space-y-3">
                            <div class="p-3 bg-surface-dark rounded-lg border border-border-dark">
                                <p class="text-[10px] font-bold text-slate-500 mb-2 uppercase">Test Send</p>
                                <div class="flex gap-2">
                                    <input type="email" id="testEmailInput" placeholder="recipient@email.com" class="flex-1 bg-surface-darker border-border-dark rounded px-3 py-1.5 text-xs focus:ring-blue-500">
                                    <button onclick="sendTestEmail()" class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded text-xs font-bold transition-colors">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex-shrink-0 bg-surface-dark border-t border-border-dark px-6 py-4 flex items-center justify-between">
                    <div id="versionInfo" class="text-xs text-slate-500 italic">Version 1 (Initial)</div>
                    <div class="flex items-center gap-3">
                        <button onclick="confirmCloseModal()" class="px-6 py-2.5 text-sm font-bold text-slate-400 hover:text-white transition-colors">Cancel</button>
                        <button onclick="saveTemplate()" class="px-8 py-2.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-blue-900/20">Save Template</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/LordKnowsBest/LMDR-_-WEBSITE-V2@main/src/public/js/lmdr-html-bridge.js"></script>
    <script>
        let allTemplates = [];
        let editingTemplate = null;
        let quill = null;
        let previewSize = 'desktop';

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            initQuill();
            
            LMDRBridge.on('actionSuccess', (msg) => {
                showToast(msg, 'success');
                refreshTemplates();
            });
            LMDRBridge.on('actionError', (msg) => showToast(msg, 'error'));
            LMDRBridge.on('templatesLoaded', (templates) => {
                allTemplates = templates;
                renderTemplates(templates);
            });

            // Initial load
            refreshTemplates();
        });

        function initQuill() {
            quill = new Quill('#quillEditor', {
                theme: 'snow',
                placeholder: 'Write your email content here...',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline', 'strike'],
                        [{ 'color': [] }, { 'background': [] }],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link', 'image'],
                        ['clean']
                    ]
                }
            });

            quill.on('text-change', () => {
                updatePreview();
            });
        }

        // ============================================
        // TEMPLATE MANAGEMENT
        // ============================================
        function refreshTemplates() {
            LMDRBridge.send('getAllTemplates');
        }

        function renderTemplates(templates) {
            const grid = document.getElementById('templateGrid');
            if (!templates || templates.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full py-20 text-center">
                        <span class="material-symbols-outlined text-4xl text-slate-600 mb-2">email</span>
                        <p class="text-slate-400">No email templates found</p>
                        <button onclick="openCreateModal()" class="mt-4 text-blue-400 font-bold hover:underline">Create your first template</button>
                    </div>
                `;
                return;
            }

            grid.innerHTML = templates.map(t => `
                <div class="bg-surface-dark border border-border-dark rounded-xl p-5 space-y-4 hover:border-slate-600 transition-colors group">
                    <div class="flex items-start justify-between">
                        <div class="min-w-0">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${getCategoryColor(t.category)}">${t.category}</span>
                                ${t.isActive ? '<span class="px-1.5 py-0.5 bg-emerald-500/20 text-emerald-400 rounded text-[10px] font-bold uppercase">Active</span>' : '<span class="px-1.5 py-0.5 bg-slate-500/20 text-slate-400 rounded text-[10px] font-bold uppercase">Draft</span>'}
                            </div>
                            <h3 class="text-base font-bold truncate text-white" title="${t.name}">${t.name}</h3>
                            <code class="text-[10px] text-blue-400 bg-blue-400/10 px-1 rounded">${t.templateKey}</code>
                        </div>
                        <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="editTemplate('${t.templateKey}')" class="p-2 hover:bg-slate-700 rounded-lg text-slate-400 hover:text-white transition-colors">
                                <span class="material-symbols-outlined text-[20px]">edit</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-surface-darker rounded-lg p-3 space-y-1">
                        <p class="text-[10px] font-bold text-slate-500 uppercase">Subject</p>
                        <p class="text-xs text-slate-300 truncate">${t.subject || 'No subject'}</p>
                    </div>

                    <div class="flex items-center justify-between pt-2 border-t border-border-dark/50">
                        <div class="flex items-center gap-3">
                            <div class="flex flex-col">
                                <span class="text-[9px] text-slate-500 font-bold uppercase">Version</span>
                                <span class="text-xs font-medium text-white">${t.version || 1}</span>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-[9px] text-slate-500 font-bold uppercase">Updated</span>
                                <span class="text-xs font-medium text-slate-400">${formatDate(t.updatedAt)}</span>
                            </div>
                        </div>
                        <button onclick="previewTemplateInModal('${t.templateKey}')" class="text-xs font-bold text-blue-400 hover:text-blue-300">Quick View</button>
                    </div>
                </div>
            `).join('');
        }

        function getCategoryColor(cat) {
            switch(cat) {
                case 'onboarding': return 'bg-violet-500/20 text-violet-400';
                case 'transactional': return 'bg-blue-500/20 text-blue-400';
                case 'notification': return 'bg-amber-500/20 text-amber-400';
                case 'marketing': return 'bg-emerald-500/20 text-emerald-400';
                default: return 'bg-slate-500/20 text-slate-400';
            }
        }

        // ============================================
        // EDITOR & PREVIEW
        // ============================================
        function openCreateModal() {
            editingTemplate = null;
            document.getElementById('modalTitle').textContent = 'Create Email Template';
            document.getElementById('formKey').value = '';
            document.getElementById('formKey').disabled = false;
            document.getElementById('formName').value = '';
            document.getElementById('formCategory').value = 'transactional';
            document.getElementById('formActive').checked = false;
            document.getElementById('formSubject').value = '';
            document.getElementById('formPreheader').value = '';
            document.getElementById('versionInfo').textContent = 'New Template';
            quill.setContents([]);
            
            document.getElementById('editorModal').classList.remove('hidden');
            updatePreview();
        }

        function editTemplate(key) {
            const template = allTemplates.find(t => t.templateKey === key);
            if (!template) return;

            editingTemplate = template;
            document.getElementById('modalTitle').textContent = 'Edit Template';
            document.getElementById('formKey').value = template.templateKey;
            document.getElementById('formKey').disabled = true;
            document.getElementById('formName').value = template.name || '';
            document.getElementById('formCategory').value = template.category || 'transactional';
            document.getElementById('formActive').checked = !!template.isActive;
            document.getElementById('formSubject').value = template.subject || '';
            document.getElementById('formPreheader').value = template.preheader || '';
            document.getElementById('versionInfo').textContent = `Version ${template.version || 1} â€¢ Last updated ${formatDate(template.updatedAt)}`;
            
            // Set HTML content
            quill.root.innerHTML = template.htmlContent || '';

            document.getElementById('editorModal').classList.remove('hidden');
            updatePreview();
        }

        function updatePreview() {
            const subject = document.getElementById('formSubject').value;
            const content = quill.root.innerHTML;
            
            // Simple replace variables for preview (mock data)
            const mockData = {
                'user.firstName': 'John',
                'carrier.name': 'Swift Transport',
                'carrier.dot': '123456',
                'match.score': '92',
                'match.reason': 'Highly recommended based on your route preferences and pay requirements.',
                'platform.url': 'https://www.lastmiledr.app',
                'date.today': new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
            };

            let rendered = content;
            Object.entries(mockData).forEach(([key, val]) => {
                const regex = new RegExp(`{{${key}}}`, 'g');
                rendered = rendered.replace(regex, val);
            });

            document.getElementById('emailPreview').innerHTML = rendered;
        }

        function insertVariable(varName) {
            const selection = quill.getSelection();
            if (selection) {
                quill.insertText(selection.index, `{{${varName}}}`);
            } else {
                quill.insertText(quill.getLength() - 1, `{{${varName}}}`);
            }
        }

        function setPreviewSize(size) {
            previewSize = size;
            const container = document.getElementById('emailPreview');
            const desktopBtn = document.getElementById('prevDesktopBtn');
            const mobileBtn = document.getElementById('prevMobileBtn');

            if (size === 'desktop') {
                container.className = 'preview-desktop shadow-lg overflow-y-auto';
                desktopBtn.className = 'p-1.5 rounded-md bg-blue-600 text-white';
                mobileBtn.className = 'p-1.5 rounded-md text-slate-400 hover:text-white';
            } else {
                container.className = 'preview-mobile shadow-lg overflow-y-auto';
                desktopBtn.className = 'p-1.5 rounded-md text-slate-400 hover:text-white';
                mobileBtn.className = 'p-1.5 rounded-md bg-blue-600 text-white';
            }
        }

        function togglePreview() {
            const panel = document.getElementById('previewPanel');
            const editor = document.getElementById('editorPanel');
            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                panel.classList.add('flex');
            } else {
                panel.classList.add('hidden');
                panel.classList.remove('flex');
            }
        }

        function confirmCloseModal() {
            if (confirm('Close editor? Unsaved changes will be lost.')) {
                document.getElementById('editorModal').classList.add('hidden');
            }
        }

        function saveTemplate() {
            const data = {
                templateKey: document.getElementById('formKey').value,
                name: document.getElementById('formName').value,
                category: document.getElementById('formCategory').value,
                isActive: document.getElementById('formActive').checked,
                subject: document.getElementById('formSubject').value,
                preheader: document.getElementById('formPreheader').value,
                htmlContent: quill.root.innerHTML
            };

            if (editingTemplate) {
                LMDRBridge.send('updateTemplate', { templateKey: data.templateKey, updates: data });
            } else {
                LMDRBridge.send('createTemplate', { templateData: data });
            }
            
            document.getElementById('editorModal').classList.add('hidden');
        }

        function sendTestEmail() {
            const email = document.getElementById('testEmailInput').value;
            if (!email) {
                alert('Please enter a test recipient email');
                return;
            }
            
            const key = document.getElementById('formKey').value;
            LMDRBridge.send('sendTestEmail', { templateKey: key, recipientEmail: email });
        }

        // ============================================
        // FILTERS & UTILS
        // ============================================
        function filterTemplates() {
            const search = document.getElementById('templateSearch').value.toLowerCase();
            const category = document.getElementById('filterCategory').value;

            const filtered = allTemplates.filter(t => {
                const matchesSearch = t.templateKey.toLowerCase().includes(search) || t.name.toLowerCase().includes(search);
                const matchesCategory = category === 'all' || t.category === category;
                return matchesSearch && matchesCategory;
            });

            renderTemplates(filtered);
        }

        function formatDate(date) {
            if (!date) return 'Never';
            const d = new Date(date);
            return d.toLocaleDateString() + ' ' + d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const id = 'toast-' + Date.now();
            const bgColor = type === 'success' ? 'bg-emerald-600' : type === 'error' ? 'bg-rose-600' : 'bg-blue-600';
            const icon = type === 'success' ? 'check_circle' : type === 'error' ? 'error' : 'info';

            const toast = document.createElement('div');
            toast.id = id;
            toast.className = `toast flex items-center gap-3 px-4 py-3 rounded-lg ${bgColor} shadow-lg text-white`;
            toast.innerHTML = `
                <span class="material-symbols-outlined text-[20px]">${icon}</span>
                <span class="text-sm font-medium flex-1">${message}</span>
                <button onclick="document.getElementById('${id}').remove()" class="text-white/80 hover:text-white">
                    <span class="material-symbols-outlined text-[18px]">close</span>
                </button>
            `;
            container.appendChild(toast);
            setTimeout(() => { if (document.getElementById(id)) document.getElementById(id).remove(); }, 5000);
        }
    </script>
</body>
</html>
