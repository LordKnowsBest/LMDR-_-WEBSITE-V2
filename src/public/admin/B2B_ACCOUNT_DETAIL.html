<!DOCTYPE html>
<html class="dark" lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover"/>
  <title>VelocityMatch | Account Detail</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'lmdr-blue': '#2563eb', 'lmdr-deep': '#1e40af',
            'lmdr-yellow': '#fbbf24', 'lmdr-dark': '#0f172a'
          },
          fontFamily: { 'd': ['Inter', 'sans-serif'] }
        }
      }
    };
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LordKnowsBest/LMDR-_-WEBSITE-V2@main/src/public/admin/css/b2b-account-detail.css"/>
</head>
<body class="font-d antialiased bg-slate-950 text-white">
  <div id="toastContainer" class="fixed top-4 right-4 left-4 md:left-auto z-[100] space-y-2"></div>

  <div class="flex flex-col h-full">
    <header class="flex-shrink-0 border-b border-slate-800 bg-slate-900 px-4 md:px-6 py-4 safe-top">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button onclick="goBack()" class="touch-active p-1 rounded-lg hover:bg-slate-800">
            <span class="material-symbols-outlined text-slate-400">arrow_back</span>
          </button>
          <div>
            <h1 id="accountName" class="text-lg md:text-xl font-black tracking-tight">Loading...</h1>
            <p id="accountMeta" class="text-xs text-slate-400 mt-0.5">--</p>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <span id="statusBadge" class="text-xs font-bold px-2.5 py-1 rounded-full bg-slate-700 text-slate-300">--</span>
        </div>
      </div>
    </header>

    <main class="flex-1 overflow-auto scrollbar-thin">
      <div class="p-4 md:p-6 space-y-6">
        <!-- Top Row: Signal + Opportunity + Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Match Signal</h3>
            <div class="flex items-baseline gap-2 mb-2">
              <span id="signalScore" class="text-3xl font-black text-blue-400">--</span>
              <span class="text-sm text-slate-500">score</span>
            </div>
            <p id="signalDrivers" class="text-sm text-slate-300">-- matching drivers</p>
            <p id="signalRegions" class="text-xs text-slate-500 mt-1">Regions: --</p>
            <p id="signalEquipment" class="text-xs text-slate-500">Equipment: --</p>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Opportunity</h3>
            <p class="text-sm text-slate-300">Stage: <span id="oppStage" class="font-semibold text-white">--</span></p>
            <p class="text-sm text-slate-300 mt-1">Value: <span id="oppValue" class="font-semibold text-emerald-400">--</span></p>
            <p class="text-sm text-slate-300 mt-1">Next Step: <span id="oppNextStep" class="font-medium text-slate-200">--</span></p>
            <p id="oppNextStepDate" class="text-xs text-slate-500 mt-0.5">--</p>
          </div>
          <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Actions</h3>
            <div class="grid grid-cols-2 gap-2">
              <button onclick="action('call')" class="touch-target touch-active flex items-center gap-2 px-3 py-2.5 rounded-lg bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30 text-sm font-medium transition-colors">
                <span class="material-symbols-outlined text-[18px]">call</span>Call
              </button>
              <button onclick="action('email')" class="touch-target touch-active flex items-center gap-2 px-3 py-2.5 rounded-lg bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 text-sm font-medium transition-colors">
                <span class="material-symbols-outlined text-[18px]">mail</span>Email
              </button>
              <button onclick="action('sms')" class="touch-target touch-active flex items-center gap-2 px-3 py-2.5 rounded-lg bg-amber-600/20 text-amber-400 hover:bg-amber-600/30 text-sm font-medium transition-colors">
                <span class="material-symbols-outlined text-[18px]">sms</span>Text
              </button>
              <button onclick="action('task')" class="touch-target touch-active flex items-center gap-2 px-3 py-2.5 rounded-lg bg-purple-600/20 text-purple-400 hover:bg-purple-600/30 text-sm font-medium transition-colors">
                <span class="material-symbols-outlined text-[18px]">add_task</span>Task
              </button>
              <button onclick="action('brief')" class="touch-target touch-active col-span-2 flex items-center justify-center gap-2 px-3 py-2.5 rounded-lg bg-cyan-600/20 text-cyan-400 hover:bg-cyan-600/30 text-sm font-medium transition-colors">
                <span class="material-symbols-outlined text-[18px]">auto_awesome</span>Generate Brief
              </button>
            </div>
          </div>
        </div>

        <!-- Contacts + Timeline -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6">
          <div class="bg-slate-900 border border-slate-800 rounded-xl overflow-hidden">
            <div class="px-4 py-3 border-b border-slate-800 flex items-center justify-between">
              <h3 class="text-sm font-bold text-slate-200 uppercase tracking-wider">Contacts</h3>
              <button onclick="action('addContact')" class="touch-active text-xs text-blue-400 hover:text-blue-300 font-medium">+ Add</button>
            </div>
            <div id="contactList" class="divide-y divide-slate-800/50 max-h-[300px] overflow-auto scrollbar-thin">
              <div class="p-4 text-center text-slate-500 text-sm">No contacts yet</div>
            </div>
          </div>
          <div class="lg:col-span-2 bg-slate-900 border border-slate-800 rounded-xl overflow-hidden">
            <div class="px-4 py-3 border-b border-slate-800 flex items-center justify-between">
              <h3 class="text-sm font-bold text-slate-200 uppercase tracking-wider">Activity Timeline</h3>
              <button onclick="action('logActivity')" class="touch-active text-xs text-blue-400 hover:text-blue-300 font-medium">+ Log Activity</button>
            </div>
            <div id="timeline" class="p-4 max-h-[400px] overflow-auto scrollbar-thin space-y-4">
              <div class="text-center text-slate-500 text-sm py-4">No activities yet</div>
            </div>
          </div>
        </div>

        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <div class="flex items-center justify-between mb-2">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider">AI Context</h3>
            <button onclick="refreshSummary()" class="text-xs text-blue-400 hover:text-blue-300">Refresh</button>
          </div>
          <p id="aiSummaryText" class="text-sm text-slate-200">Loading summary...</p>
          <p id="aiSummaryMeta" class="text-xs text-slate-500 mt-2">--</p>
        </div>

        <!-- Deal Risks -->
        <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
          <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Deal Risks & Notes</h3>
          <div id="riskList" class="space-y-2">
            <p class="text-sm text-slate-500">No risks identified</p>
          </div>
        </div>
      </div>
      <div class="safe-bottom"></div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/gh/LordKnowsBest/LMDR-_-WEBSITE-V2@main/src/public/admin/js/b2b-account-detail-bridge.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/LordKnowsBest/LMDR-_-WEBSITE-V2@main/src/public/admin/js/b2b-account-detail-logic.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      AccountDetailLogic.exposeGlobals();
      AccountDetailLogic.init();
    });
  </script>
</body>
</html>
