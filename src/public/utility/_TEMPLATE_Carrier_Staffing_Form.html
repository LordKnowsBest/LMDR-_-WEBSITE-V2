<!DOCTYPE html>
<!--
================================================================================
LMDR CARRIER STAFFING FORM TEMPLATE
================================================================================

USAGE:
1. Copy this file and rename for your landing page (e.g., "Regional CDL Staffing.html")
2. Customize the hero section, pain points, and page content
3. DO NOT modify the form structure or PostMessage bridge - they integrate with carrierLeadsService.jsw
4. Place file in src/public/ directory

REQUIRED PAGE CODE:
Your Wix page code must include:

  import { submitCarrierStaffingRequest } from 'backend/carrierLeadsService';

  $w.onReady(function() {
    initCarrierStaffingForm();
  });

  function initCarrierStaffingForm() {
    const htmlComponent = $w('#html1'); // Adjust ID as needed

    htmlComponent.onMessage(async (event) => {
      if (event.data.type === 'submitCarrierStaffingRequest') {
        const result = await submitCarrierStaffingRequest(event.data.data);
        htmlComponent.postMessage({ type: 'staffingRequestResult', data: result });
      }
    });
  }

FORM FIELDS (do not rename):
- companyName: Company name (required)
- contactName: Contact person (required)
- email: Email address (required)
- phone: Phone number (required)
- dotNumber: DOT number (optional - enables carrier linking)
- staffingType: "emergency" or "strategic" (required)
- driversNeeded: Driver count range (required)
- driverTypes: Array of driver types needed
- additionalNotes: Free text (optional)

POSTMESSAGE PROTOCOL:
- Form sends: { type: 'submitCarrierStaffingRequest', data: formData }
- Backend responds: { type: 'staffingRequestResult', data: { success, leadId?, error? } }

================================================================================
-->
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CUSTOMIZE: Update title and meta tags for your landing page -->
    <title>[PAGE TITLE] | VelocityMatch</title>
    <meta name="description" content="[PAGE DESCRIPTION]">
    <link rel="canonical" href="https://www.lastmiledr.app/[PAGE-SLUG]">

    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- LMDR Standard Tailwind Config (inline for Wix iframe) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        lmdr: {
                            dark: '#0f172a',
                            blue: '#2563eb',
                            yellow: '#fbbf24',
                            canvas: '#f8fafc',
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
    <script src="../theme-utils.js"></script>

    <!-- Analytics Placeholders (Replace IDs in production) -->
    <script>
        // Google Analytics (Stub)
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        // gtag('config', 'G-XXXXXXXXXX'); 

        // Facebook Pixel (Stub)
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        // fbq('init', 'XXXXXXXXXXXXXXXX'); 
        // fbq('track', 'PageView');
    </script>

    <!-- LMDR Standard Form Styles (DO NOT MODIFY) -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .hero-gradient-text {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .reveal {
            opacity: 1;
            transform: translateY(0);
            transition: all 0.8s ease-out;
            will-change: opacity, transform;
        }

        @media (prefers-reduced-motion: no-preference) {
            .reveal:not(.active) {
                opacity: 0;
                transform: translateY(30px);
            }
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .staffing-type-option input:checked~.check-indicator {
            background: #2563eb;
            border-color: #2563eb;
        }

        .staffing-type-option input:checked~.check-indicator::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        .staffing-type-option:has(input:checked) {
            border-color: #2563eb;
            background: #eff6ff;
        }

        .staffing-type-option:has(input[value="Emergency"]:checked) {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .driver-type-chip {
            cursor: pointer;
        }

        .driver-type-chip .chip-label {
            display: block;
            padding: 0.5rem 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            text-align: center;
            transition: all 0.2s;
            background: white;
            color: #475569;
        }

        .driver-type-chip:hover .chip-label {
            border-color: #2563eb;
            color: #2563eb;
        }

        .driver-type-chip input:checked+.chip-label {
            background: #2563eb;
            border-color: #2563eb;
            color: white;
        }
    </style>
</head>

<body class="bg-lmdr-canvas text-slate-900 font-sans antialiased">

    <!-- ================================================================
         CUSTOMIZE: Add your hero section and page content here
         ================================================================ -->
    <section class="py-16 md:py-24">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-6xl font-black text-lmdr-dark mb-6">
                [Your Page Title]
            </h1>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto mb-8">
                [Your page description]
            </p>
            <a href="#carrier-form-section"
                onclick="document.getElementById('carrier-form-section').scrollIntoView({behavior: 'smooth'}); return false;"
                class="inline-block bg-lmdr-blue text-white font-bold px-8 py-4 rounded-xl hover:bg-blue-700 transition-colors">
                Request Staffing <i class="fa-solid fa-arrow-right ml-2"></i>
            </a>
        </div>
    </section>

    <!-- ================================================================
         STANDARD CARRIER STAFFING FORM (DO NOT MODIFY STRUCTURE)
         ================================================================ -->
    <section id="carrier-form-section" class="py-20 bg-slate-50 relative">
        <div class="container mx-auto px-4 relative z-10">
            <div class="max-w-4xl mx-auto text-center mb-12 reveal">
                <span class="inline-block bg-lmdr-blue text-white text-xs font-bold px-3 py-1 rounded-full mb-4">
                    ENTERPRISE SOLUTIONS
                </span>
                <h2 class="text-3xl md:text-5xl font-black mb-4 text-lmdr-dark">Request Staffing Now</h2>
                <p class="text-slate-500">Fill out the form below. Whether it's 1 emergency driver or 100 for peak
                    season.</p>
            </div>

            <div class="max-w-3xl mx-auto bg-white rounded-2xl p-8 md:p-12 shadow-2xl reveal border border-slate-200">
                <form id="carrierStaffingForm" class="space-y-6">
                    <!-- Row 1: Company & Contact -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="companyName" class="block text-sm font-semibold text-slate-700 mb-2">
                                Company Name <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="companyName" name="companyName" required
                                class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all"
                                placeholder="Your Company Name">
                        </div>
                        <div>
                            <label for="contactName" class="block text-sm font-semibold text-slate-700 mb-2">
                                Contact Name <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="contactName" name="contactName" required
                                class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all"
                                placeholder="Your Name">
                        </div>
                    </div>

                    <!-- Row 2: Email & Phone -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label for="email" class="block text-sm font-semibold text-slate-700 mb-2">
                                Email <span class="text-red-500">*</span>
                            </label>
                            <input type="email" id="email" name="email" required
                                class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all"
                                placeholder="you@company.com">
                        </div>
                        <div>
                            <label for="phone" class="block text-sm font-semibold text-slate-700 mb-2">
                                Phone <span class="text-red-500">*</span>
                            </label>
                            <input type="tel" id="phone" name="phone" required
                                class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all"
                                placeholder="(555) 123-4567">
                        </div>
                    </div>

                    <!-- Row 3: DOT Number (Optional - enables carrier linking) -->
                    <div>
                        <label for="dotNumber" class="block text-sm font-semibold text-slate-700 mb-2">
                            DOT Number <span class="text-slate-400 font-normal">(Optional)</span>
                        </label>
                        <input type="text" id="dotNumber" name="dotNumber"
                            class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all"
                            placeholder="e.g., 1234567">
                    </div>

                    <!-- Row 4: Staffing Type -->
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-3">
                            Staffing Type <span class="text-red-500">*</span>
                        </label>
                        <div class="grid md:grid-cols-2 gap-4">
                            <label
                                class="relative flex items-start p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:border-red-400 transition-all staffing-type-option">
                                <input type="radio" name="staffingType" value="Emergency" required class="sr-only">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0">
                                        <i class="fa-solid fa-bolt text-red-600"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">Emergency Response</span>
                                        <span class="text-xs text-slate-500">Need drivers in &lt;24 hours</span>
                                    </div>
                                </div>
                                <div
                                    class="absolute top-3 right-3 w-5 h-5 rounded-full border-2 border-slate-300 check-indicator">
                                </div>
                            </label>
                            <label
                                class="relative flex items-start p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:border-lmdr-blue transition-all staffing-type-option">
                                <input type="radio" name="staffingType" value="Strategic" required class="sr-only">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                                        <i class="fa-solid fa-chart-line text-lmdr-blue"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">Strategic Staffing</span>
                                        <span class="text-xs text-slate-500">Planned high-volume needs</span>
                                    </div>
                                </div>
                                <div
                                    class="absolute top-3 right-3 w-5 h-5 rounded-full border-2 border-slate-300 check-indicator">
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Row 5: Drivers Needed -->
                    <div>
                        <label for="driversNeeded" class="block text-sm font-semibold text-slate-700 mb-2">
                            How Many Drivers Do You Need? <span class="text-red-500">*</span>
                        </label>
                        <select id="driversNeeded" name="driversNeeded" required
                            class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all bg-white">
                            <option value="">Select...</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10+">10+</option>
                        </select>
                    </div>

                    <!-- Row 6: Driver Types (Multi-select) -->
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-3">
                            Driver Types Needed <span class="text-slate-400 font-normal">(Select all that apply)</span>
                        </label>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Class A" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-truck mr-1"></i> Class A</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Class B" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-truck-moving mr-1"></i> Class B</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Hazmat" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-flask mr-1"></i> Hazmat</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Tanker" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-truck-droplet mr-1"></i> Tanker</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Reefer" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-snowflake mr-1"></i> Reefer</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Flatbed" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-dolly mr-1"></i> Flatbed</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="DSD" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-store mr-1"></i> DSD</span>
                            </label>
                            <label class="driver-type-chip">
                                <input type="checkbox" name="driverTypes" value="Non-CDL" class="sr-only">
                                <span class="chip-label"><i class="fa-solid fa-van-shuttle mr-1"></i> Non-CDL</span>
                            </label>
                        </div>
                    </div>

                    <!-- Row 7: Additional Notes -->
                    <div>
                        <label for="additionalNotes" class="block text-sm font-semibold text-slate-700 mb-2">
                            Additional Details <span class="text-slate-400 font-normal">(Optional)</span>
                        </label>
                        <textarea id="additionalNotes" name="additionalNotes" rows="3"
                            class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-lmdr-blue focus:ring-2 focus:ring-lmdr-blue/20 outline-none transition-all resize-none"
                            placeholder="Tell us more about your staffing needs, locations, timeline, etc."></textarea>
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-4">
                        <button type="submit" id="submitBtn"
                            class="w-full bg-lmdr-blue text-white font-bold text-lg py-4 rounded-xl hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
                            <span id="submitBtnText">Submit Staffing Request</span>
                            <i class="fa-solid fa-arrow-right"></i>
                            <i class="fa-solid fa-spinner fa-spin hidden" id="submitSpinner"></i>
                        </button>
                    </div>

                    <!-- Form Messages -->
                    <div id="formSuccess"
                        class="hidden p-4 rounded-xl bg-green-50 border border-green-200 text-green-800">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-circle-check text-green-600 text-xl"></i>
                            <div>
                                <p class="font-bold">Request Submitted!</p>
                                <p class="text-sm">Redirecting to secure checkout...</p>
                            </div>
                        </div>
                    </div>
                    <div id="formError" class="hidden p-4 rounded-xl bg-red-50 border border-red-200 text-red-800">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-circle-exclamation text-red-600 text-xl"></i>
                            <div>
                                <p class="font-bold">Submission Error</p>
                                <p class="text-sm" id="formErrorMessage">There was a problem submitting your request.
                                    Please try again.</p>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- ================================================================
         STANDARD SCRIPTS (DO NOT MODIFY)
         ================================================================ -->

    <!-- Reveal Animation -->
    <script>
        const revealElements = document.querySelectorAll('.reveal');
        function checkScroll() {
            const triggerBottom = window.innerHeight * 0.85;
            revealElements.forEach(el => {
                const elementTop = el.getBoundingClientRect().top;
                if (elementTop < triggerBottom) {
                    el.classList.add('active');
                }
            });
        }
        window.addEventListener('scroll', checkScroll);
        checkScroll();
    </script>

    <!-- Carrier Staffing Form Handler (PostMessage Bridge) -->
    <script>
        (function () {
            'use strict';

            const DEBUG = true;
            const VELO_TIMEOUT = 30000;

            function log(...args) {
                if (DEBUG) console.log('[StaffingForm]', ...args);
            }

            const form = document.getElementById('carrierStaffingForm');
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitSpinner = document.getElementById('submitSpinner');
            const formSuccess = document.getElementById('formSuccess');
            const formError = document.getElementById('formError');
            const formErrorMessage = document.getElementById('formErrorMessage');

            let pendingCallback = null;

            window.addEventListener('message', function (event) {
                const msg = event.data;
                if (!msg || !msg.type) return;

                log('Received message:', msg.type);

                if (msg.type === 'staffingRequestResult') {
                    if (pendingCallback) {
                        pendingCallback(msg.data);
                        pendingCallback = null;
                    }
                }
            });

            function sendToVelo(action, data) {
                return new Promise((resolve, reject) => {
                    const timeoutId = setTimeout(() => {
                        pendingCallback = null;
                        reject(new Error('Request timed out. Please try again.'));
                    }, VELO_TIMEOUT);

                    pendingCallback = (result) => {
                        clearTimeout(timeoutId);
                        resolve(result);
                    };

                    const message = { type: action, action: action, data: data };
                    log('Sending to Velo:', action, data);
                    window.parent.postMessage(message, '*');
                });
            }

            function getFormData() {
                const driverTypeCheckboxes = form.querySelectorAll('input[name="driverTypes"]:checked');
                const driverTypes = Array.from(driverTypeCheckboxes).map(cb => cb.value);
                const staffingType = form.querySelector('input[name="staffingType"]:checked');

                return {
                    companyName: form.querySelector('#companyName').value.trim(),
                    contactName: form.querySelector('#contactName').value.trim(),
                    email: form.querySelector('#email').value.trim(),
                    phone: form.querySelector('#phone').value.trim(),
                    dotNumber: form.querySelector('#dotNumber').value.trim(),
                    staffingType: staffingType ? staffingType.value : '',
                    driversNeeded: form.querySelector('#driversNeeded').value,
                    driverTypes: driverTypes,
                    additionalNotes: form.querySelector('#additionalNotes').value.trim(),
                    sourceUrl: window.location.pathname
                };
            }

            function setLoading(isLoading) {
                submitBtn.disabled = isLoading;
                if (isLoading) {
                    submitBtnText.textContent = 'Submitting...';
                    submitSpinner.classList.remove('hidden');
                    submitBtn.querySelector('.fa-arrow-right').classList.add('hidden');
                } else {
                    submitBtnText.textContent = 'Submit Staffing Request';
                    submitSpinner.classList.add('hidden');
                    submitBtn.querySelector('.fa-arrow-right').classList.remove('hidden');
                }
            }

            function showSuccess() {
                formSuccess.classList.remove('hidden');
                formError.classList.add('hidden');
                form.reset();
                formSuccess.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Track Conversion
                try {
                    console.log('[Analytics] Tracking lead_submitted');
                    /*
                    gtag('event', 'lead_submitted', {
                        'event_category': 'Carrier',
                        'event_label': 'Staffing Request'
                    });
                    fbq('track', 'Lead');
                    */
                } catch (e) { console.error('Analytics error:', e); }
            }

            function showError(message) {
                formError.classList.remove('hidden');
                formSuccess.classList.add('hidden');
                formErrorMessage.textContent = message || 'There was a problem submitting your request. Please try again.';
                formError.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            function hideMessages() {
                formSuccess.classList.add('hidden');
                formError.classList.add('hidden');
            }

            form.addEventListener('submit', async function (e) {
                e.preventDefault();
                hideMessages();

                const formData = getFormData();
                log('Form data:', formData);

                if (!formData.companyName) { showError('Please enter your company name.'); return; }
                if (!formData.contactName) { showError('Please enter your name.'); return; }
                if (!formData.email) { showError('Please enter your email address.'); return; }
                if (!formData.phone) { showError('Please enter your phone number.'); return; }
                if (!formData.staffingType) { showError('Please select a staffing type.'); return; }
                if (!formData.driversNeeded) { showError('Please select how many drivers you need.'); return; }

                setLoading(true);

                try {
                    const result = await sendToVelo('submitCarrierStaffingRequest', formData);
                    log('Submission result:', result);

                    if (result && result.success) {
                        showSuccess();
                    } else {
                        showError(result?.error || 'Submission failed. Please try again.');
                    }
                } catch (error) {
                    log('Submission error:', error);
                    showError(error.message || 'There was a problem submitting your request. Please try again.');
                } finally {
                    setLoading(false);
                }
            });

            log('Carrier Staffing Form initialized');
            window.parent.postMessage({ type: 'staffingFormReady', action: 'staffingFormReady' }, '*');
        })();
    </script>
</body>

</html>