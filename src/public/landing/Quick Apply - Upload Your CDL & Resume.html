<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Securely upload your CDL, Medical Card, and resume to Last Mile Driver Recruiting. Fast-track your application and get matched with top local carriers in 24 hours.">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.lastmiledr.app/ai-matching">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.lastmiledr.app/apply">
    <meta property="og:title" content="Upload CDL Documents - Fast Track Application | LMDR">
    <meta property="og:description" content="Securely upload your CDL and Medical Card. Complete your driver profile in 60 seconds and start receiving job offers.">
    <meta property="og:image" content="https://www.lastmiledr.app/assets/og-upload.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.lastmiledr.app/apply">
    <meta property="twitter:title" content="Upload CDL Documents - Fast Track Application | LMDR">
    <meta property="twitter:description" content="Securely upload your CDL and Medical Card. Complete your driver profile in 60 seconds.">
    <meta property="twitter:image" content="https://www.lastmiledr.app/assets/og-upload.jpg">

    <title>Upload CDL Documents | Quick Apply | Last Mile DR</title>
    
    <!-- Performance Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../lmdr-config.js"></script>
    

    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .driver-gradient { background: linear-gradient(135deg, #F9FF80 0%, #fbbf24 100%); }

        /* File Upload Styles */
        .file-upload-section { margin-bottom: 24px; }
        .file-upload-section h4 {
            font-size: 14px;
            font-weight: 700;
            color: #0f172a;
            margin: 0 0 12px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .file-upload-section h4 i { color: #2563eb; }
        .file-upload-section h4 .required { color: #ef4444; font-size: 12px; }

        .file-upload-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        @media (max-width: 600px) {
            .file-upload-grid { grid-template-columns: 1fr; }
        }

        .file-upload-box {
            border: 2px dashed #e2e8f0;
            border-radius: 12px;
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: #f8fafc;
            position: relative;
        }
        .file-upload-box:hover {
            border-color: #2563eb;
            background: #eff6ff;
        }
        .file-upload-box.has-file {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .file-upload-box.error {
            border-color: #ef4444;
            background: #fef2f2;
        }
        .file-upload-box.ocr-processing {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            animation: ocr-pulse 1.5s ease-in-out infinite;
        }
        .file-upload-box.ocr-processing .upload-icon { color: #3b82f6; }
        .file-upload-box.ocr-success {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        @keyframes ocr-pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(59, 130, 246, 0); }
        }

        .file-upload-box input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .file-upload-box .upload-icon {
            font-size: 28px;
            color: #94a3b8;
            margin-bottom: 10px;
        }
        .file-upload-box.has-file .upload-icon { color: #10b981; }
        .file-upload-box .upload-label {
            font-size: 14px;
            font-weight: 600;
            color: #0f172a;
            display: block;
            margin-bottom: 4px;
        }
        .file-upload-box .upload-hint {
            font-size: 12px;
            color: #94a3b8;
        }
        .file-upload-box .file-name {
            font-size: 12px;
            color: #10b981;
            font-weight: 600;
            margin-top: 8px;
            word-break: break-all;
        }
        .file-upload-box .remove-file {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 12px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .file-upload-box.has-file .remove-file { display: flex; }

        .upload-requirements {
            background: #fffbeb;
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            font-size: 12px;
            color: #92400e;
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }
        .upload-requirements i { color: #f59e0b; margin-top: 2px; }

        /* Form Styles */
        .form-section { margin-top: 24px; }
        .form-section-title {
            font-size: 14px;
            font-weight: 700;
            color: #0f172a;
            margin: 0 0 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }
        .form-section-title i { color: #2563eb; }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        @media (max-width: 600px) {
            .form-grid { grid-template-columns: 1fr; }
        }

        .form-group { display: flex; flex-direction: column; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group label {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #0f172a;
        }
        .form-group label .required { color: #ef4444; }

        .form-input, .form-select {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            padding: 12px 16px;
            font-size: 15px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            color: #0f172a;
            border-radius: 10px;
            transition: all 0.2s;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        .form-input.auto-filled, .form-select.auto-filled {
            border-color: #10b981 !important;
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%) !important;
        }

        .error-message {
            font-size: 12px;
            color: #ef4444;
            margin-top: 4px;
            display: none;
        }
        .form-group.error .error-message { display: block; }
        .form-group.error .form-input { border-color: #ef4444; }

        /* Submit Button */
        .submit-section { margin-top: 32px; }
        .submit-btn {
            width: 100%;
            background: #0f172a;
            color: #ffffff;
            border: none;
            padding: 18px 32px;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            border-radius: 12px;
        }
        .submit-btn:hover {
            background: #1e293b;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(15, 23, 42, 0.25);
        }
        .submit-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .submit-btn.loading { pointer-events: none; }

        /* Success/Error States */
        .form-success, .form-error {
            padding: 20px;
            border-radius: 12px;
            margin-top: 16px;
            display: none;
        }
        .form-success {
            background: #f0fdf4;
            border: 1px solid #10b981;
            color: #065f46;
        }
        .form-success.show { display: block; }
        .form-error {
            background: #fef2f2;
            border: 1px solid #ef4444;
            color: #991b1b;
        }
        .form-error.show { display: block; }
    </style>

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Upload CDL Documents",
      "description": "Secure document upload portal for CDL drivers applying to Last Mile Driver Recruiting.",
      "url": "https://www.lastmiledr.app/quick-apply",
      "isPartOf": {
        "@type": "WebSite",
        "name": "Last Mile Driver Recruiting",
        "url": "https://www.lastmiledr.app"
      },
      "audience": {
        "@type": "Audience",
        "audienceType": "CDL Truck Drivers"
      }
    }
    </script>
</head>
<body class="bg-lmdr-canvas text-lmdr-dark font-sans antialiased selection:bg-amber-100 selection:text-lmdr-dark">

    <!-- Announcement Banner -->
    <div role="banner" class="bg-lmdr-dark text-white text-center py-2 text-sm font-medium border-b border-slate-800">
        <i class="fa-solid fa-calendar-check text-lmdr-yellow mr-2" aria-hidden="true"></i>
        <span>Start 2026 Strong: Fast-track your application by uploading documents today.</span>
    </div>

    <!-- Hero Header -->
    <header class="bg-lmdr-dark pt-12 pb-24 relative overflow-hidden" aria-label="Page Header">
        <!-- Background Decorative Elements -->
        <div class="absolute top-0 right-0 w-96 h-96 bg-lmdr-blue/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2" aria-hidden="true"></div>
        <div class="absolute bottom-0 left-0 w-64 h-64 bg-lmdr-yellow/5 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2" aria-hidden="true"></div>

        <div class="max-w-6xl mx-auto px-4 relative z-10">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <!-- Hero Text -->
                <div class="text-center md:text-left">
                    <h1 class="text-3xl md:text-5xl lg:text-6xl font-black text-white mb-6 leading-tight">
                        CDL Document <br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-yellow-200">Upload Center</span>
                    </h1>
                    <p class="text-lg text-slate-300 max-w-xl mx-auto md:mx-0 mb-8 leading-relaxed">
                        You're almost there! Securely upload your required documents to complete your profile and get matched with top local carriers in as little as 24 hours.
                    </p>
                    <div class="flex flex-wrap gap-4 justify-center md:justify-start text-sm text-slate-400">
                        <span class="flex items-center gap-2">
                            <i class="fa-solid fa-shield-halved text-lmdr-blue" aria-hidden="true"></i>
                            DOT Compliant
                        </span>
                        <span class="flex items-center gap-2">
                            <i class="fa-solid fa-clock text-lmdr-yellow" aria-hidden="true"></i>
                            24h Verification
                        </span>
                    </div>
                </div>

                <!-- Hero Image Visual -->
                <div class="hidden md:block relative">
                    <div class="absolute inset-0 bg-gradient-to-tr from-blue-600/20 to-amber-400/10 rounded-3xl blur-2xl" aria-hidden="true"></div>
                    <img 
                        src="https://static.wixstatic.com/media/39f69d_f33c1845c11043e0b0e421f2ee4365ec~mv2.png" 
                        alt="Professional CDL Driver Application" 
                        class="relative z-10 w-full h-auto object-contain max-h-[400px] drop-shadow-2xl animate-float rounded-3xl"
                        loading="lazy"
                    >
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 -mt-16 pb-12 relative z-20">
        
        <!-- Progress Bar -->
        <nav aria-label="Progress Steps" class="bg-white rounded-2xl shadow-lg p-6 mb-8 max-w-3xl mx-auto border border-slate-100">
            <ol class="flex items-center justify-between relative list-none m-0 p-0">
                <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-100 -z-0" aria-hidden="true"></div>
                <div id="progressFill" class="absolute top-1/2 left-0 h-1 bg-lmdr-dark -z-0 transition-all duration-500" style="width: 0%;" aria-hidden="true"></div>

                <li id="step1" class="relative z-10 text-center">
                    <div id="step1Circle" class="w-10 h-10 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center font-bold mx-auto mb-2 ring-4 ring-white transition-all duration-300">
                        <span id="step1Number">1</span>
                        <i id="step1Check" class="fa-solid fa-check hidden" aria-hidden="true"></i>
                    </div>
                    <span id="step1Label" class="text-xs font-bold text-gray-400 uppercase tracking-wide transition-colors duration-300">Contact Info</span>
                </li>

                <li id="step2" class="relative z-10 text-center">
                    <div id="step2Circle" class="w-10 h-10 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center font-bold mx-auto mb-2 ring-4 ring-white transition-all duration-300">
                        <span id="step2Number">2</span>
                        <i id="step2Check" class="fa-solid fa-check hidden" aria-hidden="true"></i>
                    </div>
                    <span id="step2Label" class="text-xs font-bold text-gray-400 uppercase tracking-wide transition-colors duration-300">Upload Docs</span>
                </li>

                <li id="step3" class="relative z-10 text-center">
                    <div id="step3Circle" class="w-10 h-10 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center font-bold mx-auto mb-2 ring-4 ring-white transition-all duration-300">
                        <span id="step3Number">3</span>
                        <i id="step3Check" class="fa-solid fa-check hidden" aria-hidden="true"></i>
                    </div>
                    <span id="step3Label" class="text-xs font-bold text-gray-400 uppercase tracking-wide transition-colors duration-300">CDL Details</span>
                </li>
            </ol>
            <!-- Progress percentage -->
            <div class="mt-4 text-center">
                <span id="progressText" class="text-sm font-semibold text-slate-600">0% Complete</span>
            </div>
        </nav>

        <div class="grid md:grid-cols-3 gap-8">
            <!-- Sidebar -->
            <aside class="md:col-span-1 space-y-6">
                <section class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6" aria-labelledby="req-docs-title">
                    <h2 id="req-docs-title" class="text-lg font-bold text-lmdr-dark mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-list-check text-lmdr-blue" aria-hidden="true"></i>
                        Required Docs
                    </h2>
                    
                    <ul class="space-y-4 list-none pl-0">
                        <li id="checkCdlFront" class="flex gap-3">
                            <div id="checkCdlFrontIcon" class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center text-xs transition-all duration-300" aria-hidden="true">
                                <i class="fa-solid fa-circle text-[8px]"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-lmdr-dark">CDL Front</h3>
                                <p id="checkCdlFrontStatus" class="text-xs text-slate-500">Not uploaded</p>
                            </div>
                        </li>

                        <li id="checkCdlBack" class="flex gap-3">
                            <div id="checkCdlBackIcon" class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center text-xs transition-all duration-300" aria-hidden="true">
                                <i class="fa-solid fa-circle text-[8px]"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-lmdr-dark">CDL Back</h3>
                                <p id="checkCdlBackStatus" class="text-xs text-slate-500">Not uploaded</p>
                            </div>
                        </li>

                        <li id="checkMedCard" class="flex gap-3">
                            <div id="checkMedCardIcon" class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center text-xs transition-all duration-300" aria-hidden="true">
                                <i class="fa-solid fa-circle text-[8px]"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-lmdr-dark">Medical Card</h3>
                                <p id="checkMedCardStatus" class="text-xs text-slate-500">Not uploaded</p>
                            </div>
                        </li>

                        <li id="checkMvr" class="flex gap-3">
                            <div id="checkMvrIcon" class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center text-xs transition-all duration-300" aria-hidden="true">
                                <i class="fa-solid fa-circle text-[8px]"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-lmdr-dark">MVR <span class="text-gray-400 font-normal">(Optional)</span></h3>
                                <p id="checkMvrStatus" class="text-xs text-slate-500">Not uploaded</p>
                            </div>
                        </li>

                        <li id="checkResume" class="flex gap-3">
                            <div id="checkResumeIcon" class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center text-xs transition-all duration-300" aria-hidden="true">
                                <i class="fa-solid fa-circle text-[8px]"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-lmdr-dark">Resume <span class="text-gray-400 font-normal">(Optional)</span></h3>
                                <p id="checkResumeStatus" class="text-xs text-slate-500">Not uploaded</p>
                            </div>
                        </li>
                    </ul>

                    <div class="mt-6 bg-amber-50 border border-amber-100 rounded-lg p-4">
                        <div class="flex gap-2">
                            <i class="fa-solid fa-lightbulb text-amber-500 mt-1" aria-hidden="true"></i>
                            <div>
                                <h4 class="text-sm font-bold text-lmdr-dark">Pro Tip</h4>
                                <p class="text-xs text-slate-600 mt-1">Ensure photos are clear, well-lit, and all text is readable to speed up verification.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <nav class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6" aria-label="Quick Links">
                    <h3 class="text-sm font-bold text-lmdr-dark mb-4">Quick Links</h3>
                    <div class="space-y-3">
                        <a href="https://www.lastmiledr.app/ai-matching" target="_blank" rel="noopener noreferrer" class="block w-full text-center py-2 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-colors">
                            Use AI Matcher Instead
                        </a>
                        <a href="https://www.lastmiledr.app/drivers" target="_blank" rel="noopener noreferrer" class="block w-full text-center py-2 px-4 bg-white border border-slate-200 hover:border-slate-300 text-slate-600 rounded-lg text-sm font-medium transition-colors">
                            Browse All Jobs
                        </a>
                    </div>
                </nav>
            </aside>

            <!-- Main Form Section -->
            <section class="md:col-span-2">
                <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden">
                    <div class="bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                        <h2 class="text-lg font-bold text-lmdr-dark">Secure Upload Form</h2>
                        <span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700">
                            <i class="fa-solid fa-lock" aria-hidden="true"></i> 256-bit SSL Encrypted
                        </span>
                    </div>
                    
                    <div class="p-6">
                        <form id="quickApplyForm">
                            <!-- CDL Upload Section -->
                            <div class="file-upload-section">
                                <h4><i class="fa-solid fa-id-card"></i> CDL License <span class="required">*</span></h4>
                                <div class="file-upload-grid">
                                    <div class="file-upload-box" id="cdlFrontBox">
                                        <input type="file" id="cdlFront" accept="image/*" />
                                        <button type="button" class="remove-file" onclick="removeFile('cdlFront')"><i class="fa-solid fa-times"></i></button>
                                        <div class="upload-icon"><i class="fa-solid fa-id-card"></i></div>
                                        <span class="upload-label">CDL Front</span>
                                        <span class="upload-hint">Click or tap to upload</span>
                                        <span class="file-name" id="cdlFrontName"></span>
                                    </div>
                                    <div class="file-upload-box" id="cdlBackBox">
                                        <input type="file" id="cdlBack" accept="image/*" />
                                        <button type="button" class="remove-file" onclick="removeFile('cdlBack')"><i class="fa-solid fa-times"></i></button>
                                        <div class="upload-icon"><i class="fa-solid fa-id-card-clip"></i></div>
                                        <span class="upload-label">CDL Back</span>
                                        <span class="upload-hint">Click or tap to upload</span>
                                        <span class="file-name" id="cdlBackName"></span>
                                    </div>
                                </div>
                                <div class="error-message" id="cdlError">Please upload both sides of your CDL</div>
                            </div>

                            <!-- Medical Card Upload Section -->
                            <div class="file-upload-section">
                                <h4><i class="fa-solid fa-file-medical"></i> Medical Card <span class="required">*</span></h4>
                                <div class="file-upload-grid" style="grid-template-columns: 1fr;">
                                    <div class="file-upload-box" id="medCardBox">
                                        <input type="file" id="medCard" accept="image/*,.pdf" />
                                        <button type="button" class="remove-file" onclick="removeFile('medCard')"><i class="fa-solid fa-times"></i></button>
                                        <div class="upload-icon"><i class="fa-solid fa-file-medical"></i></div>
                                        <span class="upload-label">DOT Medical Card</span>
                                        <span class="upload-hint">Image or PDF</span>
                                        <span class="file-name" id="medCardName"></span>
                                    </div>
                                </div>
                                <div class="error-message" id="medCardError">Please upload your medical card</div>
                            </div>

                            <!-- MVR Upload Section (Optional) -->
                            <div class="file-upload-section">
                                <h4><i class="fa-solid fa-file-lines"></i> MVR <span class="text-slate-400 text-xs font-normal">(Optional)</span></h4>
                                <div class="file-upload-grid" style="grid-template-columns: 1fr;">
                                    <div class="file-upload-box" id="mvrBox">
                                        <input type="file" id="mvr" accept="image/*,.pdf" />
                                        <button type="button" class="remove-file" onclick="removeFile('mvr')"><i class="fa-solid fa-times"></i></button>
                                        <div class="upload-icon"><i class="fa-solid fa-file-lines"></i></div>
                                        <span class="upload-label">Motor Vehicle Record</span>
                                        <span class="upload-hint">Last 3 years if available</span>
                                        <span class="file-name" id="mvrName"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Resume Upload Section (Optional) -->
                            <div class="file-upload-section">
                                <h4><i class="fa-solid fa-file-alt"></i> Resume <span class="text-slate-400 text-xs font-normal">(Optional)</span></h4>
                                <div class="file-upload-grid" style="grid-template-columns: 1fr;">
                                    <div class="file-upload-box" id="resumeBox">
                                        <input type="file" id="resume" accept=".pdf,.doc,.docx" />
                                        <button type="button" class="remove-file" onclick="removeFile('resume')"><i class="fa-solid fa-times"></i></button>
                                        <div class="upload-icon"><i class="fa-solid fa-file-alt"></i></div>
                                        <span class="upload-label">Upload Resume</span>
                                        <span class="upload-hint">PDF, DOC, DOCX</span>
                                        <span class="file-name" id="resumeName"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="upload-requirements">
                                <i class="fa-solid fa-circle-info"></i>
                                <span>Files must be clear, readable images (JPG, PNG) or PDF. Max 5MB each. <strong>AI will auto-extract your CDL details!</strong></span>
                            </div>

                            <!-- CDL Details (Auto-filled by OCR) -->
                            <div class="form-section">
                                <h4 class="form-section-title"><i class="fa-solid fa-id-badge"></i> CDL Details</h4>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="cdlNumber">CDL Number <span class="required">*</span></label>
                                        <input type="text" id="cdlNumber" name="cdlNumber" class="form-input" placeholder="Enter CDL number" required>
                                        <div class="error-message">Please enter your CDL number</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="cdlState">State Issued</label>
                                        <input type="text" id="cdlState" name="cdlState" class="form-input" placeholder="e.g., TX">
                                    </div>
                                    <div class="form-group">
                                        <label for="cdlExpiration">CDL Expiration <span class="required">*</span></label>
                                        <input type="date" id="cdlExpiration" name="cdlExpiration" class="form-input" required>
                                        <div class="error-message">Please enter CDL expiration date</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="medCardExpiration">Med Card Expiration <span class="required">*</span></label>
                                        <input type="date" id="medCardExpiration" name="medCardExpiration" class="form-input" required>
                                        <div class="error-message">Please enter med card expiration</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Contact Information -->
                            <div class="form-section">
                                <h4 class="form-section-title"><i class="fa-solid fa-address-book"></i> Contact Information</h4>
                                <div class="form-grid">
                                    <div class="form-group full-width">
                                        <label for="fullName">Full Name <span class="required">*</span></label>
                                        <input type="text" id="fullName" name="fullName" class="form-input" placeholder="John Smith" required>
                                        <div class="error-message">Please enter your full name</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="email">Email Address <span class="required">*</span></label>
                                        <input type="email" id="email" name="email" class="form-input" placeholder="driver@email.com" required>
                                        <div class="error-message">Please enter a valid email</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="phone">Phone Number <span class="required">*</span></label>
                                        <input type="tel" id="phone" name="phone" class="form-input" placeholder="(555) 123-4567" required>
                                        <div class="error-message">Please enter your phone number</div>
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="homeZip">Home ZIP Code</label>
                                        <input type="text" id="homeZip" name="homeZip" class="form-input" placeholder="75001" maxlength="5">
                                    </div>
                                </div>
                            </div>

                            <!-- Submit Section -->
                            <div class="submit-section">
                                <button type="submit" class="submit-btn" id="submitBtn">
                                    <i class="fa-solid fa-paper-plane"></i>
                                    Complete Application
                                </button>
                            </div>

                            <!-- Success/Error Messages -->
                            <div class="form-success" id="formSuccess">
                                <div class="flex items-center gap-3">
                                    <i class="fa-solid fa-circle-check text-2xl"></i>
                                    <div>
                                        <strong>Application Submitted!</strong>
                                        <p class="text-sm mt-1">Your documents are being verified. We'll reach out within 24 hours.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="form-error" id="formError">
                                <div class="flex items-center gap-3">
                                    <i class="fa-solid fa-circle-exclamation text-2xl"></i>
                                    <div>
                                        <strong>Submission Failed</strong>
                                        <p class="text-sm mt-1" id="formErrorMessage">Please check your information and try again.</p>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- FAQ Section -->
                <section class="mt-8 bg-white rounded-2xl shadow-sm border border-slate-100 p-6" aria-labelledby="faq-title">
                    <h3 id="faq-title" class="text-lg font-bold text-lmdr-dark mb-6">Common Questions</h3>
                    
                    <div class="space-y-4">
                        <details class="group">
                            <summary class="flex justify-between items-center font-medium cursor-pointer list-none text-slate-700 group-hover:text-lmdr-blue transition-colors">
                                <span>How long does verification take?</span>
                                <span class="transition group-open:rotate-180">
                                    <i class="fa-solid fa-chevron-down text-slate-400" aria-hidden="true"></i>
                                </span>
                            </summary>
                            <p class="text-slate-600 mt-3 text-sm leading-relaxed pl-4 border-l-2 border-slate-200">
                                Verification typically takes 24-48 hours. You'll receive an email notification as soon as your profile is approved.
                            </p>
                        </details>

                        <div class="h-px bg-slate-100" aria-hidden="true"></div>

                        <details class="group">
                            <summary class="flex justify-between items-center font-medium cursor-pointer list-none text-slate-700 group-hover:text-lmdr-blue transition-colors">
                                <span>Can I upload directly from my phone?</span>
                                <span class="transition group-open:rotate-180">
                                    <i class="fa-solid fa-chevron-down text-slate-400" aria-hidden="true"></i>
                                </span>
                            </summary>
                            <p class="text-slate-600 mt-3 text-sm leading-relaxed pl-4 border-l-2 border-slate-200">
                                Yes! This page is mobile-optimized. You can take photos of your documents directly when prompted by the upload field.
                            </p>
                        </details>

                        <div class="h-px bg-slate-100" aria-hidden="true"></div>

                        <details class="group">
                            <summary class="flex justify-between items-center font-medium cursor-pointer list-none text-slate-700 group-hover:text-lmdr-blue transition-colors">
                                <span>Is my data safe?</span>
                                <span class="transition group-open:rotate-180">
                                    <i class="fa-solid fa-chevron-down text-slate-400" aria-hidden="true"></i>
                                </span>
                            </summary>
                            <p class="text-slate-600 mt-3 text-sm leading-relaxed pl-4 border-l-2 border-slate-200">
                                Absolutely. We use bank-level encryption to store your documents, and they are only shared with carriers you explicitly apply to.
                            </p>
                        </details>
                    </div>
                </section>
            </section>
        </div>

        <!-- Carrier CTA -->
        <aside class="mt-12 bg-gradient-to-r from-slate-900 to-slate-800 rounded-2xl p-8 flex flex-col md:flex-row items-center justify-between gap-6 shadow-xl" aria-label="Carrier Information">
            <div>
                <h4 class="text-xl font-bold text-white">Are you a carrier?</h4>
                <p class="text-slate-300 mt-1">Get instant access to pre-verified drivers like this.</p>
            </div>
            <a href="https://www.lastmiledr.app/carriers-driver-recruiting" target="_blank" rel="noopener noreferrer" class="bg-lmdr-yellow hover:bg-amber-500 text-lmdr-dark font-bold py-3 px-6 rounded-lg transition-colors shadow-lg shadow-amber-400/20 flex items-center gap-2">
                Carrier Solutions
                <i class="fa-solid fa-arrow-right" aria-hidden="true"></i>
            </a>
        </aside>

    </main>

    <!-- OCR Handler Module (compression + auto-fill) - Inlined for Wix compatibility -->
    <script>
    (function(global) {
      'use strict';

      const DEFAULT_CONFIG = {
        compression: { maxWidth: 1200, maxHeight: 1600, quality: 0.85, format: 'image/jpeg' },
        validation: { maxFileSizeMB: 5, supportedTypes: ['image/jpeg', 'image/png', 'image/webp', 'application/pdf'] },
        timing: { ocrTimeoutMs: 30000, successDisplayMs: 2500 },
        ui: {
          processingHtml: '<i class="fa-solid fa-spinner fa-spin"></i> AI extracting data...',
          successHtml: '<i class="fa-solid fa-check-circle" style="color: #10b981;"></i> Data extracted!',
          fileTooLargeMsg: 'File too large. Maximum size is {maxSize}MB.',
          unsupportedTypeMsg: 'Unsupported file type. Please upload a JPG, PNG, or PDF.'
        },
        cssClasses: { hasFile: 'has-file', processing: 'ocr-processing', success: 'ocr-success', error: 'error', autoFilled: 'auto-filled' }
      };

      let _config = null, _sendMessage = null, _fileStorage = null, _ocrTimeouts = {}, _initialized = false;

      function init(options) {
        if (!options || typeof options.sendMessage !== 'function' || typeof options.fileStorage !== 'object' || typeof options.documents !== 'object') {
          console.error('OCRHandler: Invalid configuration'); return false;
        }
        _config = {
          compression: { ...DEFAULT_CONFIG.compression, ...(options.compression || {}) },
          validation: { ...DEFAULT_CONFIG.validation, ...(options.validation || {}) },
          timing: { ...DEFAULT_CONFIG.timing, ...(options.timing || {}) },
          ui: { ...DEFAULT_CONFIG.ui, ...(options.ui || {}) },
          cssClasses: { ...DEFAULT_CONFIG.cssClasses, ...(options.cssClasses || {}) },
          documents: options.documents, formFields: options.formFields || {},
          onExtracted: options.onExtracted || null, onError: options.onError || null, onFileSelected: options.onFileSelected || null
        };
        _sendMessage = options.sendMessage; _fileStorage = options.fileStorage; _initialized = true;
        console.log('üìÑ OCR Handler initialized (max ' + _config.compression.maxWidth + 'px, ' + Object.keys(_config.documents).length + ' document types)');
        return true;
      }

      function isInitialized() { return _initialized; }

      function compressImageForOCR(file) {
        return new Promise(function(resolve, reject) {
          if (!_config) { reject(new Error('OCRHandler not initialized')); return; }
          if (file.type === 'application/pdf') {
            if (file.size > 1024 * 1024) console.warn('‚ö†Ô∏è PDF file is large, OCR may fail.');
            var reader = new FileReader();
            reader.onload = function() { resolve(reader.result); }; reader.onerror = reject;
            reader.readAsDataURL(file); return;
          }
          var img = new Image(), canvas = document.createElement('canvas'), ctx = canvas.getContext('2d'), c = _config.compression;
          img.onload = function() {
            var w = img.width, h = img.height;
            if (w > c.maxWidth) { h = Math.round(h * (c.maxWidth / w)); w = c.maxWidth; }
            if (h > c.maxHeight) { w = Math.round(w * (c.maxHeight / h)); h = c.maxHeight; }
            canvas.width = w; canvas.height = h;
            ctx.fillStyle = '#FFFFFF'; ctx.fillRect(0, 0, w, h); ctx.drawImage(img, 0, 0, w, h);
            var compressed = canvas.toDataURL(c.format, c.quality);
            var origKB = Math.round(file.size / 1024), compKB = Math.round((compressed.length * 3) / 4 / 1024);
            console.log('üóúÔ∏è Image compressed: ' + origKB + 'KB ‚Üí ' + compKB + 'KB (' + Math.round((1 - compKB/origKB) * 100) + '% reduction)');
            resolve(compressed);
          };
          img.onerror = function() { reject(new Error('Failed to load image')); };
          var reader = new FileReader();
          reader.onload = function(e) { img.src = e.target.result; }; reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      function fileToBase64(file) {
        return new Promise(function(resolve, reject) {
          if (!file) { resolve(null); return; }
          var reader = new FileReader();
          reader.onload = function() { resolve(reader.result); }; reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      function getDocConfigByInputId(id) { return _config && _config.documents ? _config.documents[id] || null : null; }
      function getInputIdByDocType(type) { if (!_config || !_config.documents) return null; for (var id in _config.documents) { if (_config.documents[id].type === type) return id; } return null; }
      function getElement(id) { return id ? document.getElementById(id) : null; }
      function truncateFilename(name, max) { max = max || 20; if (!name || name.length <= max) return name || ''; return name.substring(0, max - 3) + '...'; }
      function flashField(field) { if (!field) return; field.style.transition = 'background-color 0.3s ease'; field.style.backgroundColor = '#10b98130'; setTimeout(function() { field.style.backgroundColor = ''; }, 1500); }

      function handleFileChange(inputId) {
        if (!_initialized) { console.error('OCRHandler: Not initialized'); return; }
        var docConfig = getDocConfigByInputId(inputId); if (!docConfig) { console.warn('OCRHandler: Unknown input:', inputId); return; }
        var input = getElement(docConfig.input || inputId), box = getElement(docConfig.box), nameEl = getElement(docConfig.nameDisplay);
        if (!input || !input.files || !input.files[0]) return;
        var file = input.files[0], v = _config.validation, cls = _config.cssClasses, ui = _config.ui;
        if (file.size > v.maxFileSizeMB * 1024 * 1024) { alert(ui.fileTooLargeMsg.replace('{maxSize}', v.maxFileSizeMB)); input.value = ''; return; }
        var isValid = v.supportedTypes.indexOf(file.type) !== -1 || file.type.indexOf('image/') === 0;
        if (!isValid) { alert(ui.unsupportedTypeMsg); input.value = ''; return; }
        if (_fileStorage) _fileStorage[inputId] = file;
        if (box) { box.classList.add(cls.hasFile); box.classList.remove(cls.error, cls.success); }
        if (nameEl) nameEl.textContent = truncateFilename(file.name);
        if (_config.onFileSelected) _config.onFileSelected(inputId, file);
        if (docConfig.type) triggerOCR(inputId, file, docConfig, box, nameEl);
      }

      function triggerOCR(inputId, file, docConfig, box, nameEl) {
        var cls = _config.cssClasses, ui = _config.ui, timing = _config.timing;
        if (_ocrTimeouts[inputId]) clearTimeout(_ocrTimeouts[inputId]);
        if (box) box.classList.add(cls.processing);
        if (nameEl) nameEl.innerHTML = ui.processingHtml;
        compressImageForOCR(file).then(function(compressed) {
          _sendMessage('extractDocumentOCR', { base64Data: compressed, docType: docConfig.type, inputId: inputId });
          _ocrTimeouts[inputId] = setTimeout(function() {
            if (box) box.classList.remove(cls.processing);
            if (nameEl) nameEl.textContent = truncateFilename(file.name);
            console.warn('‚ö†Ô∏è OCR timeout for ' + inputId);
            if (_config.onError) _config.onError(docConfig.type, 'OCR request timed out');
          }, timing.ocrTimeoutMs);
        }).catch(function(err) {
          console.error('Error preparing file for OCR:', err);
          if (box) box.classList.remove(cls.processing);
          if (nameEl) nameEl.textContent = truncateFilename(file.name);
          if (_config.onError) _config.onError(docConfig.type, err.message);
        });
      }

      function handleOCRResult(data) {
        if (!_initialized) { console.error('OCRHandler: Not initialized'); return; }
        console.log('ü§ñ OCR Result received:', data);
        var inputId = getInputIdByDocType(data.docType); if (!inputId) { console.warn('OCRHandler: Unknown docType:', data.docType); return; }
        var docConfig = getDocConfigByInputId(inputId); if (!docConfig) return;
        if (_ocrTimeouts[inputId]) { clearTimeout(_ocrTimeouts[inputId]); delete _ocrTimeouts[inputId]; }
        var box = getElement(docConfig.box), nameEl = getElement(docConfig.nameDisplay), file = _fileStorage ? _fileStorage[inputId] : null, cls = _config.cssClasses;
        if (box) box.classList.remove(cls.processing);
        if (data.success && data.extracted) {
          if (box) box.classList.add(cls.success);
          if (nameEl) nameEl.innerHTML = _config.ui.successHtml;
          autoFillFormFields(data.docType, data.extracted);
          if (data.confidence) console.log('üìä OCR Confidence: ' + data.confidence + ' (' + (data.consensusMethod || 'single_pass') + ')');
          if (_config.onExtracted) _config.onExtracted(data.docType, data.extracted, data);
          setTimeout(function() { if (nameEl && file) nameEl.textContent = truncateFilename(file.name); }, _config.timing.successDisplayMs);
        } else {
          if (nameEl && file) nameEl.textContent = truncateFilename(file.name);
          var errMsg = data.error || data.userMessage || 'Unknown error';
          console.warn('‚ö†Ô∏è OCR extraction failed:', errMsg);
          if (_config.onError) _config.onError(data.docType, errMsg, data);
        }
      }

      function autoFillFormFields(docType, ext) {
        if (!_config.formFields || !ext) return;
        var f = _config.formFields, cls = _config.cssClasses;
        if (docType === 'CDL_FRONT' || docType === 'CDL_BACK') {
          if (ext.licenseNumber && f.cdlNumber) { var el = getElement(f.cdlNumber); if (el && !el.value) { el.value = ext.licenseNumber; el.classList.add(cls.autoFilled); flashField(el); } }
          if (ext.expirationDate && f.cdlExpiration) { var el = getElement(f.cdlExpiration); if (el && !el.value) { el.value = ext.expirationDate; el.classList.add(cls.autoFilled); flashField(el); } }
          if (ext.state && f.cdlState) { var el = getElement(f.cdlState); if (el && !el.value) { el.value = ext.state; el.classList.add(cls.autoFilled); flashField(el); } }
          if (ext.fullName && f.fullName) { var el = getElement(f.fullName); if (el && !el.value) { el.value = ext.fullName; el.classList.add(cls.autoFilled); flashField(el); } }
          console.log('‚úÖ CDL data auto-filled:', { licenseNumber: ext.licenseNumber, expiration: ext.expirationDate, state: ext.state });
        }
        if (docType === 'MED_CARD') {
          if (ext.certificateExpirationDate && f.medCardExpiration) { var el = getElement(f.medCardExpiration); if (el && !el.value) { el.value = ext.certificateExpirationDate; el.classList.add(cls.autoFilled); flashField(el); } }
          console.log('‚úÖ Med Card data auto-filled:', { expiration: ext.certificateExpirationDate });
        }
      }

      function removeFile(inputId) {
        if (!_initialized) return; var docConfig = getDocConfigByInputId(inputId); if (!docConfig) return;
        var input = getElement(docConfig.input || inputId), box = getElement(docConfig.box), nameEl = getElement(docConfig.nameDisplay), cls = _config.cssClasses;
        if (input) input.value = ''; if (_fileStorage) _fileStorage[inputId] = null;
        if (box) box.classList.remove(cls.hasFile, cls.success, cls.processing); if (nameEl) nameEl.textContent = '';
        if (_ocrTimeouts[inputId]) { clearTimeout(_ocrTimeouts[inputId]); delete _ocrTimeouts[inputId]; }
      }

      function resetFileUploads() { if (!_initialized || !_config.documents) return; Object.keys(_config.documents).forEach(function(id) { removeFile(id); }); }
      function clearOCRTimeouts() { Object.keys(_ocrTimeouts).forEach(function(k) { clearTimeout(_ocrTimeouts[k]); delete _ocrTimeouts[k]; }); }

      function setupFileInputListeners() {
        if (!_initialized || !_config.documents) { console.error('OCRHandler: Cannot setup listeners - not initialized'); return; }
        var count = 0;
        Object.keys(_config.documents).forEach(function(inputId) {
          var docConfig = _config.documents[inputId], input = getElement(docConfig.input || inputId);
          if (input) { input.addEventListener('change', function() { handleFileChange(inputId); }); count++; }
        });
        console.log('üìé File input listeners attached (' + count + ' inputs)');
      }

      function getConfig() { return _config ? JSON.parse(JSON.stringify(_config)) : null; }

      global.OCRHandler = {
        init: init, isInitialized: isInitialized, handleFileChange: handleFileChange, handleOCRResult: handleOCRResult,
        removeFile: removeFile, resetFileUploads: resetFileUploads, clearOCRTimeouts: clearOCRTimeouts,
        setupFileInputListeners: setupFileInputListeners, fileToBase64: fileToBase64, compressImageForOCR: compressImageForOCR,
        getConfig: getConfig, DEFAULT_CONFIG: DEFAULT_CONFIG
      };
    })(window);
    </script>

    <!-- Quick Apply Form Logic -->
    <script>
    // File upload storage
    const uploadedFiles = {
      cdlFront: null,
      cdlBack: null,
      medCard: null,
      mvr: null,
      resume: null
    };

    // PostMessage bridge to Wix Velo
    function sendToWix(action, data) {
      console.log('üì§ [HTML‚ÜíVelo]', action, data ? Object.keys(data) : '(no data)');
      if (window.parent) {
        window.parent.postMessage({
          type: 'quickApply',
          action: action,
          data: data
        }, '*');
      }
    }

    // Listen for messages from Wix Velo
    window.addEventListener('message', (event) => {
      const msg = event.data;
      if (!msg || !msg.type) return;

      console.log('üì• [Velo‚ÜíHTML]', msg.type);

      switch (msg.type) {
        case 'ocrResult':
          if (window.OCRHandler && window.OCRHandler.isInitialized()) {
            window.OCRHandler.handleOCRResult(msg.data);
          }
          break;

        case 'submitResult':
          handleSubmitResult(msg.data);
          break;

        case 'pong':
          console.log('‚úÖ Wix connection verified');
          break;
      }
    });

    // Initialize OCR Handler
    if (window.OCRHandler) {
      window.OCRHandler.init({
        sendMessage: sendToWix,
        fileStorage: uploadedFiles,
        documents: {
          cdlFront: { type: 'CDL_FRONT', input: 'cdlFront', box: 'cdlFrontBox', nameDisplay: 'cdlFrontName' },
          cdlBack: { type: 'CDL_BACK', input: 'cdlBack', box: 'cdlBackBox', nameDisplay: 'cdlBackName' },
          medCard: { type: 'MED_CARD', input: 'medCard', box: 'medCardBox', nameDisplay: 'medCardName' },
          mvr: { type: null, input: 'mvr', box: 'mvrBox', nameDisplay: 'mvrName' },
          resume: { type: null, input: 'resume', box: 'resumeBox', nameDisplay: 'resumeName' }
        },
        formFields: {
          cdlNumber: 'cdlNumber',
          cdlExpiration: 'cdlExpiration',
          cdlState: 'cdlState',
          medCardExpiration: 'medCardExpiration',
          fullName: 'fullName'
        },
        onFileSelected: (inputId, file) => {
          // Update progress tracker when file is selected
          if (window.ProgressTracker) {
            const truncName = file.name.length > 15 ? file.name.substring(0, 12) + '...' : file.name;
            window.ProgressTracker.setDocument(inputId, true, truncName);
          }
        },
        onExtracted: (docType, extracted, fullResult) => {
          console.log('‚úÖ OCR extracted for', docType, extracted);
          // Update CDL details progress when OCR fills fields
          if (window.ProgressTracker && extracted) {
            if (extracted.licenseNumber) {
              window.ProgressTracker.setCdlField('cdlNumber', extracted.licenseNumber);
            }
            if (extracted.expirationDate) {
              window.ProgressTracker.setCdlField('cdlExpiration', extracted.expirationDate);
            }
            if (extracted.certificateExpirationDate) {
              window.ProgressTracker.setCdlField('medCardExpiration', extracted.certificateExpirationDate);
            }
            if (extracted.fullName) {
              window.ProgressTracker.setContactField('fullName', extracted.fullName);
            }
          }
        },
        onError: (docType, error) => {
          console.warn('‚ö†Ô∏è OCR failed for', docType, error);
        }
      });
      window.OCRHandler.setupFileInputListeners();
    }

    // Fallback file handlers for non-OCR documents (MVR, Resume)
    ['mvr', 'resume'].forEach(id => {
      const input = document.getElementById(id);
      if (input) {
        input.addEventListener('change', function() {
          const file = this.files[0];
          if (!file) return;

          if (file.size > 5 * 1024 * 1024) {
            alert('File too large. Maximum size is 5MB.');
            this.value = '';
            return;
          }

          uploadedFiles[id] = file;
          const box = document.getElementById(id + 'Box');
          const nameEl = document.getElementById(id + 'Name');
          if (box) box.classList.add('has-file');
          if (nameEl) nameEl.textContent = file.name.length > 20 ? file.name.substring(0, 17) + '...' : file.name;

          // Update progress tracker
          if (window.ProgressTracker) {
            const truncName = file.name.length > 15 ? file.name.substring(0, 12) + '...' : file.name;
            window.ProgressTracker.setDocument(id, true, truncName);
          }
        });
      }
    });

    // Remove file handler (global for onclick)
    window.removeFile = function(inputId) {
      if (window.OCRHandler && window.OCRHandler.isInitialized()) {
        window.OCRHandler.removeFile(inputId);
      } else {
        const input = document.getElementById(inputId);
        const box = document.getElementById(inputId + 'Box');
        const nameEl = document.getElementById(inputId + 'Name');
        if (input) input.value = '';
        uploadedFiles[inputId] = null;
        if (box) box.classList.remove('has-file', 'ocr-success', 'ocr-processing');
        if (nameEl) nameEl.textContent = '';
      }
    };

    // =========================================================================
    // PROGRESS TRACKING SYSTEM
    // =========================================================================

    const ProgressTracker = {
      // Track completion state
      state: {
        // Step 1: Contact Info (required fields)
        contactInfo: {
          fullName: false,
          email: false,
          phone: false
        },
        // Step 2: Document Uploads (required: CDL Front, CDL Back, Med Card)
        documents: {
          cdlFront: false,
          cdlBack: false,
          medCard: false,
          mvr: false,      // optional
          resume: false    // optional
        },
        // Step 3: CDL Details (required fields)
        cdlDetails: {
          cdlNumber: false,
          cdlExpiration: false,
          medCardExpiration: false
        }
      },

      // Calculate overall progress percentage
      calculateProgress() {
        let completed = 0;
        let total = 0;

        // Step 1: Contact Info (3 required fields)
        Object.values(this.state.contactInfo).forEach(v => { total++; if (v) completed++; });

        // Step 2: Documents (3 required, 2 optional bonus)
        ['cdlFront', 'cdlBack', 'medCard'].forEach(k => { total++; if (this.state.documents[k]) completed++; });
        // Optional docs give bonus but don't count toward total
        if (this.state.documents.mvr) completed += 0.25;
        if (this.state.documents.resume) completed += 0.25;

        // Step 3: CDL Details (3 required fields)
        Object.values(this.state.cdlDetails).forEach(v => { total++; if (v) completed++; });

        return Math.min(100, Math.round((completed / total) * 100));
      },

      // Check if a step is complete
      isStepComplete(step) {
        switch (step) {
          case 1: return Object.values(this.state.contactInfo).every(v => v);
          case 2: return ['cdlFront', 'cdlBack', 'medCard'].every(k => this.state.documents[k]);
          case 3: return Object.values(this.state.cdlDetails).every(v => v);
          default: return false;
        }
      },

      // Update step circle UI
      updateStepUI(stepNum, status) {
        const circle = document.getElementById(`step${stepNum}Circle`);
        const number = document.getElementById(`step${stepNum}Number`);
        const check = document.getElementById(`step${stepNum}Check`);
        const label = document.getElementById(`step${stepNum}Label`);

        if (!circle) return;

        // Reset classes
        circle.classList.remove('bg-gray-200', 'bg-lmdr-yellow', 'bg-lmdr-dark', 'bg-green-500',
                                'text-gray-500', 'text-lmdr-dark', 'text-lmdr-yellow', 'text-white',
                                'shadow-lg', 'shadow-amber-400/30', 'shadow-green-400/30');
        label.classList.remove('text-gray-400', 'text-lmdr-dark', 'text-green-600');

        if (status === 'completed') {
          circle.classList.add('bg-green-500', 'text-white');
          number.classList.add('hidden');
          check.classList.remove('hidden');
          label.classList.add('text-green-600');
        } else if (status === 'active') {
          circle.classList.add('bg-lmdr-yellow', 'text-lmdr-dark', 'shadow-lg', 'shadow-amber-400/30');
          number.classList.remove('hidden');
          check.classList.add('hidden');
          label.classList.add('text-lmdr-dark');
        } else {
          circle.classList.add('bg-gray-200', 'text-gray-500');
          number.classList.remove('hidden');
          check.classList.add('hidden');
          label.classList.add('text-gray-400');
        }
      },

      // Update sidebar checklist item
      updateChecklistItem(docId, isComplete, statusText) {
        const iconMap = {
          cdlFront: 'checkCdlFrontIcon',
          cdlBack: 'checkCdlBackIcon',
          medCard: 'checkMedCardIcon',
          mvr: 'checkMvrIcon',
          resume: 'checkResumeIcon'
        };
        const statusMap = {
          cdlFront: 'checkCdlFrontStatus',
          cdlBack: 'checkCdlBackStatus',
          medCard: 'checkMedCardStatus',
          mvr: 'checkMvrStatus',
          resume: 'checkResumeStatus'
        };

        const iconEl = document.getElementById(iconMap[docId]);
        const statusEl = document.getElementById(statusMap[docId]);

        if (iconEl) {
          iconEl.classList.remove('bg-gray-100', 'bg-green-100', 'text-gray-400', 'text-green-600');
          if (isComplete) {
            iconEl.classList.add('bg-green-100', 'text-green-600');
            iconEl.innerHTML = '<i class="fa-solid fa-check"></i>';
          } else {
            iconEl.classList.add('bg-gray-100', 'text-gray-400');
            iconEl.innerHTML = '<i class="fa-solid fa-circle text-[8px]"></i>';
          }
        }

        if (statusEl) {
          statusEl.textContent = statusText || (isComplete ? 'Uploaded ‚úì' : 'Not uploaded');
          statusEl.classList.toggle('text-green-600', isComplete);
          statusEl.classList.toggle('text-slate-500', !isComplete);
        }
      },

      // Main update function - call this after any change
      update() {
        const progress = this.calculateProgress();

        // Update progress bar fill
        const fill = document.getElementById('progressFill');
        if (fill) fill.style.width = `${progress}%`;

        // Update progress text
        const text = document.getElementById('progressText');
        if (text) {
          if (progress === 100) {
            text.textContent = '100% Complete - Ready to Submit!';
            text.classList.add('text-green-600');
          } else {
            text.textContent = `${progress}% Complete`;
            text.classList.remove('text-green-600');
          }
        }

        // Update step circles
        for (let i = 1; i <= 3; i++) {
          if (this.isStepComplete(i)) {
            this.updateStepUI(i, 'completed');
          } else if (i === 1 || this.isStepComplete(i - 1)) {
            this.updateStepUI(i, 'active');
          } else {
            this.updateStepUI(i, 'pending');
          }
        }

        // Update sidebar checklist
        Object.keys(this.state.documents).forEach(docId => {
          this.updateChecklistItem(docId, this.state.documents[docId]);
        });

        console.log(`üìä Progress: ${progress}%`, this.state);
      },

      // Update contact info field
      setContactField(field, value) {
        this.state.contactInfo[field] = !!value && value.trim().length > 0;
        this.update();
      },

      // Update document upload status
      setDocument(docId, isUploaded, fileName) {
        this.state.documents[docId] = isUploaded;
        this.updateChecklistItem(docId, isUploaded, isUploaded ? `${fileName || 'Uploaded'} ‚úì` : 'Not uploaded');
        this.update();
      },

      // Update CDL details field
      setCdlField(field, value) {
        this.state.cdlDetails[field] = !!value && value.trim().length > 0;
        this.update();
      },

      // Reset progress
      reset() {
        Object.keys(this.state.contactInfo).forEach(k => this.state.contactInfo[k] = false);
        Object.keys(this.state.documents).forEach(k => this.state.documents[k] = false);
        Object.keys(this.state.cdlDetails).forEach(k => this.state.cdlDetails[k] = false);
        this.update();
      }
    };

    // Initialize progress on page load
    ProgressTracker.update();

    // Attach listeners to form fields for real-time progress updates
    ['fullName', 'email', 'phone'].forEach(id => {
      const el = document.getElementById(id);
      if (el) {
        el.addEventListener('input', () => ProgressTracker.setContactField(id, el.value));
        el.addEventListener('change', () => ProgressTracker.setContactField(id, el.value));
      }
    });

    ['cdlNumber', 'cdlExpiration', 'medCardExpiration'].forEach(id => {
      const el = document.getElementById(id);
      if (el) {
        el.addEventListener('input', () => ProgressTracker.setCdlField(id, el.value));
        el.addEventListener('change', () => ProgressTracker.setCdlField(id, el.value));
      }
    });

    // Expose for OCRHandler callbacks
    window.ProgressTracker = ProgressTracker;

    // Form submission
    const form = document.getElementById('quickApplyForm');
    const submitBtn = document.getElementById('submitBtn');
    const formSuccess = document.getElementById('formSuccess');
    const formError = document.getElementById('formError');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Validate required files
      const hasCdlFront = uploadedFiles.cdlFront;
      const hasCdlBack = uploadedFiles.cdlBack;
      const hasMedCard = uploadedFiles.medCard;

      let hasError = false;

      if (!hasCdlFront || !hasCdlBack) {
        document.getElementById('cdlFrontBox').classList.toggle('error', !hasCdlFront);
        document.getElementById('cdlBackBox').classList.toggle('error', !hasCdlBack);
        hasError = true;
      }

      if (!hasMedCard) {
        document.getElementById('medCardBox').classList.add('error');
        hasError = true;
      }

      // Validate required form fields
      const requiredFields = ['cdlNumber', 'cdlExpiration', 'medCardExpiration', 'fullName', 'email', 'phone'];
      requiredFields.forEach(id => {
        const input = document.getElementById(id);
        const group = input.closest('.form-group');
        if (!input.value.trim()) {
          group.classList.add('error');
          hasError = true;
        } else {
          group.classList.remove('error');
        }
      });

      if (hasError) {
        formError.classList.add('show');
        formSuccess.classList.remove('show');
        setTimeout(() => formError.classList.remove('show'), 3000);
        return;
      }

      // Show loading state
      submitBtn.disabled = true;
      submitBtn.classList.add('loading');
      submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Compressing & Submitting...';

      // Compress image files before submission (reuse OCRHandler compression)
      const compressForSubmission = async (file) => {
        if (!file) return null;
        // Use OCRHandler compression for images
        if (window.OCRHandler && file.type.startsWith('image/')) {
          try {
            return await window.OCRHandler.compressImageForOCR(file);
          } catch (e) {
            console.warn('Compression failed, using original:', e);
          }
        }
        // Fallback to raw base64 for PDFs and other files
        return new Promise((resolve) => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.onerror = () => resolve(null);
          reader.readAsDataURL(file);
        });
      };

      try {
        console.log('üóúÔ∏è Compressing documents for submission...');
        const [cdlFrontData, cdlBackData, medCardData, mvrData, resumeData] = await Promise.all([
          compressForSubmission(uploadedFiles.cdlFront),
          compressForSubmission(uploadedFiles.cdlBack),
          compressForSubmission(uploadedFiles.medCard),
          compressForSubmission(uploadedFiles.mvr),
          compressForSubmission(uploadedFiles.resume)
        ]);
        console.log('‚úÖ Documents compressed');

        const formData = {
          fullName: document.getElementById('fullName').value.trim(),
          email: document.getElementById('email').value.trim(),
          phone: document.getElementById('phone').value.trim(),
          homeZip: document.getElementById('homeZip').value.trim(),
          cdlNumber: document.getElementById('cdlNumber').value.trim(),
          cdlState: document.getElementById('cdlState').value.trim(),
          cdlExpiration: document.getElementById('cdlExpiration').value,
          medCardExpiration: document.getElementById('medCardExpiration').value,
          documents: {
            cdlFront: cdlFrontData ? { data: cdlFrontData, name: uploadedFiles.cdlFront.name, type: uploadedFiles.cdlFront.type } : null,
            cdlBack: cdlBackData ? { data: cdlBackData, name: uploadedFiles.cdlBack.name, type: uploadedFiles.cdlBack.type } : null,
            medCard: medCardData ? { data: medCardData, name: uploadedFiles.medCard.name, type: uploadedFiles.medCard.type } : null,
            mvr: mvrData && uploadedFiles.mvr ? { data: mvrData, name: uploadedFiles.mvr.name, type: uploadedFiles.mvr.type } : null,
            resume: resumeData && uploadedFiles.resume ? { data: resumeData, name: uploadedFiles.resume.name, type: uploadedFiles.resume.type } : null
          }
        };

        sendToWix('submitQuickApply', formData);

        // Timeout fallback - show success after 10s if no response
        setTimeout(() => {
          if (submitBtn.disabled) {
            handleSubmitResult({ success: true });
          }
        }, 10000);

      } catch (err) {
        console.error('Error preparing submission:', err);
        handleSubmitResult({ success: false, error: err.message });
      }
    });

    function handleSubmitResult(result) {
      submitBtn.disabled = false;
      submitBtn.classList.remove('loading');
      submitBtn.innerHTML = '<i class="fa-solid fa-paper-plane"></i> Complete Application';

      if (result.success) {
        formSuccess.classList.add('show');
        formError.classList.remove('show');
        form.reset();
        window.OCRHandler && window.OCRHandler.resetFileUploads();
        Object.keys(uploadedFiles).forEach(k => uploadedFiles[k] = null);
        document.querySelectorAll('.file-upload-box').forEach(el => el.classList.remove('has-file', 'ocr-success'));
      } else {
        formError.classList.add('show');
        formSuccess.classList.remove('show');
        document.getElementById('formErrorMessage').textContent = result.error || 'Please check your information and try again.';
      }
    }

    // Notify Wix that form is ready
    sendToWix('quickApplyFormReady', { timestamp: Date.now() });
    </script>
</body>
</html>