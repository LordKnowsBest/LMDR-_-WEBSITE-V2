<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VelocityMatch Recruiter CRM + Telemetry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        lmdr: {
                            blue: '#2563eb',
                            dark: '#0f172a',
                            canvas: '#f1f5f9',
                            success: '#10b981',
                            alert: '#ef4444'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Pulse Animation for Active Call */
        .call-pulse {
            animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
            }
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        /* Glassmorphism for the Dialer */
        .dialer-glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        /* Voice Waveform Animation */
        .bar {
            width: 3px;
            background: #2563eb;
            animation: sound 0s -0.4s linear infinite;
            border-radius: 2px;
        }

        .bar:nth-child(1) {
            left: 1px;
            animation-duration: 474ms;
            height: 10px;
        }

        .bar:nth-child(2) {
            left: 5px;
            animation-duration: 433ms;
            height: 18px;
        }

        .bar:nth-child(3) {
            left: 9px;
            animation-duration: 407ms;
            height: 22px;
        }

        .bar:nth-child(4) {
            left: 13px;
            animation-duration: 458ms;
            height: 14px;
        }

        .bar:nth-child(5) {
            left: 17px;
            animation-duration: 400ms;
            height: 20px;
        }

        .mic-active .bar {
            animation-play-state: running;
        }

        .mic-inactive .bar {
            height: 2px;
            animation-play-state: paused;
            background: #94a3b8;
        }

        @keyframes sound {
            0% {
                opacity: .35;
                height: 3px;
            }

            100% {
                opacity: 1;
                height: 20px;
            }
        }

        /* ============================================
           GLOBAL SIDEBAR STYLES
           ============================================ */
        .sidebar-transition {
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .fade-text {
            transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
        }

        .collapsed .fade-text {
            opacity: 0;
            pointer-events: none;
            display: none;
        }

        .collapsed .sidebar-header {
            justify-content: center;
            padding-left: 0;
            padding-right: 0;
        }

        .collapsed .logo-text {
            display: none;
        }

        .sidebar-link {
            transition: all 0.2s ease-in-out;
            white-space: nowrap;
            overflow: hidden;
        }

        .sidebar-link:hover {
            background-color: rgba(255, 255, 255, 0.08);
        }

        .sidebar-link.active {
            background: linear-gradient(90deg, rgba(37, 99, 235, 0.2) 0%, transparent 100%);
            border-left: 4px solid #2563eb;
            color: white;
            text-shadow: 0 0 10px rgba(37, 99, 235, 0.5);
        }

        .sidebar-link.active i {
            color: #60a5fa;
            filter: drop-shadow(0 0 5px rgba(37, 99, 235, 0.8));
        }

        .sidebar-chat-panel {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        .chat-open .sidebar-chat-panel {
            max-height: 400px;
            opacity: 1;
            padding-bottom: 1rem;
        }

        .chat-bubble-in {
            border-radius: 1.25rem 1.25rem 1.25rem 0.25rem;
        }

        .chat-bubble-out {
            border-radius: 1.25rem 1.25rem 0.25rem 1.25rem;
        }

        @keyframes subtle-pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4);
            }

            70% {
                box-shadow: 0 0 0 6px rgba(37, 99, 235, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(37, 99, 235, 0);
            }
        }

        .chat-pulse {
            animation: subtle-pulse 2s infinite;
        }

        .thin-scroll::-webkit-scrollbar {
            width: 4px;
        }

        .thin-scroll::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(16px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-bubble-in {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            z-index: 0;
            opacity: 0.6;
            animation: float-blob 10s infinite ease-in-out;
        }

        .blob-1 {
            top: -10%;
            left: -20%;
            width: 300px;
            height: 300px;
            background: #2563eb;
        }

        .blob-2 {
            bottom: 10%;
            right: -20%;
            width: 250px;
            height: 250px;
            background: #6366f1;
            animation-delay: -5s;
        }

        @keyframes float-blob {

            0%,
            100% {
                transform: translate(0, 0);
            }

            50% {
                transform: translate(20px, 40px);
            }
        }

        .shadow-glow {
            box-shadow: 0 0 15px rgba(37, 99, 235, 0.5);
        }

        .shadow-glow-active {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.6);
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LordKnowsBest/LMDR-_-WEBSITE-V2@main/src/public/recruiter/recruiter-design-system.css">
</head>

<body class="bg-lmdr-canvas text-slate-600 antialiased h-screen overflow-hidden pt-safe pb-safe">

    <!-- MAIN LAYOUT WITH SIDEBAR -->
    <div class="flex h-screen overflow-hidden">

        <!-- GLOBAL SIDEBAR -->
        <div class="relative h-full flex flex-col z-40 bg-slate-900 overflow-hidden shadow-2xl transition-all duration-300 flex-shrink-0"
            id="sidebar-container">
            <div class="blob blob-1"></div>
            <div class="blob blob-2"></div>

            <aside id="sidebar"
                class="w-64 text-slate-300 flex flex-col h-full sidebar-transition group relative z-10 bg-slate-900/60 backdrop-blur-xl border-r border-white/5">
                <button onclick="toggleSidebar()"
                    class="absolute -right-3 top-20 bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center shadow-lg border border-slate-900 hover:scale-110 transition-transform z-50 opacity-0 group-hover:opacity-100">
                    <i class="fa-solid fa-chevron-left text-[10px]" id="toggleIcon"></i>
                </button>

                <div class="h-16 flex items-center px-6 border-b border-white/10 sidebar-header transition-all">
                    <div class="flex items-center gap-3">
                        <div
                            class="h-8 w-8 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex-none flex items-center justify-center text-white font-black text-sm shadow-lg shadow-blue-500/30 ring-1 ring-white/20">
                            VM</div>
                        <div class="logo-text fade-text">
                            <h1 class="font-bold text-white text-sm tracking-tight drop-shadow-md">Velocity<span
                                    class="text-blue-400">Match</span></h1>
                            <p class="text-[10px] text-blue-200/70 uppercase font-bold tracking-wider">Recruiter OS</p>
                        </div>
                    </div>
                </div>

                <nav class="flex-1 overflow-y-auto thin-scroll py-6 space-y-1">
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Dashboard" data-page="dashboard">
                        <i
                            class="fa-solid fa-table-columns w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Dashboard</span>
                    </a>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Driver Search" data-page="driver-search">
                        <i
                            class="fa-solid fa-magnifying-glass w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Driver Search</span>
                    </a>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Pipeline" data-page="pipeline">
                        <i
                            class="fa-solid fa-layer-group w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Pipeline</span>
                    </a>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Jobs" data-page="jobs">
                        <i
                            class="fa-solid fa-briefcase w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Jobs</span>
                    </a>

                    <div
                        class="px-6 mt-6 mb-2 text-[10px] font-bold uppercase tracking-widest text-blue-200/50 fade-text">
                        Intelligence</div>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Ad Studio" data-page="ad-studio">
                        <i
                            class="fa-solid fa-wand-magic-sparkles w-5 text-center flex-none text-slate-400 group-hover:text-indigo-400 transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Ad Studio</span>
                    </a>
                    <a href="#" class="sidebar-link active flex items-center gap-4 px-6 py-3 text-sm font-bold"
                        title="Telemetry" data-page="telemetry">
                        <i class="fa-solid fa-chart-line w-5 text-center flex-none"></i>
                        <span class="fade-text">Telemetry</span>
                    </a>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Compliance" data-page="compliance">
                        <i
                            class="fa-solid fa-shield-halved w-5 text-center flex-none text-slate-400 group-hover:text-green-400 transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Compliance</span>
                    </a>

                    <div
                        class="px-6 mt-6 mb-2 text-[10px] font-bold uppercase tracking-widest text-blue-200/50 fade-text">
                        Settings</div>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Match Scoring" data-page="match-scoring">
                        <i
                            class="fa-solid fa-sliders w-5 text-center flex-none text-slate-400 group-hover:text-blue-400 transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Match Scoring</span>
                    </a>
                    <a href="#"
                        class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group"
                        title="Preferences" data-page="preferences">
                        <i
                            class="fa-solid fa-gear w-5 text-center flex-none text-slate-400 group-hover:text-slate-300 transition-colors"></i>
                        <span class="fade-text group-hover:translate-x-1 transition-transform">Preferences</span>
                    </a>
                </nav>

                <div id="sidebarChatContainer" class="glass-panel">
                    <button onclick="toggleSidebarChat()"
                        class="w-full flex items-center gap-4 px-6 py-4 hover:bg-white/10 transition group relative">
                        <div
                            class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center text-white shadow-glow chat-pulse flex-none group-hover:shadow-glow-active transition-shadow ring-1 ring-white/20">
                            <i class="fa-solid fa-comment-dots"></i>
                        </div>
                        <div class="fade-text text-left flex-1">
                            <p class="text-sm font-bold text-white group-hover:text-blue-300 transition-colors">Quick
                                Chat</p>
                            <p class="text-[10px] text-green-400 font-medium" id="sidebar-drivers-online">-- Online</p>
                        </div>
                        <i class="fa-solid fa-chevron-up text-xs text-slate-400 fade-text group-hover:text-white transition-transform"
                            id="sidebarChatChevron"></i>
                    </button>

                    <div id="sidebarChatPanel" class="sidebar-chat-panel border-t border-white/5 bg-black/20">
                        <div class="px-4 space-y-3 pt-2">
                            <div class="text-center py-2">
                                <span
                                    class="text-[9px] font-bold text-slate-400 bg-white/5 px-2 py-0.5 rounded-full border border-white/5 backdrop-blur-sm">Today</span>
                            </div>
                            <div class="flex gap-2">
                                <div
                                    class="w-6 h-6 rounded-full bg-slate-700/50 flex-none flex items-center justify-center text-[9px] font-bold text-white shadow-sm ring-1 ring-white/10">
                                    JD</div>
                                <div
                                    class="glass-bubble-in text-slate-200 text-xs p-3 chat-bubble-in max-w-[85%] shadow-sm">
                                    <p>Is the dedicated route still open?</p>
                                </div>
                            </div>
                            <div class="flex gap-2 flex-row-reverse">
                                <div
                                    class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-xs p-3 chat-bubble-out max-w-[85%] shadow-md border border-white/10">
                                    <p>Yes, John. Can you talk now?</p>
                                </div>
                            </div>
                            <div class="pt-2 mt-2 border-t border-white/10 flex gap-2">
                                <input type="text" placeholder="Type..."
                                    class="w-full bg-white/5 border border-white/10 rounded-full px-3 py-1.5 text-base md:text-xs text-white focus:outline-none focus:border-blue-500 focus:bg-white/10 transition-colors placeholder-slate-500 backdrop-blur-sm">
                                <button
                                    class="w-7 h-7 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs hover:bg-blue-500 transition shadow-glow">
                                    <i class="fa-solid fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-4 border-t border-white/10 bg-black/30 backdrop-blur-md">
                    <button
                        class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-white/10 transition text-left group">
                        <div class="h-9 w-9 rounded-full bg-slate-800/50 flex-none flex items-center justify-center border border-slate-600/50 text-white font-bold text-xs group-hover:border-blue-500 shadow-sm"
                            id="sidebar-user-initials">--</div>
                        <div class="flex-1 overflow-hidden fade-text">
                            <p class="text-sm font-bold text-white truncate" id="sidebar-user-name">Loading...</p>
                            <p class="text-xs text-slate-400 truncate" id="sidebar-user-company">--</p>
                        </div>
                    </button>
                </div>
            </aside>
        </div>

        <!-- MAIN CONTENT AREA -->
        <div class="flex-1 flex flex-col overflow-hidden">

            <!-- GLOBAL HEADER -->
            <header
                class="bg-white border-b border-slate-200 h-16 flex-none z-30 flex justify-between items-center px-6">
                <div class="flex items-center gap-3">
                    <div class="h-9 w-9 bg-lmdr-dark rounded-lg flex items-center justify-center text-white font-black">
                        VM</div>
                    <nav class="hidden md:flex items-center gap-1 bg-slate-100 p-1 rounded-lg">
                        <button
                            class="px-4 py-1.5 bg-white shadow-sm rounded-md text-xs font-bold text-slate-900">Candidates</button>
                        <button
                            class="px-4 py-1.5 text-xs font-bold text-slate-500 hover:text-slate-900">Campaigns</button>
                        <button
                            class="px-4 py-1.5 text-xs font-bold text-slate-500 hover:text-slate-900">Analytics</button>
                    </nav>
                </div>

                <!-- Status Bar -->
                <div class="flex items-center gap-6">
                    <div
                        class="flex items-center gap-2 text-xs font-bold bg-green-50 text-green-700 px-3 py-1.5 rounded-full border border-green-100">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        System Operational
                    </div>
                    <div class="flex items-center gap-4 border-l border-slate-200 pl-6">
                        <button class="relative text-slate-400 hover:text-slate-600">
                            <i class="fa-regular fa-bell text-lg"></i>
                            <span
                                class="absolute -top-1 -right-1 h-4 w-4 bg-red-500 text-white text-[9px] font-bold flex items-center justify-center rounded-full border-2 border-white">3</span>
                        </button>
                        <div
                            class="h-9 w-9 bg-lmdr-blue rounded-full text-white font-bold flex items-center justify-center border-2 border-blue-200 shadow-sm cursor-pointer">
                            AS</div>
                    </div>
                </div>
            </header>

            <!-- MAIN WORKSPACE -->
            <main class="flex-1 flex overflow-hidden">

                <!-- LEFT: CRM List View -->
                <aside class="w-80 bg-white border-r border-slate-200 flex flex-col z-20 shadow-sm">
                    <div class="p-4 border-b border-slate-100">
                        <div class="relative">
                            <i
                                class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"></i>
                            <input type="text" placeholder="Search pipeline..."
                                class="w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-base md:text-sm focus:outline-none focus:border-blue-500">
                        </div>
                    </div>

                    <div class="flex-1 overflow-y-auto">
                        <!-- Candidate Item (Active) -->
                        <div class="p-4 border-l-4 border-lmdr-blue bg-blue-50/50 cursor-pointer">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-slate-900 text-sm">Michael Scott</span>
                                <span class="text-[10px] text-slate-400">10:42 AM</span>
                            </div>
                            <div class="text-xs text-slate-500 truncate">Regional • Class A • 12 Yrs</div>
                            <div class="flex items-center gap-2 mt-2">
                                <span
                                    class="bg-blue-100 text-blue-700 text-[10px] font-bold px-2 py-0.5 rounded">Negotiating</span>
                                <i class="fa-solid fa-phone text-green-500 text-xs animate-pulse"></i>
                            </div>
                        </div>

                        <!-- Candidate Item -->
                        <div
                            class="p-4 border-l-4 border-transparent hover:bg-slate-50 cursor-pointer border-b border-slate-50">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-slate-700 text-sm">Jim Halpert</span>
                                <span class="text-[10px] text-slate-400">Yesterday</span>
                            </div>
                            <div class="text-xs text-slate-500 truncate">OTR • Class A • 5 Yrs</div>
                            <div class="flex items-center gap-2 mt-2">
                                <span class="bg-slate-100 text-slate-500 text-[10px] font-bold px-2 py-0.5 rounded">New
                                    Match</span>
                            </div>
                        </div>

                        <!-- Candidate Item -->
                        <div
                            class="p-4 border-l-4 border-transparent hover:bg-slate-50 cursor-pointer border-b border-slate-50">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-slate-700 text-sm">Dwight Schrute</span>
                                <span class="text-[10px] text-slate-400">Mon</span>
                            </div>
                            <div class="text-xs text-slate-500 truncate">Hazmat • Tanker • 8 Yrs</div>
                            <div class="flex items-center gap-2 mt-2">
                                <span
                                    class="bg-yellow-50 text-yellow-700 text-[10px] font-bold px-2 py-0.5 rounded">Follow
                                    Up</span>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- CENTER: Context & Chat -->
                <section class="flex-1 flex flex-col bg-slate-50 relative">

                    <!-- Chat Header -->
                    <div class="h-16 border-b border-slate-200 bg-white px-6 flex justify-between items-center">
                        <div>
                            <h2 class="font-bold text-slate-900 text-lg">Michael Scott</h2>
                            <div class="flex items-center gap-2 text-xs text-slate-500">
                                <span class="w-2 h-2 rounded-full bg-green-500"></span> Online
                                <span class="text-slate-300">|</span>
                                <span>Scranton, PA</span>
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <button
                                class="h-9 px-4 border border-slate-200 rounded-lg text-xs font-bold text-slate-600 hover:bg-slate-50 transition">View
                                Profile</button>
                            <!-- Quick Call Action -->
                            <button
                                class="h-9 px-4 bg-green-500 text-white rounded-lg text-xs font-bold shadow-md hover:bg-green-600 transition flex items-center gap-2">
                                <i class="fa-solid fa-phone"></i> Call Now
                            </button>
                        </div>
                    </div>

                    <!-- Chat Area -->
                    <div class="flex-1 p-6 overflow-y-auto space-y-6">

                        <!-- Date Divider -->
                        <div class="flex items-center gap-4">
                            <div class="h-px bg-slate-200 flex-1"></div>
                            <span class="text-[10px] font-bold text-slate-400 uppercase">Today</span>
                            <div class="h-px bg-slate-200 flex-1"></div>
                        </div>

                        <!-- Message (Candidate) -->
                        <div class="flex gap-4">
                            <div class="w-8 h-8 rounded-full bg-slate-200 flex-none"></div>
                            <div class="space-y-1">
                                <div
                                    class="bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 max-w-md">
                                    <p class="text-sm text-slate-700">Hey, thanks for the info on the Regional run. Does
                                        it include detention pay?</p>
                                </div>
                                <span class="text-[10px] text-slate-400 pl-2">10:30 AM</span>
                            </div>
                        </div>

                        <!-- Message (Recruiter) -->
                        <div class="flex gap-4 flex-row-reverse">
                            <div
                                class="w-8 h-8 rounded-full bg-blue-100 flex-none flex items-center justify-center text-blue-600 font-bold text-xs">
                                AS</div>
                            <div class="space-y-1 text-right">
                                <div
                                    class="bg-lmdr-blue p-4 rounded-2xl rounded-tr-none shadow-md shadow-blue-100 max-w-md text-left">
                                    <p class="text-sm text-white">Yes, absolutely. We pay $25/hr after the first 2
                                        hours. I can break down the full comp package if you have a minute to chat?</p>
                                </div>
                                <span class="text-[10px] text-slate-400 pr-2">10:32 AM • Read</span>
                            </div>
                        </div>

                        <!-- SYSTEM ALERT: Smart Assist -->
                        <div class="flex justify-center">
                            <div
                                class="bg-indigo-50 border border-indigo-100 px-4 py-2 rounded-full flex items-center gap-3 shadow-sm">
                                <div
                                    class="w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 text-xs">
                                    <i class="fa-solid fa-wand-magic-sparkles"></i>
                                </div>
                                <span class="text-xs text-indigo-800 font-medium">Suggestion: Call Michael now to close.
                                    He is viewing the offer.</span>
                                <button
                                    class="text-xs font-bold text-indigo-600 underline hover:text-indigo-800">Dial</button>
                            </div>
                        </div>

                    </div>

                    <!-- Enhanced Input Area (Text + Voice + Toggle) -->
                    <div class="p-4 bg-white border-t border-slate-200">

                        <!-- Channel Selector -->
                        <div class="flex gap-3 mb-2">
                            <button
                                class="text-[10px] font-bold uppercase tracking-wider text-blue-600 bg-blue-50 px-3 py-1 rounded-full border border-blue-100">
                                <i class="fa-solid fa-comment-sms mr-1"></i> SMS
                            </button>
                            <button
                                class="text-[10px] font-bold uppercase tracking-wider text-slate-400 hover:text-slate-600 px-3 py-1 rounded-full hover:bg-slate-50 transition">
                                <i class="fa-solid fa-note-sticky mr-1"></i> Note
                            </button>
                        </div>

                        <div class="relative flex items-center gap-2">

                            <!-- Voice Toggle / Status -->
                            <button
                                class="group h-11 w-11 flex-none rounded-xl border border-slate-200 bg-white hover:border-blue-300 hover:bg-blue-50 flex items-center justify-center transition-all relative overflow-hidden"
                                onclick="this.classList.toggle('mic-active'); this.classList.toggle('bg-blue-50'); this.classList.toggle('border-blue-400');">

                                <!-- Visual Waveform (Hidden by default, shown when active) -->
                                <div
                                    class="absolute inset-0 flex items-center justify-center gap-[2px] opacity-0 group-[.mic-active]:opacity-100 transition-opacity">
                                    <div class="bar h-3 bg-blue-500 animate-[sound_0.8s_ease-in-out_infinite]"></div>
                                    <div class="bar h-5 bg-blue-500 animate-[sound_0.6s_ease-in-out_infinite]"></div>
                                    <div class="bar h-3 bg-blue-500 animate-[sound_0.9s_ease-in-out_infinite]"></div>
                                </div>

                                <!-- Static Icon (Hidden when active) -->
                                <i
                                    class="fa-solid fa-microphone text-slate-400 group-hover:text-blue-600 group-[.mic-active]:opacity-0 transition-opacity"></i>
                            </button>

                            <!-- Text Input -->
                            <input type="text" placeholder="Type message or speak..."
                                class="flex-1 pl-4 pr-12 py-3 bg-slate-50 border border-slate-200 rounded-xl text-base md:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white transition">

                            <!-- Send Button -->
                            <button
                                class="absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 bg-blue-600 text-white rounded-lg flex items-center justify-center hover:bg-blue-700 transition shadow-sm">
                                <i class="fa-solid fa-paper-plane text-xs"></i>
                            </button>
                        </div>

                        <div class="mt-2 flex justify-between items-center px-1">
                            <span class="text-[10px] text-slate-400 italic">Listening for commands: "Call Jim",
                                "Schedule", "Log note"</span>
                            <div class="flex gap-2">
                                <i class="fa-solid fa-image text-slate-400 hover:text-slate-600 cursor-pointer"></i>
                                <i class="fa-solid fa-paperclip text-slate-400 hover:text-slate-600 cursor-pointer"></i>
                            </div>
                        </div>
                    </div>

                </section>

                <!-- RIGHT: THE OMNI-DIALER (Expanded State) -->
                <aside class="w-96 bg-white border-l border-slate-200 z-30 shadow-xl flex flex-col relative">

                    <!-- Dialer Header (Active Call) -->
                    <div class="bg-slate-900 text-white p-6 relative overflow-hidden">
                        <!-- Background Pulse Effect -->
                        <div
                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-green-500 rounded-full opacity-10 blur-3xl animate-pulse">
                        </div>

                        <div class="relative z-10 text-center">
                            <div
                                class="w-20 h-20 bg-slate-800 rounded-full mx-auto mb-4 border-4 border-slate-700 relative">
                                <img src="/api/placeholder/80/80"
                                    class="w-full h-full rounded-full object-cover opacity-80">
                                <div
                                    class="absolute bottom-0 right-0 w-6 h-6 bg-green-500 border-2 border-slate-900 rounded-full flex items-center justify-center">
                                    <i class="fa-solid fa-phone text-[10px] text-white animate-bounce"></i>
                                </div>
                            </div>
                            <h3 class="text-xl font-bold">Michael Scott</h3>
                            <p class="text-green-400 text-sm font-mono mt-1 mb-6">04:12 • Connected</p>

                            <!-- Call Controls -->
                            <div class="flex justify-center gap-4">
                                <button
                                    class="w-12 h-12 rounded-full bg-slate-800 text-white hover:bg-slate-700 transition flex items-center justify-center">
                                    <i class="fa-solid fa-microphone-slash"></i>
                                </button>
                                <button
                                    class="w-12 h-12 rounded-full bg-slate-800 text-white hover:bg-slate-700 transition flex items-center justify-center">
                                    <i class="fa-solid fa-pause"></i>
                                </button>
                                <button
                                    class="w-14 h-14 rounded-full bg-red-500 text-white hover:bg-red-600 shadow-lg shadow-red-900/50 transition flex items-center justify-center text-xl">
                                    <i class="fa-solid fa-phone-slash"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- AI Co-Pilot (Telemetry) -->
                    <div class="flex-1 bg-slate-50 flex flex-col overflow-hidden">
                        <div class="px-6 py-3 border-b border-slate-200 flex justify-between items-center bg-white">
                            <span
                                class="text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2">
                                <i class="fa-solid fa-robot text-indigo-500"></i> Call Intelligence
                            </span>
                            <span
                                class="bg-indigo-100 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded">Recording</span>
                        </div>

                        <div class="flex-1 overflow-y-auto p-4 space-y-4">
                            <!-- Live Transcript -->
                            <div class="space-y-2">
                                <p class="text-xs text-slate-400 font-bold uppercase mb-2">Live Transcript</p>
                                <div class="flex gap-2">
                                    <span class="text-[10px] font-bold text-slate-400 mt-1">M:</span>
                                    <p
                                        class="text-sm text-slate-600 bg-white p-2 rounded-lg shadow-sm border border-slate-100">
                                        ...so the 25 per hour, is that guaranteed even if the dock is delayed?</p>
                                </div>
                                <div class="flex gap-2">
                                    <span class="text-[10px] font-bold text-slate-400 mt-1">You:</span>
                                    <p class="text-sm text-slate-600 bg-blue-50 p-2 rounded-lg border border-blue-100">
                                        Yes, our detention policy kicks in automatically. No admin needed.</p>
                                </div>
                            </div>

                            <!-- AI Suggestions -->
                            <div class="mt-6 pt-4 border-t border-slate-200">
                                <p class="text-xs text-indigo-600 font-bold uppercase mb-3 flex items-center gap-2">
                                    <i class="fa-solid fa-lightbulb"></i> Recommended Actions
                                </p>
                                <div class="space-y-2">
                                    <button
                                        class="w-full text-left p-3 bg-white border border-indigo-100 hover:border-indigo-300 rounded-xl shadow-sm group transition">
                                        <div class="text-xs font-bold text-slate-900 group-hover:text-indigo-600">Send
                                            Offer Letter</div>
                                        <div class="text-[10px] text-slate-400">AI detected "Salary" keyword.</div>
                                    </button>
                                    <button
                                        class="w-full text-left p-3 bg-white border border-indigo-100 hover:border-indigo-300 rounded-xl shadow-sm group transition">
                                        <div class="text-xs font-bold text-slate-900 group-hover:text-indigo-600">
                                            Schedule Orientation</div>
                                        <div class="text-[10px] text-slate-400">Driver signaled availability.</div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Keypad Toggle -->
                    <div
                        class="h-12 bg-white border-t border-slate-200 flex items-center justify-between px-6 cursor-pointer hover:bg-slate-50 transition">
                        <span class="text-xs font-bold text-slate-500">Keypad</span>
                        <i class="fa-solid fa-grip text-slate-400"></i>
                    </div>

                </aside>

            </main>

        </div><!-- End Main Content Area -->
    </div><!-- End Main Layout with Sidebar -->

    <!-- ==================== CALL OUTCOME MODAL ==================== -->
    <div id="callOutcomeModal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center">
        <div class="bg-gray-900 border border-gray-700 rounded-xl p-6 w-full max-w-lg mx-4">
            <h3 class="text-lg font-semibold text-white mb-4">Log Call Outcome</h3>
            <input type="hidden" id="callOutcomeDriverId">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Outcome</label>
                    <div class="grid grid-cols-3 gap-2" id="outcomeButtons">
                        <button onclick="selectOutcome('interested', event)"
                            class="outcome-btn px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm text-white hover:border-green-500">Interested</button>
                        <button onclick="selectOutcome('callback', event)"
                            class="outcome-btn px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm text-white hover:border-blue-500">Callback</button>
                        <button onclick="selectOutcome('not_now', event)"
                            class="outcome-btn px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm text-white hover:border-yellow-500">Not
                            Now</button>
                        <button onclick="selectOutcome('wrong_fit', event)"
                            class="outcome-btn px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm text-white hover:border-red-500">Wrong
                            Fit</button>
                        <button onclick="selectOutcome('no_answer', event)"
                            class="outcome-btn px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm text-white hover:border-gray-500">No
                            Answer</button>
                        <button onclick="selectOutcome('voicemail', event)"
                            class="outcome-btn px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm text-white hover:border-purple-500">Voicemail</button>
                    </div>
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-1">Notes</label>
                    <textarea id="callOutcomeNotes"
                        class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white text-base md:text-sm h-20"
                        placeholder="Optional notes about the call..."></textarea>
                </div>
                <div class="flex gap-4">
                    <div class="flex-1">
                        <label class="block text-sm text-gray-400 mb-1">Follow-up Date</label>
                        <input id="callFollowUpDate" type="date"
                            class="w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-400 mb-1">Sentiment</label>
                        <div class="flex gap-3 mt-1">
                            <label class="flex items-center gap-1 text-sm text-gray-300"><input type="radio"
                                    name="callSentiment" value="positive" class="accent-green-500"> +</label>
                            <label class="flex items-center gap-1 text-sm text-gray-300"><input type="radio"
                                    name="callSentiment" value="neutral" checked class="accent-gray-400"> =</label>
                            <label class="flex items-center gap-1 text-sm text-gray-300"><input type="radio"
                                    name="callSentiment" value="negative" class="accent-red-500"> -</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex justify-end gap-3 mt-6">
                <button onclick="closeCallOutcomeModal()"
                    class="px-4 py-2 text-sm text-gray-400 hover:text-white">Cancel</button>
                <button onclick="submitCallOutcome()" id="submitOutcomeBtn"
                    class="px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
                    disabled>Log Outcome</button>
            </div>
        </div>
    </div>

    <!-- ==================== CALL ANALYTICS SECTION ==================== -->
    <div id="callAnalyticsSection" class="mx-4 mt-6">
        <h3 class="text-lg font-semibold text-white mb-4">Call Analytics</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-4">
                <div class="text-sm text-gray-400">Total Calls</div>
                <div id="totalCallsCount" class="text-2xl font-bold text-white mt-1">0</div>
            </div>
            <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-4">
                <div class="text-sm text-gray-400">Conversion Rate</div>
                <div id="overallConversion" class="text-2xl font-bold text-green-400 mt-1">0%</div>
            </div>
            <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-4">
                <div class="text-sm text-gray-400">Avg Sentiment</div>
                <div id="avgSentimentDisplay" class="text-2xl font-bold text-blue-400 mt-1">--</div>
            </div>
        </div>

        <!-- Outcome Distribution -->
        <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-4 mb-4">
            <h4 class="text-sm font-medium text-gray-300 mb-3">Outcome Distribution</h4>
            <div id="outcomeDistribution" class="space-y-2"></div>
        </div>

        <!-- Recent Calls -->
        <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-4">
            <h4 class="text-sm font-medium text-gray-300 mb-3">Recent Calls</h4>
            <div id="recentCallsList" class="space-y-2 max-h-64 overflow-y-auto"></div>
        </div>
    </div>

    <!-- SIDEBAR JAVASCRIPT -->
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const icon = document.getElementById('toggleIcon');

            sidebar.classList.toggle('w-64');
            sidebar.classList.toggle('w-20');
            sidebar.classList.toggle('collapsed');

            if (sidebar.classList.contains('collapsed')) {
                icon.classList.remove('fa-chevron-left');
                icon.classList.add('fa-chevron-right');
                document.getElementById('sidebarChatContainer').classList.remove('chat-open');
            } else {
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-left');
            }
        }

        function toggleSidebarChat() {
            const sidebar = document.getElementById('sidebar');
            const container = document.getElementById('sidebarChatContainer');
            const chevron = document.getElementById('sidebarChatChevron');

            if (sidebar.classList.contains('collapsed')) {
                toggleSidebar();
                setTimeout(() => {
                    container.classList.add('chat-open');
                    chevron.classList.replace('fa-chevron-up', 'fa-chevron-down');
                }, 300);
            } else {
                container.classList.toggle('chat-open');
                if (container.classList.contains('chat-open')) {
                    chevron.classList.replace('fa-chevron-up', 'fa-chevron-down');
                } else {
                    chevron.classList.replace('fa-chevron-down', 'fa-chevron-up');
                }
            }
        }

        // Handle sidebar navigation
        document.querySelectorAll('.sidebar-link[data-page]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('collapsed')) {
                    toggleSidebar();
                }
                const page = link.getAttribute('data-page');
                if (page) {
                    window.parent.postMessage({ type: 'navigateTo', data: { page: page } }, '*');
                }
            });
        });

        function updateSidebarUser(profile) {
            if (profile) {
                const name = profile.firstName || profile.name || 'Recruiter';
                const company = profile.company || '--';
                const initials = name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);

                const nameEl = document.getElementById('sidebar-user-name');
                const companyEl = document.getElementById('sidebar-user-company');
                const initialsEl = document.getElementById('sidebar-user-initials');

                if (nameEl) nameEl.textContent = name;
                if (companyEl) companyEl.textContent = company;
                if (initialsEl) initialsEl.textContent = initials || '--';
            }
        }

        window.addEventListener('message', function (event) {
            const data = event.data;
            if (!data || !data.type) return;

            switch (data.type) {
                case 'recruiterProfile':
                    if (data.data) updateSidebarUser(data.data);
                    break;

                case 'callOutcomeLogged':
                    if (data.data && data.data.success) {
                        showToast('Call outcome logged!', 'success');
                        closeCallOutcomeModal();
                        loadCallAnalytics();
                        loadRecentCalls();
                    } else {
                        showToast((data.data && data.data.error) || 'Failed to log outcome', 'error');
                    }
                    break;

                case 'callAnalyticsLoaded':
                    if (data.data && data.data.success) {
                        renderCallAnalytics(data.data.analytics);
                    }
                    break;

                case 'recentCallsLoaded':
                    if (data.data && data.data.success) {
                        renderRecentCalls(data.data.outcomes || []);
                    }
                    break;

                case 'driverCallHistoryLoaded':
                    // Handle driver-specific call history if needed
                    break;
            }
        });

        // ==================== POSTMESSAGE HELPER ====================
        function sendMessage(type, payload) {
            window.parent.postMessage({ type: type, data: payload }, '*');
        }

        // ==================== TOAST NOTIFICATION ====================
        function showToast(message, type) {
            const existing = document.getElementById('toastNotification');
            if (existing) existing.remove();

            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600'
            };
            const toast = document.createElement('div');
            toast.id = 'toastNotification';
            toast.className = `fixed top-4 right-4 z-[100] ${colors[type] || colors.info} text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium transition-opacity duration-300`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ==================== CALL OUTCOME FUNCTIONS ====================
        let selectedOutcome = null;

        function openCallOutcomeModal(driverId) {
            document.getElementById('callOutcomeDriverId').value = driverId || '';
            document.getElementById('callOutcomeModal').classList.remove('hidden');
            document.getElementById('callOutcomeModal').classList.add('flex');
            selectedOutcome = null;
            document.querySelectorAll('.outcome-btn').forEach(b => b.classList.remove('ring-2', 'ring-blue-500'));
            document.getElementById('submitOutcomeBtn').disabled = true;
        }

        function closeCallOutcomeModal() {
            document.getElementById('callOutcomeModal').classList.add('hidden');
            document.getElementById('callOutcomeModal').classList.remove('flex');
            document.getElementById('callOutcomeNotes').value = '';
            document.getElementById('callFollowUpDate').value = '';
            selectedOutcome = null;
        }

        function selectOutcome(outcome, e) {
            selectedOutcome = outcome;
            document.querySelectorAll('.outcome-btn').forEach(b => {
                b.classList.remove('ring-2', 'ring-blue-500');
            });
            if (e && e.target) e.target.classList.add('ring-2', 'ring-blue-500');
            document.getElementById('submitOutcomeBtn').disabled = false;
        }

        function submitCallOutcome() {
            if (!selectedOutcome) return;
            const driverId = document.getElementById('callOutcomeDriverId').value;
            const notes = document.getElementById('callOutcomeNotes').value;
            const followUpDate = document.getElementById('callFollowUpDate').value || null;
            const sentimentEl = document.querySelector('input[name="callSentiment"]:checked');
            const sentiment = sentimentEl ? sentimentEl.value : 'neutral';

            sendMessage('logCallOutcome', {
                driverId: driverId,
                outcome: selectedOutcome,
                notes: notes,
                followUpDate: followUpDate,
                sentiment: sentiment
            });
        }

        function loadCallAnalytics() {
            sendMessage('getCallAnalytics', {});
        }

        function loadRecentCalls() {
            sendMessage('getRecentCalls', { limit: 20 });
        }

        function renderCallAnalytics(analytics) {
            if (!analytics) return;
            document.getElementById('totalCallsCount').textContent = analytics.totalCalls || 0;
            document.getElementById('overallConversion').textContent = (analytics.overallConversionRate || 0) + '%';

            const sentiment = analytics.avgSentiment || 0;
            const sentimentEl = document.getElementById('avgSentimentDisplay');
            sentimentEl.textContent = sentiment > 0 ? 'Positive' : sentiment < 0 ? 'Negative' : 'Neutral';
            sentimentEl.className = 'text-2xl font-bold mt-1 ' + (sentiment > 0 ? 'text-green-400' : sentiment < 0 ? 'text-red-400' : 'text-gray-400');

            // Outcome distribution bars
            var dist = analytics.outcomeDistribution || {};
            var total = analytics.totalCalls || 1;
            var colors = { interested: 'bg-green-500', callback: 'bg-blue-500', not_now: 'bg-yellow-500', wrong_fit: 'bg-red-500', no_answer: 'bg-gray-500', voicemail: 'bg-purple-500' };

            document.getElementById('outcomeDistribution').innerHTML = Object.entries(dist).map(function (entry) {
                var key = entry[0];
                var count = entry[1];
                var pct = Math.round((count / total) * 100);
                return '<div class="flex items-center gap-2">' +
                    '<span class="text-xs text-gray-400 w-20 capitalize">' + key.replace(/_/g, ' ') + '</span>' +
                    '<div class="flex-1 bg-gray-700 rounded-full h-2"><div class="' + (colors[key] || 'bg-gray-500') + ' h-2 rounded-full" style="width: ' + pct + '%"></div></div>' +
                    '<span class="text-xs text-gray-400 w-8 text-right">' + count + '</span>' +
                    '</div>';
            }).join('');
        }

        function renderRecentCalls(calls) {
            var list = document.getElementById('recentCallsList');
            if (!calls.length) {
                list.innerHTML = '<p class="text-sm text-gray-500">No calls logged yet</p>';
                return;
            }

            var badges = { interested: 'bg-green-600', callback: 'bg-blue-600', not_now: 'bg-yellow-600', wrong_fit: 'bg-red-600', no_answer: 'bg-gray-600', voicemail: 'bg-purple-600' };

            list.innerHTML = calls.slice(0, 20).map(function (c) {
                var date = new Date(c.call_timestamp).toLocaleDateString();
                return '<div class="flex items-center justify-between py-2 border-b border-gray-700/50">' +
                    '<div class="flex-1 min-w-0">' +
                    '<span class="text-sm text-white">' + (c.driver_id || 'Unknown') + '</span>' +
                    '<span class="text-xs text-gray-400 ml-2">' + date + '</span>' +
                    '</div>' +
                    '<span class="px-2 py-0.5 ' + (badges[c.outcome] || 'bg-gray-600') + ' text-white text-xs rounded-full capitalize">' + (c.outcome || '').replace(/_/g, ' ') + '</span>' +
                    '</div>';
            }).join('');
        }

        // Notify Wix that telemetry page is ready
        window.parent.postMessage({ type: 'telemetryPageReady' }, '*');
    </script>

</body>

</html>


