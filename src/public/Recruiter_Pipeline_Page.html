<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candidate Pipeline - LMDR Recruiter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        lmdr: {
                            blue: '#2563eb',
                            dark: '#0f172a',
                            canvas: '#f1f5f9' // Light gray canvas for Kanban contrast
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .kanban-column { min-width: 320px; }
        .card-drag:hover { transform: translateY(-2px) rotate(1deg); cursor: grab; }
        .card-drag:active { cursor: grabbing; }

        /* ============================================
           GLOBAL SIDEBAR STYLES
           ============================================ */
        .sidebar-transition { transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .fade-text { transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out; }

        .collapsed .fade-text { opacity: 0; pointer-events: none; display: none; }
        .collapsed .sidebar-header { justify-content: center; padding-left: 0; padding-right: 0; }
        .collapsed .logo-text { display: none; }

        .sidebar-link { transition: all 0.2s ease-in-out; white-space: nowrap; overflow: hidden; }
        .sidebar-link:hover { background-color: rgba(255, 255, 255, 0.08); }
        .sidebar-link.active {
            background: linear-gradient(90deg, rgba(37, 99, 235, 0.2) 0%, transparent 100%);
            border-left: 4px solid #2563eb;
            color: white;
            text-shadow: 0 0 10px rgba(37, 99, 235, 0.5);
        }
        .sidebar-link.active i { color: #60a5fa; filter: drop-shadow(0 0 5px rgba(37, 99, 235, 0.8)); }

        .sidebar-chat-panel { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); max-height: 0; opacity: 0; overflow: hidden; }
        .chat-open .sidebar-chat-panel { max-height: 400px; opacity: 1; padding-bottom: 1rem; }

        .chat-bubble-in { border-radius: 1.25rem 1.25rem 1.25rem 0.25rem; }
        .chat-bubble-out { border-radius: 1.25rem 1.25rem 0.25rem 1.25rem; }

        @keyframes subtle-pulse {
            0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4); }
            70% { box-shadow: 0 0 0 6px rgba(37, 99, 235, 0); }
            100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
        }
        .chat-pulse { animation: subtle-pulse 2s infinite; }

        .thin-scroll::-webkit-scrollbar { width: 4px; }
        .thin-scroll::-webkit-scrollbar-thumb { background-color: rgba(255,255,255,0.1); border-radius: 4px; }

        .glass-panel {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(16px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-bubble-in {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .blob { position: absolute; border-radius: 50%; filter: blur(60px); z-index: 0; opacity: 0.6; animation: float-blob 10s infinite ease-in-out; }
        .blob-1 { top: -10%; left: -20%; width: 300px; height: 300px; background: #2563eb; }
        .blob-2 { bottom: 10%; right: -20%; width: 250px; height: 250px; background: #6366f1; animation-delay: -5s; }

        @keyframes float-blob {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, 40px); }
        }

        .shadow-glow { box-shadow: 0 0 15px rgba(37, 99, 235, 0.5); }
        .shadow-glow-active { box-shadow: 0 0 20px rgba(59, 130, 246, 0.6); }
    </style>
</head>
<body class="bg-lmdr-dark text-slate-300 antialiased h-screen overflow-hidden">

    <!-- MAIN LAYOUT WITH SIDEBAR -->
    <div class="flex h-screen overflow-hidden">

    <!-- GLOBAL SIDEBAR -->
    <div class="relative h-full flex flex-col z-40 bg-slate-900 overflow-hidden shadow-2xl transition-all duration-300 flex-shrink-0" id="sidebar-container">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>

        <aside id="sidebar" class="w-64 text-slate-300 flex flex-col h-full sidebar-transition group relative z-10 bg-slate-900/60 backdrop-blur-xl border-r border-white/5">
            <button onclick="toggleSidebar()" class="absolute -right-3 top-20 bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center shadow-lg border border-slate-900 hover:scale-110 transition-transform z-50 opacity-0 group-hover:opacity-100">
                <i class="fa-solid fa-chevron-left text-[10px]" id="toggleIcon"></i>
            </button>

            <div class="h-16 flex items-center px-6 border-b border-white/10 sidebar-header transition-all">
                <div class="flex items-center gap-3">
                    <div class="h-8 w-8 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex-none flex items-center justify-center text-white font-black text-sm shadow-lg shadow-blue-500/30 ring-1 ring-white/20">LM</div>
                    <div class="logo-text fade-text">
                        <h1 class="font-bold text-white text-sm tracking-tight drop-shadow-md">LMDR<span class="text-blue-400">.ai</span></h1>
                        <p class="text-[10px] text-blue-200/70 uppercase font-bold tracking-wider">Recruiter OS</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 overflow-y-auto thin-scroll py-6 space-y-1">
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Dashboard" data-page="dashboard">
                    <i class="fa-solid fa-table-columns w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Dashboard</span>
                </a>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Driver Search" data-page="driver-search">
                    <i class="fa-solid fa-magnifying-glass w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Driver Search</span>
                </a>
                <a href="#" class="sidebar-link active flex items-center gap-4 px-6 py-3 text-sm font-bold" title="Pipeline" data-page="pipeline">
                    <i class="fa-solid fa-layer-group w-5 text-center flex-none"></i>
                    <span class="fade-text">Pipeline</span>
                </a>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Jobs" data-page="jobs">
                    <i class="fa-solid fa-briefcase w-5 text-center flex-none text-slate-400 group-hover:text-white transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Jobs</span>
                </a>

                <div class="px-6 mt-6 mb-2 text-[10px] font-bold uppercase tracking-widest text-blue-200/50 fade-text">Intelligence</div>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Ad Studio" data-page="ad-studio">
                    <i class="fa-solid fa-wand-magic-sparkles w-5 text-center flex-none text-slate-400 group-hover:text-indigo-400 transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Ad Studio</span>
                </a>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Telemetry" data-page="telemetry">
                    <i class="fa-solid fa-chart-line w-5 text-center flex-none text-slate-400 group-hover:text-green-400 transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Telemetry</span>
                </a>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Compliance" data-page="compliance">
                    <i class="fa-solid fa-shield-halved w-5 text-center flex-none text-slate-400 group-hover:text-green-400 transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Compliance</span>
                </a>

                <div class="px-6 mt-6 mb-2 text-[10px] font-bold uppercase tracking-widest text-blue-200/50 fade-text">Settings</div>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Match Scoring" data-page="match-scoring">
                    <i class="fa-solid fa-sliders w-5 text-center flex-none text-slate-400 group-hover:text-blue-400 transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Match Scoring</span>
                </a>
                <a href="#" class="sidebar-link flex items-center gap-4 px-6 py-3 text-sm font-medium hover:text-white group" title="Preferences" data-page="preferences">
                    <i class="fa-solid fa-gear w-5 text-center flex-none text-slate-400 group-hover:text-slate-300 transition-colors"></i>
                    <span class="fade-text group-hover:translate-x-1 transition-transform">Preferences</span>
                </a>
            </nav>

            <div id="sidebarChatContainer" class="glass-panel">
                <button onclick="toggleSidebarChat()" class="w-full flex items-center gap-4 px-6 py-4 hover:bg-white/10 transition group relative">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center text-white shadow-glow chat-pulse flex-none group-hover:shadow-glow-active transition-shadow ring-1 ring-white/20">
                        <i class="fa-solid fa-comment-dots"></i>
                    </div>
                    <div class="fade-text text-left flex-1">
                        <p class="text-sm font-bold text-white group-hover:text-blue-300 transition-colors">Quick Chat</p>
                        <p class="text-[10px] text-green-400 font-medium" id="sidebar-drivers-online">-- Online</p>
                    </div>
                    <i class="fa-solid fa-chevron-up text-xs text-slate-400 fade-text group-hover:text-white transition-transform" id="sidebarChatChevron"></i>
                </button>

                <div id="sidebarChatPanel" class="sidebar-chat-panel border-t border-white/5 bg-black/20">
                    <div class="px-4 space-y-3 pt-2">
                        <div class="text-center py-2">
                            <span class="text-[9px] font-bold text-slate-400 bg-white/5 px-2 py-0.5 rounded-full border border-white/5 backdrop-blur-sm">Today</span>
                        </div>
                        <div class="flex gap-2">
                            <div class="w-6 h-6 rounded-full bg-slate-700/50 flex-none flex items-center justify-center text-[9px] font-bold text-white shadow-sm ring-1 ring-white/10">JD</div>
                            <div class="glass-bubble-in text-slate-200 text-xs p-3 chat-bubble-in max-w-[85%] shadow-sm">
                                <p>Is the dedicated route still open?</p>
                            </div>
                        </div>
                        <div class="flex gap-2 flex-row-reverse">
                            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-xs p-3 chat-bubble-out max-w-[85%] shadow-md border border-white/10">
                                <p>Yes, John. Can you talk now?</p>
                            </div>
                        </div>
                        <div class="pt-2 mt-2 border-t border-white/10 flex gap-2">
                            <input type="text" placeholder="Type..." class="w-full bg-white/5 border border-white/10 rounded-full px-3 py-1.5 text-xs text-white focus:outline-none focus:border-blue-500 focus:bg-white/10 transition-colors placeholder-slate-500 backdrop-blur-sm">
                            <button class="w-7 h-7 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs hover:bg-blue-500 transition shadow-glow">
                                <i class="fa-solid fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-4 border-t border-white/10 bg-black/30 backdrop-blur-md">
                <button class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-white/10 transition text-left group">
                    <div class="h-9 w-9 rounded-full bg-slate-800/50 flex-none flex items-center justify-center border border-slate-600/50 text-white font-bold text-xs group-hover:border-blue-500 shadow-sm" id="sidebar-user-initials">--</div>
                    <div class="flex-1 overflow-hidden fade-text">
                        <p class="text-sm font-bold text-white truncate" id="sidebar-user-name">Loading...</p>
                        <p class="text-xs text-slate-400 truncate" id="sidebar-user-company">--</p>
                    </div>
                </button>
            </div>
        </aside>
    </div>

    <!-- MAIN CONTENT AREA -->
    <div class="flex-1 flex flex-col overflow-hidden">

    <!-- HEADER -->
    <header class="bg-white border-b border-slate-200 h-16 flex-none z-30 flex justify-between items-center px-6 text-slate-600">
        <div class="flex items-center gap-4">
            <div class="h-9 w-9 bg-lmdr-blue rounded-lg flex items-center justify-center text-white font-black">LM</div>
            <h1 class="font-bold text-slate-900 text-lg">Campaign: Texas OTR Regional</h1>
            <span class="bg-green-100 text-green-700 text-xs font-bold px-2 py-0.5 rounded-full border border-green-200">Active</span>
        </div>
        
        <div class="flex items-center gap-4">
            <div class="hidden md:flex items-center gap-6 mr-6">
                <div class="text-center">
                    <div class="text-[10px] font-bold uppercase tracking-wider text-slate-400">Total Pipeline</div>
                    <div class="font-black text-slate-900 leading-none">48</div>
                </div>
                <div class="text-center">
                    <div class="text-[10px] font-bold uppercase tracking-wider text-slate-400">Time to Fill</div>
                    <div class="font-black text-slate-900 leading-none">12d</div>
                </div>
                <div class="text-center">
                    <div class="text-[10px] font-bold uppercase tracking-wider text-slate-400">Response Rate</div>
                    <div class="font-black text-green-600 leading-none">42%</div>
                </div>
            </div>
            <button class="bg-lmdr-dark text-white text-xs font-bold px-4 py-2 rounded-lg hover:bg-slate-800 transition">
                <i class="fa-solid fa-filter mr-1"></i> Filter
            </button>
            <button class="bg-lmdr-blue text-white text-xs font-bold px-4 py-2 rounded-lg hover:bg-blue-600 transition shadow-lg shadow-blue-200">
                <i class="fa-solid fa-plus mr-1"></i> Add Driver
            </button>
        </div>
    </header>

    <!-- KANBAN BOARD -->
    <main class="flex-1 overflow-x-auto overflow-y-hidden bg-slate-100 p-6">
        <div class="flex h-full gap-6">

            <!-- COL 1: AI MATCHED (Inbound) -->
            <div class="kanban-column flex flex-col h-full rounded-2xl bg-slate-200/50 border border-slate-200">
                <div class="p-4 flex justify-between items-center bg-white rounded-t-2xl border-b border-slate-200 sticky top-0">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                        <h3 class="font-bold text-slate-900 text-sm">AI Sourced</h3>
                        <span class="bg-slate-100 text-slate-500 text-xs font-bold px-2 rounded-full">12</span>
                    </div>
                    <i class="fa-solid fa-ellipsis text-slate-400 hover:text-slate-600 cursor-pointer"></i>
                </div>
                
                <div class="flex-1 overflow-y-auto p-3 space-y-3">
                    
                    <!-- Card 1 -->
                    <div class="card-drag bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-all group relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded-full bg-yellow-400 flex items-center justify-center text-slate-900 font-bold text-xs">JD</div>
                                <span class="font-bold text-slate-900 text-sm">John Doe</span>
                            </div>
                            <span class="text-green-600 text-xs font-black">98%</span>
                        </div>
                        <div class="text-xs text-slate-500 mb-3 flex flex-wrap gap-2">
                            <span class="bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100">Class A</span>
                            <span class="bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100">5 Yrs</span>
                            <span class="bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100">Hazmat</span>
                        </div>
                        <div class="flex gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                            <button class="flex-1 bg-blue-50 text-blue-600 text-xs font-bold py-1.5 rounded hover:bg-blue-100"><i class="fa-solid fa-eye"></i> Review</button>
                            <button class="flex-1 bg-slate-50 text-slate-400 text-xs font-bold py-1.5 rounded hover:text-red-500 hover:bg-red-50"><i class="fa-solid fa-xmark"></i></button>
                        </div>
                    </div>

                    <!-- Card 2 -->
                    <div class="card-drag bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-all group relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-blue-400/50"></div>
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-white font-bold text-xs">MR</div>
                                <span class="font-bold text-slate-900 text-sm">Marcus Ray</span>
                            </div>
                            <span class="text-blue-600 text-xs font-black">85%</span>
                        </div>
                        <div class="text-xs text-slate-500 mb-3">
                            <p class="truncate">Looking for regional runs only.</p>
                        </div>
                        <div class="flex gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                            <button class="flex-1 bg-blue-50 text-blue-600 text-xs font-bold py-1.5 rounded hover:bg-blue-100"><i class="fa-solid fa-eye"></i> Review</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- COL 2: CONTACTED (Telemetry Zone) -->
            <div class="kanban-column flex flex-col h-full rounded-2xl bg-blue-50/30 border border-blue-100">
                <div class="p-4 flex justify-between items-center bg-white rounded-t-2xl border-b border-blue-100 sticky top-0">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                        <h3 class="font-bold text-slate-900 text-sm">In Discussion</h3>
                        <span class="bg-blue-100 text-blue-600 text-xs font-bold px-2 rounded-full">5</span>
                    </div>
                </div>
                
                <div class="flex-1 overflow-y-auto p-3 space-y-3">
                    <!-- Card Active -->
                    <div class="card-drag bg-white p-4 rounded-xl shadow-lg shadow-blue-100 border border-blue-200 hover:border-blue-400 transition-all group relative overflow-hidden ring-2 ring-blue-400 ring-offset-2">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-slate-600 font-bold text-xs">SM</div>
                                <span class="font-bold text-slate-900 text-sm">Sarah Miller</span>
                            </div>
                            <div class="flex gap-1">
                                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                            </div>
                        </div>
                        <div class="bg-slate-50 p-2 rounded-lg mb-3">
                            <p class="text-[10px] text-slate-500 italic">"Can you send over the benefits package PDF?"</p>
                        </div>
                        <div class="flex gap-2">
                            <button class="flex-1 bg-green-500 text-white text-xs font-bold py-1.5 rounded hover:bg-green-600 shadow-sm flex items-center justify-center gap-1">
                                <i class="fa-solid fa-phone"></i> Call
                            </button>
                            <button class="flex-1 bg-white border border-slate-200 text-slate-600 text-xs font-bold py-1.5 rounded hover:bg-slate-50 flex items-center justify-center gap-1">
                                <i class="fa-solid fa-comment"></i> Chat
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- COL 3: VERIFICATION (Compliance) -->
            <div class="kanban-column flex flex-col h-full rounded-2xl bg-slate-200/50 border border-slate-200">
                <div class="p-4 flex justify-between items-center bg-white rounded-t-2xl border-b border-slate-200 sticky top-0">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-purple-500"></div>
                        <h3 class="font-bold text-slate-900 text-sm">Verification</h3>
                        <span class="bg-slate-100 text-slate-500 text-xs font-bold px-2 rounded-full">2</span>
                    </div>
                </div>
                
                <div class="flex-1 overflow-y-auto p-3 space-y-3">
                    <div class="card-drag bg-white p-4 rounded-xl shadow-sm border border-slate-200 opacity-80 hover:opacity-100 transition-all">
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-bold text-slate-900 text-sm">Mike T.</span>
                            <span class="text-xs font-bold text-purple-600 bg-purple-50 px-2 rounded">PSP Check</span>
                        </div>
                        <div class="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden mb-2">
                            <div class="bg-purple-500 h-full w-2/3"></div>
                        </div>
                        <p class="text-[10px] text-slate-400">Waiting on MVR results...</p>
                    </div>
                </div>
            </div>

            <!-- COL 4: HIRED (Success) -->
            <div class="kanban-column flex flex-col h-full rounded-2xl bg-green-50/50 border border-green-100">
                <div class="p-4 flex justify-between items-center bg-white rounded-t-2xl border-b border-green-100 sticky top-0">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <h3 class="font-bold text-slate-900 text-sm">Ready to Hire</h3>
                        <span class="bg-green-100 text-green-700 text-xs font-bold px-2 rounded-full">3</span>
                    </div>
                </div>
                
                <div class="flex-1 overflow-y-auto p-3 space-y-3">
                    <div class="card-drag bg-white p-4 rounded-xl shadow-sm border-l-4 border-green-500">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold text-slate-900 text-sm">Luis G.</span>
                            <i class="fa-solid fa-check-circle text-green-500"></i>
                        </div>
                        <button class="w-full bg-slate-900 text-white text-xs font-bold py-2 rounded hover:bg-slate-800">
                            Send Offer Letter
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </main>

    </div><!-- End Main Content Area -->
    </div><!-- End Main Layout with Sidebar -->

    <!-- SIDEBAR JAVASCRIPT -->
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const icon = document.getElementById('toggleIcon');

            sidebar.classList.toggle('w-64');
            sidebar.classList.toggle('w-20');
            sidebar.classList.toggle('collapsed');

            if (sidebar.classList.contains('collapsed')) {
                icon.classList.remove('fa-chevron-left');
                icon.classList.add('fa-chevron-right');
                document.getElementById('sidebarChatContainer').classList.remove('chat-open');
            } else {
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-left');
            }
        }

        function toggleSidebarChat() {
            const sidebar = document.getElementById('sidebar');
            const container = document.getElementById('sidebarChatContainer');
            const chevron = document.getElementById('sidebarChatChevron');

            if (sidebar.classList.contains('collapsed')) {
                toggleSidebar();
                setTimeout(() => {
                    container.classList.add('chat-open');
                    chevron.classList.replace('fa-chevron-up', 'fa-chevron-down');
                }, 300);
            } else {
                container.classList.toggle('chat-open');
                if (container.classList.contains('chat-open')) {
                    chevron.classList.replace('fa-chevron-up', 'fa-chevron-down');
                } else {
                    chevron.classList.replace('fa-chevron-down', 'fa-chevron-up');
                }
            }
        }

        // Handle sidebar navigation
        document.querySelectorAll('.sidebar-link[data-page]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('collapsed')) {
                    toggleSidebar();
                }
                const page = link.getAttribute('data-page');
                if (page) {
                    window.parent.postMessage({ type: 'navigateTo', data: { page: page } }, '*');
                }
            });
        });

        function updateSidebarUser(profile) {
            if (profile) {
                const name = profile.firstName || profile.name || 'Recruiter';
                const company = profile.company || '--';
                const initials = name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);

                const nameEl = document.getElementById('sidebar-user-name');
                const companyEl = document.getElementById('sidebar-user-company');
                const initialsEl = document.getElementById('sidebar-user-initials');

                if (nameEl) nameEl.textContent = name;
                if (companyEl) companyEl.textContent = company;
                if (initialsEl) initialsEl.textContent = initials || '--';
            }
        }

        window.addEventListener('message', function(event) {
            const msg = event.data;
            if (msg && msg.type === 'recruiterProfile' && msg.data) {
                updateSidebarUser(msg.data);
            }
        });

        // Notify Wix that pipeline page is ready
        window.parent.postMessage({ type: 'pipelinePageReady' }, '*');
    </script>

</body>
</html>