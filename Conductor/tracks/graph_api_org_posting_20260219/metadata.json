{
    "track_id": "graph_api_org_posting_20260219",
    "title": "Graph API Organic Posting â€” Facebook Page & Instagram Feed",
    "description": "Implement organic (non-paid) timeline posting to Facebook Pages and Instagram professional accounts using Meta Graph API and Instagram Graph API. Separate from the existing Marketing API (ads) track. Covers image, video, carousel, and Reels posting with a unified dispatcher, post queue, scheduling, retries, token lifecycle management, and a GCP-migration-ready secrets abstraction.",
    "status": "in_progress",
    "created_at": "2026-02-19",
    "updated_at": "2026-02-20",
    "owner": "Antigravity Agent",
    "priority": "high",
    "phases": [
        {
            "id": 0,
            "name": "Research & Decisions",
            "status": "complete"
        },
        {
            "id": 1,
            "name": "MVP â€” FB Text + IG Image Post",
            "status": "in_progress"
        },
        {
            "id": 2,
            "name": "Full Post Type Support + Queue Model",
            "status": "in_progress"
        },
        {
            "id": 3,
            "name": "Scheduling & Rate Limit Enforcement",
            "status": "in_progress"
        },
        {
            "id": 4,
            "name": "Hardening â€” Retries, Token Health, Audit",
            "status": "in_progress"
        },
        {
            "id": 5,
            "name": "Migration-Ready Improvements",
            "status": "complete"
        }
    ],
    "dependencies": {
        "existing_tracks": [
            "Meta Marketing API services (metaCampaignService, metaAdSetService, metaCreativeService, metaGovernanceService) â€” existing Meta app credentials and App ID are reused",
            "observabilityService.jsw â€” for structured post-attempt logging",
            "emailService.jsw â€” for token health and dead-letter alerts",
            "configData.js â€” for SOCIAL_POSTING_ENABLED kill switch",
            "airtableClient.jsw â€” for post queue and audit log collections"
        ],
        "infrastructure": [
            "Wix Secrets Manager (v1 â€” current)",
            "GCP Secret Manager (v2 â€” migration path via gcp_migration_20260218 track)"
        ],
        "external_apis": [
            "Meta Graph API v25.0 â€” graph.facebook.com",
            "Instagram Graph API â€” graph.instagram.com",
            "Meta Resumable Upload API â€” rupload.facebook.com (for Reels/video)"
        ]
    },
    "api_surfaces": {
        "facebook_page": {
            "endpoint": "POST /v25.0/{page-id}/feed",
            "photo_endpoint": "POST /v25.0/{page-id}/photos",
            "video_endpoint": "POST /v25.0/{page-id}/videos",
            "permissions": [
                "pages_manage_posts",
                "pages_read_engagement",
                "pages_show_list"
            ],
            "token_type": "Long-lived Page access token",
            "source_doc": "https://developers.facebook.com/docs/graph-api/reference/page/feed/"
        },
        "instagram": {
            "container_endpoint": "POST /{ig-id}/media",
            "publish_endpoint": "POST /{ig-id}/media_publish",
            "quota_endpoint": "GET /{ig-id}/content_publishing_limit",
            "permissions": [
                "instagram_business_basic",
                "instagram_business_content_publish"
            ],
            "token_type": "Instagram User access token",
            "rate_limit": "50 posts per 24-hour rolling window",
            "source_doc": "https://developers.facebook.com/docs/instagram-api/guides/content-publishing"
        }
    },
    "key_files_to_create": [
        "src/backend/socialPostingService.jsw",
        "src/backend/socialSecretService.jsw",
        "src/backend/socialTokenService.jsw",
        "src/backend/socialQueueService.jsw",
        "src/backend/socialQueueJob.jsw",
        "src/backend/socialRateLimitService.jsw",
        "src/backend/socialTokenHealthJob.jsw",
        "src/public/__tests__/socialPostingService.test.js",
        "src/public/__tests__/socialQueueService.test.js",
        "src/public/__tests__/socialRateLimitService.test.js",
        "src/public/__tests__/socialTokenService.test.js"
    ],
    "key_files_to_modify": [
        "src/backend/configData.js â€” add SOCIAL_POSTING_ENABLED flag",
        "src/backend/jobs.config â€” add processSocialQueue (15min) + socialTokenHealthJob (nightly)",
        "src/backend/emailService.jsw â€” add sendSocialAlert() function"
    ],
    "airtable_tables_to_create": [
        "v2_Social Post Queue",
        "v2_Social Audit Log"
    ],
    "kill_switch": "SOCIAL_POSTING_ENABLED flag in configData.js â€” set to false to immediately disable all organic posting",
    "notes": [
        "This track covers ONLY organic (non-paid) posting. Boosting posts is handled by the existing Marketing API services.",
        "Facebook personal profile posting is NOT possible via Graph API by design. This track targets Facebook Pages only.",
        "Instagram Stories are supported by the API (media_type=STORIES) but are NOT in MVP scope.",
        "All token exchange and secret operations MUST run server-side in .jsw files only. Never client-side.",
        "IG media (images) must be JPEG format only per API limitation. PNG and other formats are rejected.",
        "Video/Reels require async polling of the container status_code before publishing â€” this adds latency.",
        "Page Publishing Authorization (PPA) may be required for the linked FB Page before IG posting works â€” advise users to complete PPA preemptively.",
        "App Review is required for all permissions before Live Mode â€” development/testing only works for app role users.",
        "Schema docs created for v2_Social Post Queue and v2_Social Audit Log under docs/schemas/airtable, but Airtable tables still require manual provisioning.",
        "Audit event coverage is partial: token_refreshed and kill_switch_triggered events are still missing from implementation."
    ]
}

