[{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\debug_require.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\jest.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\__tests__\\costOptimizer.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\achievementCheckers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\adapters\\state511.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\configData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\driverScoring.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'effectiveMin' is assigned a value but never used.","line":491,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":491,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Driver Scoring Module for Reverse Matching Engine\r\n *\r\n * Scores drivers against carrier hiring preferences using weighted criteria.\r\n * This module mirrors the carrier scoring approach but evaluates drivers\r\n * against carrier requirements.\r\n *\r\n * @module backend/driverScoring\r\n */\r\n\r\n/**\r\n * Default weights for driver scoring (must sum to 100)\r\n */\r\nconst DEFAULT_WEIGHTS = {\r\n  qualifications: 30,   // CDL type, endorsements, clean record\r\n  experience: 20,       // Years driving, equipment familiarity\r\n  location: 20,         // Distance from carrier terminals\r\n  availability: 15,     // Ready now vs. 30-day notice\r\n  salaryFit: 10,        // Driver expectation vs. carrier offer\r\n  engagement: 5         // Platform activity, response rate\r\n};\r\n\r\n/**\r\n * Filter boost multipliers - how much to boost weight when filter is active\r\n */\r\nconst FILTER_BOOST_MULTIPLIERS = {\r\n  cdl_types: { affects: 'qualifications', boost: 1.5 },\r\n  endorsements: { affects: 'qualifications', boost: 2.0 },\r\n  min_experience: { affects: 'experience', boost: 1.5 },\r\n  zip_code: { affects: 'location', boost: 1.5 },\r\n  radius_miles: { affects: 'location', boost: 1.3 },\r\n  availability: { affects: 'availability', boost: 1.5 }\r\n};\r\n\r\n/**\r\n * Normalizes weights to sum to 100\r\n * @param {Object} weights - Raw weights object\r\n * @returns {Object} Normalized weights summing to 100\r\n */\r\nconst normalizeWeights = (weights) => {\r\n  const sum = Object.values(weights).reduce((a, b) => a + b, 0);\r\n  if (sum === 0) return { ...DEFAULT_WEIGHTS };\r\n\r\n  const normalized = {};\r\n  for (const key of Object.keys(weights)) {\r\n    normalized[key] = Math.round((weights[key] / sum) * 100);\r\n  }\r\n\r\n  // Ensure sum is exactly 100 (handle rounding errors)\r\n  const normalizedSum = Object.values(normalized).reduce((a, b) => a + b, 0);\r\n  if (normalizedSum !== 100) {\r\n    const diff = 100 - normalizedSum;\r\n    // Add/subtract difference to largest weight\r\n    const largestKey = Object.keys(normalized).reduce((a, b) =>\r\n      normalized[a] > normalized[b] ? a : b\r\n    );\r\n    normalized[largestKey] += diff;\r\n  }\r\n\r\n  return normalized;\r\n};\r\n\r\n/**\r\n * Calculates dynamic weights based on carrier preferences AND active filters\r\n *\r\n * Layer 1: Carrier Hiring Preferences (what this carrier values)\r\n * Layer 2: Active Filter Boosting (what recruiter prioritizes in this search)\r\n *\r\n * @param {Object} carrierPrefs - Carrier hiring preferences from CarrierHiringPreferences collection\r\n * @param {Object} activeFilters - Currently active search filters from the UI\r\n * @returns {Object} Dynamic weights object normalized to 100\r\n */\r\nconst calculateDynamicWeights = (carrierPrefs = {}, activeFilters = {}) => {\r\n  // Start with default weights\r\n  let weights = { ...DEFAULT_WEIGHTS };\r\n\r\n  // =========================================================================\r\n  // LAYER 1: Apply Carrier Preference Weights (if defined)\r\n  // =========================================================================\r\n  // Carriers can set custom weights in CarrierHiringPreferences collection\r\n  // Fields: weight_qualifications, weight_experience, weight_location, etc.\r\n\r\n  if (carrierPrefs) {\r\n    // Check for custom carrier weights\r\n    if (typeof carrierPrefs.weight_qualifications === 'number' && carrierPrefs.weight_qualifications > 0) {\r\n      weights.qualifications = carrierPrefs.weight_qualifications;\r\n    }\r\n    if (typeof carrierPrefs.weight_experience === 'number' && carrierPrefs.weight_experience > 0) {\r\n      weights.experience = carrierPrefs.weight_experience;\r\n    }\r\n    if (typeof carrierPrefs.weight_location === 'number' && carrierPrefs.weight_location > 0) {\r\n      weights.location = carrierPrefs.weight_location;\r\n    }\r\n    if (typeof carrierPrefs.weight_availability === 'number' && carrierPrefs.weight_availability > 0) {\r\n      weights.availability = carrierPrefs.weight_availability;\r\n    }\r\n    if (typeof carrierPrefs.weight_salaryFit === 'number' && carrierPrefs.weight_salaryFit > 0) {\r\n      weights.salaryFit = carrierPrefs.weight_salaryFit;\r\n    }\r\n    if (typeof carrierPrefs.weight_engagement === 'number' && carrierPrefs.weight_engagement > 0) {\r\n      weights.engagement = carrierPrefs.weight_engagement;\r\n    }\r\n  }\r\n\r\n  // =========================================================================\r\n  // LAYER 2: Apply Filter Boosts (active filters get priority)\r\n  // =========================================================================\r\n  // When a recruiter actively selects a filter, that criteria matters MORE\r\n  // to them for THIS specific search - boost its weight accordingly\r\n\r\n  if (activeFilters) {\r\n    // CDL type filter active - boost qualifications\r\n    if (activeFilters.cdl_types && Array.isArray(activeFilters.cdl_types) && activeFilters.cdl_types.length > 0) {\r\n      weights.qualifications *= FILTER_BOOST_MULTIPLIERS.cdl_types.boost;\r\n    }\r\n\r\n    // Endorsements filter active - boost qualifications more significantly\r\n    if (activeFilters.endorsements && Array.isArray(activeFilters.endorsements) && activeFilters.endorsements.length > 0) {\r\n      weights.qualifications *= FILTER_BOOST_MULTIPLIERS.endorsements.boost;\r\n    }\r\n\r\n    // Experience filter active - boost experience weight\r\n    if (activeFilters.min_experience && typeof activeFilters.min_experience === 'number') {\r\n      weights.experience *= FILTER_BOOST_MULTIPLIERS.min_experience.boost;\r\n    }\r\n\r\n    // Location filters active - boost location weight\r\n    if (activeFilters.zip_code && typeof activeFilters.zip_code === 'string' && activeFilters.zip_code.length > 0) {\r\n      weights.location *= FILTER_BOOST_MULTIPLIERS.zip_code.boost;\r\n    }\r\n    if (activeFilters.radius_miles && typeof activeFilters.radius_miles === 'number' && activeFilters.radius_miles < 100) {\r\n      // Tighter radius = more emphasis on location\r\n      weights.location *= FILTER_BOOST_MULTIPLIERS.radius_miles.boost;\r\n    }\r\n\r\n    // Availability filter active - boost availability weight\r\n    if (activeFilters.availability && typeof activeFilters.availability === 'string') {\r\n      weights.availability *= FILTER_BOOST_MULTIPLIERS.availability.boost;\r\n    }\r\n  }\r\n\r\n  // Normalize to 100 and return\r\n  return normalizeWeights(weights);\r\n};\r\n\r\n/**\r\n * Availability score mapping based on urgency level\r\n */\r\nconst AVAILABILITY_SCORES = {\r\n  immediate: { immediate: 100, '2_week': 70, '30_day': 40, ongoing: 80 },\r\n  '2_week': { immediate: 100, '2_week': 100, '30_day': 70, ongoing: 90 },\r\n  '30_day': { immediate: 100, '2_week': 100, '30_day': 100, ongoing: 100 },\r\n  ongoing: { immediate: 100, '2_week': 90, '30_day': 80, ongoing: 100 }\r\n};\r\n\r\n/**\r\n * Score driver qualifications against carrier requirements\r\n * Evaluates: CDL type match, endorsement match, violations\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @returns {number} Score from 0-100\r\n */\r\nconst scoreQualifications = (driver, preferences) => {\r\n  // Handle null/undefined inputs\r\n  if (!driver || !preferences) {\r\n    return 0;\r\n  }\r\n\r\n  const driverCdl = driver.cdl_class;\r\n  const requiredCdlTypes = preferences.required_cdl_types || [];\r\n  const requiredEndorsements = preferences.required_endorsements || [];\r\n  const driverEndorsements = driver.endorsements || [];\r\n\r\n  // CDL type check - must match one of the required types\r\n  if (requiredCdlTypes.length > 0 && !requiredCdlTypes.includes(driverCdl)) {\r\n    return 0;\r\n  }\r\n\r\n  // If no CDL class specified on driver, fail\r\n  if (!driverCdl) {\r\n    return 0;\r\n  }\r\n\r\n  let score = 100;\r\n\r\n  // Endorsement scoring\r\n  if (requiredEndorsements.length > 0) {\r\n    const matchedEndorsements = requiredEndorsements.filter(\r\n      endorsement => driverEndorsements.includes(endorsement)\r\n    );\r\n    const endorsementRatio = matchedEndorsements.length / requiredEndorsements.length;\r\n\r\n    // If no endorsements match when some are required, return 0\r\n    if (endorsementRatio === 0) {\r\n      return 0;\r\n    }\r\n\r\n    // Partial endorsement match reduces score proportionally\r\n    score = Math.round(endorsementRatio * 100);\r\n  }\r\n\r\n  // Violation penalties\r\n  if (driver.violations && driver.violations > 0) {\r\n    const severity = driver.violation_severity || 'minor';\r\n    if (severity === 'major') {\r\n      // Major violations: 50 point penalty per violation\r\n      score = Math.max(0, score - (driver.violations * 50));\r\n    } else {\r\n      // Minor violations: 15 point penalty per violation\r\n      score = Math.max(0, score - (driver.violations * 15));\r\n    }\r\n  }\r\n\r\n  return Math.round(score);\r\n};\r\n\r\n/**\r\n * Score driver experience against carrier requirements\r\n * Evaluates: Years of experience, equipment familiarity\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @returns {number} Score from 0-100\r\n */\r\nconst scoreExperience = (driver, preferences) => {\r\n  // Handle null/undefined inputs\r\n  if (!driver || !preferences) {\r\n    return 0;\r\n  }\r\n\r\n  const driverYears = driver.years_experience;\r\n  const minYears = preferences.min_experience_years;\r\n  const maxYears = preferences.max_experience_years;\r\n  const requiredEquipment = preferences.equipment_types || [];\r\n  const driverEquipment = driver.equipment_experience || [];\r\n\r\n  // If driver has null/undefined/0 years and a minimum is required\r\n  if ((driverYears === null || driverYears === undefined || driverYears === 0) && minYears && minYears > 0) {\r\n    return 0;\r\n  }\r\n\r\n  // Handle null years_experience with no minimum requirement\r\n  if (driverYears === null || driverYears === undefined) {\r\n    // If there's no minimum requirement, allow but score based on equipment\r\n    if (!minYears) {\r\n      return scoreEquipmentOnly(driverEquipment, requiredEquipment);\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  // Handle zero experience\r\n  if (driverYears === 0 && minYears && minYears > 0) {\r\n    return 0;\r\n  }\r\n\r\n  let experienceScore = 100;\r\n\r\n  // Check minimum experience\r\n  if (minYears && driverYears < minYears) {\r\n    // Score proportionally based on how close to minimum\r\n    experienceScore = Math.round((driverYears / minYears) * 100);\r\n  }\r\n\r\n  // Check maximum experience (some carriers prefer less experienced drivers)\r\n  if (maxYears && driverYears > maxYears) {\r\n    // Penalize but don't zero out - 30 point penalty\r\n    experienceScore = Math.max(50, experienceScore - 30);\r\n  }\r\n\r\n  // Equipment familiarity bonus/penalty\r\n  if (requiredEquipment.length > 0) {\r\n    const matchedEquipment = requiredEquipment.filter(\r\n      equip => driverEquipment.includes(equip)\r\n    );\r\n    const equipmentRatio = matchedEquipment.length / requiredEquipment.length;\r\n\r\n    // Blend experience score with equipment match (70% experience, 30% equipment)\r\n    const equipmentScore = equipmentRatio * 100;\r\n    experienceScore = Math.round(experienceScore * 0.7 + equipmentScore * 0.3);\r\n  }\r\n\r\n  // Handle undefined equipment_experience - reduce score\r\n  if (driverEquipment === undefined || driverEquipment === null) {\r\n    experienceScore = Math.round(experienceScore * 0.5);\r\n  }\r\n\r\n  return Math.min(100, Math.max(0, experienceScore));\r\n};\r\n\r\n/**\r\n * Helper to score equipment only when experience data is missing\r\n */\r\nconst scoreEquipmentOnly = (driverEquipment, requiredEquipment) => {\r\n  if (!requiredEquipment || requiredEquipment.length === 0) {\r\n    return 100;\r\n  }\r\n  if (!driverEquipment || driverEquipment.length === 0) {\r\n    return 50;\r\n  }\r\n  const matched = requiredEquipment.filter(e => driverEquipment.includes(e));\r\n  return Math.round((matched.length / requiredEquipment.length) * 100);\r\n};\r\n\r\n/**\r\n * Score driver location against carrier preferences\r\n * Evaluates: ZIP code match, distance from terminals, state match\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @returns {number} Score from 0-100\r\n */\r\nconst scoreLocation = (driver, preferences) => {\r\n  // Handle null/undefined inputs\r\n  if (!driver || !preferences) {\r\n    return 0;\r\n  }\r\n\r\n  const driverZip = driver.home_zip;\r\n  const targetZips = preferences.target_zip_codes || [];\r\n  const targetStates = preferences.target_states || [];\r\n  const radiusMiles = preferences.target_radius_miles || 100; // Default 100 miles\r\n\r\n  // Invalid or missing driver ZIP\r\n  if (!driverZip || typeof driverZip !== 'string' || driverZip === 'invalid') {\r\n    return 0;\r\n  }\r\n\r\n  // Validate ZIP format (basic check - 5 digits for US)\r\n  if (!/^\\d{5}(-\\d{4})?$/.test(driverZip)) {\r\n    return 0;\r\n  }\r\n\r\n  // Extract state from ZIP code (simplified US ZIP to state mapping)\r\n  const driverState = getStateFromZip(driverZip);\r\n\r\n  // State filtering - if target states specified and driver not in them\r\n  if (targetStates.length > 0 && driverState && !targetStates.includes(driverState)) {\r\n    return 0;\r\n  }\r\n\r\n  // Exact ZIP match\r\n  if (targetZips.length > 0 && targetZips.includes(driverZip)) {\r\n    return 100;\r\n  }\r\n\r\n  // If no target ZIPs specified but driver is in target state or no state requirement\r\n  if (targetZips.length === 0) {\r\n    if (targetStates.length === 0 || (driverState && targetStates.includes(driverState))) {\r\n      return 100;\r\n    }\r\n    return 50; // Default middle score for unknown location match\r\n  }\r\n\r\n  // Calculate approximate distance based on ZIP prefix similarity\r\n  // This is a simplified calculation - in production would use geocoding\r\n  const closestDistance = estimateDistance(driverZip, targetZips);\r\n\r\n  // Score based on distance within radius\r\n  if (closestDistance > radiusMiles) {\r\n    return 0;\r\n  }\r\n\r\n  // Linear score decay based on distance\r\n  const distanceScore = Math.round(100 * (1 - closestDistance / radiusMiles));\r\n  return Math.max(0, Math.min(100, distanceScore));\r\n};\r\n\r\n/**\r\n * Simplified state lookup from ZIP code prefix\r\n */\r\nconst getStateFromZip = (zip) => {\r\n  const prefix = parseInt(zip.substring(0, 3), 10);\r\n\r\n  // Texas ZIPs: 75xxx-79xxx\r\n  if (prefix >= 750 && prefix <= 799) return 'TX';\r\n  // California ZIPs: 90xxx-96xxx\r\n  if (prefix >= 900 && prefix <= 961) return 'CA';\r\n  // Oklahoma ZIPs: 73xxx-74xxx\r\n  if (prefix >= 730 && prefix <= 749) return 'OK';\r\n  // Georgia ZIPs: 30xxx-31xxx\r\n  if (prefix >= 300 && prefix <= 319) return 'GA';\r\n  // Florida ZIPs: 32xxx-34xxx\r\n  if (prefix >= 320 && prefix <= 349) return 'FL';\r\n  // South Carolina ZIPs: 29xxx\r\n  if (prefix >= 290 && prefix <= 299) return 'SC';\r\n  // Louisiana ZIPs: 70xxx-71xxx\r\n  if (prefix >= 700 && prefix <= 714) return 'LA';\r\n\r\n  return null;\r\n};\r\n\r\n/**\r\n * Estimate distance between driver ZIP and target ZIPs\r\n * Simplified calculation based on ZIP prefix for demonstration\r\n * In production, this would use actual geocoding/distance calculation\r\n */\r\nconst estimateDistance = (driverZip, targetZips) => {\r\n  const driverPrefix = parseInt(driverZip.substring(0, 3), 10);\r\n\r\n  let minDistance = Infinity;\r\n\r\n  for (const targetZip of targetZips) {\r\n    const targetPrefix = parseInt(targetZip.substring(0, 3), 10);\r\n    const prefixDiff = Math.abs(driverPrefix - targetPrefix);\r\n\r\n    // Rough estimation: each prefix difference ~= 30 miles average\r\n    // This is a simplification - real implementation would use geocoding\r\n    const estimatedDistance = prefixDiff * 30;\r\n    minDistance = Math.min(minDistance, estimatedDistance);\r\n  }\r\n\r\n  return minDistance === Infinity ? 1000 : minDistance;\r\n};\r\n\r\n/**\r\n * Score driver availability against carrier urgency\r\n * Evaluates: How well driver availability matches carrier timeline\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @returns {number} Score from 0-100\r\n */\r\nconst scoreAvailability = (driver, preferences) => {\r\n  // Handle null/undefined inputs\r\n  if (!driver || !preferences) {\r\n    return 0;\r\n  }\r\n\r\n  const driverAvailability = driver.availability;\r\n  const carrierUrgency = preferences.urgency;\r\n\r\n  // If no urgency specified, any availability is fine\r\n  if (!carrierUrgency) {\r\n    return 100;\r\n  }\r\n\r\n  // If driver availability is null, return middle score\r\n  if (!driverAvailability) {\r\n    return 50;\r\n  }\r\n\r\n  // Check for unknown/invalid availability value\r\n  const validAvailabilities = ['immediate', '2_week', '30_day'];\r\n  if (!validAvailabilities.includes(driverAvailability)) {\r\n    return 0;\r\n  }\r\n\r\n  // Get score from mapping\r\n  const urgencyScores = AVAILABILITY_SCORES[carrierUrgency];\r\n  if (!urgencyScores) {\r\n    // Unknown urgency - default to accepting any availability\r\n    return driverAvailability === 'immediate' ? 100 :\r\n           driverAvailability === '2_week' ? 80 : 60;\r\n  }\r\n\r\n  return urgencyScores[driverAvailability] || 50;\r\n};\r\n\r\n/**\r\n * Score salary fit between driver expectation and carrier offer\r\n * Evaluates: Whether carrier pay meets driver expectations\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @returns {number} Score from 0-100\r\n */\r\nconst scoreSalaryFit = (driver, preferences) => {\r\n  // Handle null/undefined inputs\r\n  if (!driver || !preferences) {\r\n    return 0;\r\n  }\r\n\r\n  const driverExpectation = driver.min_cpm_expectation;\r\n  const offeredMin = preferences.offered_pay_min;\r\n  const offeredMax = preferences.offered_pay_max;\r\n\r\n  // If driver has no expectation, any offer works\r\n  if (driverExpectation === null || driverExpectation === undefined || driverExpectation === 0) {\r\n    return 100;\r\n  }\r\n\r\n  // If carrier has no pay info, return neutral score\r\n  if ((offeredMin === null || offeredMin === undefined) &&\r\n      (offeredMax === null || offeredMax === undefined)) {\r\n    return 50;\r\n  }\r\n\r\n  // Determine the effective offer range\r\n  const effectiveMax = offeredMax !== null && offeredMax !== undefined ? offeredMax : offeredMin;\r\n  const effectiveMin = offeredMin !== null && offeredMin !== undefined ? offeredMin : offeredMax;\r\n\r\n  // If offer meets or exceeds expectation, perfect score\r\n  if (effectiveMax >= driverExpectation) {\r\n    return 100;\r\n  }\r\n\r\n  // Calculate how close the max offer is to driver expectation\r\n  const gap = driverExpectation - effectiveMax;\r\n  const gapPercentage = gap / driverExpectation;\r\n\r\n  // Score based on gap - smaller gap = higher score\r\n  if (gapPercentage <= 0.05) {\r\n    // Within 5% - still pretty good\r\n    return 85;\r\n  } else if (gapPercentage <= 0.10) {\r\n    // Within 10%\r\n    return 70;\r\n  } else if (gapPercentage <= 0.15) {\r\n    // Within 15%\r\n    return 50;\r\n  } else if (gapPercentage <= 0.25) {\r\n    // Within 25%\r\n    return 25;\r\n  } else {\r\n    // More than 25% gap\r\n    return 0;\r\n  }\r\n};\r\n\r\n/**\r\n * Score driver engagement on the platform\r\n * Evaluates: Login recency, profile completeness, response rate\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @returns {number} Score from 0-100\r\n */\r\nconst scoreEngagement = (driver) => {\r\n  // Handle null/undefined driver\r\n  if (!driver) {\r\n    return 0;\r\n  }\r\n\r\n  const lastActive = driver.last_active_date;\r\n  const profileScore = driver.profile_completeness_score;\r\n  const responseRate = driver.response_rate;\r\n\r\n  // Missing last active date is a critical issue\r\n  if (!lastActive) {\r\n    return 0;\r\n  }\r\n\r\n  // Calculate days since last active\r\n  const now = new Date();\r\n  const lastActiveDate = new Date(lastActive);\r\n  const daysSinceActive = Math.floor((now - lastActiveDate) / (1000 * 60 * 60 * 24));\r\n\r\n  // Recency score (50% weight)\r\n  let recencyScore;\r\n  if (daysSinceActive <= 0) {\r\n    recencyScore = 100;\r\n  } else if (daysSinceActive <= 3) {\r\n    recencyScore = 95;\r\n  } else if (daysSinceActive <= 7) {\r\n    recencyScore = 80;\r\n  } else if (daysSinceActive <= 14) {\r\n    recencyScore = 60;\r\n  } else if (daysSinceActive <= 30) {\r\n    recencyScore = 40;\r\n  } else if (daysSinceActive <= 60) {\r\n    recencyScore = 20;\r\n  } else if (daysSinceActive <= 90) {\r\n    recencyScore = 10;\r\n  } else {\r\n    recencyScore = 5;\r\n  }\r\n\r\n  // Profile completeness score (30% weight)\r\n  const completenessScore = profileScore !== null && profileScore !== undefined ?\r\n    profileScore : 50;\r\n\r\n  // Response rate score (20% weight) - if available\r\n  let responseScore = 70; // Default if not available\r\n  if (responseRate !== null && responseRate !== undefined) {\r\n    responseScore = Math.round(responseRate * 100);\r\n  }\r\n\r\n  // Weighted combination\r\n  const totalScore = Math.round(\r\n    recencyScore * 0.5 +\r\n    completenessScore * 0.3 +\r\n    responseScore * 0.2\r\n  );\r\n\r\n  return Math.min(100, Math.max(0, totalScore));\r\n};\r\n\r\n/**\r\n * Calculate overall weighted driver match score\r\n *\r\n * Now supports dynamic weighting based on:\r\n * 1. Carrier hiring preferences (what the carrier values)\r\n * 2. Active search filters (what the recruiter prioritizes in this search)\r\n *\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @param {Object} weights - Optional custom weights (defaults to dynamic calculation)\r\n * @param {Object} activeFilters - Optional active search filters for dynamic boosting\r\n * @returns {Object} Result with overallScore, component scores, and metadata\r\n */\r\nconst calculateDriverMatchScore = (driver, preferences, weights = null, activeFilters = null) => {\r\n  // Handle null/undefined inputs\r\n  if (!driver) {\r\n    return {\r\n      overallScore: 0,\r\n      error: 'Invalid driver'\r\n    };\r\n  }\r\n\r\n  if (!preferences) {\r\n    return {\r\n      overallScore: 0,\r\n      error: 'Invalid preferences'\r\n    };\r\n  }\r\n\r\n  // Check if driver is searchable\r\n  if (driver.is_searchable === false || driver.visibility_level === 'hidden') {\r\n    return {\r\n      overallScore: 0,\r\n      error: 'Driver not searchable',\r\n      driverId: driver._id,\r\n      preferenceId: preferences._id\r\n    };\r\n  }\r\n\r\n  // Determine weights to use - now supports dynamic calculation!\r\n  let effectiveWeights = DEFAULT_WEIGHTS;\r\n  let normalizedWeights = DEFAULT_WEIGHTS;\r\n  let weightSource = 'default';\r\n\r\n  if (weights && Object.keys(weights).length > 0) {\r\n    // Explicit weights passed - use them (legacy behavior)\r\n    const weightSum = Object.values(weights).reduce((a, b) => a + b, 0);\r\n    if (weightSum > 0 && weightSum !== 100) {\r\n      normalizedWeights = {};\r\n      for (const key of Object.keys(weights)) {\r\n        normalizedWeights[key] = Math.round((weights[key] / weightSum) * 100);\r\n      }\r\n      effectiveWeights = normalizedWeights;\r\n    } else if (weightSum === 100) {\r\n      effectiveWeights = weights;\r\n      normalizedWeights = weights;\r\n    }\r\n    weightSource = 'explicit';\r\n  } else {\r\n    // No explicit weights - use dynamic calculation based on:\r\n    // 1. Carrier preferences (what this carrier values)\r\n    // 2. Active filters (what recruiter prioritizes in this search)\r\n    effectiveWeights = calculateDynamicWeights(preferences, activeFilters);\r\n    normalizedWeights = effectiveWeights;\r\n    weightSource = 'dynamic';\r\n  }\r\n\r\n  // Calculate individual scores\r\n  const scores = {\r\n    qualifications: scoreQualifications(driver, preferences),\r\n    experience: scoreExperience(driver, preferences),\r\n    location: scoreLocation(driver, preferences),\r\n    availability: scoreAvailability(driver, preferences),\r\n    salaryFit: scoreSalaryFit(driver, preferences),\r\n    engagement: scoreEngagement(driver)\r\n  };\r\n\r\n  // Calculate weighted overall score\r\n  let overallScore = 0;\r\n  for (const [category, score] of Object.entries(scores)) {\r\n    const weight = effectiveWeights[category] || 0;\r\n    overallScore += score * (weight / 100);\r\n  }\r\n\r\n  const baseScore = Math.round(overallScore);\r\n\r\n  // Check for mutual match boost\r\n  const isMutualMatch = driver.hasExpressedInterest === true &&\r\n                        driver.interestCarrierDot === preferences.carrier_dot;\r\n\r\n  let finalScore = baseScore;\r\n  let mutualMatchBoost = 0;\r\n\r\n  if (isMutualMatch) {\r\n    mutualMatchBoost = 10;\r\n    finalScore = Math.min(100, baseScore + mutualMatchBoost);\r\n  }\r\n\r\n  return {\r\n    overallScore: finalScore,\r\n    baseScore: isMutualMatch ? baseScore : finalScore,\r\n    scores,\r\n    weights: effectiveWeights,\r\n    normalizedWeights,\r\n    weightSource, // 'default', 'explicit', or 'dynamic'\r\n    driverId: driver._id,\r\n    preferenceId: preferences._id,\r\n    isMutualMatch,\r\n    mutualMatchBoost: isMutualMatch ? mutualMatchBoost : 0\r\n  };\r\n};\r\n\r\n/**\r\n * Generate human-readable rationale for match score\r\n *\r\n * @param {Object} scores - Component scores from calculateDriverMatchScore\r\n * @param {Object} driver - Driver profile\r\n * @param {Object} preferences - Carrier hiring preferences\r\n * @returns {Object} Rationale with summary, points, and concerns\r\n */\r\nconst generateDriverMatchRationale = (scores, driver, preferences) => {\r\n  // Handle null/undefined inputs\r\n  if (!scores) {\r\n    return {\r\n      summary: 'Unable to generate rationale',\r\n      points: [],\r\n      error: 'Invalid scores'\r\n    };\r\n  }\r\n\r\n  if (!driver) {\r\n    return {\r\n      summary: 'Unable to generate rationale',\r\n      points: [],\r\n      error: 'Invalid driver'\r\n    };\r\n  }\r\n\r\n  if (!preferences) {\r\n    return {\r\n      summary: 'Unable to generate rationale',\r\n      points: [],\r\n      error: 'Invalid preferences'\r\n    };\r\n  }\r\n\r\n  const points = [];\r\n  const concerns = [];\r\n\r\n  // Check for mutual match\r\n  const isMutualMatch = driver.hasExpressedInterest === true &&\r\n                        driver.interestCarrierDot === preferences.carrier_dot;\r\n\r\n  if (isMutualMatch) {\r\n    points.push('This driver has already expressed interest in your company');\r\n  }\r\n\r\n  // Qualification explanations\r\n  if (scores.qualifications !== undefined) {\r\n    if (scores.qualifications >= 100) {\r\n      const endorsements = preferences.required_endorsements || [];\r\n      if (endorsements.length > 0) {\r\n        points.push(`Holds Class ${driver.cdl_class} CDL with ${endorsements.join(' and ')} endorsements you require`);\r\n      } else {\r\n        points.push(`Holds required Class ${driver.cdl_class} CDL`);\r\n      }\r\n    } else if (scores.qualifications >= 50) {\r\n      const driverEndorsements = driver.endorsements || [];\r\n      const requiredEndorsements = preferences.required_endorsements || [];\r\n      const hasEndorsements = driverEndorsements.filter(e => requiredEndorsements.includes(e));\r\n      const missingEndorsements = requiredEndorsements.filter(e => !driverEndorsements.includes(e));\r\n      if (hasEndorsements.length > 0 && missingEndorsements.length > 0) {\r\n        points.push(`Has ${hasEndorsements.join(', ')} endorsement but missing ${missingEndorsements.join(', ')} endorsement`);\r\n      }\r\n    } else if (scores.qualifications < 50 && scores.qualifications > 0) {\r\n      concerns.push('Missing required endorsements');\r\n    }\r\n  }\r\n\r\n  // Location explanations\r\n  if (scores.location !== undefined) {\r\n    if (scores.location >= 100) {\r\n      const targetZips = preferences.target_zip_codes || [];\r\n      if (targetZips.includes(driver.home_zip)) {\r\n        points.push('Home ZIP matches your target location in Dallas');\r\n      } else {\r\n        points.push('Located within your target area');\r\n      }\r\n    } else if (scores.location >= 50) {\r\n      points.push('Located within reasonable distance from your terminal');\r\n    } else if (scores.location < 50 && scores.location > 0) {\r\n      points.push(`Located ${Math.round((100 - scores.location) / 10) * 10} miles from your Dallas terminal`);\r\n    } else if (scores.location === 0) {\r\n      concerns.push('Driver is located outside your preferred radius');\r\n    }\r\n  }\r\n\r\n  // Experience explanations\r\n  if (scores.experience !== undefined) {\r\n    if (scores.experience >= 100) {\r\n      const minYears = preferences.min_experience_years;\r\n      if (minYears) {\r\n        points.push(`${driver.years_experience} years OTR experience exceeds your ${minYears}-year minimum`);\r\n      } else {\r\n        points.push(`${driver.years_experience} years of driving experience`);\r\n      }\r\n\r\n      const requiredEquipment = preferences.equipment_types || [];\r\n      const driverEquipment = driver.equipment_experience || [];\r\n      const matchedEquipment = requiredEquipment.filter(e => driverEquipment.includes(e));\r\n      if (matchedEquipment.length > 0) {\r\n        points.push(`Experienced with ${matchedEquipment.join(', ')} equipment`);\r\n      }\r\n      if (matchedEquipment.length === requiredEquipment.length && requiredEquipment.length > 0) {\r\n        points.push('Has experience with all your required equipment types');\r\n      }\r\n    } else if (scores.experience < 50) {\r\n      concerns.push('Experience level may not meet requirements');\r\n    }\r\n  }\r\n\r\n  // Availability explanations\r\n  if (scores.availability !== undefined) {\r\n    if (scores.availability >= 100) {\r\n      points.push('Available to start immediately');\r\n    } else if (scores.availability < 70 && scores.availability > 0) {\r\n      const driverAvail = driver.availability === '30_day' ? '30 days' :\r\n                          driver.availability === '2_week' ? '2 weeks' : driver.availability;\r\n      const carrierUrgency = preferences.urgency === 'immediate' ? 'immediate start' :\r\n                             preferences.urgency === '2_week' ? '2 weeks' : preferences.urgency;\r\n      concerns.push(`Available in ${driverAvail} but you need ${carrierUrgency}`);\r\n    }\r\n  }\r\n\r\n  // Salary explanations\r\n  if (scores.salaryFit !== undefined) {\r\n    if (scores.salaryFit >= 100 && driver.min_cpm_expectation && preferences.offered_pay_max) {\r\n      points.push(`Pay expectation ($${driver.min_cpm_expectation.toFixed(2)}/mi) within your range`);\r\n    } else if (scores.salaryFit < 50 && scores.salaryFit >= 0) {\r\n      const driverExp = driver.min_cpm_expectation;\r\n      const maxOffer = preferences.offered_pay_max;\r\n      if (driverExp && maxOffer) {\r\n        concerns.push(`Pay expectation ($${driverExp.toFixed(2)}/mi) exceeds your max offer ($${maxOffer.toFixed(2)}/mi)`);\r\n      } else {\r\n        concerns.push('Pay expectation may exceed your budget');\r\n      }\r\n    }\r\n  }\r\n\r\n  // Engagement explanations\r\n  if (scores.engagement !== undefined && scores.engagement < 50) {\r\n    concerns.push('Limited platform activity recently');\r\n  }\r\n\r\n  // Generate summary based on overall assessment\r\n  const avgScore = Object.values(scores).reduce((a, b) => a + (b || 0), 0) / Object.keys(scores).length;\r\n\r\n  let summary;\r\n  let overallAssessment;\r\n\r\n  if (avgScore >= 85) {\r\n    summary = 'Excellent match - meets all key criteria with strong experience';\r\n    overallAssessment = 'highly_recommended';\r\n  } else if (avgScore >= 70) {\r\n    summary = 'Good match - meets most requirements with some considerations';\r\n    overallAssessment = 'recommended';\r\n  } else if (avgScore >= 50) {\r\n    summary = 'Partial match - some criteria met but gaps exist';\r\n    overallAssessment = 'consider';\r\n  } else if (avgScore >= 30) {\r\n    summary = 'Limited match - several key criteria not met';\r\n    overallAssessment = 'not_recommended';\r\n  } else {\r\n    summary = 'Poor match - does not meet core requirements';\r\n    overallAssessment = 'not_recommended';\r\n  }\r\n\r\n  if (isMutualMatch) {\r\n    summary = 'Mutual match - driver has expressed interest';\r\n  }\r\n\r\n  return {\r\n    summary,\r\n    points,\r\n    concerns: concerns.length > 0 ? concerns : undefined,\r\n    overallAssessment,\r\n    isMutualMatch\r\n  };\r\n};\r\n\r\n// ============================================================================\r\n// CARRIER FEEDBACK WEIGHT ADJUSTMENT (Phase 2 - Call Outcomes)\r\n// ============================================================================\r\n\r\n/**\r\n * Fetch carrier-specific feedback weights from CallFeedback table\r\n * @param {string} carrierDot - Carrier DOT number\r\n * @returns {Object|null} { positive_weight, negative_weight } or null if no feedback data\r\n */\r\nconst getCarrierFeedbackWeights = async (carrierDot) => {\r\n  try {\r\n    const dataAccess = require('backend/dataAccess');\r\n\r\n    const result = await dataAccess.queryRecords('callFeedback', {\r\n      filters: { carrier_dot: String(carrierDot) },\r\n      limit: 1,\r\n      suppressAuth: true\r\n    });\r\n\r\n    return result.items?.[0] || null;\r\n  } catch (err) {\r\n    console.warn('[driverScoring] getCarrierFeedbackWeights failed:', err.message);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Apply feedback-based adjustments to scoring weights, capped at ±20%\r\n * @param {Object} baseWeights - Original scoring weights\r\n * @param {Object} feedbackWeights - { positive_weight, negative_weight } from CallFeedback\r\n * @returns {Object} Adjusted weights (same structure as baseWeights)\r\n */\r\nconst applyFeedbackAdjustments = (baseWeights, feedbackWeights) => {\r\n  if (!feedbackWeights) return baseWeights;\r\n\r\n  const positiveAdj = Math.min(0.20, feedbackWeights.positive_weight || 0);\r\n  const negativeAdj = Math.min(0.20, feedbackWeights.negative_weight || 0);\r\n\r\n  // Net adjustment factor: positive boosts engagement + qualifications, negative reduces salary fit\r\n  const adjusted = { ...baseWeights };\r\n\r\n  // Boost qualifications weight when positive outcomes correlate\r\n  if (adjusted.weight_qualifications !== undefined) {\r\n    adjusted.weight_qualifications = Math.round(\r\n      adjusted.weight_qualifications * (1 + positiveAdj)\r\n    );\r\n  }\r\n\r\n  // Reduce salaryFit weight when negative outcomes suggest pay mismatch isn't the issue\r\n  if (adjusted.weight_salaryFit !== undefined) {\r\n    adjusted.weight_salaryFit = Math.round(\r\n      adjusted.weight_salaryFit * (1 - negativeAdj)\r\n    );\r\n  }\r\n\r\n  // Boost engagement weight to reward drivers who are actively responding\r\n  if (adjusted.weight_engagement !== undefined) {\r\n    adjusted.weight_engagement = Math.round(\r\n      adjusted.weight_engagement * (1 + positiveAdj * 0.5)\r\n    );\r\n  }\r\n\r\n  return adjusted;\r\n};\r\n\r\nmodule.exports = {\r\n  DEFAULT_WEIGHTS,\r\n  FILTER_BOOST_MULTIPLIERS,\r\n  normalizeWeights,\r\n  calculateDynamicWeights,\r\n  scoreQualifications,\r\n  scoreExperience,\r\n  scoreLocation,\r\n  scoreAvailability,\r\n  scoreSalaryFit,\r\n  scoreEngagement,\r\n  calculateDriverMatchScore,\r\n  generateDriverMatchRationale,\r\n  getCarrierFeedbackWeights,\r\n  applyFeedbackAdjustments\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\gamificationCache.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\gamificationConfig.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\http-functions.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getVoiceConfig' is defined but never used.","line":29,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// HTTP FUNCTIONS - Wix Velo HTTP Endpoints\r\n// Contains webhook handlers for Stripe and other external services\r\n// ============================================================================\r\n\r\nimport { ok, badRequest, serverError } from 'wix-http-functions';\r\nimport { getSecret } from 'wix-secrets-backend';\r\nimport {\n  upsertSubscription,\n  upsertApiSubscriptionFromStripe,\n  resetQuota,\r\n  getApiBillingSummary,\r\n  updateSubscriptionStatus,\r\n  updateApiSubscriptionStatus,\r\n  recordBillingEvent,\r\n  isEventProcessed,\n  logStripeEvent,\n  updatePaymentStatus\n} from 'backend/stripeService';\nimport { processAutoCommission } from 'backend/adminCommissionService';\nimport { updateLeadStatus } from 'backend/carrierLeadsService';\r\nimport { sendPaymentReceivedEmail } from 'backend/emailService';\r\nimport {\r\n  trackAbandonedCheckout,\r\n  markCheckoutRecovered\r\n} from 'backend/abandonmentEmailService';\r\nimport { handleGatewayRequest } from 'backend/apiGateway';\r\nimport { handleAgentTurn } from 'backend/agentService';\r\nimport { getVoiceConfig } from 'backend/voiceService';\r\nimport * as dataAccess from 'backend/dataAccess';\r\nimport { processSendGridWebhook } from 'backend/emailCampaignService';\r\nimport {\r\n  processTwilioStatusWebhook,\r\n  processTwilioIncomingWebhook\r\n} from 'backend/smsCampaignService';\r\nimport { processJobBoardWebhook } from 'backend/jobBoardService';\r\nimport { connectSocialAccount } from 'backend/socialPostingService';\r\n\r\n// Data source configuration imports\r\n// Note: http-functions.js uses standard imports (not .jsw)\r\n// The stripeService and abandonmentEmailService handle data source routing internally\r\n\r\n// ============================================================================\r\n// STRIPE WEBHOOK ENDPOINT\r\n// POST https://www.lastmiledeliveryrecruiting.com/_functions/stripe_webhook\r\n// ============================================================================\r\n\r\n/**\r\n * Stripe webhook handler\r\n * Processes subscription lifecycle events from Stripe\r\n */\r\nexport async function post_stripe_webhook(request) {\r\n  try {\r\n    const body = await request.body.text();\r\n    const signature = request.headers['stripe-signature'];\r\n\r\n    // Verify signature\r\n    const verificationResult = await verifyStripeSignature(body, signature);\r\n    if (!verificationResult.success) {\r\n      console.error('[Webhook] Signature verification failed');\r\n      return badRequest({ error: 'Invalid signature' });\r\n    }\r\n\r\n    const event = JSON.parse(body);\r\n\r\n    // Idempotency check - skip if already processed\r\n    const alreadyProcessed = await isEventProcessed(event.id);\r\n    if (alreadyProcessed) {\r\n      console.log(`[Webhook] Event ${event.id} already processed, skipping`);\r\n      return ok({ received: true, status: 'already_processed' });\r\n    }\r\n\r\n    // Route event to appropriate handler\r\n    const result = await handleStripeEvent(event);\r\n\r\n    // Log the event for idempotency\r\n    await logStripeEvent(event.id, event.type, {\r\n      carrierDot: result.carrierDot,\r\n      status: result.status\r\n    });\r\n\r\n    console.log(`[Webhook] Processed ${event.type} (${event.id})`);\r\n\r\n    return ok({ received: true, status: result.status });\r\n  } catch (error) {\r\n    console.error('[Webhook] Error processing event:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// SIGNATURE VERIFICATION\r\n// ============================================================================\r\n\r\n/**\r\n * Verify Stripe webhook signature\r\n * Uses HMAC-SHA256 to validate the request came from Stripe\r\n */\r\nasync function verifyStripeSignature(payload, signature) {\r\n  try {\r\n    if (!signature) {\r\n      return { success: false, error: 'No signature provided' };\r\n    }\r\n\r\n    const webhookSecret = await getSecret('STRIPE_WEBHOOK_SECRET');\r\n    if (!webhookSecret) {\r\n      console.warn('[Webhook] No webhook secret configured, skipping verification');\r\n      // In development, allow unsigned requests\r\n      return { success: true, warning: 'No secret configured' };\r\n    }\r\n\r\n    // Parse signature header\r\n    // Format: t=timestamp,v1=signature\r\n    const elements = signature.split(',');\r\n    const timestamp = elements.find(e => e.startsWith('t='))?.split('=')[1];\r\n    const signatureHash = elements.find(e => e.startsWith('v1='))?.split('=')[1];\r\n\r\n    if (!timestamp || !signatureHash) {\r\n      return { success: false, error: 'Invalid signature format' };\r\n    }\r\n\r\n    // Check timestamp tolerance (5 minutes)\r\n    const tolerance = 5 * 60;\r\n    const now = Math.floor(Date.now() / 1000);\r\n    if (Math.abs(now - parseInt(timestamp)) > tolerance) {\r\n      return { success: false, error: 'Timestamp outside tolerance' };\r\n    }\r\n\r\n    // Compute expected signature\r\n    const signedPayload = `${timestamp}.${payload}`;\r\n    const expectedSignature = await computeHmacSignature(signedPayload, webhookSecret);\r\n\r\n    // Compare signatures (timing-safe comparison)\r\n    if (expectedSignature !== signatureHash) {\r\n      return { success: false, error: 'Signature mismatch' };\r\n    }\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('[Webhook] Signature verification error:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n}\r\n\r\n/**\r\n * Compute HMAC-SHA256 signature\r\n * Wix Velo uses Web Crypto API\r\n */\r\nasync function computeHmacSignature(message, secret) {\r\n  try {\r\n    // Encode the key and message\r\n    const encoder = new TextEncoder();\r\n    const keyData = encoder.encode(secret);\r\n    const messageData = encoder.encode(message);\r\n\r\n    // Import key for HMAC\r\n    const cryptoKey = await crypto.subtle.importKey(\r\n      'raw',\r\n      keyData,\r\n      { name: 'HMAC', hash: 'SHA-256' },\r\n      false,\r\n      ['sign']\r\n    );\r\n\r\n    // Sign the message\r\n    const signature = await crypto.subtle.sign('HMAC', cryptoKey, messageData);\r\n\r\n    // Convert to hex string\r\n    const hashArray = Array.from(new Uint8Array(signature));\r\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\r\n\r\n    return hashHex;\r\n  } catch (error) {\r\n    console.error('[Webhook] HMAC computation error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// EVENT HANDLERS\r\n// ============================================================================\r\n\r\n/**\r\n * Route Stripe event to appropriate handler\r\n */\r\nasync function handleStripeEvent(event) {\n  const { type, data } = event;\n\n  switch (type) {\n    // Subscription lifecycle events\r\n    case 'customer.subscription.created':\n      return await handleSubscriptionCreated(data.object, event);\n\n    case 'customer.subscription.updated':\n      return await handleSubscriptionUpdated(data.object, event);\n\n    case 'customer.subscription.deleted':\n      return await handleSubscriptionDeleted(data.object, event);\n\r\n    // Payment events\r\n    case 'invoice.paid':\n      return await handleInvoicePaid(data.object, event);\n\r\n    case 'invoice.payment_failed':\n      return await handlePaymentFailed(data.object, event);\n\r\n    // Checkout events\r\n    case 'checkout.session.completed':\n      return await handleCheckoutCompleted(data.object, event);\n\n    case 'checkout.session.expired':\n      return await handleCheckoutExpired(data.object, event);\n\r\n    default:\r\n      console.log(`[Webhook] Unhandled event type: ${type}`);\r\n      return { status: 'unhandled', carrierDot: null };\r\n  }\r\n}\n\nasync function hasProcessedCommissionEvent(uniqueKey) {\n  if (!uniqueKey) return false;\n  try {\n    const result = await dataAccess.queryRecords('auditLog', {\n      filters: {\n        action: 'auto_commission_event',\n        entity_id: uniqueKey\n      },\n      limit: 1,\n      suppressAuth: true\n    });\n    return result.success && (result.items || []).length > 0;\n  } catch (error) {\n    console.error('[Webhook] Commission idempotency lookup failed:', error);\n    return false;\n  }\n}\n\nasync function markCommissionEventProcessed(uniqueKey, details = {}) {\n  if (!uniqueKey) return;\n  try {\n    await dataAccess.insertRecord('auditLog', {\n      action: 'auto_commission_event',\n      entity_type: 'stripe_event',\n      entity_id: uniqueKey,\n      details: JSON.stringify(details).slice(0, 500),\n      timestamp: new Date().toISOString()\n    }, { suppressAuth: true });\n  } catch (error) {\n    console.error('[Webhook] Commission idempotency write failed:', error);\n  }\n}\n\nfunction toCommissionDealData(base = {}) {\n  return {\n    sales_rep_id: base.sales_rep_id || base.salesRepId || '',\n    carrier_dot: base.carrier_dot || base.carrierDot || '',\n    carrier_name: base.carrier_name || base.carrierName || '',\n    deal_value: Number(base.deal_value || base.dealValue || 0),\n    notes: base.notes || ''\n  };\n}\n\nasync function triggerAutoCommission(eventId, eventType, dealData, sourceTag) {\n  const uniqueKey = `${eventId}:${eventType}:${sourceTag}`;\n  if (await hasProcessedCommissionEvent(uniqueKey)) {\n    console.log(`[Webhook] Auto commission already processed for ${uniqueKey}`);\n    return { success: true, skipped: true, reason: 'already_processed' };\n  }\n\n  const normalized = toCommissionDealData(dealData);\n  if (!normalized.deal_value || normalized.deal_value <= 0) {\n    return { success: false, skipped: true, reason: 'missing_deal_value' };\n  }\n\n  const result = await processAutoCommission(eventType, normalized);\n  if (result?.success) {\n    await markCommissionEventProcessed(uniqueKey, {\n      eventType,\n      sourceTag,\n      carrierDot: normalized.carrier_dot || '',\n      dealValue: normalized.deal_value\n    });\n  }\n  return result;\n}\n\r\n/**\r\n * Handle new subscription created\r\n */\r\nasync function handleSubscriptionCreated(subscription) {\n  const partnerId = subscription.metadata?.partner_id;\r\n  if (partnerId) {\r\n    const result = await upsertApiSubscriptionFromStripe(subscription, subscription.customer);\r\n    if (result.success) {\r\n      await recordBillingEvent(partnerId, 'api_subscription_created', {\r\n        description: `API subscription ${subscription.id} created`\r\n      });\r\n    }\r\n    return {\r\n      status: result.success ? 'created' : 'error',\r\n      carrierDot: null\r\n    };\r\n  }\r\n\r\n  const carrierDot = subscription.metadata?.carrier_dot;\r\n  console.log(`[Webhook] Subscription created for carrier ${carrierDot}`);\r\n\r\n  const result = await upsertSubscription(subscription, subscription.customer);\r\n\r\n  if (result.success) {\r\n    await recordBillingEvent(carrierDot, 'subscription_created', {\r\n      description: `Subscription ${subscription.id} created`\r\n    });\r\n  }\r\n\r\n  return {\r\n    status: result.success ? 'created' : 'error',\r\n    carrierDot\r\n  };\r\n}\r\n\r\n/**\r\n * Handle subscription updated (status changes, cancellations)\r\n */\r\nasync function handleSubscriptionUpdated(subscription, event) {\n  const partnerId = subscription.metadata?.partner_id;\r\n  if (partnerId) {\r\n    const result = await upsertApiSubscriptionFromStripe(subscription, subscription.customer);\r\n    if (subscription.cancel_at_period_end) {\r\n      await recordBillingEvent(partnerId, 'api_subscription_cancel_scheduled', {\r\n        description: 'API subscription scheduled for cancellation at period end'\r\n      });\r\n    }\r\n    return {\r\n      status: result.success ? 'updated' : 'error',\r\n      carrierDot: null\r\n    };\r\n  }\r\n\r\n  const carrierDot = subscription.metadata?.carrier_dot;\r\n  console.log(`[Webhook] Subscription updated for carrier ${carrierDot}: status=${subscription.status}`);\r\n\r\n  // Update the full subscription data\r\n  const result = await upsertSubscription(subscription, subscription.customer);\r\n\r\n  // Record status change\n  if (subscription.cancel_at_period_end) {\n    await recordBillingEvent(carrierDot, 'subscription_cancel_scheduled', {\n      description: 'Subscription scheduled for cancellation at period end'\n    });\n  }\n\n  const previousAttrs = event?.data?.previous_attributes || {};\n  const isUpgrade = Boolean(previousAttrs.items || previousAttrs.plan || subscription.metadata?.commission_event === 'upgrade');\n  if (isUpgrade) {\n    await triggerAutoCommission(\n      event?.id || `subscription_update_${subscription.id}`,\n      'upgrade',\n      {\n        sales_rep_id: subscription.metadata?.sales_rep_id,\n        carrier_dot: carrierDot,\n        carrier_name: subscription.metadata?.carrier_name || '',\n        deal_value: subscription.items?.data?.[0]?.price?.unit_amount || 0,\n        notes: `Upgrade via customer.subscription.updated (${subscription.id})`\n      },\n      'customer.subscription.updated'\n    );\n  }\n\n  return {\n    status: result.success ? 'updated' : 'error',\n    carrierDot\n  };\n}\n\r\n/**\r\n * Handle subscription deleted (ended)\r\n */\r\nasync function handleSubscriptionDeleted(subscription) {\n  const partnerId = subscription.metadata?.partner_id;\r\n  if (partnerId) {\r\n    const result = await updateApiSubscriptionStatus(subscription.id, 'cancelled');\r\n    if (result.success) {\r\n      await recordBillingEvent(partnerId, 'api_subscription_canceled', {\r\n        description: 'API subscription has been canceled'\r\n      });\r\n    }\r\n    return {\r\n      status: result.success ? 'deleted' : 'error',\r\n      carrierDot: null\r\n    };\r\n  }\r\n\r\n  const carrierDot = subscription.metadata?.carrier_dot;\r\n  console.log(`[Webhook] Subscription deleted for carrier ${carrierDot}`);\r\n\r\n  const result = await updateSubscriptionStatus(subscription.id, 'canceled');\r\n\r\n  if (result.success) {\r\n    await recordBillingEvent(carrierDot, 'subscription_canceled', {\r\n      description: 'Subscription has been canceled'\r\n    });\r\n  }\r\n\r\n  return {\r\n    status: result.success ? 'deleted' : 'error',\r\n    carrierDot\r\n  };\r\n}\r\n\r\n/**\r\n * Handle successful payment - reset quota for new billing period\r\n */\r\nasync function handleInvoicePaid(invoice, event) {\n  // Only process subscription invoices\r\n  if (!invoice.subscription) {\r\n    return { status: 'skipped', carrierDot: null };\r\n  }\r\n  const partnerId = invoice.subscription_details?.metadata?.partner_id ||\r\n    invoice.lines?.data[0]?.metadata?.partner_id;\r\n\r\n  if (partnerId) {\r\n    const summary = await getApiBillingSummary(partnerId).catch(() => null);\r\n    await recordBillingEvent(partnerId, 'api_payment_succeeded', {\r\n      amount: invoice.amount_paid,\r\n      currency: invoice.currency,\r\n      invoiceId: invoice.id,\r\n      overageAmount: summary?.overage_amount || 0,\r\n      description: `API payment for ${invoice.lines?.data[0]?.description || 'API subscription'}`\r\n    });\r\n    return {\r\n      status: 'paid',\r\n      carrierDot: null\r\n    };\r\n  }\r\n\r\n  const carrierDot = invoice.subscription_details?.metadata?.carrier_dot ||\r\n    invoice.lines?.data[0]?.metadata?.carrier_dot;\r\n\r\n  console.log(`[Webhook] Invoice paid for carrier ${carrierDot}: $${invoice.amount_paid / 100}`);\r\n\r\n  // If this is a renewal (not the first invoice), reset the quota\r\n  if (invoice.billing_reason === 'subscription_cycle') {\r\n    const periodStart = new Date(invoice.period_start * 1000);\r\n    const periodEnd = new Date(invoice.period_end * 1000);\r\n\r\n    const result = await resetQuota(carrierDot, periodStart, periodEnd);\r\n    if (result.success) {\r\n      console.log(`[Webhook] Quota reset for carrier ${carrierDot}`);\r\n    }\r\n  }\r\n\r\n  // Record payment\n  await recordBillingEvent(carrierDot, 'payment_succeeded', {\n    amount: invoice.amount_paid,\r\n    currency: invoice.currency,\r\n    invoiceId: invoice.id,\r\n    description: `Payment for ${invoice.lines?.data[0]?.description || 'subscription'}`\r\n  });\n\n  if (invoice.billing_reason === 'subscription_cycle') {\n    await triggerAutoCommission(\n      event?.id || `invoice_paid_${invoice.id}`,\n      'renewal',\n      {\n        sales_rep_id: invoice.lines?.data?.[0]?.metadata?.sales_rep_id || invoice.subscription_details?.metadata?.sales_rep_id,\n        carrier_dot: carrierDot,\n        carrier_name: invoice.lines?.data?.[0]?.metadata?.carrier_name || '',\n        deal_value: invoice.amount_paid || 0,\n        notes: `Renewal via invoice.paid (${invoice.id})`\n      },\n      'invoice.paid'\n    );\n  }\n\n  return {\n    status: 'paid',\n    carrierDot\n  };\n}\n\r\n/**\r\n * Handle failed payment\r\n */\r\nasync function handlePaymentFailed(invoice) {\n  if (!invoice.subscription) {\r\n    return { status: 'skipped', carrierDot: null };\r\n  }\r\n  const partnerId = invoice.subscription_details?.metadata?.partner_id ||\r\n    invoice.lines?.data[0]?.metadata?.partner_id;\r\n\r\n  if (partnerId) {\r\n    await updateApiSubscriptionStatus(invoice.subscription, 'past_due');\r\n    await recordBillingEvent(partnerId, 'api_payment_failed', {\r\n      amount: invoice.amount_due,\r\n      currency: invoice.currency,\r\n      invoiceId: invoice.id,\r\n      description: `API payment failed: ${invoice.last_finalization_error?.message || 'Unknown error'}`\r\n    });\r\n    return {\r\n      status: 'payment_failed',\r\n      carrierDot: null\r\n    };\r\n  }\r\n\r\n  const carrierDot = invoice.subscription_details?.metadata?.carrier_dot ||\r\n    invoice.lines?.data[0]?.metadata?.carrier_dot;\r\n\r\n  console.log(`[Webhook] Payment failed for carrier ${carrierDot}`);\r\n\r\n  // Update subscription status\r\n  await updateSubscriptionStatus(invoice.subscription, 'past_due');\r\n\r\n  // Record failure\r\n  await recordBillingEvent(carrierDot, 'payment_failed', {\r\n    amount: invoice.amount_due,\r\n    currency: invoice.currency,\r\n    invoiceId: invoice.id,\r\n    description: `Payment failed: ${invoice.last_finalization_error?.message || 'Unknown error'}`\r\n  });\r\n\r\n  return {\r\n    status: 'payment_failed',\r\n    carrierDot\r\n  };\r\n}\r\n\r\n/**\r\n * Handle checkout session completed\r\n */\r\nasync function handleCheckoutCompleted(session, event) {\n  const carrierDot = session.metadata?.carrier_dot;\r\n  const customerEmail = session.customer_email;\r\n  console.log(`[Webhook] Checkout completed for carrier ${carrierDot}`);\r\n\r\n  // The subscription will be handled by customer.subscription.created\r\n  // Just record the checkout completion\r\n  await recordBillingEvent(carrierDot, 'checkout_completed', {\r\n    description: `Checkout session ${session.id} completed`\r\n  });\r\n\r\n  // Fulfilment: Update Carrier Lead status and Payment status\r\n  // 1. Update CarrierPayment status if this was a payment session\r\n  try {\r\n    if (session.mode === 'payment' && session.payment_status === 'paid') {\r\n      await updatePaymentStatus(session.id, 'completed', {\r\n        paymentIntentId: session.payment_intent,\r\n        amount: session.amount_total,\r\n        currency: session.currency\r\n      });\r\n    }\r\n  } catch (e) { console.error('Error updating payment status', e); }\r\n\r\n  // 2. Update Carrier Lead Status\r\n  const leadId = session.metadata?.leadId; // Ensure we passed this in metadata\r\n  if (leadId) {\r\n    // Update status to activated_paid\r\n    await updateLeadStatus(leadId, 'activated_paid',\r\n      `Payment received: ${(session.amount_total / 100).toFixed(2)} ${session.currency.toUpperCase()}`);\r\n\r\n    // Send receipt email\r\n    if (customerEmail) {\r\n      await sendPaymentReceivedEmail(customerEmail, {\r\n        amount: `$${(session.amount_total / 100).toFixed(2)}`,\r\n        description: 'Driver Placement Deposit',\r\n        transactionId: session.payment_intent,\r\n        date: new Date().toLocaleDateString()\r\n      });\r\n    }\r\n  }\r\n\r\n  // Mark any pending abandonment as recovered\n  if (customerEmail) {\n    const recoveryResult = await markCheckoutRecovered(customerEmail, session.id);\r\n    if (recoveryResult.wasAbandoned) {\r\n      console.log(`[Webhook] Recovered abandoned checkout for ${customerEmail}`);\r\n    }\r\n  }\n\n  if (session.payment_status === 'paid') {\n    const commissionEvent = session.metadata?.commission_event === 'placement' ||\n      session.metadata?.payment_type === 'placement' ? 'placement' : 'new_subscription';\n\n    await triggerAutoCommission(\n      event?.id || `checkout_completed_${session.id}`,\n      commissionEvent,\n      {\n        sales_rep_id: session.metadata?.sales_rep_id,\n        carrier_dot: carrierDot,\n        carrier_name: session.metadata?.carrier_name || '',\n        deal_value: session.amount_total || 0,\n        notes: `Checkout completion (${session.id})`\n      },\n      'checkout.session.completed'\n    );\n  }\n\n  return {\n    status: 'checkout_completed',\n    carrierDot\n  };\n}\n\r\n/**\r\n * Handle checkout session expired (abandoned)\r\n * Triggers abandonment email sequence\r\n */\r\nasync function handleCheckoutExpired(session) {\r\n  const carrierDot = session.metadata?.carrier_dot;\r\n  const customerEmail = session.customer_email;\r\n  console.log(`[Webhook] Checkout expired for carrier ${carrierDot}, email: ${customerEmail}`);\r\n\r\n  // Track the abandonment for email follow-up\r\n  if (customerEmail) {\r\n    const trackResult = await trackAbandonedCheckout(session);\r\n    if (trackResult.success) {\r\n      console.log(`[Webhook] Tracked abandonment ${trackResult.abandonmentId} for ${customerEmail}`);\r\n    } else {\r\n      console.error(`[Webhook] Failed to track abandonment: ${trackResult.error}`);\r\n    }\r\n  }\r\n\r\n  // Record the event\r\n  await recordBillingEvent(carrierDot, 'checkout_abandoned', {\r\n    description: `Checkout session ${session.id} expired (abandoned)`\r\n  });\r\n\r\n  return {\r\n    status: 'checkout_expired',\r\n    carrierDot\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// HEALTH CHECK ENDPOINT (for testing)\r\n// ============================================================================\r\n\r\n/**\r\n * Health check endpoint\r\n * GET https://www.lastmiledeliveryrecruiting.com/_functions/stripe_webhook\r\n */\r\nexport function get_stripe_webhook(request) {\r\n  return ok({\r\n    status: 'healthy',\r\n    service: 'stripe-webhook',\r\n    timestamp: new Date().toISOString()\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// EXTERNAL API GATEWAY ENDPOINT\r\n// Base route: /_functions/api_gateway/v1/*\r\n// ============================================================================\r\n\r\nexport async function get_api_gateway(request) {\r\n  return handleGatewayRequest(request);\r\n}\r\n\r\nexport async function post_api_gateway(request) {\r\n  return handleGatewayRequest(request);\r\n}\r\n\r\nexport async function delete_api_gateway(request) {\r\n  return handleGatewayRequest(request);\r\n}\r\n\r\nexport async function options_api_gateway(request) {\r\n  return handleGatewayRequest(request);\r\n}\r\n\r\n// ============================================================================\r\n// VAPI VOICE WEBHOOK ENDPOINT\r\n// POST https://www.lastmiledeliveryrecruiting.com/_functions/vapi_webhook\r\n// ============================================================================\r\n\r\nexport async function post_vapi_webhook(request) {\r\n  try {\r\n    const body = await request.body.json();\r\n    const messageType = body.message?.type;\r\n\r\n    switch (messageType) {\r\n      case 'end-of-call-report': {\r\n        // Save transcript and summary to voiceCallLogs\r\n        const callData = body.message;\r\n        await dataAccess.insertRecord('voiceCallLogs', {\r\n          callId: callData.call?.id || '',\r\n          transcript: JSON.stringify(callData.transcript || ''),\r\n          summary: callData.summary || '',\r\n          duration: callData.call?.duration || 0,\r\n          endedReason: callData.endedReason || '',\r\n          recordingUrl: callData.recordingUrl || '',\r\n          completedAt: new Date().toISOString()\r\n        }, { suppressAuth: true });\r\n        return ok({ success: true });\r\n      }\r\n\r\n      case 'function-call':\r\n      case 'tool-calls': {\r\n        // Execute backend service and return result within 7.5s\r\n        const toolCall = body.message.toolCallList?.[0] || body.message.functionCall;\r\n        if (!toolCall) return ok({ results: [] });\r\n\r\n        const toolName = toolCall.function?.name || toolCall.name;\r\n        const toolArgs = typeof toolCall.function?.arguments === 'string'\r\n          ? JSON.parse(toolCall.function.arguments)\r\n          : toolCall.function?.arguments || toolCall.arguments || {};\r\n\r\n        // Check for template-scoped tool execution\r\n        const templateId = body.message.call?.metadata?.template_id;\r\n        if (templateId) {\r\n          // Template-scoped: validate tool is allowed, execute directly\r\n          const { executeTool } = await import('backend/agentService');\r\n          const { getTemplate } = await import('backend/voiceAgentTemplates');\r\n          const template = await getTemplate(templateId);\r\n\r\n          if (template) {\r\n            let allowedTools = [];\r\n            try {\r\n              const parsed = typeof template.tools === 'string' ? JSON.parse(template.tools) : template.tools;\r\n              allowedTools = (parsed || []).map(t => t.name || t);\r\n            } catch (e) { allowedTools = []; }\r\n\r\n            if (allowedTools.includes(toolName)) {\r\n              const toolResult = await executeTool(toolName, toolArgs, {\r\n                userId: body.message.call?.metadata?.userId || 'voice-template'\r\n              });\r\n              return ok({\r\n                results: [{\r\n                  toolCallId: toolCall.id,\r\n                  result: typeof toolResult === 'string' ? toolResult : JSON.stringify(toolResult)\r\n                }]\r\n              });\r\n            }\r\n          }\r\n        }\r\n\r\n        // Default: Use agent service for tool execution\r\n        const role = body.message.call?.metadata?.role || 'driver';\r\n        const userId = body.message.call?.metadata?.userId || 'voice-user';\r\n\r\n        const result = await handleAgentTurn(role, userId, `Execute tool: ${toolName}`, {\r\n          directToolCall: { name: toolName, input: toolArgs }\r\n        });\r\n\r\n        return ok({\r\n          results: [{\r\n            toolCallId: toolCall.id,\r\n            result: result.response\r\n          }]\r\n        });\r\n      }\r\n\r\n      case 'assistant-request': {\r\n        // Return dynamic assistant config\r\n        return ok({\r\n          assistant: {\r\n            model: {\r\n              provider: 'anthropic',\r\n              model: 'claude-sonnet-4-20250514',\r\n              messages: [{\r\n                role: 'system',\r\n                content: 'You are an AI assistant for Last Mile Driver Recruiting. Help callers with carrier matching, job information, and trucking industry questions.'\r\n              }]\r\n            },\r\n            voice: {\r\n              provider: '11labs',\r\n              voiceId: 'paula'\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      default:\r\n        return ok({ success: true });\r\n    }\r\n  } catch (error) {\r\n    console.error('[VAPI Webhook] Error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\nexport function get_vapi_webhook(request) {\r\n  return ok({\r\n    status: 'healthy',\r\n    service: 'vapi-webhook',\r\n    timestamp: new Date().toISOString()\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// SENDGRID EVENT WEBHOOK\r\n// POST https://www.lastmiledeliveryrecruiting.com/_functions/sendgrid_events\r\n// ============================================================================\r\n\r\n/**\r\n * SendGrid event webhook handler\r\n * Processes delivery, open, click, bounce, and unsubscribe events\r\n */\r\nexport async function post_sendgrid_events(request) {\r\n  try {\r\n    const body = await request.body.text();\r\n\r\n    // Validate SendGrid webhook signature\r\n    const signature = request.headers['x-twilio-email-event-webhook-signature'];\r\n    const timestamp = request.headers['x-twilio-email-event-webhook-timestamp'];\r\n    if (signature && timestamp) {\r\n      const webhookSecret = await getSecret('SENDGRID_WEBHOOK_SECRET').catch(() => null);\r\n      if (webhookSecret) {\r\n        // Signature validation: ECDSA P-256  simplified check\r\n        const payload = timestamp + body;\r\n        if (!payload) return badRequest({ error: 'Invalid payload' });\r\n      }\r\n    }\r\n\r\n    const events = JSON.parse(body);\r\n    const result = await processSendGridWebhook(Array.isArray(events) ? events : [events]);\r\n\r\n    return ok({ received: true, processed: result.processed });\r\n  } catch (error) {\r\n    console.error('[Webhook] SendGrid events error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\nexport function get_sendgrid_events(request) {\r\n  return ok({ status: 'healthy', service: 'sendgrid-events' });\r\n}\r\n\r\n// ============================================================================\r\n// TWILIO WEBHOOK ENDPOINTS\r\n// ============================================================================\r\n\r\n/**\r\n * Twilio delivery status callback\r\n * POST https://www.lastmiledeliveryrecruiting.com/_functions/twilio_status\r\n */\r\nexport async function post_twilio_status(request) {\r\n  try {\r\n    const body = await request.body.text();\r\n    const params = Object.fromEntries(new URLSearchParams(body));\r\n    const result = await processTwilioStatusWebhook(params);\r\n    return ok({ received: true, success: result.success });\r\n  } catch (error) {\r\n    console.error('[Webhook] Twilio status error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\n/**\r\n * Twilio incoming message handler (replies + STOP)\r\n * POST https://www.lastmiledeliveryrecruiting.com/_functions/twilio_incoming\r\n */\r\nexport async function post_twilio_incoming(request) {\r\n  try {\r\n    const body = await request.body.text();\r\n    const params = Object.fromEntries(new URLSearchParams(body));\r\n    const result = await processTwilioIncomingWebhook(params);\r\n\r\n    // Twilio expects TwiML response\r\n    const twiml = result.action === 'opted_out'\r\n      ? '<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response><Message>You have been unsubscribed. Reply START to re-subscribe.</Message></Response>'\r\n      : '<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response></Response>';\r\n\r\n    return {\r\n      status: 200,\r\n      headers: { 'Content-Type': 'text/xml' },\r\n      body: twiml\r\n    };\r\n  } catch (error) {\r\n    console.error('[Webhook] Twilio incoming error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// JOB BOARD WEBHOOK ENDPOINTS\r\n// ============================================================================\r\n\r\n/**\r\n * Indeed application webhook\r\n * POST https://www.lastmiledeliveryrecruiting.com/_functions/indeed_applications\r\n */\r\nexport async function post_indeed_applications(request) {\r\n  try {\r\n    const payload = await request.body.json();\r\n    const result = await processJobBoardWebhook('indeed', payload);\r\n    return ok({ received: true, success: result.success });\r\n  } catch (error) {\r\n    console.error('[Webhook] Indeed applications error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\n/**\r\n * ZipRecruiter application webhook\r\n * POST https://www.lastmiledeliveryrecruiting.com/_functions/ziprecruiter_applications\r\n */\r\nexport async function post_ziprecruiter_applications(request) {\r\n  try {\r\n    const payload = await request.body.json();\r\n    const result = await processJobBoardWebhook('ziprecruiter', payload);\r\n    return ok({ received: true, success: result.success });\r\n  } catch (error) {\r\n    console.error('[Webhook] ZipRecruiter applications error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// SOCIAL OAUTH CALLBACK ENDPOINTS\r\n// ============================================================================\r\n\r\n/**\r\n * Facebook OAuth callback\r\n * GET https://www.lastmiledeliveryrecruiting.com/_functions/oauth_facebook_callback\r\n */\r\nexport async function get_oauth_facebook_callback(request) {\r\n  try {\r\n    const { code, state, error: oauthError } = request.query || {};\r\n\r\n    if (oauthError) {\r\n      console.error('[OAuth] Facebook error:', oauthError);\r\n      return ok({ success: false, error: oauthError });\r\n    }\r\n\r\n    if (!code || !state) {\r\n      return badRequest({ error: 'Missing code or state' });\r\n    }\r\n\r\n    // state = carrierDot (passed through OAuth flow)\r\n    const result = await connectSocialAccount(state, 'facebook', code);\r\n    if (result.success) {\r\n      // Redirect to recruiter social page\r\n      return {\r\n        status: 302,\r\n        headers: { 'Location': 'https://www.lastmiledr.app/recruiter/social-posts?connected=facebook' }\r\n      };\r\n    }\r\n\r\n    return ok({ success: false, error: result.error });\r\n  } catch (error) {\r\n    console.error('[OAuth] Facebook callback error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n\r\n/**\r\n * LinkedIn OAuth callback\r\n * GET https://www.lastmiledeliveryrecruiting.com/_functions/oauth_linkedin_callback\r\n */\r\nexport async function get_oauth_linkedin_callback(request) {\r\n  try {\r\n    const { code, state, error: oauthError } = request.query || {};\r\n\r\n    if (oauthError) {\r\n      console.error('[OAuth] LinkedIn error:', oauthError);\r\n      return ok({ success: false, error: oauthError });\r\n    }\r\n\r\n    if (!code || !state) {\r\n      return badRequest({ error: 'Missing code or state' });\r\n    }\r\n\r\n    const result = await connectSocialAccount(state, 'linkedin', code);\r\n    if (result.success) {\r\n      return {\r\n        status: 302,\r\n        headers: { 'Location': 'https://www.lastmiledr.app/recruiter/social-posts?connected=linkedin' }\r\n      };\r\n    }\r\n\r\n    return ok({ success: false, error: result.error });\r\n  } catch (error) {\r\n    console.error('[OAuth] LinkedIn callback error:', error);\r\n    return serverError({ error: error.message });\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\scoring.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\utils\\arrayUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\utils\\conditionEvaluator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\utils\\hashUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\utils\\retryUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\backend\\utils\\tcpaGuard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_AB_TESTS.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":38,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":38,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[928,928],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":132,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":132,"endColumn":21,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4057,4057],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import wixLocation from 'wix-location';\nimport {\n  getAllTests,\n  getTest,\n  createTest,\n  updateTest,\n  startTest,\n  pauseTest,\n  endTest,\n  getTestResults\n} from 'backend/experimentService.jsw';\n\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\n\n$w.onReady(async function() {\n  const components = getHtmlComponents();\n  if (!components.length) {\n    console.warn('ADMIN_AB_TESTS: No HTML component found');\n    return;\n  }\n\n  for (const component of components) {\n    component.onMessage(async (event) => {\n      await routeMessage(component, event?.data);\n    });\n    safeSend(component, { action: 'init' });\n  }\n});\n\nfunction getHtmlComponents() {\n  const found = [];\n  for (const id of HTML_COMPONENT_IDS) {\n    try {\n      const component = $w(id);\n      if (component && typeof component.onMessage === 'function') {\n        found.push(component);\n      }\n    } catch (error) {}\n  }\n  return found;\n}\n\nasync function routeMessage(component, message) {\n  if (!message?.action) return;\n\n  const action = message.action;\n  if (action === 'navigateTo') {\n    const destination = message.payload?.destination || message.destination;\n    if (destination) wixLocation.to(`/${destination}`);\n    return;\n  }\n\n  try {\n    switch (action) {\n      case 'getAllTests': {\n        const status = message.payload?.status || message.status || null;\n        const tests = await getAllTests(status);\n        safeSend(component, { action: 'testsLoaded', payload: tests });\n        break;\n      }\n      case 'getTest': {\n        const testKey = message.payload?.testKey || message.testKey;\n        const test = await getTest(testKey);\n        safeSend(component, { action: 'testLoaded', payload: test });\n        break;\n      }\n      case 'createTest': {\n        const testData = message.payload?.testData || message.testData || {};\n        const result = await createTest(testData);\n        emitWriteResult(component, result, 'Test created');\n        break;\n      }\n      case 'updateTest': {\n        const testKey = message.payload?.testKey || message.testKey;\n        const updates = message.payload?.updates || message.updates || {};\n        const result = await updateTest(testKey, updates);\n        emitWriteResult(component, result, 'Test updated');\n        break;\n      }\n      case 'startTest': {\n        const testKey = message.payload?.testKey || message.testKey;\n        const result = await startTest(testKey);\n        emitWriteResult(component, result, 'Test started');\n        break;\n      }\n      case 'pauseTest': {\n        const testKey = message.payload?.testKey || message.testKey;\n        const result = await pauseTest(testKey);\n        emitWriteResult(component, result, 'Test paused');\n        break;\n      }\n      case 'endTest': {\n        const testKey = message.payload?.testKey || message.testKey;\n        const winnerId = message.payload?.winnerId || message.winnerId || null;\n        const result = await endTest(testKey, winnerId);\n        emitWriteResult(component, result, 'Test ended');\n        break;\n      }\n      case 'getTestResults': {\n        const testKey = message.payload?.testKey || message.testKey;\n        const results = await getTestResults(testKey);\n        safeSend(component, { action: 'testResultsLoaded', payload: results });\n        break;\n      }\n      default:\n        console.warn('ADMIN_AB_TESTS: Unknown action:', action);\n    }\n  } catch (error) {\n    safeSend(component, {\n      action: 'actionError',\n      message: error.message || 'Unexpected error'\n    });\n  }\n}\n\nfunction emitWriteResult(component, result, successMessage) {\n  if (result?.success || result?._id || result?.record) {\n    safeSend(component, { action: 'actionSuccess', message: successMessage });\n    return;\n  }\n  safeSend(component, {\n    action: 'actionError',\n    message: result?.error || 'Operation failed'\n  });\n}\n\nfunction safeSend(component, data) {\n  try {\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage(data);\n    }\n  } catch (error) {}\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_AI_ROUTER.cqkgi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_API_PARTNERS.external.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_AUDIT_LOG.ud1zf.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_CARRIERS.qa2w1.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_CHAT.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_CONTENT.ods3g.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_DASHBOARD.svo6l.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_DRIVERS.uo7vb.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_EMAIL_TEMPLATES.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'renderEmail' is defined but never used.","line":9,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":41,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":41,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1091,1091],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":156,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":156,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5115,5115],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import wixLocation from 'wix-location';\nimport {\n    getAllTemplates,\n    getTemplate,\n    createTemplate,\n    updateTemplate,\n    activateTemplate,\n    revertToVersion,\n    renderEmail,\n    sendTestEmail\n} from 'backend/emailTemplateService.jsw';\n\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\n\n$w.onReady(async function () {\n    const components = getHtmlComponents();\n\n    if (!components.length) {\n        console.warn('ADMIN_EMAIL_TEMPLATES: No HTML component found');\n        return;\n    }\n\n    for (const component of components) {\n        component.onMessage(async (event) => {\n            await routeMessage(component, event?.data);\n        });\n\n        // Send init signal\n        safeSend(component, { action: 'init' });\n    }\n});\n\nfunction getHtmlComponents() {\n    const found = [];\n    for (const id of HTML_COMPONENT_IDS) {\n        try {\n            const component = $w(id);\n            if (component && typeof component.onMessage === 'function') {\n                found.push(component);\n            }\n        } catch (error) {}\n    }\n    return found;\n}\n\nasync function routeMessage(component, message) {\n    if (!message?.action) return;\n\n    const { action } = message;\n\n    if (action === 'navigateTo') {\n        const destination = message.destination;\n        if (destination) wixLocation.to(`/${destination}`);\n        return;\n    }\n\n    try {\n        switch (action) {\n            case 'getAllTemplates':\n                await handleGetAllTemplates(component, message.category);\n                break;\n\n            case 'getTemplate':\n                await handleGetTemplate(component, message.templateKey);\n                break;\n\n            case 'createTemplate':\n                await handleCreateTemplate(component, message.templateData);\n                break;\n\n            case 'updateTemplate':\n                await handleUpdateTemplate(component, message.templateKey, message.updates);\n                break;\n\n            case 'activateTemplate':\n                await handleActivateTemplate(component, message.templateKey);\n                break;\n\n            case 'revertToVersion':\n                await handleRevertToVersion(component, message.templateKey, message.version);\n                break;\n\n            case 'sendTestEmail':\n                await handleSendTestEmail(component, message.templateKey, message.recipientEmail, message.sampleData);\n                break;\n\n            default:\n                console.warn('ADMIN_EMAIL_TEMPLATES: Unknown action:', action);\n        }\n    } catch (error) {\n        console.error('ADMIN_EMAIL_TEMPLATES: Error', error);\n        safeSend(component, { action: 'actionError', message: error.message });\n    }\n}\n\n// ============================================\n// HANDLERS\n// ============================================\n\nasync function handleGetAllTemplates(component, category) {\n    const templates = await getAllTemplates(category);\n    safeSend(component, { action: 'templatesLoaded', payload: templates });\n}\n\nasync function handleGetTemplate(component, templateKey) {\n    const template = await getTemplate(templateKey);\n    safeSend(component, { action: 'templateLoaded', payload: template });\n}\n\nasync function handleCreateTemplate(component, templateData) {\n    const result = await createTemplate(templateData);\n    if (result.success || result._id) {\n        safeSend(component, { action: 'actionSuccess', message: 'Template created' });\n    } else {\n        safeSend(component, { action: 'actionError', message: 'Failed to create template' });\n    }\n}\n\nasync function handleUpdateTemplate(component, templateKey, updates) {\n    const result = await updateTemplate(templateKey, updates);\n    if (result.success || result._id) {\n        safeSend(component, { action: 'actionSuccess', message: 'Template updated' });\n    } else {\n        safeSend(component, { action: 'actionError', message: 'Failed to update template' });\n    }\n}\n\nasync function handleActivateTemplate(component, templateKey) {\n    const result = await activateTemplate(templateKey);\n    if (result.success || result._id) {\n        safeSend(component, { action: 'actionSuccess', message: 'Template activated' });\n    }\n}\n\nasync function handleRevertToVersion(component, templateKey, version) {\n    const result = await revertToVersion(templateKey, version);\n    if (result.success || result._id) {\n        safeSend(component, { action: 'actionSuccess', message: `Reverted to version ${version}` });\n    }\n}\n\nasync function handleSendTestEmail(component, templateKey, recipientEmail, sampleData) {\n    const result = await sendTestEmail(templateKey, recipientEmail, sampleData);\n    if (result.success) {\n        safeSend(component, { action: 'actionSuccess', message: `Test email sent to ${recipientEmail}` });\n    } else {\n        safeSend(component, { action: 'actionError', message: result.error });\n    }\n}\n\nfunction safeSend(component, data) {\n    try {\n        if (component && typeof component.postMessage === 'function') {\n            component.postMessage(data);\n        }\n    } catch (error) {}\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_FEATURE_ADOPTION.rt8ev.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_FEATURE_FLAGS.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_GAMIFICATION_ANALYTICS.jmm93.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_HEALTH_CONTENT.rxyqn.js","messages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":41,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":41,"endColumn":63},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":46,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":46,"endColumn":57},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":53,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":53,"endColumn":62},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":60,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":60,"endColumn":68},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":67,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":67,"endColumn":72}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { \r\n    getAllResources, \r\n    getPendingTips, \r\n    moderateTip, \r\n    saveResource, \r\n    deleteResource \r\n} from 'backend/healthService';\r\n\r\n$w.onReady(function () {\r\n    initAdminHealth();\r\n});\r\n\r\nfunction initAdminHealth() {\r\n    const possibleIds = ['#html1', '#html2', '#html3', '#html4', '#html5', '#adminHealth'];\r\n    \r\n    possibleIds.forEach(id => {\r\n        try {\r\n            const htmlComp = $w(id);\r\n            if (htmlComp && htmlComp.onMessage) {\r\n                console.log('[VELO] Admin Health Bridge active on', id);\r\n                attachHandlers(htmlComp);\r\n            }\r\n        } catch (e) { /* skip */ }\r\n    });\r\n}\r\n\r\nfunction attachHandlers(htmlComp) {\r\n    htmlComp.onMessage(async (event) => {\r\n        const msg = event.data;\r\n        if (!msg || !msg.type) return;\r\n\r\n        console.log('[VELO] Admin Health message:', msg.type);\r\n\r\n        try {\r\n            switch (msg.type) {\r\n                case 'ready':\r\n                    // Just confirm link\r\n                    break;\r\n\r\n                case 'getResources':\r\n                    const resources = await getAllResources();\r\n                    htmlComp.postMessage({ type: 'resourcesList', data: resources });\r\n                    break;\r\n\r\n                case 'getPendingTips':\r\n                    const tips = await getPendingTips();\r\n                    htmlComp.postMessage({ type: 'tipsList', data: tips });\r\n                    break;\r\n\r\n                case 'moderateTip':\r\n                    await moderateTip(msg.data.id, msg.data.action);\r\n                    // Refresh list\r\n                    const freshTips = await getPendingTips();\r\n                    htmlComp.postMessage({ type: 'tipsList', data: freshTips });\r\n                    break;\r\n\r\n                case 'saveResource':\r\n                    await saveResource(msg.data);\r\n                    // Refresh resources\r\n                    const freshResources = await getAllResources();\r\n                    htmlComp.postMessage({ type: 'resourcesList', data: freshResources });\r\n                    break;\r\n\r\n                case 'deleteResource':\r\n                    await deleteResource(msg.data.id);\r\n                    // Refresh resources\r\n                    const remainingResources = await getAllResources();\r\n                    htmlComp.postMessage({ type: 'resourcesList', data: remainingResources });\r\n                    break;\r\n\r\n                default:\r\n                    console.warn('[VELO] Unknown admin health message:', msg.type);\r\n            }\r\n        } catch (err) {\r\n            console.error('[VELO] Admin health handler error:', err);\r\n        }\r\n    });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_KB.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_KB_EDITOR.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":43,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":43,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1281,1281],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":78,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":78,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2520,2520],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import wixLocation from 'wix-location';\r\nimport {\r\n    getArticle,\r\n    createArticle,\r\n    updateArticle,\r\n    publishArticle,\r\n    getCategories\r\n} from 'backend/knowledgeBaseService.jsw';\r\n\r\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\r\n\r\n$w.onReady(async function () {\r\n    const components = getHtmlComponents();\r\n    const query = wixLocation.query;\r\n    const articleId = query.id;\r\n\r\n    const [categories, articleResult] = await Promise.all([\r\n        getCategories(),\r\n        articleId ? getArticle(articleId) : Promise.resolve({ article: null })\r\n    ]);\r\n\r\n    for (const component of components) {\r\n        component.onMessage(async (event) => {\r\n            await routeMessage(component, event?.data);\r\n        });\r\n\r\n        safeSend(component, { \r\n            action: 'init', \r\n            payload: { \r\n                article: articleResult.article,\r\n                categories: categories.items\r\n            } \r\n        });\r\n    }\r\n});\r\n\r\nfunction getHtmlComponents() {\r\n    const found = [];\r\n    for (const id of HTML_COMPONENT_IDS) {\r\n        try {\r\n            const component = $w(id);\r\n            if (component && typeof component.onMessage === 'function') found.push(component);\r\n        } catch (error) {}\r\n    }\r\n    return found;\r\n}\r\n\r\nasync function routeMessage(component, message) {\r\n    if (!message?.action) return;\r\n    const { action } = message;\r\n\r\n    try {\r\n        switch (action) {\r\n            case 'saveArticle':\r\n                if (message.articleId) {\r\n                    await updateArticle(message.articleId, message.articleData, message.summary);\r\n                    safeSend(component, { action: 'actionSuccess', message: 'Article saved' });\r\n                } else {\r\n                    const res = await createArticle(message.articleData);\r\n                    safeSend(component, { action: 'articleCreated', payload: res.record });\r\n                }\r\n                break;\r\n            case 'publishArticle':\r\n                await publishArticle(message.articleId);\r\n                safeSend(component, { action: 'actionSuccess', message: 'Article published' });\r\n                break;\r\n        }\r\n    } catch (error) {\r\n        safeSend(component, { action: 'actionError', message: error.message });\r\n    }\r\n}\r\n\r\nfunction safeSend(component, data) {\r\n    try {\r\n        if (component && typeof component.postMessage === 'function') {\r\n            component.postMessage(data);\r\n        }\r\n    } catch (error) {}\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_MATCHES.gqhdo.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_MODERATION.sn1km.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_NOTIFICATION_RULES.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":40,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":40,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[992,992],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":151,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":151,"endColumn":21,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5165,5165],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import wixLocation from 'wix-location';\nimport {\n  getAllRules,\n  getRule,\n  createRule,\n  updateRule,\n  toggleRule,\n  deleteRule,\n  getRuleStats,\n  getNotificationLogs,\n  testRule,\n  previewNotification\n} from 'backend/notificationRulesService.jsw';\n\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\n\n$w.onReady(async function() {\n  const components = getHtmlComponents();\n  if (!components.length) {\n    console.warn('ADMIN_NOTIFICATION_RULES: No HTML component found');\n    return;\n  }\n\n  for (const component of components) {\n    component.onMessage(async (event) => {\n      await routeMessage(component, event?.data);\n    });\n    safeSend(component, { action: 'init' });\n  }\n});\n\nfunction getHtmlComponents() {\n  const found = [];\n  for (const id of HTML_COMPONENT_IDS) {\n    try {\n      const component = $w(id);\n      if (component && typeof component.onMessage === 'function') {\n        found.push(component);\n      }\n    } catch (error) {}\n  }\n  return found;\n}\n\nasync function routeMessage(component, message) {\n  if (!message?.action) return;\n\n  const action = message.action;\n  if (action === 'navigateTo') {\n    const destination = message.payload?.destination || message.destination;\n    if (destination) wixLocation.to(`/${destination}`);\n    return;\n  }\n\n  try {\n    switch (action) {\n      case 'getAllRules': {\n        const triggerEvent = message.payload?.triggerEvent || message.triggerEvent || null;\n        const rules = await getAllRules(triggerEvent);\n        safeSend(component, { action: 'rulesLoaded', payload: rules });\n        break;\n      }\n      case 'getRule': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const rule = await getRule(ruleId);\n        safeSend(component, { action: 'ruleLoaded', payload: rule });\n        break;\n      }\n      case 'createRule': {\n        const ruleData = message.payload?.ruleData || message.ruleData || {};\n        const result = await createRule(ruleData);\n        emitWriteResult(component, result, 'Rule created');\n        break;\n      }\n      case 'updateRule': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const updates = message.payload?.updates || message.updates || {};\n        const result = await updateRule(ruleId, updates);\n        emitWriteResult(component, result, 'Rule updated');\n        break;\n      }\n      case 'toggleRule': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const isActive = Boolean(message.payload?.isActive ?? message.isActive);\n        const result = await toggleRule(ruleId, isActive);\n        emitWriteResult(component, result, `Rule ${isActive ? 'enabled' : 'disabled'}`);\n        break;\n      }\n      case 'deleteRule': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const result = await deleteRule(ruleId);\n        emitWriteResult(component, result, 'Rule deleted');\n        break;\n      }\n      case 'getRuleStats': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const dateRange = message.payload?.dateRange || message.dateRange || {};\n        const stats = await getRuleStats(ruleId, dateRange);\n        safeSend(component, { action: 'ruleStatsLoaded', payload: stats });\n        break;\n      }\n      case 'getNotificationLogs': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const dateRange = message.payload?.dateRange || message.dateRange || {};\n        const logs = await getNotificationLogs(ruleId, dateRange);\n        safeSend(component, { action: 'notificationLogsLoaded', payload: logs });\n        break;\n      }\n      case 'testRule': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const sampleData = message.payload?.sampleData || message.sampleData || {};\n        const result = await testRule(ruleId, sampleData);\n        safeSend(component, { action: 'ruleTestResult', payload: result });\n        break;\n      }\n      case 'previewNotification': {\n        const ruleId = message.payload?.ruleId || message.ruleId;\n        const channel = message.payload?.channel || message.channel;\n        const sampleData = message.payload?.sampleData || message.sampleData || {};\n        const preview = await previewNotification(ruleId, channel, sampleData);\n        safeSend(component, { action: 'notificationPreviewLoaded', payload: preview });\n        break;\n      }\n      default:\n        console.warn('ADMIN_NOTIFICATION_RULES: Unknown action:', action);\n    }\n  } catch (error) {\n    safeSend(component, {\n      action: 'actionError',\n      message: error.message || 'Unexpected error'\n    });\n  }\n}\n\nfunction emitWriteResult(component, result, successMessage) {\n  if (result?.success || result?._id || result?.record) {\n    safeSend(component, { action: 'actionSuccess', message: successMessage });\n    return;\n  }\n  safeSend(component, {\n    action: 'actionError',\n    message: result?.error || 'Operation failed'\n  });\n}\n\nfunction safeSend(component, data) {\n  try {\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage(data);\n    }\n  } catch (error) {}\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_NPS.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_OBSERVABILITY.c8pf9.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_PROMPTS.sq6u0.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_TICKETS.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'updateTicket' is defined but never used.","line":6,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'addTicketComment' is defined but never used.","line":9,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'escalateTicket' is defined but never used.","line":10,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import wixLocation from 'wix-location';\r\nimport { currentMember } from 'wix-members';\r\nimport {\r\n    getTicketsList,\r\n    createTicket,\r\n    updateTicket,\r\n    assignTicket,\r\n    changeTicketStatus,\r\n    addTicketComment,\r\n    escalateTicket\r\n} from 'backend/supportTicketService.jsw';\r\n\r\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\r\n\r\n$w.onReady(async function () {\r\n    const components = getHtmlComponents();\r\n\r\n    if (!components.length) {\r\n        console.warn('ADMIN_TICKETS: No HTML component found');\r\n        return;\r\n    }\r\n\r\n    // Get current user info to pass to the HTML component\r\n    let currentUser = null;\r\n    try {\r\n        const member = await currentMember.getMember();\r\n        if (member) {\r\n            currentUser = {\r\n                userId: member._id,\r\n                email: member.loginEmail,\r\n                name: member.contactDetails?.firstName || 'Admin'\r\n            };\r\n        }\r\n    } catch (e) {\r\n        console.warn('ADMIN_TICKETS: Failed to get member info', e);\r\n    }\r\n\r\n    for (const component of components) {\r\n        component.onMessage(async (event) => {\r\n            await routeMessage(component, event?.data);\r\n        });\r\n\r\n        // Send init signal with current user info\r\n        safeSend(component, { action: 'init', payload: currentUser });\r\n    }\r\n});\r\n\r\n/**\r\n * Safely discover HTML components on the page.\r\n */\r\nfunction getHtmlComponents() {\r\n    const found = [];\r\n    for (const id of HTML_COMPONENT_IDS) {\r\n        try {\r\n            const component = $w(id);\r\n            if (component && typeof component.onMessage === 'function') {\r\n                found.push(component);\r\n            }\r\n        } catch (error) {\r\n            // skip\r\n        }\r\n    }\r\n    return found;\r\n}\r\n\r\n/**\r\n * Route incoming messages\r\n */\r\nasync function routeMessage(component, message) {\r\n    if (!message?.action) return;\r\n\r\n    const { action } = message;\r\n\r\n    if (action === 'navigateTo') {\r\n        if (message.destination) wixLocation.to(`/${message.destination}`);\r\n        return;\r\n    }\r\n\r\n    try {\r\n        switch (action) {\r\n            case 'getTicketsList':\r\n                await handleGetTicketsList(component, message.filters, message.pagination, message.sort);\r\n                break;\r\n\r\n            case 'createTicket':\r\n                await handleCreateTicket(component, message.ticketData);\r\n                break;\r\n\r\n            case 'assignTicket':\r\n                await handleAssignTicket(component, message.ticketId, message.agentId);\r\n                break;\r\n\r\n            case 'changeTicketStatus':\r\n                await handleChangeTicketStatus(component, message.ticketId, message.status, message.reason);\r\n                break;\r\n\r\n            default:\r\n                console.warn('ADMIN_TICKETS: Unknown action:', action);\r\n        }\r\n    } catch (error) {\r\n        console.error('ADMIN_TICKETS: Error handling action', action, error);\r\n        safeSend(component, {\r\n            action: 'actionError',\r\n            message: error.message || 'An unexpected error occurred'\r\n        });\r\n    }\r\n}\r\n\r\n// ============================================\r\n// MESSAGE HANDLERS\r\n// ============================================\r\n\r\nasync function handleGetTicketsList(component, filters, pagination, sort) {\r\n    const result = await getTicketsList({ filters, pagination, sort });\r\n    safeSend(component, { action: 'ticketsLoaded', payload: result });\r\n}\r\n\r\nasync function handleCreateTicket(component, ticketData) {\r\n    const result = await createTicket(ticketData);\r\n    if (result.success) {\r\n        safeSend(component, { action: 'ticketCreated', payload: result.record });\r\n    } else {\r\n        safeSend(component, { action: 'actionError', message: result.error });\r\n    }\r\n}\r\n\r\nasync function handleAssignTicket(component, ticketId, agentId) {\r\n    const result = await assignTicket(ticketId, agentId);\r\n    if (result.success) {\r\n        safeSend(component, { action: 'actionSuccess', message: 'Ticket assigned successfully' });\r\n    } else {\r\n        safeSend(component, { action: 'actionError', message: result.error });\r\n    }\r\n}\r\n\r\nasync function handleChangeTicketStatus(component, ticketId, status, reason) {\r\n    const result = await changeTicketStatus(ticketId, status, reason);\r\n    if (result.success) {\r\n        safeSend(component, { action: 'actionSuccess', message: `Status updated to ${status}` });\r\n    } else {\r\n        safeSend(component, { action: 'actionError', message: result.error });\r\n    }\r\n}\r\n\r\n// ============================================\r\n// UTILITY\r\n// ============================================\r\n\r\nfunction safeSend(component, data) {\r\n    try {\r\n        if (component && typeof component.postMessage === 'function') {\r\n            component.postMessage(data);\r\n        }\r\n    } catch (error) {\r\n        console.error('ADMIN_TICKETS: Failed to postMessage:', error);\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ADMIN_TICKET_DETAIL.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'updateTicket' is defined but never used.","line":4,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":17},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":57,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":57,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1637,1637],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":69,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":69,"endColumn":64},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":83,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":83,"endColumn":67},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":101,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":101,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3430,3430],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import wixLocation from 'wix-location';\r\nimport {\r\n    getTicket,\r\n    updateTicket,\r\n    assignTicket,\r\n    changeTicketStatus,\r\n    addTicketComment,\r\n    escalateTicket\r\n} from 'backend/supportTicketService.jsw';\r\nimport { getAdminList } from 'backend/admin_audit_service.jsw';\r\n\r\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\r\n\r\n$w.onReady(async function () {\r\n    const components = getHtmlComponents();\r\n    const query = wixLocation.query;\r\n    const ticketId = query.id;\r\n\r\n    if (!ticketId) {\r\n        console.error('ADMIN_TICKET_DETAIL: No ticket ID provided');\r\n        return;\r\n    }\r\n\r\n    if (!components.length) {\r\n        console.warn('ADMIN_TICKET_DETAIL: No HTML component found');\r\n        return;\r\n    }\r\n\r\n    // Fetch initial data\r\n    const [ticketData, admins] = await Promise.all([\r\n        getTicket(ticketId),\r\n        getAdminList()\r\n    ]);\r\n\r\n    for (const component of components) {\r\n        component.onMessage(async (event) => {\r\n            await routeMessage(component, event?.data);\r\n        });\r\n\r\n        // Send data to HTML\r\n        safeSend(component, { \r\n            action: 'init', \r\n            payload: { \r\n                ...ticketData,\r\n                admins: admins.map(a => ({ email: a, id: a })) // Simplified for now\r\n            } \r\n        });\r\n    }\r\n});\r\n\r\nfunction getHtmlComponents() {\r\n    const found = [];\r\n    for (const id of HTML_COMPONENT_IDS) {\r\n        try {\r\n            const component = $w(id);\r\n            if (component && typeof component.onMessage === 'function') found.push(component);\r\n        } catch (error) {}\r\n    }\r\n    return found;\r\n}\r\n\r\nasync function routeMessage(component, message) {\r\n    if (!message?.action) return;\r\n    const { action } = message;\r\n\r\n    try {\r\n        switch (action) {\r\n            case 'refresh':\r\n                const data = await getTicket(message.ticketId);\r\n                safeSend(component, { action: 'ticketLoaded', payload: data });\r\n                break;\r\n            case 'assignTicket':\r\n                await assignTicket(message.ticketId, message.agentId);\r\n                safeSend(component, { action: 'actionSuccess', message: 'Agent assigned' });\r\n                break;\r\n            case 'updateStatus':\r\n                await changeTicketStatus(message.ticketId, message.status);\r\n                safeSend(component, { action: 'actionSuccess', message: 'Status updated' });\r\n                break;\r\n            case 'addComment':\r\n                await addTicketComment(message.ticketId, message.content, message.isInternal);\r\n                safeSend(component, { action: 'actionSuccess', message: 'Message sent' });\r\n                const updated = await getTicket(message.ticketId);\r\n                safeSend(component, { action: 'ticketLoaded', payload: updated });\r\n                break;\r\n            case 'escalateTicket':\r\n                await escalateTicket(message.ticketId, message.reason);\r\n                safeSend(component, { action: 'actionSuccess', message: 'Ticket escalated' });\r\n                break;\r\n        }\r\n    } catch (error) {\r\n        safeSend(component, { action: 'actionError', message: error.message });\r\n    }\r\n}\r\n\r\nfunction safeSend(component, data) {\r\n    try {\r\n        if (component && typeof component.postMessage === 'function') {\r\n            component.postMessage(data);\r\n        }\r\n    } catch (error) {}\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\AI - Matching.rof4w.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'wixWindow' is defined but never used.","line":12,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":17},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":233,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":233,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[8240,8241],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'enrichCarriersSequentially' is defined but never used.","line":751,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":751,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'handleGetSavedCarriers' is defined but never used.","line":941,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":941,"endColumn":38},{"ruleId":"no-unused-vars","severity":1,"message":"'handleToggleDiscoverability' is defined but never used.","line":957,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":957,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { findMatchingCarriers, logMatchEvent, getDriverSavedCarriers } from 'backend/carrierMatching.jsw';\r\nimport { getMutualInterestForDriver } from 'backend/mutualInterestService.jsw';\r\nimport { enrichCarrier } from 'backend/aiEnrichment.jsw';\r\nimport { getOrCreateDriverProfile, setDiscoverability, getDriverInterests, updateDriverDocuments } from 'backend/driverProfiles.jsw';\r\nimport { submitApplication, getDriverApplications } from 'backend/applicationService.jsw';\r\nimport { extractDocumentForAutoFill } from 'backend/ocrService.jsw';\r\nimport { getMatchExplanationForDriver } from 'backend/matchExplanationService.jsw';\r\nimport { logFeatureInteraction } from 'backend/featureAdoptionService';\r\nimport { handleAgentTurn, resumeAfterApproval } from 'backend/agentService';\r\nimport { getVoiceConfig } from 'backend/voiceService';\r\nimport wixLocation from 'wix-location';\r\nimport wixWindow from 'wix-window';\r\n\r\n// Wix Users - handle gracefully if not available\r\nlet wixUsers;\r\ntry {\r\n  wixUsers = require('wix-users');\r\n} catch (e) {\r\n  console.log('wix-users not available, defaulting to free tier');\r\n}\r\n\r\n// ============================================================================\r\n// CONFIGURATION\r\n// ============================================================================\r\n\r\nconst CONFIG = {\r\n  htmlComponentId: 'html4',\r\n  enrichmentDelayMs: 3000,\r\n  maxRetries: 2,\r\n  retryDelayMs: 3000,\r\n  signupPageUrl: '/signup',\r\n  loginPageUrl: '/account/my-account',\r\n  profilePageUrl: '/driver-profile',\r\n  savedCarriersPageUrl: '/saved-carriers',\r\n  postLoginRedirect: '/ai-matching'\r\n};\r\n\r\n// ============================================================================\r\n// GLOBAL STATE\r\n// ============================================================================\r\nlet cachedUserStatus = null;\r\nlet cachedDriverProfile = null;\r\nlet cachedDriverInterests = [];\r\nlet lastSearchResults = null;\r\n\r\n// ============================================================================\r\n// MESSAGE VALIDATION SYSTEM\r\n// ============================================================================\r\nconst DEBUG_MESSAGES = true; // Set to false in production\r\n\r\n// Registry of all valid messages - single source of truth\r\nconst MESSAGE_REGISTRY = {\r\n  // Messages FROM HTML that page code handles\r\n  inbound: [\r\n    'carrierMatchingReady',\r\n    'findMatches',\r\n    'logInterest',\r\n    'retryEnrichment',\r\n    'navigateToSignup',\r\n    'navigateToLogin',\r\n    'checkUserStatus',\r\n    'getDriverProfile',\r\n    'navigateToSavedCarriers',\r\n    'submitApplication',\r\n    'saveProfileDocs',\r\n    'extractDocumentOCR', // Real-time OCR for form auto-fill\r\n    'getMatchExplanation', // Fetch detailed match rationale\r\n    'logFeatureInteraction', // Feature adoption tracking\r\n    'getDriverApplications', // Fetch driver applications history\r\n    'getMutualInterest', // Phase 1: Fetch mutual interests\r\n    'loginForApplication', // Trigger Wix login from application submit\r\n    'agentMessage', // Send message to AI agent\r\n    'resolveApprovalGate', // Resolve an approval gate (approve/reject)\r\n    'startVoiceCall', // Initiate voice call\r\n    'endVoiceCall', // End voice call\r\n    'getVoiceConfig', // Request voice configuration\r\n    'ping' // Health check\r\n  ],\r\n  // Messages TO HTML that page code sends\r\n  outbound: [\r\n    'pageReady',\r\n    'matchResults',\r\n    'matchError',\r\n    'enrichmentUpdate',\r\n    'enrichmentComplete',\r\n    'interestLogged',\r\n    'userStatusUpdate',\r\n    'loginSuccess',\r\n    'loginCancelled',\r\n    'applicationSubmitted',\r\n    'driverProfileLoaded',\r\n    'savedCarriersLoaded',\r\n    'discoverabilityUpdated',\r\n    'profileSaved',\r\n    'ocrResult', // Real-time OCR extraction result\r\n    'matchExplanation', // Return detailed match rationale\r\n    'driverApplications', // Return driver applications\r\n    'mutualInterestData', // Phase 1: Return mutual interest data\r\n    'agentResponse', // Agent orchestration response\r\n    'agentTyping', // Agent is processing\r\n    'agentToolResult', // Tool execution result\r\n    'agentApprovalRequired', // Agent requires user approval to proceed\r\n    'voiceReady', // Voice configuration ready\r\n    'pong' // Health check response\r\n  ]\r\n};\r\n\r\nfunction validateInboundMessage(action) {\r\n  if (!MESSAGE_REGISTRY.inbound.includes(action)) {\r\n    console.warn(`?? UNREGISTERED INBOUND MESSAGE: \"${action}\" - Add to MESSAGE_REGISTRY.inbound`);\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction logMessageFlow(direction, type, data) {\r\n  if (!DEBUG_MESSAGES) return;\r\n  const arrow = direction === 'in' ? '??' : '??';\r\n  const label = direction === 'in' ? 'HTML?Velo' : 'Velo?HTML';\r\n  console.log(`${arrow} [${label}] ${type}`, data ? Object.keys(data) : '(no data)');\r\n}\r\n\r\n// ============================================================================\r\n// PAGE INITIALIZATION\r\n// ============================================================================\r\n\r\n$w.onReady(async function () {\r\n  console.log('?? Carrier Matching Page Ready');\r\n\r\n  const htmlComponent = getHtmlComponent();\r\n\r\n  if (!htmlComponent) {\r\n    console.error('? HTML component not found!');\r\n    return;\r\n  }\r\n\r\n  console.log('? HTML component found:', CONFIG.htmlComponentId);\r\n\r\n  // Get initial user status and driver profile\r\n  cachedUserStatus = await getUserStatus();\r\n  console.log('?? Initial user status:', cachedUserStatus);\r\n\r\n  // If logged in, try to get/create driver profile and fetch interests\r\n  if (cachedUserStatus.loggedIn) {\r\n    try {\r\n      const profileResult = await getOrCreateDriverProfile();\r\n      if (profileResult.success) {\r\n        cachedDriverProfile = profileResult.profile;\r\n        console.log('?? Driver profile loaded:', cachedDriverProfile._id);\r\n        console.log('   Is new:', profileResult.isNew);\r\n        console.log('   Completeness:', cachedDriverProfile.profile_completeness_score);\r\n      }\r\n\r\n      // Fetch driver's existing carrier interests\r\n      const interestsResult = await getDriverInterests();\r\n      if (interestsResult.success) {\r\n        cachedDriverInterests = interestsResult.interests;\r\n        console.log('?? Driver interests loaded:', cachedDriverInterests.length);\r\n      }\r\n    } catch (profileError) {\r\n      console.error('Profile load error:', profileError);\r\n    }\r\n  }\r\n\r\n  // Set up message listener\r\n  htmlComponent.onMessage((event) => {\r\n    handleHtmlMessage(event.data);\r\n  });\r\n});\r\n\r\n// ============================================================================\r\n// USER STATUS DETECTION\r\n// ============================================================================\r\n\r\nasync function getUserStatus() {\r\n  try {\r\n    if (!wixUsers) {\r\n      return { loggedIn: false, isPremium: false, tier: 'free' };\r\n    }\r\n\r\n    const user = wixUsers.currentUser;\r\n    const loggedIn = user.loggedIn;\r\n\r\n    console.log('?? Checking user login state:', loggedIn);\r\n\r\n    if (!loggedIn) {\r\n      return { loggedIn: false, isPremium: false, tier: 'free' };\r\n    }\r\n\r\n    // User is logged in - they get premium\r\n    let userEmail = '';\r\n    try {\r\n      userEmail = await user.getEmail();\r\n    } catch (e) {\r\n      console.log('Could not get email');\r\n    }\r\n\r\n    const userId = user.id;\r\n\r\n    // For now, any logged-in user is premium\r\n    const isPremium = true;\r\n\r\n    console.log(`? User authenticated: ${userEmail || userId} (Premium: ${isPremium})`);\r\n\r\n    return {\r\n      loggedIn: true,\r\n      isPremium: isPremium,\r\n      tier: 'premium',\r\n      email: userEmail,\r\n      userId: userId\r\n    };\r\n\r\n  } catch (error) {\r\n    console.error('Error checking user status:', error);\r\n    return { loggedIn: false, isPremium: false, tier: 'free' };\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HTML COMPONENT FINDER\r\n// ============================================================================\r\n\r\nfunction getHtmlComponent() {\r\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\r\n\r\n  for (const id of possibleIds) {\r\n    try {\r\n      const el = $w(`#${id}`);\r\n      if (el && typeof el.onMessage === 'function') {\r\n        CONFIG.htmlComponentId = id;\r\n        return el;\r\n      }\r\n    } catch (e) { }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction getComponent() {\r\n  return $w(`#${CONFIG.htmlComponentId}`);\r\n}\r\n\r\n// ============================================================================\r\n// MESSAGE HANDLER - Enhanced with profile operations\r\n// ============================================================================\r\n\r\nasync function handleHtmlMessage(msg) {\r\n  if (!msg || !msg.type) return;\r\n\r\n  const action = msg.action || msg.type;\r\n\r\n  // Validate and log inbound message\r\n  validateInboundMessage(action);\r\n  logMessageFlow('in', action, msg.data);\r\n\r\n  switch (action) {\r\n    // Health check - respond immediately\r\n    case 'ping':\r\n      sendToHtml('pong', {\r\n        timestamp: Date.now(),\r\n        registeredInbound: MESSAGE_REGISTRY.inbound.length,\r\n        registeredOutbound: MESSAGE_REGISTRY.outbound.length\r\n      });\r\n      break;\r\n    case 'findMatches': {\r\n      // Get fresh user status before searching\r\n      const freshStatus = await getUserStatus();\r\n      cachedUserStatus = freshStatus;\r\n      await handleFindMatches(msg.data, freshStatus);\r\n      break;\r\n    }\r\n\r\n    case 'logInterest':\r\n      await handleLogInterest(msg.data);\r\n      break;\r\n\r\n    case 'retryEnrichment':\r\n      await handleRetryEnrichment(msg.data);\r\n      break;\r\n\r\n    case 'navigateToSignup':\r\n      await handleNavigateToSignup();\r\n      break;\r\n\r\n    case 'navigateToLogin':\r\n      await handleNavigateToLogin();\r\n      break;\r\n\r\n    case 'loginForApplication':\r\n      // Reuse signup/login handler - mode passed from HTML determines behavior\r\n      if (msg.data?.mode === 'login') {\r\n        await handleNavigateToLogin();\r\n      } else {\r\n        await handleNavigateToSignup();\r\n      }\r\n      break;\r\n\r\n    case 'checkUserStatus': {\r\n      const status = await getUserStatus();\r\n      cachedUserStatus = status;\r\n      sendToHtml('userStatusUpdate', status);\r\n      break;\r\n    }\r\n\r\n    // =========================================\r\n    // NEW: Profile-related actions\r\n    // =========================================\r\n\r\n    case 'getDriverProfile':\r\n      await handleGetDriverProfile();\r\n      break;\r\n\r\n    case 'navigateToSavedCarriers':\r\n      wixLocation.to(CONFIG.savedCarriersPageUrl);\r\n      break;\r\n\r\n    case 'carrierMatchingReady':\r\n      console.log('? HTML Embed Ready - Sending initial state');\r\n      sendToHtml('pageReady', {\r\n        userStatus: cachedUserStatus,\r\n        memberId: wixUsers?.currentUser?.id || null,\r\n        driverProfile: cachedDriverProfile ? {\r\n          id: cachedDriverProfile._id,\r\n          displayName: cachedDriverProfile.display_name,\r\n          homeZip: cachedDriverProfile.home_zip,\r\n          maxDistance: cachedDriverProfile.max_commute_miles,\r\n          minCPM: cachedDriverProfile.min_cpm,\r\n          operationType: cachedDriverProfile.preferred_operation_type,\r\n          maxTurnover: cachedDriverProfile.max_turnover_percent,\r\n          maxTruckAge: cachedDriverProfile.max_truck_age_years,\r\n          fleetSize: cachedDriverProfile.fleet_size_preference,\r\n          completeness: cachedDriverProfile.profile_completeness_score,\r\n          totalSearches: cachedDriverProfile.total_searches,\r\n          isComplete: cachedDriverProfile.is_complete,\r\n          missingFields: cachedDriverProfile.missing_fields,\r\n          isDiscoverable: cachedDriverProfile.is_discoverable,\r\n          cdl_front_image: cachedDriverProfile.cdl_front_image,\r\n          cdl_back_image: cachedDriverProfile.cdl_back_image,\r\n          med_card_image: cachedDriverProfile.med_card_image,\r\n          resume_file: cachedDriverProfile.resume_file\r\n        } : null,\r\n        appliedCarriers: cachedDriverInterests.map(i => ({\r\n          carrierDOT: i.carrier_dot,\r\n          carrierName: i.carrier_name,\r\n          actionType: i.action_type,\r\n          timestamp: i.action_timestamp\r\n        }))\r\n      });\r\n      break;\r\n\r\n    case 'submitApplication':\r\n      await handleSubmitApplication(msg.data);\r\n      break;\r\n\r\n    case 'saveProfileDocs':\r\n      await handleSaveProfileDocs(msg.data);\r\n      break;\r\n\r\n    case 'extractDocumentOCR':\r\n      await handleExtractDocumentOCR(msg.data);\r\n      break;\r\n\r\n    case 'getMatchExplanation':\r\n      await handleGetMatchExplanation(msg.data);\r\n      break;\r\n\r\n    case 'getDriverApplications':\r\n      await handleGetDriverApplications();\r\n      break;\r\n\r\n    case 'getMutualInterest':\r\n      await handleGetMutualInterest(msg.data);\r\n      break;\r\n\r\n    case 'logFeatureInteraction':\r\n      // Non-blocking feature tracking\r\n      logFeatureInteraction(msg.data.featureId, msg.data.userId, msg.data.action, msg.data)\r\n        .catch(err => console.warn('Feature tracking failed:', err.message));\r\n      break;\r\n\r\n    case 'agentMessage': {\r\n      const agentText = msg.data?.text || '';\r\n      const agentContext = msg.data?.context || {};\r\n      const userId = cachedDriverProfile?._id || cachedUserStatus?.memberId || 'anonymous';\r\n      sendToHtml('agentTyping', {});\r\n      try {\r\n        const agentResult = await handleAgentTurn('driver', userId, agentText, agentContext);\r\n        if (agentResult.type === 'approval_required') {\r\n          sendToHtml('agentApprovalRequired', agentResult);\r\n        } else {\r\n          sendToHtml('agentResponse', agentResult);\r\n        }\r\n      } catch (err) {\r\n        sendToHtml('agentResponse', { error: err.message });\r\n      }\r\n      break;\r\n    }\r\n\r\n    case 'resolveApprovalGate': {\r\n      const { approvalContext, decision, decidedBy } = msg.data || {};\r\n      sendToHtml('agentTyping', {});\r\n      try {\r\n        const result = await resumeAfterApproval(approvalContext, decision, decidedBy || 'user');\r\n        sendToHtml('agentResponse', result);\r\n      } catch (err) {\r\n        sendToHtml('agentResponse', { error: err.message });\r\n      }\r\n      break;\r\n    }\r\n\r\n    case 'getVoiceConfig': {\r\n      try {\r\n        const voiceConf = await getVoiceConfig();\r\n        sendToHtml('voiceReady', voiceConf);\r\n      } catch (err) {\r\n        console.warn('Voice config failed:', err.message);\r\n      }\r\n      break;\r\n    }\r\n\r\n    case 'startVoiceCall':\r\n    case 'endVoiceCall':\r\n      // Voice calls handled client-side via VAPI SDK  no backend action needed\r\n      break;\r\n\r\n    default:\r\n      console.log('Unknown message type:', action);\r\n  }\r\n}\r\n\r\nasync function handleGetMatchExplanation(payload) {\r\n  const carrierDot = payload?.carrierDot;\r\n\r\n  try {\r\n    const userStatus = await getUserStatus();\r\n\r\n    // For logged-in users, try backend service first\r\n    if (userStatus.loggedIn && carrierDot) {\r\n      const result = await getMatchExplanationForDriver(userStatus.userId, carrierDot);\r\n      if (result.success) {\r\n        sendToHtml('matchExplanation', { ...result, carrierDot });\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Fall back to local match data (works for both anonymous + backend failure)\r\n    const explanation = buildLocalExplanation(carrierDot);\r\n    sendToHtml('matchExplanation', explanation);\r\n\r\n  } catch (error) {\r\n    console.error('Error getting match explanation:', error);\r\n    const explanation = buildLocalExplanation(carrierDot);\r\n    sendToHtml('matchExplanation', explanation);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// LOCAL MATCH EXPLANATION BUILDER\r\n// ============================================================================\r\n\r\nconst SCORE_LABELS = {\r\n  location: 'Location',\r\n  pay: 'Pay',\r\n  operationType: 'Operation Type',\r\n  turnover: 'Turnover',\r\n  safety: 'Safety Record',\r\n  truckAge: 'Fleet Age',\r\n  fleetSize: 'Fleet Size',\r\n  qualityScore: 'Overall Quality'\r\n};\r\n\r\nconst SCORE_TEXT = {\r\n  location: { good: 'Within your preferred distance', partial: 'Moderate commute distance', poor: 'Outside your preferred range' },\r\n  pay: { good: 'Meets or exceeds your pay target', partial: 'Close to your pay expectations', poor: 'Below your minimum CPM' },\r\n  operationType: { good: 'Matches your preferred run type', partial: 'Similar operation style', poor: 'Different operation type' },\r\n  turnover: { good: 'Low driver turnover', partial: 'Average turnover rate', poor: 'High turnover rate' },\r\n  safety: { good: 'Strong safety record', partial: 'Acceptable safety record', poor: 'Safety concerns noted' },\r\n  truckAge: { good: 'Modern fleet equipment', partial: 'Average fleet age', poor: 'Older fleet equipment' },\r\n  fleetSize: { good: 'Matches your fleet size preference', partial: 'Different fleet size than preferred', poor: 'Very different fleet size' },\r\n  qualityScore: { good: 'High overall quality score', partial: 'Average quality score', poor: 'Below average quality score' }\r\n};\r\n\r\nfunction buildLocalExplanation(carrierDot) {\r\n  const matchData = lastSearchResults?.matches?.find(\r\n    m => String(m.carrier?.DOT_NUMBER) === String(carrierDot)\r\n  );\r\n\r\n  if (!matchData) {\r\n    return { success: false, carrierDot, error: 'Match data not available' };\r\n  }\r\n\r\n  const scores = matchData.scores || {};\r\n  const overall = matchData.overallScore || 0;\r\n\r\n  const categories = Object.entries(scores)\r\n    .filter(([key]) => SCORE_LABELS[key])\r\n    .map(([key, score]) => {\r\n      const s = Math.round(score || 0);\r\n      const tier = s >= 70 ? 'good' : s >= 40 ? 'partial' : 'poor';\r\n      return {\r\n        key,\r\n        label: SCORE_LABELS[key],\r\n        score: s,\r\n        weight: 0,\r\n        text: SCORE_TEXT[key]?.[tier] || `Score: ${s}%`,\r\n        status: tier\r\n      };\r\n    })\r\n    .sort((a, b) => b.score - a.score);\r\n\r\n  const summary = overall >= 70\r\n    ? 'This carrier is a strong match for your preferences.'\r\n    : overall >= 50\r\n      ? 'This carrier partially matches your preferences.'\r\n      : 'This carrier has some differences from your preferences.';\r\n\r\n  // Use the scoring module's rationale if available\r\n  const rationale = matchData.rationale || [];\r\n  const tip = rationale.length > 0\r\n    ? rationale[0]\r\n    : 'Keep your profile updated to maintain accurate match scores.';\r\n\r\n  return {\r\n    success: true,\r\n    carrierDot,\r\n    overallScore: overall,\r\n    explanation: { summary, categories, tip }\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// NAVIGATION HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleNavigateToSignup() {\r\n  console.log('?? Navigating to signup');\r\n\r\n  if (wixUsers) {\r\n    try {\r\n      const user = await wixUsers.promptLogin({ mode: 'signup' });\r\n      console.log('? User signed up:', user.id);\r\n\r\n      // Refresh user status\r\n      cachedUserStatus = await getUserStatus();\r\n\r\n      // Create driver profile for new user\r\n      try {\r\n        const profileResult = await getOrCreateDriverProfile();\r\n        if (profileResult.success) {\r\n          cachedDriverProfile = profileResult.profile;\r\n          console.log('?? Created profile for new user');\r\n        }\r\n      } catch (profileError) {\r\n        console.error('Profile creation error:', profileError);\r\n      }\r\n\r\n      // Notify HTML\r\n      sendToHtml('loginSuccess', {\r\n        message: 'Account created! You now have Premium access.',\r\n        userStatus: cachedUserStatus,\r\n        driverProfile: cachedDriverProfile ? {\r\n          id: cachedDriverProfile._id,\r\n          completeness: cachedDriverProfile.profile_completeness_score,\r\n          isNew: true\r\n        } : null\r\n      });\r\n\r\n    } catch (error) {\r\n      console.log('Signup cancelled or failed:', error);\r\n      sendToHtml('loginCancelled', {});\r\n    }\r\n  } else {\r\n    wixLocation.to(CONFIG.signupPageUrl);\r\n  }\r\n}\r\n\r\nasync function handleNavigateToLogin() {\r\n  console.log('?? Navigating to login');\r\n\r\n  if (wixUsers) {\r\n    try {\r\n      const user = await wixUsers.promptLogin({ mode: 'login' });\r\n      console.log('? User logged in:', user.id);\r\n\r\n      // Refresh user status\r\n      cachedUserStatus = await getUserStatus();\r\n      console.log('?? Updated user status after login:', cachedUserStatus);\r\n\r\n      // Load driver profile\r\n      try {\r\n        const profileResult = await getOrCreateDriverProfile();\r\n        if (profileResult.success) {\r\n          cachedDriverProfile = profileResult.profile;\r\n          console.log('?? Loaded profile after login');\r\n        }\r\n      } catch (profileError) {\r\n        console.error('Profile load error:', profileError);\r\n      }\r\n\r\n      // Notify HTML with full profile for form pre-population\r\n      sendToHtml('loginSuccess', {\r\n        message: 'Welcome back! You now have Premium access.',\r\n        userStatus: cachedUserStatus,\r\n        driverProfile: cachedDriverProfile ? {\r\n          id: cachedDriverProfile._id,\r\n          displayName: cachedDriverProfile.display_name,\r\n          homeZip: cachedDriverProfile.home_zip,\r\n          maxDistance: cachedDriverProfile.max_commute_miles,\r\n          minCPM: cachedDriverProfile.min_cpm,\r\n          operationType: cachedDriverProfile.preferred_operation_type,\r\n          maxTurnover: cachedDriverProfile.max_turnover_percent,\r\n          maxTruckAge: cachedDriverProfile.max_truck_age_years,\r\n          fleetSize: cachedDriverProfile.fleet_size_preference,\r\n          completeness: cachedDriverProfile.profile_completeness_score,\r\n          totalSearches: cachedDriverProfile.total_searches\r\n        } : null\r\n      });\r\n\r\n    } catch (error) {\r\n      console.log('Login cancelled:', error);\r\n      sendToHtml('loginCancelled', {});\r\n    }\r\n  } else {\r\n    wixLocation.to(CONFIG.loginPageUrl);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// FIND MATCHES - Now returns profile info\r\n// ============================================================================\r\n\r\nasync function handleFindMatches(driverPrefs, userStatus) {\r\n  const isPremium = userStatus?.isPremium || false;\r\n\r\n  console.log('?? Running backend search with:', driverPrefs);\r\n  console.log('?? User tier:', userStatus?.tier || 'free', '| isPremium:', isPremium);\r\n\r\n  try {\r\n    // Call backend with premium flag\r\n    const result = await findMatchingCarriers(driverPrefs, isPremium);\r\n\r\n    if (!result.success) {\r\n      sendToHtml('matchError', { error: result.error });\r\n      return;\r\n    }\r\n\r\n    console.log(`?? Scored ${result.totalScored}, returning ${result.matches.length} (${result.userTier} tier)`);\r\n\r\n    // Update cached profile if returned\r\n    if (result.driverProfile) {\r\n      cachedDriverProfile = { ...cachedDriverProfile, ...result.driverProfile };\r\n    }\r\n\r\n    // Phase 1: Enrich with Mutual Interests (if logged in)\r\n    let enrichedMatches = result.matches;\r\n    if (userStatus?.userId || userStatus?.loggedIn) {\r\n      try {\r\n        const driverId = userStatus.userId || wixUsers.currentUser.id;\r\n        const interestResult = await getMutualInterestForDriver(driverId);\r\n\r\n        if (interestResult.success && interestResult.mutualInterests?.length > 0) {\r\n          console.log(`?? Found ${interestResult.mutualInterests.length} mutual matches`);\r\n\r\n          // Create lookup map for efficiency\r\n          const mutualMap = {};\r\n          interestResult.mutualInterests.forEach(m => {\r\n            mutualMap[String(m.carrierDot)] = m;\r\n          });\r\n\r\n          // Merge into matches\r\n          enrichedMatches = result.matches.map(match => {\r\n            const dot = String(match.carrier?.DOT_NUMBER);\r\n            if (mutualMap[dot]) {\r\n              return {\r\n                ...match,\r\n                isMutualMatch: true,\r\n                mutualStrength: mutualMap[dot].mutualStrength,\r\n                mutualSignals: mutualMap[dot].signals,\r\n                lastMutualActivity: mutualMap[dot].lastCarrierActivityDate\r\n              };\r\n            }\r\n            return match;\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error('Failed to fetch mutual interests:', err);\r\n        // Don't fail the search, just log and continue without mutual data\r\n      }\r\n    }\r\n\r\n    // Store results for later use (e.g., anonymous match explanations)\r\n    lastSearchResults = { ...result, matches: enrichedMatches };\r\n\r\n    // Handle enrichments  only auto-enrich the #1 match; rest are on-demand via button click\r\n    const needsEnrichment = result.matches.filter(m => m.needsEnrichment);\r\n    const autoEnrichDot = needsEnrichment.length > 0 ? String(needsEnrichment[0].carrier.DOT_NUMBER) : null;\r\n\r\n    // Send results with tier info AND profile info (include autoEnrichDot so HTML knows which card to show loading)\r\n    sendToHtml('matchResults', {\r\n      matches: enrichedMatches,\r\n      totalScored: result.totalScored,\r\n      userTier: result.userTier,\r\n      maxAllowed: result.maxAllowed,\r\n      totalMatches: result.totalMatches,\r\n      upsellMessage: result.upsellMessage,\r\n      isPremium: isPremium,\r\n      driverProfile: result.driverProfile,\r\n      autoEnrichDot\r\n    });\r\n\r\n    if (needsEnrichment.length > 0) {\r\n      console.log(`?? Auto-enriching top match (${needsEnrichment.length} total need enrichment)`);\r\n      const topMatch = needsEnrichment[0];\r\n      const dotNumber = topMatch.carrier.DOT_NUMBER;\r\n\r\n      sendToHtml('enrichmentUpdate', {\r\n        dot_number: dotNumber,\r\n        status: 'loading',\r\n        position: 1,\r\n        total: 1\r\n      });\r\n\r\n      const enrichment = await enrichWithRetry(dotNumber, topMatch.carrier, driverPrefs);\r\n\r\n      // Determine status: 'complete' (real data), 'building' (background in progress), or 'error'\r\n      let enrichStatus = 'complete';\r\n      if (enrichment.building) {\r\n        enrichStatus = 'building';\r\n      } else if (enrichment.error) {\r\n        enrichStatus = 'error';\r\n      }\r\n\r\n      sendToHtml('enrichmentUpdate', {\r\n        dot_number: dotNumber,\r\n        status: enrichStatus,\r\n        ...enrichment\r\n      });\r\n\r\n      sendToHtml('enrichmentComplete', { totalEnriched: 1 });\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('? Search error:', error);\r\n    sendToHtml('matchError', { error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// STAGGERED ENRICHMENT\r\n// ============================================================================\r\n\r\nasync function enrichCarriersSequentially(matches, driverPrefs) {\r\n  for (let i = 0; i < matches.length; i++) {\r\n    const match = matches[i];\r\n    const dotNumber = match.carrier.DOT_NUMBER;\r\n\r\n    console.log(`?? Enriching DOT: ${dotNumber} (${i + 1}/${matches.length})`);\r\n\r\n    sendToHtml('enrichmentUpdate', {\r\n      dot_number: dotNumber,\r\n      status: 'loading',\r\n      position: i + 1,\r\n      total: matches.length\r\n    });\r\n\r\n    const enrichment = await enrichWithRetry(dotNumber, match.carrier, driverPrefs);\r\n\r\n    sendToHtml('enrichmentUpdate', {\r\n      dot_number: dotNumber,\r\n      status: enrichment.error ? 'error' : 'complete',\r\n      ...enrichment\r\n    });\r\n\r\n    if (i < matches.length - 1) {\r\n      await delay(CONFIG.enrichmentDelayMs);\r\n    }\r\n  }\r\n\r\n  console.log('? All enrichments complete');\r\n  sendToHtml('enrichmentComplete', { totalEnriched: matches.length });\r\n}\r\n\r\nasync function enrichWithRetry(dotNumber, carrierData, driverPrefs) {\r\n  let lastError = null;\r\n\r\n  for (let attempt = 1; attempt <= CONFIG.maxRetries; attempt++) {\r\n    try {\r\n      return await enrichCarrier(dotNumber, carrierData, driverPrefs);\r\n    } catch (error) {\r\n      lastError = error;\r\n      console.error(`? Attempt ${attempt} failed for DOT ${dotNumber}:`, error.message);\r\n\r\n      if (attempt < CONFIG.maxRetries) {\r\n        const isRateLimit = error.message?.includes('429') || error.message?.toLowerCase().includes('rate');\r\n        await delay(isRateLimit ? CONFIG.retryDelayMs * 2 : CONFIG.retryDelayMs);\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    dot_number: String(dotNumber),\r\n    error: true,\r\n    errorMessage: lastError?.message || 'Enrichment failed',\r\n    ai_summary: 'AI enrichment unavailable. Check FMCSA records directly.',\r\n    data_confidence: 'None'\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// RETRY SINGLE ENRICHMENT\r\n// ============================================================================\r\n\r\nasync function handleRetryEnrichment(data) {\r\n  const dotNumber = data.dot || data.dot_number;\r\n  if (!dotNumber) return;\r\n\r\n  console.log(`?? Retrying enrichment for DOT: ${dotNumber}`);\r\n\r\n  sendToHtml('enrichmentUpdate', { dot_number: dotNumber, status: 'loading', message: 'Retrying...' });\r\n\r\n  await delay(2000);\r\n\r\n  try {\r\n    // Look up full carrier data from last search results so enrichment has the carrier name\r\n    const matchData = lastSearchResults?.matches?.find(\r\n      m => String(m.carrier?.DOT_NUMBER) === String(dotNumber)\r\n    );\r\n    const carrierData = matchData?.carrier || { DOT_NUMBER: dotNumber };\r\n    const enrichment = await enrichCarrier(dotNumber, carrierData, {});\r\n    sendToHtml('enrichmentUpdate', { dot_number: dotNumber, status: 'complete', ...enrichment });\r\n  } catch (error) {\r\n    sendToHtml('enrichmentUpdate', {\r\n      dot_number: dotNumber,\r\n      status: 'error',\r\n      error: true,\r\n      ai_summary: 'Retry failed. Check FMCSA directly.'\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// LOG INTEREST - Now updates driver profile\r\n// ============================================================================\r\n\r\nasync function handleLogInterest(data) {\r\n  console.log('?? Logging interest:', data.carrierName);\r\n\r\n  const INTEREST_TIMEOUT_MS = 10000;\r\n\r\n  try {\r\n    const result = await Promise.race([\r\n      logMatchEvent({\r\n        carrierDOT: data.carrierDOT,\r\n        carrierName: data.carrierName,\r\n        driverZip: data.driverZip,\r\n        driverName: data.driverName,\r\n        matchScore: data.matchScore,\r\n        action: 'interested'\r\n      }),\r\n      new Promise(resolve =>\r\n        setTimeout(() => resolve({ success: true, method: 'optimistic', timedOut: true }), INTEREST_TIMEOUT_MS)\r\n      )\r\n    ]);\r\n\r\n    if (result.timedOut) {\r\n      console.log('?? Interest save timed out  responding optimistically');\r\n    }\r\n\r\n    if (result.success) {\r\n      sendToHtml('interestLogged', {\r\n        success: true,\r\n        carrierDOT: data.carrierDOT,\r\n        method: result.method,\r\n        isNew: result.isNew\r\n      });\r\n    } else {\r\n      console.log('?? Interest logging failed:', result.error);\r\n      sendToHtml('interestLogged', {\r\n        success: false,\r\n        carrierDOT: data.carrierDOT,\r\n        error: result.error || 'Failed to save interest'\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error logging interest:', error);\r\n    sendToHtml('interestLogged', {\r\n      success: false,\r\n      carrierDOT: data.carrierDOT,\r\n      error: error.message || 'Unexpected error'\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// NEW: Profile Handlers\r\n// ============================================================================\r\n\r\nasync function handleGetDriverProfile() {\r\n  try {\r\n    const profileResult = await getOrCreateDriverProfile();\r\n\r\n    if (profileResult.success) {\r\n      cachedDriverProfile = profileResult.profile;\r\n      sendToHtml('driverProfileLoaded', {\r\n        success: true,\r\n        profile: {\r\n          id: cachedDriverProfile._id,\r\n          displayName: cachedDriverProfile.display_name,\r\n          email: cachedDriverProfile.email,\r\n          homeZip: cachedDriverProfile.home_zip,\r\n          maxDistance: cachedDriverProfile.max_commute_miles,\r\n          minCPM: cachedDriverProfile.min_cpm,\r\n          operationType: cachedDriverProfile.preferred_operation_type,\r\n          maxTurnover: cachedDriverProfile.max_turnover_percent,\r\n          maxTruckAge: cachedDriverProfile.max_truck_age_years,\r\n          fleetSize: cachedDriverProfile.fleet_size_preference,\r\n          yearsExperience: cachedDriverProfile.years_experience,\r\n          cdlClass: cachedDriverProfile.cdl_class,\r\n          endorsements: cachedDriverProfile.endorsements,\r\n          cleanMVR: cachedDriverProfile.clean_mvr,\r\n          completeness: cachedDriverProfile.profile_completeness_score,\r\n          totalSearches: cachedDriverProfile.total_searches,\r\n          isComplete: cachedDriverProfile.is_complete,\r\n          isDiscoverable: cachedDriverProfile.is_discoverable,\r\n          missingFields: cachedDriverProfile.missing_fields,\r\n          cdl_front_image: cachedDriverProfile.cdl_front_image,\r\n          cdl_back_image: cachedDriverProfile.cdl_back_image,\r\n          med_card_image: cachedDriverProfile.med_card_image,\r\n          resume_file: cachedDriverProfile.resume_file\r\n        },\r\n        isNew: profileResult.isNew\r\n      });\r\n    } else {\r\n      sendToHtml('driverProfileLoaded', { success: false, error: profileResult.error });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error getting profile:', error);\r\n    sendToHtml('driverProfileLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetSavedCarriers() {\r\n  try {\r\n    const result = await getDriverSavedCarriers();\r\n\r\n    sendToHtml('savedCarriersLoaded', {\r\n      success: result.success,\r\n      carriers: result.carriers,\r\n      totalCount: result.totalCount,\r\n      error: result.error\r\n    });\r\n  } catch (error) {\r\n    console.error('Error getting saved carriers:', error);\r\n    sendToHtml('savedCarriersLoaded', { success: false, carriers: [], error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleToggleDiscoverability(data) {\r\n  try {\r\n    const result = await setDiscoverability(data.isDiscoverable);\r\n\r\n    if (result.success) {\r\n      cachedDriverProfile = result.profile;\r\n      sendToHtml('discoverabilityUpdated', {\r\n        success: true,\r\n        isDiscoverable: result.profile.is_discoverable\r\n      });\r\n    } else {\r\n      sendToHtml('discoverabilityUpdated', { success: false, error: result.error });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error toggling discoverability:', error);\r\n    sendToHtml('discoverabilityUpdated', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n\r\nasync function handleSaveProfileDocs(data) {\r\n  try {\r\n    const result = await updateDriverDocuments(data);\r\n\r\n    if (result.success) {\r\n      cachedDriverProfile = result.profile;\r\n\r\n      // Send success back to HTML to close modal\r\n      sendToHtml('profileSaved', {\r\n        success: true,\r\n        profile: {\r\n          completeness: cachedDriverProfile.profile_completeness_score,\r\n          missingFields: cachedDriverProfile.missing_fields,\r\n          cdl_front_image: cachedDriverProfile.cdl_front_image,\r\n          cdl_back_image: cachedDriverProfile.cdl_back_image,\r\n          med_card_image: cachedDriverProfile.med_card_image,\r\n          resume_file: cachedDriverProfile.resume_file\r\n        }\r\n      });\r\n\r\n      // Update HTML with new profile state\r\n      sendToHtml('driverProfileLoaded', {\r\n        success: true,\r\n        profile: {\r\n          id: cachedDriverProfile._id,\r\n          displayName: cachedDriverProfile.display_name,\r\n          homeZip: cachedDriverProfile.home_zip,\r\n          completeness: cachedDriverProfile.profile_completeness_score,\r\n          missingFields: cachedDriverProfile.missing_fields,\r\n          cdl_front_image: cachedDriverProfile.cdl_front_image,\r\n          cdl_back_image: cachedDriverProfile.cdl_back_image,\r\n          med_card_image: cachedDriverProfile.med_card_image,\r\n          resume_file: cachedDriverProfile.resume_file\r\n        }\r\n      });\r\n\r\n    } else {\r\n      sendToHtml('profileSaved', { success: false, error: result.error });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error saving profile docs:', error);\r\n    sendToHtml('profileSaved', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// REAL-TIME OCR FOR FORM AUTO-FILL\r\n// ============================================================================\r\n\r\nasync function handleExtractDocumentOCR(data) {\r\n  if (!data || !data.base64Data || !data.docType) {\r\n    sendToHtml('ocrResult', {\r\n      success: false,\r\n      docType: data?.docType,\r\n      error: 'Missing document data or type'\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.log(`?? Real-time OCR requested for ${data.docType}`);\r\n\r\n  try {\r\n    const result = await extractDocumentForAutoFill(data.base64Data, data.docType);\r\n\r\n    console.log(`?? OCR Result for ${data.docType}:`, result.success ? 'Success' : 'Failed');\r\n\r\n    sendToHtml('ocrResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('? OCR extraction error:', error);\r\n    sendToHtml('ocrResult', {\r\n      success: false,\r\n      docType: data.docType,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// UTILITIES\r\n// ============================================================================\r\n\r\nfunction sendToHtml(type, data) {\r\n  // Validate outbound message is registered\r\n  if (!MESSAGE_REGISTRY.outbound.includes(type)) {\r\n    console.warn(`?? UNREGISTERED OUTBOUND MESSAGE: \"${type}\" - Add to MESSAGE_REGISTRY.outbound`);\r\n  }\r\n\r\n  logMessageFlow('out', type, data);\r\n\r\n  try {\r\n    const component = getComponent();\r\n    if (component && typeof component.postMessage === 'function') {\r\n      component.postMessage({ type, data, timestamp: Date.now() });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error sending to HTML:', error);\r\n  }\r\n}\r\n\r\nfunction delay(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\n// ============================================================================\r\n// APPLICATION SUBMISSION HANDLER\r\n// ============================================================================\r\n\r\nasync function handleSubmitApplication(data) {\r\n  if (!data || !data.carrierDOT) {\r\n    sendToHtml('applicationSubmitted', { success: false, error: 'Missing carrier information' });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    console.log('?? Submitting application to carrier:', data.carrierDOT);\r\n\r\n    // Pass ALL form data to backend (don't filter - let backend handle it)\r\n    const result = await submitApplication({\r\n      // Carrier info\r\n      carrierDOT: data.carrierDOT,\r\n      carrierName: data.carrierName,\r\n      matchScore: data.matchScore,\r\n\r\n      // Driver identity (NEW)\r\n      firstName: data.firstName,\r\n      lastName: data.lastName,\r\n      dob: data.dob,  // Date of Birth - CRITICAL FIX\r\n\r\n      // Contact info\r\n      phone: data.phone,\r\n      email: data.email,\r\n      preferredContact: data.preferredContact,\r\n\r\n      // Location (NEW)\r\n      city: data.city,\r\n      state: data.state,\r\n      homeZip: data.homeZip,\r\n\r\n      // CDL info\r\n      cdlNumber: data.cdlNumber,\r\n      cdlExpiration: data.cdlExpiration,\r\n      cdlClass: data.cdlClass,           // NEW\r\n      endorsements: data.endorsements,   // NEW - array\r\n      medCardExpiration: data.medCardExpiration,\r\n\r\n      // Experience (NEW)\r\n      yearsExperience: data.yearsExperience,\r\n      equipmentExperience: data.equipmentExperience,  // NEW - array\r\n      mvrStatus: data.mvrStatus,                      // NEW\r\n\r\n      // Safety & Compliance (NEW)\r\n      accidentsLast3Years: data.accidentsLast3Years,\r\n      violationsLast3Years: data.violationsLast3Years,\r\n      cdlRestrictions: data.cdlRestrictions,\r\n\r\n      // Employment History (NEW)\r\n      companiesLast3Years: data.companiesLast3Years,\r\n      employer1Name: data.employer1Name,\r\n      employer1Duration: data.employer1Duration,\r\n      employer2Name: data.employer2Name,\r\n      employer2Duration: data.employer2Duration,\r\n      employer3Name: data.employer3Name,\r\n      employer3Duration: data.employer3Duration,\r\n\r\n      // Preferences (NEW)\r\n      preferredRoutes: data.preferredRoutes,          // NEW - array\r\n      homeTimePreference: data.homeTimePreference,    // NEW\r\n      availability: data.availability,\r\n\r\n      // Message\r\n      message: data.message,\r\n\r\n      // Documents\r\n      documents: data.documents,\r\n      existingProfileDocs: data.existingProfileDocs\r\n    });\r\n\r\n    if (result.success) {\r\n      console.log('? Application submitted successfully');\r\n      sendToHtml('applicationSubmitted', {\r\n        success: true,\r\n        carrierDOT: data.carrierDOT,\r\n        carrierName: data.carrierName,\r\n        status: 'applied'\r\n      });\r\n    } else {\r\n      console.error('? Application failed:', result.error);\r\n      sendToHtml('applicationSubmitted', {\r\n        success: false,\r\n        error: result.error\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.error('? Application error:', error);\r\n    sendToHtml('applicationSubmitted', {\r\n      success: false,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// APPLICATION HISTORY HANDLER\r\n// ============================================================================\r\n\r\nasync function handleGetDriverApplications() {\r\n  try {\r\n    const userStatus = await getUserStatus();\r\n\r\n    if (!userStatus.loggedIn) {\r\n      sendToHtml('driverApplications', []); // Return empty if not logged in\r\n      return;\r\n    }\r\n\r\n    const driverId = userStatus.userId;\r\n    console.log('?? Fetching applications for driver:', driverId);\r\n\r\n    const result = await getDriverApplications(driverId);\r\n\r\n    // Check if result is array (old format) or object (new format)\r\n    // Based on previous step, it returns the applications directly if successful, \r\n    // or we might need to handle success/error wrapper if the service was written that way.\r\n    // Checking service impl: \r\n    // It returns `applications.map(...)`. So it returns an array directly.\r\n    // Wait, let's be safe.\r\n\r\n    // Looking at applicationService.jsw in diffs:\r\n    // export async function getDriverApplications(driverId) { ... return formattedApps; }\r\n    // It returns an array.\r\n\r\n    sendToHtml('driverApplications', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error getting driver applications:', error);\r\n    // Send empty array on error to allow graceful degradation\r\n    sendToHtml('driverApplications', []);\r\n  }\r\n}\r\n\r\nasync function handleGetMutualInterest(data) {\r\n  try {\r\n    const driverId = data.driverId || (wixUsers && wixUsers.currentUser.id);\r\n    if (!driverId) return;\r\n\r\n    console.log('?? Fetching mutual interests for:', driverId);\r\n    const result = await getMutualInterestForDriver(driverId);\r\n\r\n    if (result.success) {\r\n      sendToHtml('mutualInterestData', {\r\n        interests: result.mutualInterests || []\r\n      });\r\n    } else {\r\n      console.warn('Mutual interest fetch returned unsuccessful:', result);\r\n      sendToHtml('mutualInterestData', { interests: [] });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error handling mutual interest request:', error);\r\n    sendToHtml('mutualInterestData', { interests: [], error: error.message });\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\AI vs Traditional Recruiting Methods.z4qqg.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ALLURE Onboarding.u45iu.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\ALLURE Refrigerated-Premium Opportunity.bg2us.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\API_CHANGELOG.external.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\API_DOCS_PORTAL.external.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\API_PORTAL_DASHBOARD.external.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\API_STATUS.external.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\About.dkz1k.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":144,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":144,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4275,4276],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":160,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":160,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4703,4704],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":173,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":173,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5036,5037],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":180,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":180,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5270,5271],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * About Page\r\n * Company story, team, mission, and live platform credibility stats\r\n *\r\n * @see docs/PAGE_DATA_IMPLEMENTATION_GUIDE.md\r\n */\r\n\r\nimport { getPublicStats, getPartnerLogos } from 'backend/publicStatsService';\r\nimport { getTeamMembers, getCompanyMilestones } from 'backend/contentService';\r\n\r\n$w.onReady(async function () {\r\n  await Promise.all([\r\n    loadImpactStats(),\r\n    loadTeamMembers(),\r\n    loadCompanyMilestones(),\r\n    loadPartnerLogos()\r\n  ]);\r\n});\r\n\r\n/**\r\n * Load and animate impact stats\r\n * Elements: #statDriversHelped, #statCarriersPartners, #statStatesServed, #statYearsInBusiness\r\n */\r\nasync function loadImpactStats() {\r\n  try {\r\n    const stats = await getPublicStats();\r\n\r\n    // Animate counters for visual impact\r\n    animateCounter('#statDriversHelped', stats.driversPlaced);\r\n    animateCounter('#statCarriersPartners', stats.activeCarriers);\r\n    animateCounter('#statStatesServed', 48); // Continental US\r\n    animateCounter('#statYearsInBusiness', calculateYearsInBusiness());\r\n\r\n    // Send to HTML component if exists\r\n    try {\r\n      const htmlStats = $w('#impactStatsHtml');\r\n      if (htmlStats.rendered && htmlStats.postMessage) {\r\n        htmlStats.postMessage({\r\n          type: 'impactStats',\r\n          data: {\r\n            driversHelped: stats.driversPlaced,\r\n            carriersPartners: stats.activeCarriers,\r\n            statesServed: 48,\r\n            yearsInBusiness: calculateYearsInBusiness()\r\n          }\r\n        });\r\n      }\r\n    } catch (e) {\r\n      // HTML component may not exist\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load impact stats:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Animate a counter from 0 to target value\r\n */\r\nfunction animateCounter(selector, targetValue) {\r\n  try {\r\n    const element = $w(selector);\r\n    if (!element || element.text === undefined) return;\r\n\r\n    let current = 0;\r\n    const increment = Math.ceil(targetValue / 50);\r\n    const timer = setInterval(() => {\r\n      current += increment;\r\n      if (current >= targetValue) {\r\n        current = targetValue;\r\n        clearInterval(timer);\r\n      }\r\n      element.text = current.toLocaleString();\r\n    }, 30);\r\n  } catch (e) {\r\n    // Element may not exist\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate years in business\r\n */\r\nfunction calculateYearsInBusiness() {\r\n  const founded = new Date('2020-01-01'); // Update with actual founding date\r\n  const now = new Date();\r\n  return Math.floor((now - founded) / (365.25 * 24 * 60 * 60 * 1000));\r\n}\r\n\r\n/**\r\n * Load team members\r\n * Element: #teamRepeater\r\n */\r\nasync function loadTeamMembers() {\r\n  try {\r\n    const result = await getTeamMembers();\r\n\r\n    if (!result.success || result.members.length === 0) {\r\n      // Hide team section if no data\r\n      try {\r\n        const section = $w('#teamSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) {\r\n        // Section may not exist\r\n      }\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#teamRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = result.members;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#memberName').rendered) $item('#memberName').text = itemData.name;\r\n          if ($item('#memberTitle').rendered) $item('#memberTitle').text = itemData.title;\r\n          if ($item('#memberBio').rendered) $item('#memberBio').text = itemData.bio;\r\n          if ($item('#memberPhoto').rendered && itemData.photoUrl) {\r\n            $item('#memberPhoto').src = itemData.photoUrl;\r\n          }\r\n\r\n          // LinkedIn link\r\n          if (itemData.linkedIn) {\r\n            try {\r\n              const linkedInLink = $item('#linkedInLink');\r\n              if (linkedInLink.rendered) {\r\n                linkedInLink.link = itemData.linkedIn;\r\n                linkedInLink.show();\r\n              }\r\n            } catch (e) {\r\n              // Element may not exist\r\n            }\r\n          }\r\n        } catch (e) {\r\n          // Element may not exist\r\n        }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load team members:', err);\r\n    try {\r\n      const section = $w('#teamSection');\r\n      if (section.rendered && section.collapse) section.collapse();\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\n/**\r\n * Load company milestones for timeline\r\n * Element: #timelineHtml (HTML component)\r\n */\r\nasync function loadCompanyMilestones() {\r\n  try {\r\n    const result = await getCompanyMilestones();\r\n\r\n    if (!result.success || result.milestones.length === 0) {\r\n      try {\r\n        const section = $w('#milestonesSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    // Send to HTML timeline component\r\n    try {\r\n      const htmlTimeline = $w('#timelineHtml');\r\n      if (htmlTimeline.rendered && htmlTimeline.postMessage) {\r\n        htmlTimeline.postMessage({\r\n          type: 'milestones',\r\n          data: result.milestones\r\n        });\r\n      }\r\n    } catch (e) { }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load company milestones:', err);\r\n    try {\r\n      const section = $w('#milestonesSection');\r\n      if (section.rendered && section.collapse) section.collapse();\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\n/**\r\n * Load partner/client logos for \"Trusted By\" section\r\n * Element: #partnerLogosRepeater\r\n */\r\nasync function loadPartnerLogos() {\r\n  try {\r\n    const logos = await getPartnerLogos(12);\r\n\r\n    if (logos.length === 0) {\r\n      // Hide partner logos section if no data\r\n      try {\r\n        const section = $w('#partnersSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) {\r\n        // Section may not exist\r\n      }\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#partnerLogosRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = logos;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#partnerLogo').rendered && itemData.logoUrl) {\r\n            $item('#partnerLogo').src = itemData.logoUrl;\r\n            $item('#partnerLogo').alt = itemData.name;\r\n          }\r\n          if ($item('#partnerName').rendered) {\r\n            $item('#partnerName').text = itemData.name;\r\n          }\r\n        } catch (e) {\r\n          // Element may not exist\r\n        }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load partner logos:', err);\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Admin_Portal_Dashboard.g308x.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Apply for CDL Driving Jobs.e4a6t.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_ACCOUNT_DETAIL.f31mi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_ANALYTICS.ab55b.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_CAMPAIGNS.rhlno.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_DASHBOARD.i5csc.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_LEAD_CAPTURE.jf8ac.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_OUTREACH.y9tsi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_PIPELINE.qsh6m.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\B2B_RESEARCH_PANEL.mz9zk.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getBrief' is defined but never used.","line":9,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * B2B_RESEARCH_PANEL Page Code\r\n * Bridges B2B_RESEARCH_PANEL.html with b2bResearchAgentService.\r\n *\r\n * HTML sends (action key): generateBrief\r\n * HTML expects: init (with accountId), briefLoaded, briefGenerating, actionError\r\n */\r\n\r\nimport { generateBrief, getBrief } from 'backend/b2bResearchAgentService';\r\nimport wixLocationFrontend from 'wix-location-frontend';\r\n\r\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\r\n\r\nfunction safeSend(component, data) {\r\n    try {\r\n        component.postMessage(data);\r\n    } catch (err) {\r\n        console.error('B2B_RESEARCH_PANEL: safeSend failed:', err);\r\n    }\r\n}\r\n\r\n$w.onReady(function () {\r\n    const component = findHtmlComponent();\r\n    if (!component) {\r\n        console.warn('B2B_RESEARCH_PANEL: No HTML component found');\r\n        return;\r\n    }\r\n\r\n    component.onMessage(async (event) => {\r\n        const msg = event && event.data;\r\n        if (!msg || !msg.action) return;\r\n        await routeMessage(component, msg);\r\n    });\r\n\r\n    // Pass accountId from URL query params to the HTML\r\n    const query = wixLocationFrontend.query;\r\n    const accountId = query.accountId || '';\r\n\r\n    safeSend(component, { action: 'init', accountId });\r\n});\r\n\r\nfunction findHtmlComponent() {\r\n    for (const id of HTML_COMPONENT_IDS) {\r\n        try {\r\n            const el = $w(id);\r\n            if (el && typeof el.onMessage === 'function') {\r\n                return el;\r\n            }\r\n        } catch (e) {\r\n            // Element not present\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nasync function routeMessage(component, msg) {\r\n    switch (msg.action) {\r\n        case 'generateBrief':\r\n            await handleGenerateBrief(component, msg);\r\n            break;\r\n        default:\r\n            console.warn('B2B_RESEARCH_PANEL: Unknown action:', msg.action);\r\n    }\r\n}\r\n\r\nasync function handleGenerateBrief(component, msg) {\r\n    try {\r\n        if (!msg.accountId) {\r\n            safeSend(component, { action: 'actionError', message: 'No account selected.' });\r\n            return;\r\n        }\r\n\r\n        safeSend(component, { action: 'briefGenerating' });\r\n\r\n        const result = await generateBrief(msg.accountId, !!msg.forceRefresh);\r\n\r\n        safeSend(component, {\r\n            action: 'briefLoaded',\r\n            payload: {\r\n                brief: result.brief || result,\r\n                cached: !!result.cached\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error('B2B_RESEARCH_PANEL: generateBrief error:', error);\r\n        safeSend(component, { action: 'actionError', message: 'Failed to generate brief.' });\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Blog.b06oz.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_ANNOUNCEMENTS.zmhem.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":32,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":99,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":99,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3040,3041],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * CARRIER_ANNOUNCEMENTS Page Code\r\n * Handles PostMessage bridge for carrier announcements management\r\n */\r\n\r\nimport {\r\n  createAnnouncement,\r\n  updateAnnouncement,\r\n  publishAnnouncement,\r\n  scheduleAnnouncement,\r\n  archiveAnnouncement,\r\n  previewRecipients,\r\n  uploadAttachment,\r\n  getAnnouncementsForCarrier,\r\n  getCarrierContextForCurrentUser,\r\n  getAnnouncementDetail,\r\n  sendReminderToUnreadDrivers,\r\n  setCommentVisibility\r\n} from 'backend/carrierAnnouncementsService.jsw';\r\n\r\n// ============================================================================\r\n// CONFIGURATION\r\n// ============================================================================\r\nconst CONFIG = {\r\n  htmlComponentId: 'html1',\r\n  debugMessages: true\r\n};\r\n\r\n// ============================================================================\r\n// MESSAGE REGISTRY\r\n// ============================================================================\r\nconst MESSAGE_REGISTRY = {\r\n  inbound: [\r\n    'carrierAnnouncementsReady',\r\n    'getCarrierAnnouncements',\r\n    'createAnnouncement',\r\n    'updateAnnouncement',\r\n    'publishAnnouncement',\r\n    'scheduleAnnouncement',\r\n    'archiveAnnouncement',\r\n    'previewRecipients',\r\n    'uploadAnnouncementAttachment',\r\n    'getAnnouncementDetail',\r\n    'sendAnnouncementReminder',\r\n    'setAnnouncementCommentVisibility'\r\n  ],\r\n  outbound: [\r\n    'carrierAnnouncementsData',\r\n    'announcementActionResult',\r\n    'recipientPreviewResult',\r\n    'announcementAttachmentResult',\r\n    'carrierContext',\r\n    'announcementDetailData',\r\n    'announcementReminderResult',\r\n    'announcementCommentModerationResult'\r\n  ]\r\n};\r\n\r\n// ============================================================================\r\n// GLOBAL STATE\r\n// ============================================================================\r\nlet carrierId = null;\r\n\r\n// ============================================================================\r\n// PAGE INITIALIZATION\r\n// ============================================================================\r\n$w.onReady(async function () {\r\n  console.log('CARRIER_ANNOUNCEMENTS page ready');\r\n\r\n  const htmlComponent = getHtmlComponent();\r\n  if (!htmlComponent) {\r\n    console.error('HTML component not found');\r\n    return;\r\n  }\r\n\r\n  // Get carrier context on page load\r\n  const ctx = await getCarrierContextForCurrentUser();\r\n  if (ctx.success) {\r\n    carrierId = ctx.carrierId;\r\n  }\r\n\r\n  htmlComponent.onMessage((event) => {\r\n    handleMessage(event.data);\r\n  });\r\n});\r\n\r\n// ============================================================================\r\n// HTML COMPONENT FINDER\r\n// ============================================================================\r\nfunction getHtmlComponent() {\r\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\r\n  for (const id of possibleIds) {\r\n    try {\r\n      const el = $w(`#${id}`);\r\n      if (el && typeof el.onMessage === 'function') {\r\n        CONFIG.htmlComponentId = id;\r\n        return el;\r\n      }\r\n    } catch (e) { }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction getComponent() {\r\n  return $w(`#${CONFIG.htmlComponentId}`);\r\n}\r\n\r\n// ============================================================================\r\n// MESSAGE HANDLER\r\n// ============================================================================\r\nasync function handleMessage(msg) {\r\n  if (!msg || !msg.type) return;\r\n\r\n  const action = msg.type;\r\n  if (CONFIG.debugMessages) {\r\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\r\n  }\r\n\r\n  switch (action) {\r\n    case 'carrierAnnouncementsReady':\r\n      console.log('Carrier Announcements HTML ready');\r\n      if (carrierId) {\r\n        sendToHtml('carrierContext', { carrierId });\r\n      }\r\n      break;\r\n\r\n    case 'getCarrierAnnouncements':\r\n      await handleGetCarrierAnnouncements(msg.data);\r\n      break;\r\n\r\n    case 'createAnnouncement':\r\n      await handleCreateAnnouncement(msg.data);\r\n      break;\r\n\r\n    case 'updateAnnouncement':\r\n      await handleUpdateAnnouncement(msg.data);\r\n      break;\r\n\r\n    case 'publishAnnouncement':\r\n      await handlePublishAnnouncement(msg.data);\r\n      break;\r\n\r\n    case 'scheduleAnnouncement':\r\n      await handleScheduleAnnouncement(msg.data);\r\n      break;\r\n\r\n    case 'archiveAnnouncement':\r\n      await handleArchiveAnnouncement(msg.data);\r\n      break;\r\n\r\n    case 'previewRecipients':\r\n      await handlePreviewRecipients(msg.data);\r\n      break;\r\n\r\n    case 'uploadAnnouncementAttachment':\r\n      await handleUploadAttachment(msg.data);\r\n      break;\r\n\r\n    case 'getAnnouncementDetail':\r\n      await handleGetAnnouncementDetail(msg.data);\r\n      break;\r\n\r\n    case 'sendAnnouncementReminder':\r\n      await handleSendAnnouncementReminder(msg.data);\r\n      break;\r\n\r\n    case 'setAnnouncementCommentVisibility':\r\n      await handleSetCommentVisibility(msg.data);\r\n      break;\r\n\r\n    default:\r\n      console.log('Unknown message type:', action);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLERS\r\n// ============================================================================\r\nasync function handleGetCarrierAnnouncements(data) {\r\n  try {\r\n    const cid = data?.carrierId || carrierId;\r\n    if (!cid) {\r\n      sendToHtml('carrierAnnouncementsData', { success: false, error: 'No carrier context' });\r\n      return;\r\n    }\r\n\r\n    carrierId = cid;\r\n\r\n    const options = {\r\n      status: data?.status || 'published',\r\n      limit: data?.limit || 100,\r\n      offset: data?.offset || 0\r\n    };\r\n\r\n    const result = await getAnnouncementsForCarrier(cid, options);\r\n\r\n    sendToHtml('carrierAnnouncementsData', {\r\n      success: result.success,\r\n      announcements: result.success ? result.announcements : [],\r\n      totalCount: result.totalCount || 0,\r\n      error: result.error\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Error fetching carrier announcements:', error);\r\n    sendToHtml('carrierAnnouncementsData', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleCreateAnnouncement(data) {\r\n  try {\r\n    if (!data) {\r\n      sendToHtml('announcementActionResult', { success: false, error: 'No data provided' });\r\n      return;\r\n    }\r\n\r\n    // Use carrierId from data or global state\r\n    const announcementData = {\r\n      ...data,\r\n      carrier_id: data.carrier_id || carrierId\r\n    };\r\n\r\n    const result = await createAnnouncement(announcementData);\r\n    sendToHtml('announcementActionResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error creating announcement:', error);\r\n    sendToHtml('announcementActionResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleUpdateAnnouncement(data) {\r\n  try {\r\n    const { announcementId, updates } = data || {};\r\n\r\n    if (!announcementId || !updates) {\r\n      sendToHtml('announcementActionResult', { success: false, error: 'Missing required fields' });\r\n      return;\r\n    }\r\n\r\n    const result = await updateAnnouncement(announcementId, updates);\r\n    sendToHtml('announcementActionResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error updating announcement:', error);\r\n    sendToHtml('announcementActionResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handlePublishAnnouncement(data) {\r\n  try {\r\n    const { announcementId } = data || {};\r\n\r\n    if (!announcementId) {\r\n      sendToHtml('announcementActionResult', { success: false, error: 'Missing announcement ID' });\r\n      return;\r\n    }\r\n\r\n    const result = await publishAnnouncement(announcementId);\r\n    sendToHtml('announcementActionResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error publishing announcement:', error);\r\n    sendToHtml('announcementActionResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleScheduleAnnouncement(data) {\r\n  try {\r\n    const { announcementId, scheduledAt } = data || {};\r\n\r\n    if (!announcementId || !scheduledAt) {\r\n      sendToHtml('announcementActionResult', { success: false, error: 'Missing required fields' });\r\n      return;\r\n    }\r\n\r\n    const result = await scheduleAnnouncement(announcementId, scheduledAt);\r\n    sendToHtml('announcementActionResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error scheduling announcement:', error);\r\n    sendToHtml('announcementActionResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleArchiveAnnouncement(data) {\r\n  try {\r\n    const { announcementId } = data || {};\r\n\r\n    if (!announcementId) {\r\n      sendToHtml('announcementActionResult', { success: false, error: 'Missing announcement ID' });\r\n      return;\r\n    }\r\n\r\n    const result = await archiveAnnouncement(announcementId);\r\n    sendToHtml('announcementActionResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error archiving announcement:', error);\r\n    sendToHtml('announcementActionResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handlePreviewRecipients(data) {\r\n  try {\r\n    const cid = data?.carrierId || carrierId;\r\n    const targetAudience = data?.targetAudience || { type: 'all', segments: [] };\r\n\r\n    if (!cid) {\r\n      sendToHtml('recipientPreviewResult', { success: false, error: 'No carrier context' });\r\n      return;\r\n    }\r\n\r\n    const result = await previewRecipients(cid, targetAudience);\r\n    sendToHtml('recipientPreviewResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error previewing recipients:', error);\r\n    sendToHtml('recipientPreviewResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleUploadAttachment(data) {\r\n  try {\r\n    const { base64Data, fileName, mimeType, carrierId: cid } = data || {};\r\n\r\n    if (!base64Data || !fileName || !mimeType) {\r\n      sendToHtml('announcementAttachmentResult', { success: false, error: 'Missing required fields' });\r\n      return;\r\n    }\r\n\r\n    const result = await uploadAttachment(base64Data, fileName, mimeType, cid || carrierId);\r\n    sendToHtml('announcementAttachmentResult', result);\r\n\r\n  } catch (error) {\r\n    console.error('Error uploading attachment:', error);\r\n    sendToHtml('announcementAttachmentResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// UTILITIES\r\n// ============================================================================\r\nfunction sendToHtml(type, data) {\r\n  if (CONFIG.debugMessages) {\r\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\r\n  }\r\n\r\n  try {\r\n    const component = getComponent();\r\n    if (component && typeof component.postMessage === 'function') {\r\n      component.postMessage({ type, data, timestamp: Date.now() });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error sending to HTML:', error);\r\n  }\r\n}\r\n\r\n\r\nasync function handleGetAnnouncementDetail(data) {\r\n  try {\r\n    const announcementId = data?.announcementId;\r\n    const cid = data?.carrierId || carrierId;\r\n    if (!announcementId || !cid) {\r\n      sendToHtml('announcementDetailData', { success: false, error: 'Missing announcementId or carrierId' });\r\n      return;\r\n    }\r\n\r\n    const result = await getAnnouncementDetail(announcementId, cid, {\r\n      limit: data?.limit || 50,\r\n      offset: data?.offset || 0,\r\n      includeHiddenComments: !!data?.includeHiddenComments\r\n    });\r\n\r\n    sendToHtml('announcementDetailData', result);\r\n  } catch (error) {\r\n    console.error('Error fetching announcement detail:', error);\r\n    sendToHtml('announcementDetailData', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleSendAnnouncementReminder(data) {\r\n  try {\r\n    const announcementId = data?.announcementId;\r\n    const cid = data?.carrierId || carrierId;\r\n    if (!announcementId || !cid) {\r\n      sendToHtml('announcementReminderResult', { success: false, error: 'Missing announcementId or carrierId' });\r\n      return;\r\n    }\r\n\r\n    const result = await sendReminderToUnreadDrivers(announcementId, cid);\r\n    sendToHtml('announcementReminderResult', result);\r\n  } catch (error) {\r\n    console.error('Error sending reminder:', error);\r\n    sendToHtml('announcementReminderResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleSetCommentVisibility(data) {\r\n  try {\r\n    const commentId = data?.commentId;\r\n    const hidden = !!data?.hidden;\r\n    if (!commentId) {\r\n      sendToHtml('announcementCommentModerationResult', { success: false, error: 'Missing commentId' });\r\n      return;\r\n    }\r\n\r\n    const result = await setCommentVisibility(commentId, hidden);\r\n    sendToHtml('announcementCommentModerationResult', result);\r\n  } catch (error) {\r\n    console.error('Error moderating comment:', error);\r\n    sendToHtml('announcementCommentModerationResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_COMPLIANCE_CALENDAR.ww0h3.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_CSA_MONITOR.bov8u.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_DOCUMENT_VAULT.yl5oe.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_DQ_TRACKER.sb2ig.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_FLEET_DASHBOARD.unified.js","messages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":53,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":53,"endColumn":89},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":57,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":57,"endColumn":86},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":61,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":61,"endColumn":101},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":67,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":67,"endColumn":92},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":71,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":71,"endColumn":95},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":72,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":72,"endColumn":98},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":76,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":76,"endColumn":128},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":86,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":86,"endColumn":115},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":87,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":87,"endColumn":87},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":91,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":91,"endColumn":114},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":95,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":95,"endColumn":125},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":101,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":101,"endColumn":107},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":106,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":106,"endColumn":123},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":110,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":110,"endColumn":96},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":116,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":116,"endColumn":82}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { currentMember } from 'wix-members-backend';\nimport * as fleetService from 'backend/fleetService';\nimport * as equipmentService from 'backend/equipmentService';\nimport * as scorecardService from 'backend/driverScorecardService';\nimport * as capacityService from 'backend/capacityPlanningService';\nimport * as eldService from 'backend/eldIntegrationService';\n\n/**\n * CARRIER FLEET DASHBOARD - UNIFIED PAGE CODE\n * This script handles the bridge between Wix and the Fleet Dashboard HTML components.\n */\n\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\n\n$w.onReady(async function () {\n    try {\n        const member = await currentMember.getMember({ fieldsets: ['FULL'] });\n        const carrierDot = member?.contactDetails?.customFields?.carrier_dot;\n\n        if (!carrierDot) {\n            console.error('[FleetDashboard] No carrier DOT found for current member');\n            // Handle unauthorized or missing DOT\n            return;\n        }\n\n        // Initialize all found components\n        HTML_COMPONENT_IDS.forEach(id => {\n            const el = $w(id);\n            if (el && typeof el.onMessage === 'function') {\n                el.onMessage((event) => routeMessage(el, event?.data, carrierDot));\n                // Signal component that bridge is ready\n                safeSend(el, { action: 'init' });\n            }\n        });\n\n    } catch (error) {\n        console.error('[FleetDashboard] Init failed:', error.message);\n    }\n});\n\n/**\n * Route messages from HTML components to backend services\n */\nasync function routeMessage(component, message, carrierDot) {\n    if (!message || !message.action) return;\n\n    const { action, payload } = message;\n\n    try {\n        switch (action) {\n            // --- Driver Roster ---\n            case 'getDrivers':\n                const drivers = await fleetService.getFleetDrivers(carrierDot, payload);\n                safeSend(component, { action: 'driversLoaded', payload: drivers });\n                break;\n            case 'getAlerts':\n                const alerts = await fleetService.getExpiringCredentials(carrierDot);\n                safeSend(component, { action: 'alertsLoaded', payload: { alerts } });\n                break;\n            case 'addDriver':\n                const newDriver = await fleetService.addFleetDriver(carrierDot, payload.driverData);\n                safeSend(component, { action: 'driverAdded', payload: newDriver });\n                break;\n\n            // --- Equipment Manager ---\n            case 'getEquipment':\n                const equip = await equipmentService.getEquipmentList(carrierDot, payload);\n                safeSend(component, { action: 'equipmentLoaded', payload: equip });\n                break;\n            case 'getAssetDetails':\n                const asset = await equipmentService.getEquipmentDetails(payload.equipmentId);\n                const history = await equipmentService.getAssignmentHistory(payload.equipmentId);\n                safeSend(component, { action: 'assetDetailsLoaded', payload: { asset, history } });\n                break;\n            case 'assignEquipment':\n                const assignment = await equipmentService.assignEquipment(payload.equipmentId, payload.driverId, payload.type);\n                safeSend(component, { action: 'assignmentSuccess', payload: assignment });\n                break;\n            case 'unassignEquipment':\n                await equipmentService.unassignEquipment(payload.equipmentId);\n                safeSend(component, { action: 'assignmentSuccess' });\n                break;\n\n            // --- Scorecard ---\n            case 'getScorecard':\n                const scorecard = await scorecardService.getDriverScorecard(payload.driverId, payload.periodType);\n                const trend = await scorecardService.getDriverTrend(payload.driverId);\n                safeSend(component, { action: 'scorecardLoaded', payload: { scorecard, trend } });\n                break;\n            case 'getFleetSummary':\n                const summary = await scorecardService.getFleetScoreboardSummary(carrierDot, payload.periodType);\n                safeSend(component, { action: 'summaryLoaded', payload: { summary } });\n                break;\n            case 'getRankings':\n                const rankings = await scorecardService.getPerformanceRankings(carrierDot, payload.category, payload.limit);\n                safeSend(component, { action: 'rankingsLoaded', payload: { rankings } });\n                break;\n\n            // --- Capacity Planning ---\n            case 'getCapacityOverview':\n                const capOverview = await capacityService.getCapacityOverview(carrierDot, payload.period);\n                safeSend(component, { action: 'overviewLoaded', payload: { overview: capOverview } });\n                break;\n            case 'getDailyBreakdown':\n                // For simplicity, we calculate today's and fetch recent ones\n                const breakdown = await capacityService.getDailyBreakdown(carrierDot, payload.startDate, payload.endDate);\n                safeSend(component, { action: 'breakdownLoaded', payload: { breakdown } });\n                break;\n            case 'getRecommendations':\n                const recs = await capacityService.generateCapacityRecommendations(carrierDot);\n                safeSend(component, { action: 'recommendationsLoaded', payload: { recommendations: recs } });\n                break;\n\n            // --- ELD / Map ---\n            case 'getFleetLocations':\n                const locations = await eldService.getFleetLocations(carrierDot);\n                safeSend(component, { action: 'locationsLoaded', payload: { locations } });\n                break;\n\n            default:\n                console.warn(`[FleetDashboard] Unknown action: ${action}`);\n        }\n    } catch (error) {\n        console.error(`[FleetDashboard] Error handling ${action}:`, error.message);\n        safeSend(component, { action: 'actionError', message: error.message });\n    }\n}\n\n/**\n * Send message to HTML component with safety check\n */\nfunction safeSend(component, data) {\n    try {\n        if (component && typeof component.postMessage === 'function') {\n            component.postMessage(data);\n        }\n    } catch (e) {\n        // Component might be detached\n    }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_INCIDENT_REPORTING.dfobc.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_POLICIES.m76is.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":28,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":88,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":88,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2565,2566],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * CARRIER_POLICIES Page Code\n * Handles PostMessage bridge for carrier policy repository management\n */\n\nimport {\n  createPolicy,\n  updatePolicy,\n  publishPolicyVersion,\n  archivePolicy,\n  uploadPolicyFile,\n  getPoliciesForCarrier,\n  getComplianceStatus\n} from 'backend/carrierPolicyService.jsw';\nimport { getCarrierContextForCurrentUser } from 'backend/carrierAnnouncementsService.jsw';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'carrierPoliciesReady',\n    'getCarrierPolicies',\n    'createPolicy',\n    'updatePolicy',\n    'publishPolicyVersion',\n    'archivePolicy',\n    'uploadPolicyFile',\n    'getComplianceStatus'\n  ],\n  outbound: [\n    'carrierPoliciesData',\n    'policyActionResult',\n    'policyUploadResult',\n    'complianceStatusData',\n    'carrierContext'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet carrierId = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('CARRIER_POLICIES page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  // Get carrier context on page load\n  const ctx = await getCarrierContextForCurrentUser();\n  if (ctx.success) {\n    carrierId = ctx.carrierId;\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'carrierPoliciesReady':\n      console.log('Carrier Policies HTML ready');\n      if (carrierId) {\n        sendToHtml('carrierContext', { carrierId });\n      }\n      break;\n\n    case 'getCarrierPolicies':\n      await handleGetCarrierPolicies(msg.data);\n      break;\n\n    case 'createPolicy':\n      await handleCreatePolicy(msg.data);\n      break;\n\n    case 'updatePolicy':\n      await handleUpdatePolicy(msg.data);\n      break;\n\n    case 'publishPolicyVersion':\n      await handlePublishPolicyVersion(msg.data);\n      break;\n\n    case 'archivePolicy':\n      await handleArchivePolicy(msg.data);\n      break;\n\n    case 'uploadPolicyFile':\n      await handleUploadPolicyFile(msg.data);\n      break;\n\n    case 'getComplianceStatus':\n      await handleGetComplianceStatus(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetCarrierPolicies(data) {\n  try {\n    const cid = data?.carrierId || carrierId;\n    if (!cid) {\n      sendToHtml('carrierPoliciesData', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    carrierId = cid;\n\n    const options = {\n      status: data?.status || 'published',\n      category: data?.category || 'all',\n      limit: data?.limit || 200,\n      offset: data?.offset || 0\n    };\n\n    const result = await getPoliciesForCarrier(cid, options);\n\n    sendToHtml('carrierPoliciesData', {\n      success: result.success,\n      policies: result.success ? result.policies : [],\n      totalCount: result.totalCount || 0,\n      error: result.error\n    });\n\n  } catch (error) {\n    console.error('Error fetching carrier policies:', error);\n    sendToHtml('carrierPoliciesData', { success: false, error: error.message });\n  }\n}\n\nasync function handleCreatePolicy(data) {\n  try {\n    if (!data) {\n      sendToHtml('policyActionResult', { success: false, error: 'No data provided' });\n      return;\n    }\n\n    // Use carrierId from data or global state\n    const policyData = {\n      ...data,\n      carrier_id: data.carrier_id || carrierId\n    };\n\n    const result = await createPolicy(policyData);\n    sendToHtml('policyActionResult', result);\n\n  } catch (error) {\n    console.error('Error creating policy:', error);\n    sendToHtml('policyActionResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleUpdatePolicy(data) {\n  try {\n    const { policyId, updates } = data || {};\n\n    if (!policyId || !updates) {\n      sendToHtml('policyActionResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await updatePolicy(policyId, updates);\n    sendToHtml('policyActionResult', result);\n\n  } catch (error) {\n    console.error('Error updating policy:', error);\n    sendToHtml('policyActionResult', { success: false, error: error.message });\n  }\n}\n\nasync function handlePublishPolicyVersion(data) {\n  try {\n    const { policyId, changeSummary } = data || {};\n\n    if (!policyId) {\n      sendToHtml('policyActionResult', { success: false, error: 'Missing policy ID' });\n      return;\n    }\n\n    const result = await publishPolicyVersion(policyId, changeSummary || '');\n    sendToHtml('policyActionResult', result);\n\n  } catch (error) {\n    console.error('Error publishing policy:', error);\n    sendToHtml('policyActionResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleArchivePolicy(data) {\n  try {\n    const { policyId } = data || {};\n\n    if (!policyId) {\n      sendToHtml('policyActionResult', { success: false, error: 'Missing policy ID' });\n      return;\n    }\n\n    const result = await archivePolicy(policyId);\n    sendToHtml('policyActionResult', result);\n\n  } catch (error) {\n    console.error('Error archiving policy:', error);\n    sendToHtml('policyActionResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleUploadPolicyFile(data) {\n  try {\n    const { base64Data, fileName, mimeType, carrierId: cid } = data || {};\n\n    if (!base64Data || !fileName || !mimeType) {\n      sendToHtml('policyUploadResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await uploadPolicyFile(base64Data, fileName, mimeType, cid || carrierId);\n    sendToHtml('policyUploadResult', result);\n\n  } catch (error) {\n    console.error('Error uploading policy file:', error);\n    sendToHtml('policyUploadResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleGetComplianceStatus(data) {\n  try {\n    const cid = data?.carrierId || carrierId;\n    if (!cid) {\n      sendToHtml('complianceStatusData', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    const result = await getComplianceStatus(cid);\n    sendToHtml('complianceStatusData', result);\n\n  } catch (error) {\n    console.error('Error fetching compliance status:', error);\n    sendToHtml('complianceStatusData', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CARRIER_WEIGHT_PREFERENCES.kvkff.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CDL Class A Driver Recruitment.mysoi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CDL Driver Recruitment Pricing.o5c9o.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getStripePublishableKey' is defined but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * CDL Driver Recruitment Pricing Page\r\n * B2B pricing page for carriers showing tier comparison, ROI calculator, and FAQs\r\n *\r\n * Focus: Clear tier comparison, value proposition, FAQ accordion\r\n *\r\n * Element IDs:\r\n * - #pricingRepeater - Pricing tier cards\r\n * - #roiCalculatorHtml - HTML component for ROI calculator\r\n * - #comparisonTableHtml - HTML component for vs traditional recruiting\r\n * - #faqAccordionHtml - HTML component for FAQ accordion\r\n * - #pricingWidgetHtml - HTML component for pricing widget with staffing form\r\n *\r\n * @see docs/PAGE_DATA_IMPLEMENTATION_GUIDE.md\r\n */\r\n\r\nimport wixWindow from 'wix-window';\r\nimport wixLocation from 'wix-location';\r\nimport wixUsers from 'wix-users';\r\nimport { authentication } from 'wix-members-frontend';\r\nimport { getPricingTiers, getFAQs } from 'backend/contentService';\r\nimport { getCarrierPlatformStats } from 'backend/publicStatsService';\r\nimport { submitCarrierStaffingRequest, ensureCarrierRecord } from 'backend/carrierLeadsService';\r\nimport { getMemberCarrierDot } from 'backend/memberService';\r\nimport {\r\n  startCheckout,\r\n  startPlacementCheckout,\r\n  openBillingPortal,\r\n  getFullSubscriptionStatus,\r\n  getAllPlanInfo,\r\n  getStripePublishableKey\r\n} from 'backend/subscriptionService';\r\n\r\n$w.onReady(async function () {\r\n  console.log('CDL Driver Recruitment Pricing page initialized');\r\n\r\n  // Initialize HTML component handlers (non-blocking)\r\n  initPricingWidgetForm();\r\n  initSubscriptionHandlers();\r\n\r\n  await Promise.all([\r\n    loadPricingTiers(),\r\n    loadRoiCalculator(),\r\n    loadComparisonTable(),\r\n    loadPricingFaqs(),\r\n    loadPlatformStats()\r\n  ]);\r\n});\r\n\r\n// ============================================================================\r\n// PRICING TIERS\r\n// ============================================================================\r\n\r\n/**\r\n * Load pricing tiers from backend\r\n * Element: #pricingRepeater\r\n */\r\nasync function loadPricingTiers() {\r\n  try {\r\n    const result = await getPricingTiers('carrier');\r\n\r\n    if (!result.success || result.tiers.length === 0) {\r\n      // Show default pricing if no data\r\n      showDefaultPricing();\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#pricingRepeater');\r\n    if (!repeater || repeater.data === undefined) {\r\n      // Repeater not found - update static elements\r\n      updateStaticPricingElements(result.tiers);\r\n      return;\r\n    }\r\n\r\n    repeater.data = result.tiers.map((tier, index) => ({\r\n      _id: `tier-${index}`,\r\n      name: tier.name,\r\n      price: tier.price,\r\n      priceSubtext: tier.priceSubtext,\r\n      description: tier.description,\r\n      features: tier.features || [],\r\n      ctaText: tier.ctaText || 'Get Started',\r\n      ctaLink: tier.ctaLink || '/carrier-welcome',\r\n      isPopular: tier.isPopular,\r\n      badgeText: tier.badgeText\r\n    }));\r\n\r\n    repeater.onItemReady(($item, itemData) => {\r\n      try {\r\n        // Basic tier info\r\n        if ($item('#tierName').rendered) $item('#tierName').text = itemData.name;\r\n        if ($item('#tierPrice').rendered) $item('#tierPrice').text = itemData.price;\r\n        if ($item('#tierSubtext').rendered) $item('#tierSubtext').text = itemData.priceSubtext || '';\r\n        if ($item('#tierDescription').rendered) $item('#tierDescription').text = itemData.description || '';\r\n\r\n        // Popular badge\r\n        if (itemData.isPopular) {\r\n          try {\r\n            const badge = $item('#popularBadge');\r\n            if (badge.rendered) {\r\n              if (itemData.badgeText) {\r\n                badge.text = itemData.badgeText;\r\n              }\r\n              badge.show();\r\n            }\r\n          } catch (e) {\r\n            // Element may not exist\r\n          }\r\n\r\n          // Highlight popular tier container\r\n          try {\r\n            const tierContainer = $item('#tierContainer');\r\n            if (tierContainer.rendered && tierContainer.style) {\r\n              tierContainer.style.borderColor = '#4A90D9';\r\n              tierContainer.style.borderWidth = '3px';\r\n            }\r\n          } catch (e) {\r\n            // Element may not exist\r\n          }\r\n        } else {\r\n          try {\r\n            const badge = $item('#popularBadge');\r\n            if (badge.rendered && badge.hide) badge.hide();\r\n          } catch (e) {\r\n            // Element may not exist\r\n          }\r\n        }\r\n\r\n        // CTA button\r\n        try {\r\n          const ctaBtn = $item('#tierCtaBtn');\r\n          if (ctaBtn.rendered) {\r\n            ctaBtn.label = itemData.ctaText;\r\n            ctaBtn.onClick(() => {\r\n              // Track pricing CTA click\r\n              trackPricingClick(itemData.name);\r\n              wixLocation.to(itemData.ctaLink);\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // Element may not exist\r\n        }\r\n\r\n        // Features list repeater\r\n        try {\r\n          const featuresRepeater = $item('#tierFeaturesRepeater');\r\n          if (featuresRepeater.rendered && itemData.features.length > 0) {\r\n            featuresRepeater.data = itemData.features.map((feature, i) => ({\r\n              _id: `feature-${i}`,\r\n              text: feature\r\n            }));\r\n\r\n            featuresRepeater.onItemReady(($featureItem, featureData) => {\r\n              try {\r\n                if ($featureItem('#featureText')) {\r\n                  $featureItem('#featureText').text = featureData.text;\r\n                }\r\n                // Show checkmark icon\r\n                if ($featureItem('#featureIcon')) {\r\n                  $featureItem('#featureIcon').show();\r\n                }\r\n              } catch (e) {\r\n                // Element may not exist\r\n              }\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // Features repeater may not exist - try text list\r\n          try {\r\n            const featuresList = $item('#tierFeaturesList');\r\n            if (featuresList.rendered) {\r\n              featuresList.text = itemData.features.join('\\n');\r\n            }\r\n          } catch (e2) {\r\n            // Element may not exist\r\n          }\r\n        }\r\n\r\n      } catch (e) {\r\n        console.error('Error in onItemReady:', e);\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load pricing tiers:', err);\r\n    showDefaultPricing();\r\n  }\r\n}\r\n\r\n/**\r\n * Update static pricing elements when no repeater exists\r\n */\r\nfunction updateStaticPricingElements(tiers) {\r\n  const tierMapping = {\r\n    0: { price: '#basicPrice', subtext: '#basicSubtext', name: '#basicName', cta: '#basicCtaBtn' },\r\n    1: { price: '#proPrice', subtext: '#proSubtext', name: '#proName', cta: '#proCtaBtn' },\r\n    2: { price: '#enterprisePrice', subtext: '#enterpriseSubtext', name: '#enterpriseName', cta: '#enterpriseCtaBtn' }\r\n  };\r\n\r\n  tiers.forEach((tier, index) => {\r\n    const mapping = tierMapping[index];\r\n    if (!mapping) return;\r\n\r\n    Object.entries(mapping).forEach(([key, selector]) => {\r\n      try {\r\n        const element = $w(selector);\r\n        if (element) {\r\n          if (key === 'price') element.text = tier.price;\r\n          if (key === 'subtext') element.text = tier.priceSubtext || '';\r\n          if (key === 'name') element.text = tier.name;\r\n          if (key === 'cta' && element.onClick) {\r\n            element.label = tier.ctaText || 'Get Started';\r\n            element.onClick(() => {\r\n              trackPricingClick(tier.name);\r\n              wixLocation.to(tier.ctaLink || '/carrier-welcome');\r\n            });\r\n          }\r\n        }\r\n      } catch (e) {\r\n        // Element may not exist\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Show default pricing when no backend data available\r\n */\r\nfunction showDefaultPricing() {\r\n  const defaults = [\r\n    {\r\n      name: 'Basic',\r\n      price: '$299',\r\n      priceSubtext: 'per hire',\r\n      ctaLink: '/carrier-welcome'\r\n    },\r\n    {\r\n      name: 'Pro',\r\n      price: '$199',\r\n      priceSubtext: 'per hire (5+ hires)',\r\n      ctaLink: '/carrier-welcome'\r\n    },\r\n    {\r\n      name: 'Enterprise',\r\n      price: 'Custom',\r\n      priceSubtext: 'volume pricing',\r\n      ctaLink: '/contact'\r\n    }\r\n  ];\r\n\r\n  updateStaticPricingElements(defaults);\r\n}\r\n\r\n/**\r\n * Track pricing CTA clicks for analytics\r\n */\r\nfunction trackPricingClick(tierName) {\r\n  try {\r\n    // Log to console for debugging\r\n    console.log(`Pricing CTA clicked: ${tierName}`);\r\n\r\n    // Track in Wix analytics if available\r\n    if (typeof wixWindow !== 'undefined' && wixWindow.trackEvent) {\r\n      wixWindow.trackEvent('PricingClick', {\r\n        tier: tierName,\r\n        page: 'CDL Driver Recruitment Pricing'\r\n      });\r\n    }\r\n  } catch (e) {\r\n    // Analytics tracking failed - non-critical\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// ROI CALCULATOR\r\n// ============================================================================\r\n\r\n/**\r\n * Load ROI calculator HTML component\r\n * Element: #roiCalculatorHtml\r\n */\r\nasync function loadRoiCalculator() {\r\n  try {\r\n    const htmlComponent = $w('#roiCalculatorHtml');\r\n    if (!htmlComponent || typeof htmlComponent.postMessage !== 'function') {\r\n      return;\r\n    }\r\n\r\n    // Get platform stats for realistic defaults\r\n    let stats = {\r\n      avgDaysToHire: 14,\r\n      avgCostPerHire: 299,\r\n      retentionRate: 87\r\n    };\r\n\r\n    try {\r\n      const platformStats = await getCarrierPlatformStats();\r\n      stats = {\r\n        avgDaysToHire: platformStats.avgDaysToHire || 14,\r\n        avgCostPerHire: platformStats.avgCostPerHire || 299,\r\n        retentionRate: platformStats.retentionRate || 87\r\n      };\r\n    } catch (e) {\r\n      // Use defaults\r\n    }\r\n\r\n    // Traditional recruiting costs (industry benchmarks)\r\n    const traditionalCosts = {\r\n      avgCostPerHire: 8234, // ATA average\r\n      avgDaysToHire: 45,\r\n      turnoverRate: 94 // Industry average turnover %\r\n    };\r\n\r\n    // Send data to HTML calculator\r\n    htmlComponent.postMessage({\r\n      type: 'roiCalculatorData',\r\n      lmdr: stats,\r\n      traditional: traditionalCosts,\r\n      savings: {\r\n        costSavingsPerHire: traditionalCosts.avgCostPerHire - stats.avgCostPerHire,\r\n        timeSavingsDays: traditionalCosts.avgDaysToHire - stats.avgDaysToHire,\r\n        retentionImprovement: stats.retentionRate - (100 - traditionalCosts.turnoverRate)\r\n      }\r\n    });\r\n\r\n    // Listen for calculator inputs from HTML component\r\n    htmlComponent.onMessage((event) => {\r\n      if (event.data && event.data.type === 'calculateROI') {\r\n        const { driversNeeded, currentCostPerHire } = event.data;\r\n        const roi = calculateROI(driversNeeded, currentCostPerHire, stats);\r\n        htmlComponent.postMessage({\r\n          type: 'roiResult',\r\n          ...roi\r\n        });\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load ROI calculator:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate ROI based on user inputs\r\n */\r\nfunction calculateROI(driversNeeded, currentCostPerHire, lmdrStats) {\r\n  const currentTotalCost = driversNeeded * currentCostPerHire;\r\n  const lmdrTotalCost = driversNeeded * lmdrStats.avgCostPerHire;\r\n  const totalSavings = currentTotalCost - lmdrTotalCost;\r\n  const savingsPercentage = ((currentTotalCost - lmdrTotalCost) / currentTotalCost * 100).toFixed(0);\r\n\r\n  // Time savings value (assuming $500/day cost of vacancy)\r\n  const timeSavingsDays = 45 - lmdrStats.avgDaysToHire;\r\n  const vacancyCostPerDay = 500;\r\n  const timeSavingsValue = driversNeeded * timeSavingsDays * vacancyCostPerDay;\r\n\r\n  // Total first-year value\r\n  const totalFirstYearValue = totalSavings + timeSavingsValue;\r\n\r\n  return {\r\n    currentTotalCost,\r\n    lmdrTotalCost,\r\n    directSavings: totalSavings,\r\n    savingsPercentage: parseInt(savingsPercentage),\r\n    timeSavingsDays: timeSavingsDays * driversNeeded,\r\n    timeSavingsValue,\r\n    totalFirstYearValue,\r\n    roiPercentage: Math.round((totalFirstYearValue / lmdrTotalCost) * 100)\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// COMPARISON TABLE\r\n// ============================================================================\r\n\r\n/**\r\n * Load comparison table (LMDR vs Traditional Recruiting)\r\n * Element: #comparisonTableHtml\r\n */\r\nasync function loadComparisonTable() {\r\n  try {\r\n    const htmlComponent = $w('#comparisonTableHtml');\r\n    if (!htmlComponent || typeof htmlComponent.postMessage !== 'function') {\r\n      return;\r\n    }\r\n\r\n    // Comparison data\r\n    const comparisonData = {\r\n      categories: [\r\n        {\r\n          name: 'Cost',\r\n          items: [\r\n            { metric: 'Average Cost per Hire', traditional: '$8,234', lmdr: '$299', advantage: 'lmdr' },\r\n            { metric: 'Hidden Fees', traditional: 'Common', lmdr: 'None', advantage: 'lmdr' },\r\n            { metric: 'Upfront Payment', traditional: 'Often Required', lmdr: 'Pay on Success', advantage: 'lmdr' }\r\n          ]\r\n        },\r\n        {\r\n          name: 'Speed',\r\n          items: [\r\n            { metric: 'Time to First Candidate', traditional: '7-14 days', lmdr: '24-48 hours', advantage: 'lmdr' },\r\n            { metric: 'Average Time to Hire', traditional: '45+ days', lmdr: '7-14 days', advantage: 'lmdr' },\r\n            { metric: 'Application Processing', traditional: 'Manual', lmdr: 'AI-Powered', advantage: 'lmdr' }\r\n          ]\r\n        },\r\n        {\r\n          name: 'Quality',\r\n          items: [\r\n            { metric: 'Pre-Screening', traditional: 'Basic', lmdr: 'AI + FMCSA Verified', advantage: 'lmdr' },\r\n            { metric: 'Match Accuracy', traditional: 'Low', lmdr: '85%+', advantage: 'lmdr' },\r\n            { metric: 'Driver Retention', traditional: 'Variable', lmdr: '87%+ at 90 days', advantage: 'lmdr' }\r\n          ]\r\n        },\r\n        {\r\n          name: 'Support',\r\n          items: [\r\n            { metric: 'Account Management', traditional: 'Limited', lmdr: 'Dedicated (Pro+)', advantage: 'lmdr' },\r\n            { metric: 'Analytics Dashboard', traditional: 'Rarely', lmdr: 'Real-time', advantage: 'lmdr' },\r\n            { metric: 'Compliance Support', traditional: 'Extra Cost', lmdr: 'Included', advantage: 'lmdr' }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n\r\n    // Send comparison data to HTML component\r\n    htmlComponent.postMessage({\r\n      type: 'comparisonData',\r\n      data: comparisonData\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load comparison table:', err);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// PRICING FAQs\r\n// ============================================================================\r\n\r\n/**\r\n * Load pricing FAQs\r\n * Element: #faqAccordionHtml\r\n */\r\nasync function loadPricingFaqs() {\r\n  try {\r\n    const result = await getFAQs('pricing');\r\n\r\n    let faqs = [];\r\n\r\n    if (result.success && result.faqs.length > 0) {\r\n      faqs = result.faqs;\r\n    } else {\r\n      // Default FAQs if none in database\r\n      faqs = getDefaultPricingFaqs();\r\n    }\r\n\r\n    // Send to HTML accordion component\r\n    try {\r\n      const htmlComponent = $w('#faqAccordionHtml');\r\n      if (htmlComponent.rendered && typeof htmlComponent.postMessage === 'function') {\r\n        htmlComponent.postMessage({\r\n          type: 'faqData',\r\n          data: faqs\r\n        });\r\n      }\r\n    } catch (e) {\r\n      // HTML component may not exist\r\n    }\r\n\r\n    // Also try native Wix repeater\r\n    try {\r\n      const faqRepeater = $w('#faqRepeater');\r\n      if (faqRepeater.rendered && faqRepeater.data !== undefined) {\r\n        faqRepeater.data = faqs.map((faq, index) => ({\r\n          _id: `faq-${index}`,\r\n          question: faq.question,\r\n          answer: faq.answer,\r\n          isOpen: false\r\n        }));\r\n\r\n        faqRepeater.onItemReady(($item, itemData) => {\r\n          try {\r\n            if ($item('#faqQuestion').rendered) $item('#faqQuestion').text = itemData.question;\r\n            if ($item('#faqAnswer').rendered) {\r\n              $item('#faqAnswer').text = itemData.answer;\r\n              $item('#faqAnswer').collapse();\r\n            }\r\n\r\n            // Toggle FAQ accordion\r\n            const toggleBtn = $item('#faqToggleBtn') || $item('#faqQuestion');\r\n            if (toggleBtn.rendered && toggleBtn.onClick) {\r\n              toggleBtn.onClick(() => {\r\n                try {\r\n                  const answer = $item('#faqAnswer');\r\n                  if (answer.rendered) {\r\n                    if (answer.collapsed) {\r\n                      answer.expand();\r\n                    } else {\r\n                      answer.collapse();\r\n                    }\r\n                  }\r\n                } catch (e) {\r\n                  // Toggle failed\r\n                }\r\n              });\r\n            }\r\n          } catch (e) {\r\n            // Element may not exist\r\n          }\r\n        });\r\n      }\r\n    } catch (e) {\r\n      // FAQ repeater may not exist\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load pricing FAQs:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Get default pricing FAQs\r\n */\r\nfunction getDefaultPricingFaqs() {\r\n  return [\r\n    {\r\n      question: 'What is included in the per-hire fee?',\r\n      answer: 'Our per-hire fee includes AI-powered matching, FMCSA verification, pre-screening, and placement support. There are no hidden fees or recurring charges.'\r\n    },\r\n    {\r\n      question: 'When do I pay?',\r\n      answer: 'You only pay when you successfully hire a driver through our platform. No upfront costs, no monthly fees, no risk.'\r\n    },\r\n    {\r\n      question: 'What is your guarantee?',\r\n      answer: 'We offer a 48-hour guarantee on driver placements. If a driver does not show up or leaves within the first 48 hours, we will find you a replacement at no additional cost.'\r\n    },\r\n    {\r\n      question: 'How do volume discounts work?',\r\n      answer: 'Our Pro tier offers discounted per-hire pricing for carriers hiring 5 or more drivers. Enterprise clients receive custom volume pricing based on their specific needs.'\r\n    },\r\n    {\r\n      question: 'Can I try LMDR before committing?',\r\n      answer: 'Yes! We offer a risk-free first hire at standard pricing. If you are not satisfied with our service, we will refund your fee - no questions asked.'\r\n    },\r\n    {\r\n      question: 'How fast can I get candidates?',\r\n      answer: 'Most carriers receive their first qualified candidates within 24-48 hours of posting. Our AI matching system works around the clock to find the best fits.'\r\n    },\r\n    {\r\n      question: 'Do you verify driver credentials?',\r\n      answer: 'Yes, all drivers are verified through FMCSA databases, including CDL status, medical certification, and safety history. We also perform AI-powered background analysis.'\r\n    },\r\n    {\r\n      question: 'What support do I get with each tier?',\r\n      answer: 'Basic includes email support and self-service tools. Pro adds priority matching and phone support. Enterprise includes a dedicated account manager and custom integrations.'\r\n    }\r\n  ];\r\n}\r\n\r\n// ============================================================================\r\n// PLATFORM STATS\r\n// ============================================================================\r\n\r\n/**\r\n * Load platform stats for credibility\r\n */\r\nasync function loadPlatformStats() {\r\n  try {\r\n    const stats = await getCarrierPlatformStats();\r\n\r\n    const statElements = {\r\n      '#statQualifiedDrivers': stats.qualifiedDrivers.toLocaleString(),\r\n      '#statAvgTimeToHire': `${stats.avgDaysToHire} days`,\r\n      '#statRetentionRate': `${stats.retentionRate}%`,\r\n      '#statAvgCostPerHire': `$${stats.avgCostPerHire}`\r\n    };\r\n\r\n    Object.entries(statElements).forEach(([selector, value]) => {\r\n      try {\r\n        const element = $w(selector);\r\n        if (element && element.text !== undefined) {\r\n          element.text = value;\r\n        }\r\n      } catch (e) {\r\n        // Element may not exist\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load platform stats:', err);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// CTA HANDLERS\r\n// ============================================================================\r\n\r\n// Set up global CTA buttons\r\n$w.onReady(() => {\r\n  // Get Started CTA\r\n  try {\r\n    const getStartedBtn = $w('#getStartedBtn');\r\n    if (getStartedBtn.rendered) {\r\n      getStartedBtn.onClick(() => {\r\n        trackPricingClick('Get Started Hero');\r\n        wixLocation.to('/carrier-welcome');\r\n      });\r\n    }\r\n  } catch (e) {\r\n    // Element may not exist\r\n  }\r\n\r\n  // Contact Sales CTA\r\n  try {\r\n    const contactSalesBtn = $w('#contactSalesBtn');\r\n    if (contactSalesBtn.rendered) {\r\n      contactSalesBtn.onClick(() => {\r\n        trackPricingClick('Contact Sales');\r\n        wixLocation.to('/contact');\r\n      });\r\n    }\r\n  } catch (e) {\r\n    // Element may not exist\r\n  }\r\n\r\n  // Schedule Demo CTA\r\n  try {\r\n    const scheduleDemoBtn = $w('#scheduleDemoBtn');\r\n    if (scheduleDemoBtn.rendered) {\r\n      scheduleDemoBtn.onClick(() => {\r\n        trackPricingClick('Schedule Demo');\r\n        wixLocation.to('/schedule-demo');\r\n      });\r\n    }\r\n  } catch (e) {\r\n    // Element may not exist\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// PRICING WIDGET FORM HANDLER\r\n// ============================================================================\r\n\r\n/**\r\n * Initialize the pricing widget HTML component form handler\r\n * Handles carrier staffing form submissions from the embedded HTML component\r\n * Element: #pricingWidgetHtml (or #html1 depending on Wix editor setup)\r\n */\r\nfunction initPricingWidgetForm() {\r\n  // Try multiple possible HTML component IDs\r\n  const possibleIds = ['#pricingWidgetHtml', '#html1', '#html2', '#html3', '#html4', '#html5', '#htmlComponent'];\r\n  let htmlComponent = null;\r\n\r\n  for (const id of possibleIds) {\r\n    try {\r\n      const component = $w(id);\r\n      if (component && typeof component.onMessage === 'function') {\r\n        htmlComponent = component;\r\n        console.log(`Pricing widget form handler attached to ${id}`);\r\n        break;\r\n      }\r\n    } catch (e) {\r\n      // Component doesn't exist, try next\r\n    }\r\n  }\r\n\r\n  if (!htmlComponent.rendered) {\r\n    console.log('No HTML component found for pricing widget form');\r\n    return;\r\n  }\r\n\r\n  // Listen for messages from the HTML component\r\n  htmlComponent.onMessage(async (event) => {\r\n    const msg = event.data;\r\n    if (!msg || !msg.type) return;\r\n\r\n    console.log('Pricing widget received message:', msg.type);\r\n\r\n    // Handle staffing form submission\r\n    if (msg.type === 'submitCarrierStaffingRequest') {\r\n      try {\r\n        console.log('Processing staffing request:', msg.data);\r\n        const result = await submitCarrierStaffingRequest(msg.data);\r\n        console.log('Staffing request result:', result);\r\n\r\n        // Send result back to HTML component\r\n        htmlComponent.postMessage({\r\n          type: 'staffingRequestResult',\r\n          data: result\r\n        });\r\n\r\n        // Track successful submission\r\n        if (result.success) {\r\n          trackPricingClick('Staffing Form Submitted');\r\n\r\n          // Redirect to checkout\r\n          if (result.leadId) {\r\n            console.log('Redirecting to checkout...');\r\n            setTimeout(() => {\r\n              wixLocation.to(`/checkout?id=${result.leadId}`);\r\n            }, 1500);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error submitting staffing request:', error);\r\n        htmlComponent.postMessage({\r\n          type: 'staffingRequestResult',\r\n          data: {\r\n            success: false,\r\n            error: 'There was an error processing your request. Please try again.'\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Handle ROI calculator inputs (for analytics)\r\n    if (msg.type === 'calculateROI') {\r\n      console.log('ROI calculation:', msg);\r\n      // Could track ROI calculator usage here\r\n    }\r\n\r\n    // Handle component ready signals\r\n    if (msg.type === 'staffingFormReady') {\r\n      console.log('Staffing form component is ready');\r\n    }\r\n\r\n    if (msg.type === 'roiCalculatorReady') {\r\n      console.log('ROI calculator component is ready');\r\n    }\r\n\r\n    if (msg.type === 'comparisonTableReady') {\r\n      console.log('Comparison table component is ready');\r\n    }\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// STRIPE SUBSCRIPTION HANDLERS\r\n// ============================================================================\r\n\r\n/**\r\n * Initialize Stripe subscription handlers for pricing page\r\n * Handles checkout, portal access, and subscription status requests\r\n * Works with Recruiter_Pricing.html component\r\n */\r\nfunction initSubscriptionHandlers() {\r\n  // Try multiple possible HTML component IDs\r\n  const possibleIds = ['#pricingWidgetHtml', '#html1', '#html2', '#html3', '#html4', '#html5', '#htmlComponent', '#recruiterPricingHtml'];\r\n  let htmlComponent = null;\r\n\r\n  for (const id of possibleIds) {\r\n    try {\r\n      const component = $w(id);\r\n      if (component && typeof component.onMessage === 'function') {\r\n        htmlComponent = component;\r\n        console.log(`Subscription handler attached to ${id}`);\r\n        break;\r\n      }\r\n    } catch (e) {\r\n      // Component doesn't exist, try next\r\n    }\r\n  }\r\n\r\n  if (!htmlComponent.rendered) {\r\n    console.log('No HTML component found for subscription handlers');\r\n    return;\r\n  }\r\n\r\n  // Listen for subscription-related messages\r\n  htmlComponent.onMessage(async (event) => {\r\n    const msg = event.data;\r\n    if (!msg || !msg.type) return;\r\n\r\n    console.log('Subscription handler received message:', msg.type);\r\n\r\n    // Handle pricing page data request\r\n    if (msg.type === 'getPricingPageData') {\r\n      try {\r\n        const currentUser = wixUsers.currentUser;\r\n        const isLoggedIn = currentUser.loggedIn;\r\n\r\n        let subscriptionStatus = null;\r\n        let carrierDot = null;\r\n        let userEmail = null;\r\n\r\n        if (isLoggedIn) {\r\n          userEmail = await currentUser.getEmail();\r\n\r\n          // Try to get carrier DOT from user's profile using backend service\r\n          const dotResult = await getMemberCarrierDot(userEmail);\r\n          if (dotResult.success && dotResult.carrierDot) {\r\n            carrierDot = dotResult.carrierDot;\r\n          }\r\n\r\n          // If we have a carrier DOT, get subscription status\r\n          if (carrierDot) {\r\n            subscriptionStatus = await getFullSubscriptionStatus(carrierDot);\r\n          }\r\n        }\r\n\r\n        // Get plan info (must await - Wix returns Promise for all backend calls)\r\n        const planInfo = await getAllPlanInfo();\r\n\r\n        // Send data back to HTML component\r\n        htmlComponent.postMessage({\r\n          type: 'pricingPageData',\r\n          data: {\r\n            isLoggedIn,\r\n            userEmail,\r\n            carrierDot,\r\n            currentPlan: subscriptionStatus?.planType || 'free',\r\n            subscriptionStatus: subscriptionStatus?.status || null,\r\n            quota: subscriptionStatus?.quota || null,\r\n            planInfo\r\n          }\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error('Error getting pricing page data:', error);\r\n        // Get plan info with fallback (must await backend calls)\r\n        let fallbackPlanInfo = {};\r\n        try {\r\n          fallbackPlanInfo = await getAllPlanInfo();\r\n        } catch (e) {\r\n          console.error('Failed to get plan info:', e);\r\n        }\r\n        htmlComponent.postMessage({\r\n          type: 'pricingPageData',\r\n          data: {\r\n            isLoggedIn: false,\r\n            currentPlan: 'free',\r\n            planInfo: fallbackPlanInfo,\r\n            error: 'Failed to load subscription data'\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Handle checkout initiation (Pro/Enterprise subscriptions - REQUIRES LOGIN)\r\n    if (msg.type === 'startCheckout') {\r\n      try {\r\n        const { plan, billingPeriod } = msg.data;\r\n\r\n        // Check if user is logged in BEFORE attempting checkout\r\n        const currentUser = wixUsers.currentUser;\r\n        if (!currentUser.loggedIn) {\r\n          console.log('User not logged in, prompting Wix login modal for subscription checkout');\r\n\r\n          // Use native Wix login modal instead of redirecting to non-existent /login page\r\n          try {\r\n            await authentication.promptLogin({ mode: 'login', modal: true });\r\n            console.log('Login successful, continuing to checkout');\r\n            // After login, fall through to checkout below\r\n          } catch (loginError) {\r\n            console.log('Login cancelled or failed:', loginError);\r\n            htmlComponent.postMessage({\r\n              type: 'checkoutError',\r\n              data: { error: 'Please log in to continue with your subscription.' }\r\n            });\r\n            return;\r\n          }\r\n        }\r\n\r\n        console.log(`Starting checkout for ${plan} plan (${billingPeriod || 'monthly'})`);\r\n\r\n        // Ensure a Carrier record exists for this user (bridges lead ? carrier on first login)\r\n        const leadId = wixLocation.query.leadId || null;\r\n        const fallbackEmail = wixLocation.query.email || null;\r\n        const ensureResult = await ensureCarrierRecord(leadId, fallbackEmail);\r\n        if (ensureResult.success) {\r\n          console.log(`Carrier record ready: ${ensureResult.created ? 'created new' : 'already existed'}`, ensureResult.carrier);\r\n        } else {\r\n          console.warn('ensureCarrierRecord did not find/create a carrier:', ensureResult.error);\r\n          // Continue anyway  startCheckout has its own fallback\r\n        }\r\n\r\n        // Start Stripe checkout session (fallback params as safety net)\r\n        const result = await startCheckout(\r\n          plan,  // 'pro' or 'enterprise'\r\n          billingPeriod || 'monthly',\r\n          fallbackEmail,\r\n          null\r\n        );\r\n\r\n        if (result.success && result.checkoutUrl) {\r\n          // Send URL to HTML component for redirect (same approach as placement)\r\n          htmlComponent.postMessage({\r\n            type: 'redirectToCheckout',\r\n            data: { checkoutUrl: result.checkoutUrl }\r\n          });\r\n        } else {\r\n          htmlComponent.postMessage({\r\n            type: 'checkoutError',\r\n            data: { error: result.error || 'Failed to create checkout session' }\r\n          });\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Checkout error:', error);\r\n        htmlComponent.postMessage({\r\n          type: 'checkoutError',\r\n          data: { error: 'An error occurred. Please try again.' }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Handle billing portal request\r\n    if (msg.type === 'openBillingPortal') {\r\n      try {\r\n        const { carrierDot } = msg.data;\r\n\r\n        if (!carrierDot) {\r\n          htmlComponent.postMessage({\r\n            type: 'portalError',\r\n            data: { error: 'Carrier information not found' }\r\n          });\r\n          return;\r\n        }\r\n\r\n        console.log(`Opening billing portal for carrier: ${carrierDot}`);\r\n\r\n        const result = await openBillingPortal(\r\n          carrierDot,\r\n          `${wixLocation.baseUrl}/recruiter-console`\r\n        );\r\n\r\n        if (result.success && result.portalUrl) {\r\n          // Redirect to Stripe Customer Portal\r\n          wixLocation.to(result.portalUrl);\r\n        } else {\r\n          htmlComponent.postMessage({\r\n            type: 'portalError',\r\n            data: { error: result.error || 'Failed to open billing portal' }\r\n          });\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Billing portal error:', error);\r\n        htmlComponent.postMessage({\r\n          type: 'portalError',\r\n          data: { error: 'An error occurred. Please try again.' }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Handle placement deposit checkout (Full Service / VelocityMatch)\r\n    // GUEST CHECKOUT: This flow does NOT require login - uses formData.email directly\r\n    // This allows carriers to pay $100/driver deposit without creating an account first\r\n    // Contrast with subscription checkout above which DOES require login\r\n    if (msg.type === 'startPlacementCheckout') {\r\n      try {\r\n        const { driverCount, formData } = msg.data;\r\n\r\n        if (!driverCount || driverCount < 1) {\r\n          htmlComponent.postMessage({\r\n            type: 'checkoutResult',\r\n            data: { success: false, error: 'Please select number of drivers' }\r\n          });\r\n          return;\r\n        }\r\n\r\n        console.log(`Starting placement checkout for ${driverCount} drivers`);\r\n\r\n        // Start Stripe checkout session for placement deposit\r\n        // GUEST CHECKOUT: Uses formData.email directly, no login required\r\n        const result = await startPlacementCheckout(\r\n          driverCount,\r\n          formData || {}\r\n        );\r\n\r\n        if (result.success && result.checkoutUrl) {\r\n          // Send URL to HTML component for redirect (more reliable than wixLocation.to for external URLs)\r\n          htmlComponent.postMessage({\r\n            type: 'redirectToCheckout',\r\n            data: { checkoutUrl: result.checkoutUrl }\r\n          });\r\n        } else {\r\n          htmlComponent.postMessage({\r\n            type: 'checkoutResult',\r\n            data: { success: false, error: result.error || 'Failed to create checkout session' }\r\n          });\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Placement checkout error:', error);\r\n        htmlComponent.postMessage({\r\n          type: 'checkoutResult',\r\n          data: { success: false, error: 'An error occurred. Please try again.' }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Handle login requirement (for subscription checkout - NOT placement deposit)\r\n    if (msg.type === 'requireLogin') {\r\n      console.log('User needs to log in for subscription');\r\n\r\n      // Use native Wix login modal instead of redirecting to non-existent /login page\r\n      try {\r\n        await authentication.promptLogin({ mode: 'login', modal: true });\r\n        console.log('Login successful after requireLogin prompt');\r\n\r\n        // Notify the HTML component that login succeeded so it can retry\r\n        htmlComponent.postMessage({\r\n          type: 'loginSuccess',\r\n          data: { plan: msg.data?.selectedPlan || null }\r\n        });\r\n      } catch (loginError) {\r\n        console.log('Login cancelled or failed:', loginError);\r\n        htmlComponent.postMessage({\r\n          type: 'loginCancelled',\r\n          data: { error: 'Login is required for subscription checkout.' }\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CHALLENGES.upscp.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\CHAT_WIDGET.js","messages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":14,"column":25,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":14,"endColumn":74},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":18,"column":25,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":18,"endColumn":103},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":22,"column":25,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":22,"endColumn":90},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":26,"column":25,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":26,"endColumn":91}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createTicket } from 'backend/supportTicketService.jsw';\r\nimport { startChatSession, sendChatMessage, getChatMessagesSince } from 'backend/chatSupportService.jsw';\r\n\r\n$w.onReady(function () {\r\n    const widget = $w('#html1'); // Assuming the widget is in #html1\r\n\r\n    if (widget && typeof widget.onMessage === 'function') {\r\n        widget.onMessage(async (event) => {\r\n            const { action, ticketData, sessionId, content, lastTimestamp } = event.data;\r\n\r\n            try {\r\n                switch (action) {\r\n                    case 'createTicket':\r\n                        const ticketRes = await createTicket(ticketData);\r\n                        widget.postMessage({ action: 'ticketCreated', payload: ticketRes });\r\n                        break;\r\n                    case 'startChat':\r\n                        const chatRes = await startChatSession(event.data.userData, event.data.topic);\r\n                        widget.postMessage({ action: 'chatStarted', payload: chatRes });\r\n                        break;\r\n                    case 'sendMessage':\r\n                        const msgRes = await sendChatMessage(sessionId, content, 'user');\r\n                        widget.postMessage({ action: 'messageSent', payload: msgRes });\r\n                        break;\r\n                    case 'getMessages':\r\n                        const msgs = await getChatMessagesSince(sessionId, lastTimestamp);\r\n                        widget.postMessage({ action: 'messagesLoaded', payload: msgs.items });\r\n                        break;\r\n                }\r\n            } catch (error) {\r\n                widget.postMessage({ action: 'error', message: error.message });\r\n            }\r\n        });\r\n    }\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Carrier Solutions - Retention-Focused.o3sez.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":54,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":54,"endColumn":28,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1780,1781],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":66,"column":23,"nodeType":"BlockStatement","messageId":"unexpected","endLine":66,"endColumn":26,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2121,2122],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":77,"column":23,"nodeType":"BlockStatement","messageId":"unexpected","endLine":77,"endColumn":26,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2515,2516],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":78,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":78,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2540,2541],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":105,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":105,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3215,3216],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":121,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":121,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3654,3655],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":147,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":147,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4402,4403],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":166,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":166,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4903,4904],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":190,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":190,"endColumn":28,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6314,6315],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":192,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":192,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6352,6353],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":201,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":201,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6599,6600],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":217,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":217,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6998,6999],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":230,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":230,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[7307,7308],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":254,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":254,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[7980,7981],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Carrier Solutions Page\r\n * Showcase carrier services, pricing tiers, and success stories for B2B conversion\r\n *\r\n * @see docs/PAGE_DATA_IMPLEMENTATION_GUIDE.md\r\n */\r\n\r\nimport wixLocation from 'wix-location';\r\nimport { getCarrierPlatformStats } from 'backend/publicStatsService';\r\nimport { getPricingTiers, getServiceFeatures, getCaseStudies, getFAQs } from 'backend/contentService';\r\n\r\n$w.onReady(async function () {\r\n  await Promise.all([\r\n    loadPricingTiers(),\r\n    loadServiceFeatures(),\r\n    loadCaseStudies(),\r\n    loadFAQs(),\r\n    loadPlatformStats()\r\n  ]);\r\n});\r\n\r\n/**\r\n * Load pricing tiers for display\r\n * Element: #pricingRepeater\r\n */\r\nasync function loadPricingTiers() {\r\n  try {\r\n    const result = await getPricingTiers('carrier');\r\n\r\n    if (!result.success || result.tiers.length === 0) {\r\n      showDefaultPricing();\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#pricingRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = result.tiers;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#tierName').rendered) $item('#tierName').text = itemData.name;\r\n          if ($item('#tierPrice').rendered) $item('#tierPrice').text = itemData.price;\r\n          if ($item('#tierSubtext').rendered) $item('#tierSubtext').text = itemData.priceSubtext;\r\n          if ($item('#tierDescription').rendered) $item('#tierDescription').text = itemData.description;\r\n\r\n          // Popular badge\r\n          if (itemData.isPopular && itemData.badgeText) {\r\n            try {\r\n              const badge = $item('#popularBadge');\r\n              if (badge.rendered) {\r\n                badge.text = itemData.badgeText;\r\n                badge.show();\r\n              }\r\n            } catch (e) { }\r\n          }\r\n\r\n          // CTA button\r\n          try {\r\n            const ctaBtn = $item('#tierCtaBtn');\r\n            if (ctaBtn.rendered) {\r\n              ctaBtn.label = itemData.ctaText;\r\n              ctaBtn.onClick(() => {\r\n                wixLocation.to(itemData.ctaLink);\r\n              });\r\n            }\r\n          } catch (e) { }\r\n\r\n          // Features list\r\n          try {\r\n            const featuresRepeater = $item('#tierFeaturesRepeater');\r\n            if (featuresRepeater.rendered && itemData.features.length > 0) {\r\n              featuresRepeater.data = itemData.features.map((f, i) => ({\r\n                _id: `feature-${i}`,\r\n                text: f\r\n              }));\r\n            }\r\n          } catch (e) { }\r\n        } catch (e) { }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load pricing tiers:', err);\r\n    showDefaultPricing();\r\n  }\r\n}\r\n\r\n/**\r\n * Show default pricing when no collection data exists\r\n */\r\nfunction showDefaultPricing() {\r\n  const defaults = {\r\n    '#basicPrice': '$299',\r\n    '#basicSubtext': 'per hire',\r\n    '#proPrice': '$199',\r\n    '#proSubtext': 'per hire (5+ hires)',\r\n    '#enterprisePrice': 'Custom',\r\n    '#enterpriseSubtext': 'volume pricing'\r\n  };\r\n\r\n  Object.entries(defaults).forEach(([selector, value]) => {\r\n    try {\r\n      const element = $w(selector);\r\n      if (element && element.text !== undefined) element.text = value;\r\n    } catch (e) { }\r\n  });\r\n}\r\n\r\n/**\r\n * Load service features for comparison matrix\r\n * Element: #featureMatrixHtml (HTML component)\r\n */\r\nasync function loadServiceFeatures() {\r\n  try {\r\n    const result = await getServiceFeatures();\r\n\r\n    if (!result.success || result.features.length === 0) {\r\n      try {\r\n        const section = $w('#featureMatrixSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    // Group by category\r\n    const grouped = result.features.reduce((acc, feature) => {\r\n      if (!acc[feature.category]) acc[feature.category] = [];\r\n      acc[feature.category].push({\r\n        name: feature.feature_name,\r\n        description: feature.description,\r\n        basic: feature.tier_basic,\r\n        pro: feature.tier_pro,\r\n        enterprise: feature.tier_enterprise\r\n      });\r\n      return acc;\r\n    }, {});\r\n\r\n    // Send to HTML comparison table\r\n    try {\r\n      const htmlMatrix = $w('#featureMatrixHtml');\r\n      if (htmlMatrix.rendered && htmlMatrix.postMessage) {\r\n        htmlMatrix.postMessage({\r\n          type: 'featureMatrix',\r\n          data: grouped\r\n        });\r\n      }\r\n    } catch (e) { }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load service features:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Load case studies / success stories\r\n * Element: #caseStudiesRepeater\r\n */\r\nasync function loadCaseStudies() {\r\n  try {\r\n    const result = await getCaseStudies('carrier', 3);\r\n\r\n    if (!result.success || result.caseStudies.length === 0) {\r\n      try {\r\n        const section = $w('#caseStudiesSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#caseStudiesRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = result.caseStudies;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#csTitle').rendered) $item('#csTitle').text = itemData.title;\r\n          if ($item('#csCompany').rendered) $item('#csCompany').text = itemData.companyName;\r\n          if ($item('#csLogo').rendered && itemData.logoUrl) $item('#csLogo').src = itemData.logoUrl;\r\n          if ($item('#csChallenge').rendered) $item('#csChallenge').text = itemData.challenge;\r\n          if ($item('#csResult').rendered) $item('#csResult').text = itemData.result;\r\n          if ($item('#csMetricValue').rendered) $item('#csMetricValue').text = itemData.keyMetricValue;\r\n          if ($item('#csMetricLabel').rendered) $item('#csMetricLabel').text = itemData.keyMetric;\r\n          if ($item('#csQuote').rendered) $item('#csQuote').text = `\"${itemData.testimonialQuote}\"`;\r\n          if ($item('#csAuthor').rendered) $item('#csAuthor').text = ` ${itemData.testimonialAuthor}, ${itemData.testimonialTitle}`;\r\n\r\n          if (itemData.fullStudyUrl) {\r\n            try {\r\n              const readMoreBtn = $item('#csReadMore');\r\n              if (readMoreBtn.rendered) readMoreBtn.onClick(() => { wixLocation.to(itemData.fullStudyUrl); });\r\n            } catch (e) { }\r\n          }\r\n        } catch (e) { }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load case studies:', err);\r\n    try {\r\n      const section = $w('#caseStudiesSection');\r\n      if (section.rendered && section.collapse) section.collapse();\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\n/**\r\n * Load FAQs for accordion\r\n * Element: #faqAccordionHtml (HTML component)\r\n */\r\nasync function loadFAQs() {\r\n  try {\r\n    const result = await getFAQs('carrier-solutions');\r\n\r\n    if (!result.success || result.faqs.length === 0) {\r\n      try {\r\n        const section = $w('#faqSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    // Send to HTML accordion component\r\n    try {\r\n      const htmlFaq = $w('#faqAccordionHtml');\r\n      if (htmlFaq.rendered && htmlFaq.postMessage) {\r\n        htmlFaq.postMessage({\r\n          type: 'faqData',\r\n          data: result.faqs\r\n        });\r\n      }\r\n    } catch (e) { }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load FAQs:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Load platform stats for credibility\r\n */\r\nasync function loadPlatformStats() {\r\n  try {\r\n    const stats = await getCarrierPlatformStats();\r\n\r\n    const statElements = {\r\n      '#statQualifiedDrivers': stats.qualifiedDrivers.toLocaleString(),\r\n      '#statAvgTimeToHire': `${stats.avgDaysToHire} days`,\r\n      '#statRetentionRate': `${stats.retentionRate}%`\r\n    };\r\n\r\n    Object.entries(statElements).forEach(([selector, value]) => {\r\n      try {\r\n        const element = $w(selector);\r\n        if (element && element.text !== undefined) element.text = value;\r\n      } catch (e) { }\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load platform stats:', err);\r\n  }\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Carrier Welcome.gnhma.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Checkout.kbyzk.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DOT Compliance in Driver Hiring.ydkkc.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DQF_Compliance_Portal.u6ygh.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_ANNOUNCEMENTS.jgkc4.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":24,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":79,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":79,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2317,2318],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * DRIVER_ANNOUNCEMENTS Page Code\n * Handles PostMessage bridge for driver announcements feed\n */\n\nimport {\n  getAnnouncementsForDriver,\n  markAnnouncementRead,\n  addComment\n} from 'backend/carrierAnnouncementsService.jsw';\nimport wixUsers from 'wix-users';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'driverAnnouncementsReady',\n    'getDriverAnnouncements',\n    'markAnnouncementRead',\n    'addAnnouncementComment'\n  ],\n  outbound: [\n    'driverAnnouncementsData',\n    'announcementCommentResult',\n    'driverContext'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet driverId = null;\nlet carrierId = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('DRIVER_ANNOUNCEMENTS page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  // Get driver context on page load\n  const user = wixUsers.currentUser;\n  if (user.loggedIn) {\n    driverId = user.id;\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'driverAnnouncementsReady':\n      console.log('Driver Announcements HTML ready');\n      if (driverId || carrierId) {\n        sendToHtml('driverContext', { driverId, carrierId });\n      }\n      break;\n\n    case 'getDriverAnnouncements':\n      await handleGetDriverAnnouncements(msg.data);\n      break;\n\n    case 'markAnnouncementRead':\n      await handleMarkAnnouncementRead(msg.data);\n      break;\n\n    case 'addAnnouncementComment':\n      await handleAddAnnouncementComment(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetDriverAnnouncements(data) {\n  try {\n    const did = data?.driverId || driverId;\n    const cid = data?.carrierId || carrierId;\n\n    if (!did || !cid) {\n      sendToHtml('driverAnnouncementsData', { success: false, error: 'Missing driver or carrier context' });\n      return;\n    }\n\n    // Store for later use\n    driverId = did;\n    carrierId = cid;\n\n    const options = {\n      limit: data?.limit || 100,\n      offset: data?.offset || 0\n    };\n\n    const result = await getAnnouncementsForDriver(did, cid, options);\n\n    sendToHtml('driverAnnouncementsData', {\n      success: result.success,\n      announcements: result.success ? result.announcements : [],\n      error: result.error\n    });\n\n  } catch (error) {\n    console.error('Error fetching driver announcements:', error);\n    sendToHtml('driverAnnouncementsData', { success: false, error: error.message });\n  }\n}\n\nasync function handleMarkAnnouncementRead(data) {\n  try {\n    const { announcementId, deviceType, timeSpentSeconds } = data || {};\n    const did = data?.driverId || driverId;\n\n    if (!announcementId || !did) {\n      // Silent fail for read receipts - not critical\n      return;\n    }\n\n    await markAnnouncementRead(announcementId, did, deviceType || 'web', timeSpentSeconds);\n\n  } catch (error) {\n    console.error('Error marking announcement read:', error);\n    // Don't send error to HTML - read receipts should fail silently\n  }\n}\n\nasync function handleAddAnnouncementComment(data) {\n  try {\n    const { announcementId, commentText } = data || {};\n    const did = data?.driverId || driverId;\n\n    if (!announcementId || !did || !commentText) {\n      sendToHtml('announcementCommentResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await addComment(announcementId, did, commentText);\n    sendToHtml('announcementCommentResult', result);\n\n  } catch (error) {\n    console.error('Error adding comment:', error);\n    sendToHtml('announcementCommentResult', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_BADGES.jlfgc.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getBadgeDefinitions' is defined but never used.","line":12,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * DRIVER_BADGES Page Code\r\n * Bridges DRIVER_BADGES.html with badgeService.\r\n *\r\n * HTML uses type key pattern.\r\n * HTML sends: badgesReady, updateFeatured\r\n * HTML expects: achievementsData, featuredUpdated, error\r\n */\r\n\r\nimport {\r\n    getBadges,\r\n    getBadgeDefinitions\r\n} from 'backend/badgeService';\r\n\r\nimport wixUsers from 'wix-users';\r\n\r\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\r\n\r\nfunction safeSend(component, data) {\r\n    try {\r\n        component.postMessage(data);\r\n    } catch (err) {\r\n        console.error('DRIVER_BADGES: safeSend failed:', err);\r\n    }\r\n}\r\n\r\n$w.onReady(function () {\r\n    const component = findHtmlComponent();\r\n    if (!component) {\r\n        console.warn('DRIVER_BADGES: No HTML component found');\r\n        return;\r\n    }\r\n\r\n    component.onMessage(async (event) => {\r\n        const msg = event && event.data;\r\n        if (!msg || !msg.type) return;\r\n        await routeMessage(component, msg);\r\n    });\r\n\r\n    safeSend(component, { type: 'init' });\r\n});\r\n\r\nfunction findHtmlComponent() {\r\n    for (const id of HTML_COMPONENT_IDS) {\r\n        try {\r\n            const el = $w(id);\r\n            if (el && typeof el.onMessage === 'function') {\r\n                return el;\r\n            }\r\n        } catch (e) {\r\n            // Element not present\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nasync function routeMessage(component, msg) {\r\n    switch (msg.type) {\r\n        case 'badgesReady':\r\n            await handleLoadBadges(component);\r\n            break;\r\n        case 'updateFeatured':\r\n            await handleUpdateFeatured(component, msg);\r\n            break;\r\n        default:\r\n            console.warn('DRIVER_BADGES: Unknown type:', msg.type);\r\n    }\r\n}\r\n\r\nasync function handleLoadBadges(component) {\r\n    try {\r\n        const userId = wixUsers.currentUser.id;\r\n        const badges = await getBadges(userId, 'driver');\r\n        safeSend(component, {\r\n            type: 'achievementsData',\r\n            data: {\r\n                achievements: badges.achievements || badges || [],\r\n                featured: badges.featured || []\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error('DRIVER_BADGES: loadBadges error:', error);\r\n        safeSend(component, {\r\n            type: 'achievementsData',\r\n            data: { achievements: [], featured: [] }\r\n        });\r\n    }\r\n}\r\n\r\nasync function handleUpdateFeatured(component, msg) {\r\n    try {\r\n        const data = msg.data || {};\r\n        safeSend(component, {\r\n            type: 'featuredUpdated',\r\n            data: { featured: data.featured || [] }\r\n        });\r\n    } catch (error) {\r\n        console.error('DRIVER_BADGES: updateFeatured error:', error);\r\n        safeSend(component, { type: 'error', data: { message: error.message } });\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_DOCUMENT_UPLOAD.r5jyr.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'wixUsers' is defined but never used.","line":19,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * DRIVER_DOCUMENT_UPLOAD Page Code\r\n * Bridges DRIVER_DOCUMENT_UPLOAD.html with onboardingWorkflowService.\r\n *\r\n * HTML uses type key pattern.\r\n * HTML sends: documentUploadReady, requestDocumentList, uploadDocument\r\n * HTML expects: initDocumentUpload, documentList, uploadResult, verificationUpdate\r\n */\r\n\r\nimport {\n    getWorkflowStatus\n} from 'backend/onboardingWorkflowService';\nimport {\n    getDocumentStatus,\n    uploadDocument as uploadDriverDocument\n} from 'backend/documentCollectionService';\n\r\nimport wixLocationFrontend from 'wix-location-frontend';\r\nimport wixUsers from 'wix-users';\r\n\r\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\r\n\r\nfunction safeSend(component, data) {\r\n    try {\r\n        component.postMessage(data);\r\n    } catch (err) {\r\n        console.error('DRIVER_DOCUMENT_UPLOAD: safeSend failed:', err);\r\n    }\r\n}\r\n\r\n$w.onReady(function () {\r\n    const component = findHtmlComponent();\r\n    if (!component) {\r\n        console.warn('DRIVER_DOCUMENT_UPLOAD: No HTML component found');\r\n        return;\r\n    }\r\n\r\n    component.onMessage(async (event) => {\r\n        const msg = event && event.data;\r\n        if (!msg || !msg.type) return;\r\n        await routeMessage(component, msg);\r\n    });\r\n\r\n    safeSend(component, { type: 'init' });\r\n});\r\n\r\nfunction findHtmlComponent() {\r\n    for (const id of HTML_COMPONENT_IDS) {\r\n        try {\r\n            const el = $w(id);\r\n            if (el && typeof el.onMessage === 'function') {\r\n                return el;\r\n            }\r\n        } catch (e) {\r\n            // Element not present\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nasync function routeMessage(component, msg) {\r\n    switch (msg.type) {\r\n        case 'documentUploadReady':\r\n            await handleDocumentUploadReady(component);\r\n            break;\r\n        case 'requestDocumentList':\r\n            await handleRequestDocumentList(component, msg);\r\n            break;\r\n        case 'uploadDocument':\r\n            await handleUploadDocument(component, msg);\r\n            break;\r\n        default:\r\n            console.warn('DRIVER_DOCUMENT_UPLOAD: Unknown type:', msg.type);\r\n    }\r\n}\r\n\r\nasync function handleDocumentUploadReady(component) {\n    try {\r\n        const query = wixLocationFrontend.query;\r\n        const workflowId = query.workflowId || query.wfId || '';\r\n\r\n        let workflowData = {};\n        let uploadToken = '';\n        if (workflowId) {\n            workflowData = await getWorkflowStatus(workflowId) || {};\n            const docStatus = await getDocumentStatus(workflowId);\n            const firstPendingDoc = (docStatus?.documents || []).find(\n                (d) => d.status === 'requested' || d.status === 'rejected'\n            );\n            uploadToken = firstPendingDoc?.upload_token || '';\n        }\n\n        const workflow = workflowData.workflow || {};\n        const meta = workflow.metadata || {};\n\n        safeSend(component, {\n            type: 'initDocumentUpload',\n            data: {\n                workflowId,\n                uploadToken,\n                driverName: meta.driver_name || workflowData.driverName || '',\n                recruiterName: meta.recruiter_name || workflowData.recruiterName || '',\n                recruiterEmail: meta.recruiter_email || workflowData.recruiterEmail || '',\n                carrierName: meta.carrier_name || workflowData.carrierName || ''\n            }\n        });\n    } catch (error) {\r\n        console.error('DRIVER_DOCUMENT_UPLOAD: init error:', error);\r\n        safeSend(component, {\r\n            type: 'initDocumentUpload',\r\n            data: { workflowId: '', uploadToken: '', driverName: '', recruiterName: '', recruiterEmail: '', carrierName: '' }\r\n        });\r\n    }\r\n}\r\n\r\nasync function handleRequestDocumentList(component, msg) {\n    try {\r\n        const data = msg.data || {};\r\n        const workflowId = data.workflowId;\r\n        if (!workflowId) {\r\n            safeSend(component, { type: 'documentList', data: { documents: [] } });\r\n            return;\r\n        }\r\n        const result = await getDocumentStatus(workflowId);\n        const documents = (result?.documents || []).map((doc) => ({\n            documentId: doc._id || doc.id,\n            documentType: doc.document_type || doc.documentType,\n            displayName: doc.display_name || doc.document_type || 'Document',\n            description: doc.description || '',\n            isRequired: !!doc.is_required,\n            status: doc.status || 'requested',\n            rejectionReason: doc.rejection_reason || null,\n            submittedDate: doc.submitted_date || null\n        }));\n        safeSend(component, {\n            type: 'documentList',\n            data: { documents }\n        });\n    } catch (error) {\r\n        console.error('DRIVER_DOCUMENT_UPLOAD: requestDocumentList error:', error);\r\n        safeSend(component, { type: 'documentList', data: { documents: [] } });\r\n    }\r\n}\r\n\r\nasync function handleUploadDocument(component, msg) {\n    try {\n        const data = msg.data || {};\n        const token = data.token;\n        const documentType = data.documentType;\n        const fileData = {\n            mimeType: data.fileType,\n            size: data.fileSize,\n            fileName: data.fileName,\n            content: data.fileData\n        };\n\n        const result = await uploadDriverDocument(token, documentType, fileData);\n        safeSend(component, {\n            type: 'uploadResult',\n            data: {\n                documentType,\n                success: !!result?.success,\n                documentId: result?.documentId || null,\n                error: result?.error || null\n            }\n        });\n    } catch (error) {\r\n        console.error('DRIVER_DOCUMENT_UPLOAD: uploadDocument error:', error);\r\n        safeSend(component, {\r\n            type: 'uploadResult',\r\n            data: {\r\n                documentType: (msg.data || {}).documentType,\r\n                success: false,\r\n                error: error.message\r\n            }\r\n        });\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_FORUMS.vzg3s.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_GAMIFICATION.ik6n7.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_MY_CAREER.q178n.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\DRIVER_POLICIES.mbmmh.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Driver Dashboard.ctupv.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Driver Jobs (Item).s0js1.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Driver Opportunities - Your Next Career .lb0uy.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Driver Retention Best Practices.ypq30.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\GAMIFICATION_HELP.itvxy.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\HEALTH_WELLNESS.jho72.js","messages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":42,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":42,"endColumn":87},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":47,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":47,"endColumn":75},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":52,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":52,"endColumn":70},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":57,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":57,"endColumn":77},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":67,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":67,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { \r\n    getResourcesByCategory, \r\n    getApprovedTips, \r\n    getTelemedicinePartners, \r\n    getResourceBySlug, \r\n    markResourceHelpful, \r\n    submitTip \r\n} from 'backend/healthService';\r\n\r\n$w.onReady(function () {\r\n    initHealthHub();\r\n});\r\n\r\nfunction initHealthHub() {\r\n    const possibleIds = ['#html1', '#html2', '#html3', '#html4', '#html5', '#healthHub'];\r\n    \r\n    possibleIds.forEach(id => {\r\n        try {\r\n            const htmlComp = $w(id);\r\n            if (htmlComp && htmlComp.onMessage) {\r\n                console.log('[VELO] Health Hub Bridge active on', id);\r\n                attachHandlers(htmlComp);\r\n            }\r\n        } catch (e) { /* skip */ }\r\n    });\r\n}\r\n\r\nfunction attachHandlers(htmlComp) {\r\n    htmlComp.onMessage(async (event) => {\r\n        const msg = event.data;\r\n        if (!msg || !msg.type) return;\r\n\r\n        console.log('[VELO] Health Hub message:', msg.type);\r\n\r\n        try {\r\n            switch (msg.type) {\r\n                case 'ready':\r\n                    // Initial load handled by separate messages in HTML\r\n                    break;\r\n\r\n                case 'getResources':\r\n                    const resources = await getResourcesByCategory(msg.data.category);\r\n                    htmlComp.postMessage({ type: 'resourcesData', data: resources.items });\r\n                    break;\r\n\r\n                case 'getTips':\r\n                    const tips = await getApprovedTips(msg.data.category);\r\n                    htmlComp.postMessage({ type: 'tipsData', data: tips });\r\n                    break;\r\n\r\n                case 'getPartners':\r\n                    const partners = await getTelemedicinePartners();\r\n                    htmlComp.postMessage({ type: 'partnersData', data: partners });\r\n                    break;\r\n\r\n                case 'getResourceDetail':\r\n                    const resource = await getResourceBySlug(msg.data.slug);\r\n                    htmlComp.postMessage({ type: 'resourceDetail', data: resource });\r\n                    break;\r\n\r\n                case 'markHelpful':\r\n                    await markResourceHelpful(msg.data.id);\r\n                    // No return data needed for now, optimistic UI\r\n                    break;\r\n\r\n                case 'submitTip':\r\n                    const result = await submitTip(msg.data);\r\n                    if (result.success) {\r\n                        // Optionally notify user\r\n                    }\r\n                    break;\r\n\r\n                default:\r\n                    console.warn('[VELO] Unknown health hub message:', msg.type);\r\n            }\r\n        } catch (err) {\r\n            console.error('[VELO] Health hub handler error:', err);\r\n        }\r\n    });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Home Nightly - Regional CDL Careers.uixmh.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getTopJobOpportunities' is defined but never used.","line":17,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":56},{"ruleId":"no-unused-vars","severity":1,"message":"'getRecentHires' is defined but never used.","line":17,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":72},{"ruleId":"no-unused-vars","severity":1,"message":"'isLoading' is assigned a value but never used.","line":21,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Home Nightly - Regional CDL Careers Landing Page\r\n *\r\n * Dedicated page for Regional truck drivers seeking home-nightly or\r\n * home-weekly positions. Emphasizes work-life balance, family time,\r\n * and predictable schedules.\r\n *\r\n * Element IDs:\r\n * - #regionalJobsRepeater - Regional job listings\r\n * - #homeTimeStats - Home time statistics display\r\n * - #workLifeRepeater - Work-life balance benefits\r\n * - #routesRepeater - Sample regional routes\r\n * - #applyRegionalBtn - CTA button\r\n */\r\n\r\nimport wixLocation from 'wix-location';\r\nimport { getJobsByOperationType, getTopJobOpportunities, getRecentHires } from 'backend/publicStatsService';\r\n\r\n// Page state\r\nlet regionalJobs = [];\r\nlet isLoading = false;\r\n\r\n$w.onReady(function () {\r\n    initializePage();\r\n});\r\n\r\n/**\r\n * Initialize all page components\r\n */\r\nasync function initializePage() {\r\n    try {\r\n        showLoadingState(true);\r\n\r\n        // Load all data in parallel\r\n        await Promise.all([\r\n            loadRegionalJobs(),\r\n            loadHomeTimeStats(),\r\n            loadWorkLifeBalance(),\r\n            loadRegionalRoutes()\r\n        ]);\r\n\r\n        // Set up event handlers\r\n        setupEventHandlers();\r\n\r\n        showLoadingState(false);\r\n    } catch (error) {\r\n        console.error('Regional page initialization error:', error);\r\n        showLoadingState(false);\r\n    }\r\n}\r\n\r\n/**\r\n * Load Regional-specific job opportunities\r\n * Fetches jobs filtered by operation_type = 'Regional'\r\n */\r\nasync function loadRegionalJobs() {\r\n    try {\r\n        const jobs = await getJobsByOperationType('Regional', 8);\r\n        regionalJobs = jobs;\r\n\r\n        if ($w('#regionalJobsRepeater').rendered) {\r\n            if (jobs.length > 0) {\r\n                $w('#regionalJobsRepeater').data = jobs;\r\n                $w('#regionalJobsRepeater').onItemReady(($item, itemData) => {\r\n                    renderRegionalJobItem($item, itemData);\r\n                });\r\n            } else {\r\n                // Show fallback content if no Regional jobs available\r\n                $w('#regionalJobsRepeater').collapse();\r\n            }\r\n        }\r\n\r\n        // Update stats display\r\n        updateRegionalStats(jobs);\r\n\r\n    } catch (error) {\r\n        console.error('Error loading Regional jobs:', error);\r\n        regionalJobs = [];\r\n    }\r\n}\r\n\r\n/**\r\n * Render individual Regional job item in repeater\r\n */\r\nfunction renderRegionalJobItem($item, jobData) {\r\n    // Carrier name and location\r\n    if ($item('#carrierName')) {\r\n        $item('#carrierName').text = jobData.carrierName || 'Regional Carrier';\r\n    }\r\n    if ($item('#jobLocation')) {\r\n        $item('#jobLocation').text = jobData.location || 'Regional';\r\n    }\r\n\r\n    // Pay information\r\n    if ($item('#payRange')) {\r\n        $item('#payRange').text = jobData.payRange || 'Competitive CPM';\r\n    }\r\n\r\n    // Home time - emphasize this for regional jobs\r\n    if ($item('#homeTime')) {\r\n        const homeTimeText = formatHomeTime(jobData.homeTime);\r\n        $item('#homeTime').text = homeTimeText;\r\n    }\r\n    if ($item('#homeTimeHighlight')) {\r\n        $item('#homeTimeHighlight').text = getHomeTimeHighlight(jobData.homeTime);\r\n    }\r\n\r\n    // Benefits focused on family/balance\r\n    if ($item('#benefits')) {\r\n        $item('#benefits').text = jobData.benefits || 'Full benefits + Home time';\r\n    }\r\n\r\n    // Route radius info\r\n    if ($item('#routeRadius')) {\r\n        $item('#routeRadius').text = getRouteRadius(jobData.location);\r\n    }\r\n\r\n    // Apply button\r\n    if ($item('#jobApplyBtn')) {\r\n        $item('#jobApplyBtn').onClick(() => {\r\n            navigateToApplication(jobData._id);\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Load home time statistics\r\n * Displays metrics about home frequency for regional drivers\r\n */\r\nasync function loadHomeTimeStats() {\r\n    const stats = {\r\n        homeNightly: {\r\n            value: '65%',\r\n            label: 'Home Nightly Positions',\r\n            description: 'Over half of our regional jobs get you home every night'\r\n        },\r\n        homeWeekly: {\r\n            value: '92%',\r\n            label: 'Home Weekly Guaranteed',\r\n            description: 'Nearly all regional positions guarantee weekly home time'\r\n        },\r\n        avgMilesFromHome: {\r\n            value: '250',\r\n            label: 'Avg Miles From Home',\r\n            description: 'Regional routes keep you close to your family'\r\n        },\r\n        predictableSchedule: {\r\n            value: '87%',\r\n            label: 'Predictable Schedules',\r\n            description: 'Know your routes and when you\\'ll be home'\r\n        }\r\n    };\r\n\r\n    // Update individual stat elements if they exist\r\n    if ($w('#homeTimeStats').rendered) {\r\n        // If it's a container, update child elements\r\n        updateStatElement('#homeNightlyValue', stats.homeNightly.value);\r\n        updateStatElement('#homeNightlyLabel', stats.homeNightly.label);\r\n        updateStatElement('#homeWeeklyValue', stats.homeWeekly.value);\r\n        updateStatElement('#homeWeeklyLabel', stats.homeWeekly.label);\r\n        updateStatElement('#avgMilesValue', stats.avgMilesFromHome.value + ' mi');\r\n        updateStatElement('#avgMilesLabel', stats.avgMilesFromHome.label);\r\n        updateStatElement('#predictableValue', stats.predictableSchedule.value);\r\n        updateStatElement('#predictableLabel', stats.predictableSchedule.label);\r\n    }\r\n\r\n    // If there's a stats repeater instead\r\n    if ($w('#homeTimeStatsRepeater').rendered) {\r\n        const statsArray = Object.values(stats).map((stat, index) => ({\r\n            _id: `stat_${index}`,\r\n            ...stat\r\n        }));\r\n\r\n        $w('#homeTimeStatsRepeater').data = statsArray;\r\n        $w('#homeTimeStatsRepeater').onItemReady(($item, itemData) => {\r\n            if ($item('#statValue')) $item('#statValue').text = itemData.value;\r\n            if ($item('#statLabel')) $item('#statLabel').text = itemData.label;\r\n            if ($item('#statDescription')) $item('#statDescription').text = itemData.description;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Load work-life balance benefits\r\n * Highlights family-focused advantages of regional driving\r\n */\r\nasync function loadWorkLifeBalance() {\r\n    const benefits = [\r\n        {\r\n            _id: 'home_nightly',\r\n            title: 'Home Every Night',\r\n            description: 'Sleep in your own bed. Be there for dinner. Tuck your kids in. Regional routes make it possible.',\r\n            icon: 'home',\r\n            highlight: 'Most Popular'\r\n        },\r\n        {\r\n            _id: 'weekends_off',\r\n            title: 'Weekends Off',\r\n            description: 'Many regional positions offer Saturday and Sunday off. Attend games, events, and family gatherings.',\r\n            icon: 'calendar',\r\n            highlight: 'Family Time'\r\n        },\r\n        {\r\n            _id: 'predictable',\r\n            title: 'Predictable Schedule',\r\n            description: 'Know your routes and schedule in advance. Plan your life around work, not the other way around.',\r\n            icon: 'clock',\r\n            highlight: 'Plan Ahead'\r\n        },\r\n        {\r\n            _id: 'benefits',\r\n            title: 'Full Benefits Package',\r\n            description: 'Health, dental, vision, 401k with match. Take care of your family with comprehensive coverage.',\r\n            icon: 'health',\r\n            highlight: 'Family Coverage'\r\n        },\r\n        {\r\n            _id: 'no_slip_seat',\r\n            title: 'Dedicated Equipment',\r\n            description: 'Your truck, your space. No slip-seating means you personalize your cab and keep it how you like it.',\r\n            icon: 'truck',\r\n            highlight: 'Your Truck'\r\n        },\r\n        {\r\n            _id: 'local_knowledge',\r\n            title: 'Know Your Routes',\r\n            description: 'Drive the same lanes and build relationships with customers. Less stress, more efficiency.',\r\n            icon: 'route',\r\n            highlight: 'Familiar Roads'\r\n        }\r\n    ];\r\n\r\n    if ($w('#workLifeRepeater').rendered) {\r\n        $w('#workLifeRepeater').data = benefits;\r\n        $w('#workLifeRepeater').onItemReady(($item, itemData) => {\r\n            if ($item('#benefitTitle')) $item('#benefitTitle').text = itemData.title;\r\n            if ($item('#benefitDescription')) $item('#benefitDescription').text = itemData.description;\r\n            if ($item('#benefitHighlight')) $item('#benefitHighlight').text = itemData.highlight;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Load sample regional routes\r\n * Shows example route descriptions for driver context\r\n */\r\nasync function loadRegionalRoutes() {\r\n    const routes = [\r\n        {\r\n            _id: 'northeast',\r\n            region: 'Northeast',\r\n            description: 'NY, NJ, PA, CT, MA regional routes',\r\n            homeBase: 'New Jersey Hub',\r\n            avgMiles: '1,800-2,200/week',\r\n            homeTime: 'Home Daily',\r\n            highlights: ['Major metro delivery', 'Port runs available', 'Touch freight options']\r\n        },\r\n        {\r\n            _id: 'southeast',\r\n            region: 'Southeast',\r\n            description: 'FL, GA, NC, SC, TN regional runs',\r\n            homeBase: 'Atlanta Hub',\r\n            avgMiles: '2,000-2,400/week',\r\n            homeTime: 'Home 2-3x/week',\r\n            highlights: ['Drop and hook', 'No touch freight', 'Dedicated lanes']\r\n        },\r\n        {\r\n            _id: 'midwest',\r\n            region: 'Midwest',\r\n            description: 'IL, IN, OH, MI, WI regional routes',\r\n            homeBase: 'Chicago Hub',\r\n            avgMiles: '1,500-2,000/week',\r\n            homeTime: 'Home Nightly',\r\n            highlights: ['Manufacturing deliveries', 'Consistent freight', 'Day cab options']\r\n        },\r\n        {\r\n            _id: 'texas',\r\n            region: 'Texas Triangle',\r\n            description: 'Dallas, Houston, San Antonio corridor',\r\n            homeBase: 'DFW Hub',\r\n            avgMiles: '1,800-2,200/week',\r\n            homeTime: 'Home Daily',\r\n            highlights: ['Growing market', 'New equipment', 'High volume']\r\n        },\r\n        {\r\n            _id: 'southwest',\r\n            region: 'Southwest',\r\n            description: 'AZ, NV, CA regional runs',\r\n            homeBase: 'Phoenix Hub',\r\n            avgMiles: '2,000-2,500/week',\r\n            homeTime: 'Home Weekly',\r\n            highlights: ['Intermodal options', 'Dry van freight', 'Reefer available']\r\n        },\r\n        {\r\n            _id: 'pacific_nw',\r\n            region: 'Pacific Northwest',\r\n            description: 'WA, OR, ID regional routes',\r\n            homeBase: 'Seattle Hub',\r\n            avgMiles: '1,600-2,000/week',\r\n            homeTime: 'Home 2-3x/week',\r\n            highlights: ['Scenic routes', 'Tech industry freight', 'Growing demand']\r\n        }\r\n    ];\r\n\r\n    if ($w('#routesRepeater').rendered) {\r\n        $w('#routesRepeater').data = routes;\r\n        $w('#routesRepeater').onItemReady(($item, itemData) => {\r\n            if ($item('#routeRegion')) $item('#routeRegion').text = itemData.region;\r\n            if ($item('#routeDescription')) $item('#routeDescription').text = itemData.description;\r\n            if ($item('#routeHomeBase')) $item('#routeHomeBase').text = itemData.homeBase;\r\n            if ($item('#routeAvgMiles')) $item('#routeAvgMiles').text = itemData.avgMiles;\r\n            if ($item('#routeHomeTime')) $item('#routeHomeTime').text = itemData.homeTime;\r\n            if ($item('#routeHighlights')) {\r\n                $item('#routeHighlights').text = itemData.highlights.join(' | ');\r\n            }\r\n\r\n            // Route selection handler\r\n            if ($item('#selectRouteBtn')) {\r\n                $item('#selectRouteBtn').onClick(() => {\r\n                    filterJobsByRegion(itemData.region);\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Update Regional statistics display\r\n */\r\nfunction updateRegionalStats(jobs) {\r\n    if ($w('#regionalStatsText').rendered) {\r\n        const homeNightlyCount = jobs.filter(j =>\r\n            j.homeTime && j.homeTime.toLowerCase().includes('daily') ||\r\n            j.homeTime && j.homeTime.toLowerCase().includes('nightly')\r\n        ).length;\r\n\r\n        $w('#regionalStatsText').text = `${jobs.length} Regional positions | ${homeNightlyCount} Home Nightly`;\r\n    }\r\n\r\n    if ($w('#totalRegionalJobs').rendered) {\r\n        $w('#totalRegionalJobs').text = jobs.length.toString();\r\n    }\r\n}\r\n\r\n/**\r\n * Update individual stat element\r\n */\r\nfunction updateStatElement(selector, value) {\r\n    try {\r\n        if ($w(selector).rendered) {\r\n            $w(selector).text = value;\r\n        }\r\n    } catch (e) {\r\n        // Element may not exist, skip\r\n    }\r\n}\r\n\r\n/**\r\n * Set up page event handlers\r\n */\r\nfunction setupEventHandlers() {\r\n    // Main CTA button\r\n    if ($w('#applyRegionalBtn').rendered) {\r\n        $w('#applyRegionalBtn').onClick(() => {\r\n            wixLocation.to('/apply-for-cdl-driving-jobs?type=Regional');\r\n        });\r\n    }\r\n\r\n    // Alternative CTA buttons\r\n    if ($w('#applyNowButton').rendered) {\r\n        $w('#applyNowButton').onClick(() => {\r\n            wixLocation.to('/apply-for-cdl-driving-jobs?type=Regional');\r\n        });\r\n    }\r\n\r\n    // Filter buttons\r\n    if ($w('#filterHomeNightly').rendered) {\r\n        $w('#filterHomeNightly').onClick(() => filterByHomeTime('daily'));\r\n    }\r\n\r\n    if ($w('#filterHomeWeekly').rendered) {\r\n        $w('#filterHomeWeekly').onClick(() => filterByHomeTime('weekly'));\r\n    }\r\n\r\n    if ($w('#filterWeekendsOff').rendered) {\r\n        $w('#filterWeekendsOff').onClick(() => filterByHomeTime('weekends'));\r\n    }\r\n}\r\n\r\n/**\r\n * Navigate to job application with carrier ID\r\n */\r\nfunction navigateToApplication(carrierId) {\r\n    wixLocation.to(`/apply-for-cdl-driving-jobs?carrier=${carrierId}&type=Regional`);\r\n}\r\n\r\n/**\r\n * Filter jobs by home time preference\r\n */\r\nfunction filterByHomeTime(preference) {\r\n    let filtered = regionalJobs;\r\n\r\n    switch (preference) {\r\n        case 'daily':\r\n            filtered = regionalJobs.filter(j =>\r\n                j.homeTime && (j.homeTime.toLowerCase().includes('daily') ||\r\n                j.homeTime.toLowerCase().includes('nightly'))\r\n            );\r\n            break;\r\n        case 'weekly':\r\n            filtered = regionalJobs.filter(j =>\r\n                j.homeTime && j.homeTime.toLowerCase().includes('weekly')\r\n            );\r\n            break;\r\n        case 'weekends':\r\n            filtered = regionalJobs.filter(j =>\r\n                j.homeTime && j.homeTime.toLowerCase().includes('weekend')\r\n            );\r\n            break;\r\n    }\r\n\r\n    if ($w('#regionalJobsRepeater').rendered) {\r\n        $w('#regionalJobsRepeater').data = filtered.length > 0 ? filtered : regionalJobs;\r\n    }\r\n}\r\n\r\n/**\r\n * Filter jobs by region\r\n */\r\nfunction filterJobsByRegion(region) {\r\n    // Map region names to state filters\r\n    const regionStates = {\r\n        'Northeast': ['NY', 'NJ', 'PA', 'CT', 'MA'],\r\n        'Southeast': ['FL', 'GA', 'NC', 'SC', 'TN'],\r\n        'Midwest': ['IL', 'IN', 'OH', 'MI', 'WI'],\r\n        'Texas Triangle': ['TX'],\r\n        'Southwest': ['AZ', 'NV', 'CA'],\r\n        'Pacific Northwest': ['WA', 'OR', 'ID']\r\n    };\r\n\r\n    const states = regionStates[region] || [];\r\n\r\n    const filtered = regionalJobs.filter(job => {\r\n        const jobState = extractState(job.location);\r\n        return states.includes(jobState);\r\n    });\r\n\r\n    if ($w('#regionalJobsRepeater').rendered) {\r\n        $w('#regionalJobsRepeater').data = filtered.length > 0 ? filtered : regionalJobs;\r\n    }\r\n}\r\n\r\n/**\r\n * Show/hide loading state\r\n */\r\nfunction showLoadingState(loading) {\r\n    isLoading = loading;\r\n\r\n    if ($w('#loadingIndicator').rendered) {\r\n        loading ? $w('#loadingIndicator').show() : $w('#loadingIndicator').hide();\r\n    }\r\n}\r\n\r\n// Utility functions\r\n\r\nfunction formatHomeTime(homeTime) {\r\n    if (!homeTime) return 'Home Weekly';\r\n\r\n    const lower = homeTime.toLowerCase();\r\n    if (lower.includes('daily') || lower.includes('nightly')) {\r\n        return 'Home Every Night';\r\n    } else if (lower.includes('2-3') || lower.includes('multiple')) {\r\n        return 'Home 2-3x Per Week';\r\n    } else if (lower.includes('weekly')) {\r\n        return 'Home Every Weekend';\r\n    }\r\n    return homeTime;\r\n}\r\n\r\nfunction getHomeTimeHighlight(homeTime) {\r\n    if (!homeTime) return 'Weekly Home Time';\r\n\r\n    const lower = homeTime.toLowerCase();\r\n    if (lower.includes('daily') || lower.includes('nightly')) {\r\n        return 'Sleep in your own bed!';\r\n    } else if (lower.includes('2-3')) {\r\n        return 'Multiple nights home';\r\n    }\r\n    return 'Guaranteed home time';\r\n}\r\n\r\nfunction getRouteRadius(location) {\r\n    // Estimate based on location\r\n    if (!location) return '200-300 mile radius';\r\n    return '150-300 mile radius';\r\n}\r\n\r\nfunction extractState(location) {\r\n    if (!location) return '';\r\n    const parts = location.split(',');\r\n    if (parts.length >= 2) {\r\n        return parts[1].trim().toUpperCase().substring(0, 2);\r\n    }\r\n    return '';\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Home.c1dmp.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\LMDR Privacy Policy.cb4ub.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Last Mile Delivery Driver Staffing.ubhv0.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\MENTOR_PROGRAM.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Member Page.k40gh.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMemberActivityStats' is defined but never used.","line":6,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":98},{"ruleId":"no-unused-vars","severity":1,"message":"'cachedDashboardData' is assigned a value but never used.","line":76,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'cachedProfile' is assigned a value but never used.","line":77,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// MEMBER PAGE - Member Dashboard\r\n// Provides overview of profile, applications, notifications, and quick actions\r\n// ============================================================================\r\n\r\nimport { getMemberDashboard, getMemberNotifications, markNotificationRead, getMemberActivityStats } from 'backend/memberService';\r\nimport { getDriverApplications } from 'backend/applicationService';\r\nimport { getUnreadCount } from 'backend/messaging';\r\nimport { getOrCreateDriverProfile } from 'backend/driverProfiles';\r\nimport wixUsers from 'wix-users';\r\nimport wixLocation from 'wix-location';\r\n\r\n// ============================================================================\r\n// CONFIGURATION\r\n// ============================================================================\r\n\r\nconst CONFIG = {\r\n    htmlComponentId: 'memberDashboardHtml',\r\n    loginUrl: '/login',\r\n    matchingPageUrl: '/ai-matching',\r\n    driverDashboardUrl: '/driver-dashboard',\r\n    quickApplyUrl: '/quick-apply',\r\n    profilePageUrl: '/ai-matching'\r\n};\r\n\r\n// ============================================================================\r\n// MESSAGE VALIDATION SYSTEM\r\n// ============================================================================\r\n\r\nconst DEBUG_MESSAGES = true; // Set to false in production\r\n\r\n// Registry of all valid messages - single source of truth\r\nconst MESSAGE_REGISTRY = {\r\n    // Messages FROM HTML that page code handles\r\n    inbound: [\r\n        'memberDashboardReady',\r\n        'markNotificationRead',\r\n        'markAllNotificationsRead',\r\n        'navigateTo',\r\n        'refreshDashboard',\r\n        'quickAction',\r\n        'ping' // Health check\r\n    ],\r\n    // Messages TO HTML that page code sends\r\n    outbound: [\r\n        'dashboardData',\r\n        'profileUpdate',\r\n        'notificationsUpdate',\r\n        'applicationsUpdate',\r\n        'activityStatsUpdate',\r\n        'notificationMarkedRead',\r\n        'error',\r\n        'pong' // Health check response\r\n    ]\r\n};\r\n\r\nfunction validateInboundMessage(action) {\r\n    if (!MESSAGE_REGISTRY.inbound.includes(action)) {\r\n        console.warn(`?? UNREGISTERED INBOUND MESSAGE: \"${action}\" - Add to MESSAGE_REGISTRY.inbound`);\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction logMessageFlow(direction, type, data) {\r\n    if (!DEBUG_MESSAGES) return;\r\n    const arrow = direction === 'in' ? '??' : '??';\r\n    const label = direction === 'in' ? 'HTML?Velo' : 'Velo?HTML';\r\n    console.log(`${arrow} [${label}] ${type}`, data ? Object.keys(data) : '(no data)');\r\n}\r\n\r\n// ============================================================================\r\n// STATE\r\n// ============================================================================\r\n\r\nlet cachedDashboardData = null;\r\nlet cachedProfile = null;\r\n\r\n// ============================================================================\r\n// PAGE INITIALIZATION\r\n// ============================================================================\r\n\r\n$w.onReady(async function () {\r\n    console.log('?? Member Page Ready');\r\n    console.log('?? Message Registry:', {\r\n        inbound: MESSAGE_REGISTRY.inbound.length,\r\n        outbound: MESSAGE_REGISTRY.outbound.length\r\n    });\r\n\r\n    // Check if user is logged in\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        console.log('?? User not logged in, redirecting to login...');\r\n        wixLocation.to(CONFIG.loginUrl);\r\n        return;\r\n    }\r\n\r\n    // Set up HTML component message handlers\r\n    setupHtmlMessageHandlers();\r\n\r\n    // Load dashboard data\r\n    await loadDashboard();\r\n});\r\n\r\n// ============================================================================\r\n// HTML COMPONENT COMMUNICATION\r\n// ============================================================================\r\n\r\nfunction getHtmlComponent() {\r\n    try {\r\n        const component = $w(`#${CONFIG.htmlComponentId}`);\r\n        if (component && component.postMessage) {\r\n            return component;\r\n        }\r\n    } catch (e) {\r\n        console.warn('?? HTML component not found:', CONFIG.htmlComponentId);\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction setupHtmlMessageHandlers() {\r\n    const htmlComponent = getHtmlComponent();\r\n\r\n    if (htmlComponent) {\r\n        htmlComponent.onMessage((event) => {\r\n            handleHtmlMessage(event.data);\r\n        });\r\n        console.log('? HTML message handlers set up');\r\n    } else {\r\n        console.warn('?? HTML component not found, skipping message handler setup');\r\n    }\r\n}\r\n\r\nasync function handleHtmlMessage(msg) {\r\n    if (!msg || !msg.type) return;\r\n\r\n    const action = msg.action || msg.type;\r\n\r\n    // Validate and log inbound message\r\n    validateInboundMessage(action);\r\n    logMessageFlow('in', action, msg.data);\r\n\r\n    try {\r\n        switch (action) {\r\n            // Health check - respond immediately\r\n            case 'ping':\r\n                sendToHtml('pong', {\r\n                    timestamp: Date.now(),\r\n                    registeredInbound: MESSAGE_REGISTRY.inbound.length,\r\n                    registeredOutbound: MESSAGE_REGISTRY.outbound.length\r\n                });\r\n                break;\r\n\r\n            case 'memberDashboardReady':\r\n                await loadDashboard();\r\n                break;\r\n\r\n            case 'refreshDashboard':\r\n                await loadDashboard();\r\n                break;\r\n\r\n            case 'markNotificationRead':\r\n                await handleMarkNotificationRead(msg.data);\r\n                break;\r\n\r\n            case 'markAllNotificationsRead':\r\n                await handleMarkAllNotificationsRead();\r\n                break;\r\n\r\n            case 'navigateTo':\r\n                handleNavigateTo(msg.data);\r\n                break;\r\n\r\n            case 'quickAction':\r\n                handleQuickAction(msg.data);\r\n                break;\r\n\r\n            default:\r\n                console.warn('?? Unhandled action:', action);\r\n        }\r\n    } catch (error) {\r\n        console.error('? Error handling message:', error);\r\n        sendToHtml('error', { message: error.message });\r\n    }\r\n}\r\n\r\nfunction sendToHtml(type, data) {\r\n    // Validate outbound message is registered\r\n    if (!MESSAGE_REGISTRY.outbound.includes(type)) {\r\n        console.warn(`?? UNREGISTERED OUTBOUND MESSAGE: \"${type}\" - Add to MESSAGE_REGISTRY.outbound`);\r\n    }\r\n    logMessageFlow('out', type, data);\r\n\r\n    const component = getHtmlComponent();\r\n    if (component) {\r\n        component.postMessage({ type, data, timestamp: Date.now() });\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// MAIN DASHBOARD LOADER\r\n// ============================================================================\r\n\r\nasync function loadDashboard() {\r\n    console.log('?? Loading member dashboard...');\r\n\r\n    try {\r\n        // Load all dashboard data in parallel\r\n        const [dashboardResult, applicationsResult, profileResult, unreadResult] = await Promise.all([\r\n            getMemberDashboard(),\r\n            getDriverApplications(),\r\n            getOrCreateDriverProfile(),\r\n            getUnreadCount()\r\n        ]);\r\n\r\n        console.log('?? Dashboard data loaded:', {\r\n            dashboard: dashboardResult.success,\r\n            applications: applicationsResult.success,\r\n            profile: profileResult.success,\r\n            unread: unreadResult.success\r\n        });\r\n\r\n        // Cache the data\r\n        if (dashboardResult.success) {\r\n            cachedDashboardData = dashboardResult;\r\n        }\r\n        if (profileResult.success) {\r\n            cachedProfile = profileResult.profile;\r\n        }\r\n\r\n        // Update UI sections\r\n        await Promise.all([\r\n            loadProfileSection(profileResult),\r\n            loadApplicationsSection(applicationsResult),\r\n            loadNotificationsSection(dashboardResult.notifications || [], unreadResult),\r\n            loadQuickActions(dashboardResult.quickActions || [], profileResult.profile)\r\n        ]);\r\n\r\n        // Send complete data to HTML component\r\n        sendToHtml('dashboardData', {\r\n            profile: profileResult.success ? profileResult.profile : null,\r\n            applications: applicationsResult.success ? applicationsResult.applications : [],\r\n            notifications: dashboardResult.success ? dashboardResult.notifications : [],\r\n            activity: dashboardResult.success ? dashboardResult.activity : null,\r\n            quickActions: dashboardResult.success ? dashboardResult.quickActions : [],\r\n            unreadMessageCount: unreadResult.success ? unreadResult.count : 0\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('? Dashboard load error:', error);\r\n        sendToHtml('error', { message: 'Failed to load dashboard data' });\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// PROFILE SECTION\r\n// ============================================================================\r\n\r\nasync function loadProfileSection(profileResult) {\r\n    try {\r\n        const profile = profileResult.success ? profileResult.profile : null;\r\n\r\n        // Update display name\r\n        if ($w('#displayName').rendered) {\r\n            try {\r\n                $w('#displayName').text = profile?.display_name || 'Welcome, Driver';\r\n            } catch (e) {\r\n                console.warn('?? Could not set displayName:', e.message);\r\n            }\r\n        }\r\n\r\n        // Update email\r\n        if ($w('#memberEmail').rendered) {\r\n            try {\r\n                $w('#memberEmail').text = profile?.email || '';\r\n            } catch (e) {\r\n                console.warn('?? Could not set memberEmail:', e.message);\r\n            }\r\n        }\r\n\r\n        // Update profile completeness\r\n        const completeness = profile?.profile_completeness_score || 0;\r\n\r\n        if ($w('#profileCompletenessText').rendered) {\r\n            try {\r\n                $w('#profileCompletenessText').text = `${completeness}% Complete`;\r\n            } catch (e) {\r\n                console.warn('?? Could not set profileCompletenessText:', e.message);\r\n            }\r\n        }\r\n\r\n        if ($w('#profileCompletenessBar').rendered) {\r\n            try {\r\n                // Assuming this is a progress bar element\r\n                $w('#profileCompletenessBar').value = completeness;\r\n            } catch (e) {\r\n                // Try alternative - might be a box element with width styling\r\n                try {\r\n                    $w('#profileCompletenessBar').style.width = `${completeness}%`;\r\n                } catch (e2) {\r\n                    console.warn('?? Could not set profileCompletenessBar:', e2.message);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Show missing fields message if profile is incomplete\r\n        if (profile?.missing_fields && profile.missing_fields.length > 0 && completeness < 80) {\r\n            console.log('?? Missing profile fields:', profile.missing_fields.join(', '));\r\n        }\r\n\r\n        // Send profile update to HTML\r\n        sendToHtml('profileUpdate', {\r\n            profile,\r\n            completeness,\r\n            missingFields: profile?.missing_fields || [],\r\n            isComplete: completeness >= 80\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('? Error loading profile section:', error);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// APPLICATIONS SECTION\r\n// ============================================================================\r\n\r\nasync function loadApplicationsSection(applicationsResult) {\r\n    try {\r\n        const applications = applicationsResult.success ? applicationsResult.applications : [];\r\n        const totalCount = applicationsResult.success ? applicationsResult.totalCount : 0;\r\n\r\n        // Count active applications (applied, in_review, interviewing, contacted)\r\n        const activeStatuses = ['applied', 'in_review', 'interviewing', 'contacted', 'reviewing'];\r\n        const activeCount = applications.filter(app =>\r\n            activeStatuses.includes(app.status || app.action)\r\n        ).length;\r\n\r\n        // Update counts\r\n        if ($w('#activeApplicationsCount').rendered) {\r\n            try {\r\n                $w('#activeApplicationsCount').text = String(activeCount);\r\n            } catch (e) {\r\n                console.warn('?? Could not set activeApplicationsCount:', e.message);\r\n            }\r\n        }\r\n\r\n        if ($w('#totalApplicationsCount').rendered) {\r\n            try {\r\n                $w('#totalApplicationsCount').text = String(totalCount);\r\n            } catch (e) {\r\n                console.warn('?? Could not set totalApplicationsCount:', e.message);\r\n            }\r\n        }\r\n\r\n        // Populate applications repeater\r\n        if ($w('#applicationsRepeater').rendered) {\r\n            try {\r\n                const recentApplications = applications.slice(0, 5);\r\n\r\n                if (recentApplications.length > 0) {\r\n                    $w('#applicationsRepeater').data = recentApplications.map(app => ({\r\n                        _id: app._id,\r\n                        carrierName: app.carrier_name || 'Unknown Carrier',\r\n                        carrierDOT: app.carrier_dot,\r\n                        status: app.status || app.action || 'pending',\r\n                        statusLabel: getStatusLabel(app.status || app.action),\r\n                        statusColor: getStatusColor(app.status || app.action),\r\n                        appliedDate: formatDate(app.application_date || app.action_timestamp || app._createdDate),\r\n                        matchScore: app.match_score || 0\r\n                    }));\r\n\r\n                    $w('#applicationsRepeater').onItemReady(($item, itemData) => {\r\n                        setupApplicationItem($item, itemData);\r\n                    });\r\n\r\n                    $w('#applicationsRepeater').expand();\r\n                } else {\r\n                    $w('#applicationsRepeater').collapse();\r\n                }\r\n            } catch (e) {\r\n                console.warn('?? Could not set up applicationsRepeater:', e.message);\r\n            }\r\n        }\r\n\r\n        // Send applications update to HTML\r\n        sendToHtml('applicationsUpdate', {\r\n            applications: applications.slice(0, 10),\r\n            activeCount,\r\n            totalCount\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('? Error loading applications section:', error);\r\n    }\r\n}\r\n\r\nfunction setupApplicationItem($item, itemData) {\r\n    try {\r\n        if ($item('#appCarrierName')) {\r\n            $item('#appCarrierName').text = itemData.carrierName;\r\n        }\r\n        if ($item('#appStatus')) {\r\n            $item('#appStatus').text = itemData.statusLabel;\r\n        }\r\n        if ($item('#appStatusBadge')) {\r\n            $item('#appStatusBadge').style.backgroundColor = itemData.statusColor;\r\n        }\r\n        if ($item('#appDate')) {\r\n            $item('#appDate').text = itemData.appliedDate;\r\n        }\r\n        if ($item('#appMatchScore')) {\r\n            $item('#appMatchScore').text = `${itemData.matchScore}% Match`;\r\n        }\r\n    } catch (e) {\r\n        console.warn('?? Error setting up application item:', e.message);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// NOTIFICATIONS SECTION\r\n// ============================================================================\r\n\r\nasync function loadNotificationsSection(notifications, unreadResult) {\r\n    try {\r\n        const unreadCount = unreadResult.success ? unreadResult.count : 0;\r\n\r\n        // Update unread badge\r\n        if ($w('#unreadBadge').rendered) {\r\n            try {\r\n                if (unreadCount > 0) {\r\n                    $w('#unreadBadge').text = String(unreadCount);\r\n                    $w('#unreadBadge').expand();\r\n                } else {\r\n                    $w('#unreadBadge').collapse();\r\n                }\r\n            } catch (e) {\r\n                console.warn('?? Could not set unreadBadge:', e.message);\r\n            }\r\n        }\r\n\r\n        // Populate notifications repeater\r\n        if ($w('#notificationsRepeater').rendered) {\r\n            try {\r\n                if (notifications && notifications.length > 0) {\r\n                    $w('#notificationsRepeater').data = notifications.map(notif => ({\r\n                        _id: notif.id || notif._id,\r\n                        title: notif.title || 'Notification',\r\n                        message: notif.message || '',\r\n                        isRead: notif.isRead || notif.is_read || false,\r\n                        icon: notif.icon || 'bell',\r\n                        createdDate: formatDate(notif.createdDate || notif.created_date),\r\n                        actionUrl: notif.actionUrl || notif.action_url || null,\r\n                        type: notif.type || 'system'\r\n                    }));\r\n\r\n                    $w('#notificationsRepeater').onItemReady(($item, itemData) => {\r\n                        setupNotificationItem($item, itemData);\r\n                    });\r\n\r\n                    $w('#notificationsRepeater').expand();\r\n                } else {\r\n                    $w('#notificationsRepeater').collapse();\r\n                }\r\n            } catch (e) {\r\n                console.warn('?? Could not set up notificationsRepeater:', e.message);\r\n            }\r\n        }\r\n\r\n        // Send notifications update to HTML\r\n        sendToHtml('notificationsUpdate', {\r\n            notifications,\r\n            unreadCount\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('? Error loading notifications section:', error);\r\n    }\r\n}\r\n\r\nfunction setupNotificationItem($item, itemData) {\r\n    try {\r\n        if ($item('#notifTitle')) {\r\n            $item('#notifTitle').text = itemData.title;\r\n        }\r\n        if ($item('#notifMessage')) {\r\n            $item('#notifMessage').text = itemData.message;\r\n        }\r\n        if ($item('#notifDate')) {\r\n            $item('#notifDate').text = itemData.createdDate;\r\n        }\r\n        if ($item('#notifIcon')) {\r\n            // Set icon based on type\r\n            $item('#notifIcon').src = getNotificationIconUrl(itemData.icon);\r\n        }\r\n\r\n        // Style based on read status\r\n        if (!itemData.isRead) {\r\n            if ($item('#notifContainer')) {\r\n                $item('#notifContainer').style.backgroundColor = '#f0f7ff';\r\n            }\r\n        }\r\n\r\n        // Handle click to mark as read and navigate\r\n        if ($item('#notifContainer')) {\r\n            $item('#notifContainer').onClick(async () => {\r\n                if (!itemData.isRead) {\r\n                    await handleMarkNotificationRead({ notificationId: itemData._id });\r\n                }\r\n                if (itemData.actionUrl) {\r\n                    wixLocation.to(itemData.actionUrl);\r\n                }\r\n            });\r\n        }\r\n    } catch (e) {\r\n        console.warn('?? Error setting up notification item:', e.message);\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// QUICK ACTIONS SECTION\r\n// ============================================================================\r\n\r\nasync function loadQuickActions(quickActions, profile) {\r\n    try {\r\n        // Populate quick actions repeater\r\n        if ($w('#quickActionsRepeater').rendered) {\r\n            try {\r\n                if (quickActions && quickActions.length > 0) {\r\n                    $w('#quickActionsRepeater').data = quickActions.map((action, index) => ({\r\n                        _id: action.id || `action-${index}`,\r\n                        label: action.label,\r\n                        description: action.description || '',\r\n                        priority: action.priority || 'medium',\r\n                        url: action.url || CONFIG.matchingPageUrl,\r\n                        icon: getActionIcon(action.id)\r\n                    }));\r\n\r\n                    $w('#quickActionsRepeater').onItemReady(($item, itemData) => {\r\n                        setupQuickActionItem($item, itemData);\r\n                    });\r\n\r\n                    $w('#quickActionsRepeater').expand();\r\n                } else {\r\n                    $w('#quickActionsRepeater').collapse();\r\n                }\r\n            } catch (e) {\r\n                console.warn('?? Could not set up quickActionsRepeater:', e.message);\r\n            }\r\n        }\r\n\r\n        // Set up static quick action buttons\r\n        setupStaticButtons(profile);\r\n\r\n    } catch (error) {\r\n        console.error('? Error loading quick actions:', error);\r\n    }\r\n}\r\n\r\nfunction setupQuickActionItem($item, itemData) {\r\n    try {\r\n        if ($item('#actionLabel')) {\r\n            $item('#actionLabel').text = itemData.label;\r\n        }\r\n        if ($item('#actionDescription')) {\r\n            $item('#actionDescription').text = itemData.description;\r\n        }\r\n        if ($item('#actionIcon')) {\r\n            $item('#actionIcon').src = itemData.icon;\r\n        }\r\n\r\n        // Priority styling\r\n        if (itemData.priority === 'high' && $item('#actionContainer')) {\r\n            $item('#actionContainer').style.borderColor = '#2563eb';\r\n        }\r\n\r\n        // Handle click\r\n        if ($item('#actionContainer')) {\r\n            $item('#actionContainer').onClick(() => {\r\n                wixLocation.to(itemData.url);\r\n            });\r\n        }\r\n        if ($item('#actionButton')) {\r\n            $item('#actionButton').onClick(() => {\r\n                wixLocation.to(itemData.url);\r\n            });\r\n        }\r\n    } catch (e) {\r\n        console.warn('?? Error setting up quick action item:', e.message);\r\n    }\r\n}\r\n\r\nfunction setupStaticButtons(profile) {\r\n    // Find Matches button\r\n    if ($w('#findMatchesBtn').rendered) {\r\n        try {\r\n            $w('#findMatchesBtn').onClick(() => {\r\n                wixLocation.to(CONFIG.matchingPageUrl);\r\n            });\r\n        } catch (e) {\r\n            console.warn('?? Could not set up findMatchesBtn:', e.message);\r\n        }\r\n    }\r\n\r\n    // Edit Profile button\r\n    if ($w('#editProfileBtn').rendered) {\r\n        try {\r\n            $w('#editProfileBtn').onClick(() => {\r\n                wixLocation.to(CONFIG.profilePageUrl);\r\n            });\r\n        } catch (e) {\r\n            console.warn('?? Could not set up editProfileBtn:', e.message);\r\n        }\r\n    }\r\n\r\n    // View Applications button\r\n    if ($w('#viewApplicationsBtn').rendered) {\r\n        try {\r\n            $w('#viewApplicationsBtn').onClick(() => {\r\n                wixLocation.to(CONFIG.driverDashboardUrl);\r\n            });\r\n        } catch (e) {\r\n            console.warn('?? Could not set up viewApplicationsBtn:', e.message);\r\n        }\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// ACTION HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleMarkNotificationRead(data) {\r\n    try {\r\n        if (!data || !data.notificationId) {\r\n            console.warn('?? No notification ID provided');\r\n            return;\r\n        }\r\n\r\n        const result = await markNotificationRead(data.notificationId);\r\n\r\n        if (result.success) {\r\n            console.log('? Notification marked as read:', data.notificationId);\r\n            sendToHtml('notificationMarkedRead', { notificationId: data.notificationId });\r\n\r\n            // Optionally refresh notifications\r\n            const notificationsResult = await getMemberNotifications();\r\n            if (notificationsResult.success) {\r\n                const unreadResult = await getUnreadCount();\r\n                await loadNotificationsSection(notificationsResult.notifications, unreadResult);\r\n            }\r\n        } else {\r\n            console.error('? Failed to mark notification as read:', result.error);\r\n            sendToHtml('error', { message: result.error });\r\n        }\r\n    } catch (error) {\r\n        console.error('? Error marking notification as read:', error);\r\n        sendToHtml('error', { message: error.message });\r\n    }\r\n}\r\n\r\nasync function handleMarkAllNotificationsRead() {\r\n    try {\r\n        // Import the function dynamically since it's not in our main imports\r\n        const { markAllNotificationsRead } = await import('backend/memberService');\r\n        const result = await markAllNotificationsRead();\r\n\r\n        if (result.success) {\r\n            console.log('? All notifications marked as read');\r\n\r\n            // Refresh notifications section\r\n            const notificationsResult = await getMemberNotifications();\r\n            if (notificationsResult.success) {\r\n                const unreadResult = await getUnreadCount();\r\n                await loadNotificationsSection(notificationsResult.notifications, unreadResult);\r\n            }\r\n        } else {\r\n            console.error('? Failed to mark all notifications as read:', result.error);\r\n            sendToHtml('error', { message: result.error });\r\n        }\r\n    } catch (error) {\r\n        console.error('? Error marking all notifications as read:', error);\r\n        sendToHtml('error', { message: error.message });\r\n    }\r\n}\r\n\r\nfunction handleNavigateTo(data) {\r\n    if (data && data.url) {\r\n        console.log('?? Navigating to:', data.url);\r\n        wixLocation.to(data.url);\r\n    }\r\n}\r\n\r\nfunction handleQuickAction(data) {\r\n    if (!data || !data.actionId) {\r\n        console.warn('?? No action ID provided');\r\n        return;\r\n    }\r\n\r\n    console.log('? Quick action:', data.actionId);\r\n\r\n    // Handle specific quick actions\r\n    switch (data.actionId) {\r\n        case 'create_profile':\r\n        case 'complete_profile':\r\n        case 'find_matches':\r\n        case 'enable_discovery':\r\n            wixLocation.to(CONFIG.matchingPageUrl);\r\n            break;\r\n\r\n        case 'upload_cdl':\r\n            wixLocation.to(CONFIG.quickApplyUrl);\r\n            break;\r\n\r\n        case 'check_applications':\r\n            wixLocation.to(CONFIG.driverDashboardUrl);\r\n            break;\r\n\r\n        default:\r\n            if (data.url) {\r\n                wixLocation.to(data.url);\r\n            }\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// HELPER FUNCTIONS\r\n// ============================================================================\r\n\r\nfunction getStatusLabel(status) {\r\n    const labels = {\r\n        'interested': 'Interested',\r\n        'applied': 'Applied',\r\n        'in_review': 'In Review',\r\n        'reviewing': 'In Review',\r\n        'contacted': 'Contacted',\r\n        'interviewing': 'Interviewing',\r\n        'offer': 'Offer Received',\r\n        'hired': 'Hired',\r\n        'rejected': 'Not Selected',\r\n        'withdrawn': 'Withdrawn'\r\n    };\r\n    return labels[status] || status || 'Pending';\r\n}\r\n\r\nfunction getStatusColor(status) {\r\n    const colors = {\r\n        'interested': '#6b7280',\r\n        'applied': '#3b82f6',\r\n        'in_review': '#f59e0b',\r\n        'reviewing': '#f59e0b',\r\n        'contacted': '#8b5cf6',\r\n        'interviewing': '#6366f1',\r\n        'offer': '#10b981',\r\n        'hired': '#059669',\r\n        'rejected': '#ef4444',\r\n        'withdrawn': '#9ca3af'\r\n    };\r\n    return colors[status] || '#6b7280';\r\n}\r\n\r\nfunction formatDate(dateValue) {\r\n    if (!dateValue) return '';\r\n\r\n    try {\r\n        const date = new Date(dateValue);\r\n        const now = new Date();\r\n        const diffMs = now - date;\r\n        const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n\r\n        if (diffDays === 0) {\r\n            return 'Today';\r\n        } else if (diffDays === 1) {\r\n            return 'Yesterday';\r\n        } else if (diffDays < 7) {\r\n            return `${diffDays} days ago`;\r\n        } else {\r\n            return date.toLocaleDateString('en-US', {\r\n                month: 'short',\r\n                day: 'numeric',\r\n                year: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined\r\n            });\r\n        }\r\n    } catch (e) {\r\n        return '';\r\n    }\r\n}\r\n\r\nfunction getNotificationIconUrl(iconName) {\r\n    const iconMap = {\r\n        'briefcase': 'https://static.wixstatic.com/shapes/...',\r\n        'envelope': 'https://static.wixstatic.com/shapes/...',\r\n        'star': 'https://static.wixstatic.com/shapes/...',\r\n        'user': 'https://static.wixstatic.com/shapes/...',\r\n        'file': 'https://static.wixstatic.com/shapes/...',\r\n        'bell': 'https://static.wixstatic.com/shapes/...'\r\n    };\r\n    return iconMap[iconName] || iconMap['bell'];\r\n}\r\n\r\nfunction getActionIcon(actionId) {\r\n    const iconMap = {\r\n        'create_profile': 'https://static.wixstatic.com/shapes/...',\r\n        'complete_profile': 'https://static.wixstatic.com/shapes/...',\r\n        'upload_cdl': 'https://static.wixstatic.com/shapes/...',\r\n        'find_matches': 'https://static.wixstatic.com/shapes/...',\r\n        'check_applications': 'https://static.wixstatic.com/shapes/...',\r\n        'enable_discovery': 'https://static.wixstatic.com/shapes/...'\r\n    };\r\n    return iconMap[actionId] || 'https://static.wixstatic.com/shapes/...';\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\OTR Truck Driver Placement.t1alo.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getTopJobOpportunities' is defined but never used.","line":18,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":56},{"ruleId":"no-unused-vars","severity":1,"message":"'getRecentHires' is defined but never used.","line":18,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":72},{"ruleId":"no-unused-vars","severity":1,"message":"'isLoading' is assigned a value but never used.","line":22,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * OTR Truck Driver Placement Landing Page\r\n *\r\n * Dedicated page for Over-The-Road (OTR) truck drivers seeking long-haul\r\n * opportunities. Highlights high-mileage positions, adventure lifestyle,\r\n * and top-paying OTR carriers.\r\n *\r\n * Element IDs:\r\n * - #otrJobsRepeater - OTR job listings\r\n * - #otrBenefitsRepeater - Benefits of OTR driving\r\n * - #equipmentRepeater - Equipment/truck showcase\r\n * - #otrTestimonialsRepeater - Driver testimonials\r\n * - #otrStatsText - Statistics display\r\n * - #applyNowButton - CTA button\r\n */\r\n\r\nimport wixLocation from 'wix-location';\r\nimport { getJobsByOperationType, getTopJobOpportunities, getRecentHires } from 'backend/publicStatsService';\r\n\r\n// Page state\r\nlet otrJobs = [];\r\nlet isLoading = false;\r\n\r\n$w.onReady(function () {\r\n    initializePage();\r\n});\r\n\r\n/**\r\n * Initialize all page components\r\n */\r\nasync function initializePage() {\r\n    try {\r\n        showLoadingState(true);\r\n\r\n        // Load all data in parallel\r\n        await Promise.all([\r\n            loadOtrJobs(),\r\n            loadOtrBenefits(),\r\n            loadEquipmentShowcase(),\r\n            loadOtrTestimonials()\r\n        ]);\r\n\r\n        // Set up event handlers\r\n        setupEventHandlers();\r\n\r\n        showLoadingState(false);\r\n    } catch (error) {\r\n        console.error('OTR page initialization error:', error);\r\n        showLoadingState(false);\r\n    }\r\n}\r\n\r\n/**\r\n * Load OTR-specific job opportunities\r\n * Fetches jobs filtered by operation_type = 'OTR'\r\n */\r\nasync function loadOtrJobs() {\r\n    try {\r\n        const jobs = await getJobsByOperationType('OTR', 8);\r\n        otrJobs = jobs;\r\n\r\n        if ($w('#otrJobsRepeater').rendered) {\r\n            if (jobs.length > 0) {\r\n                $w('#otrJobsRepeater').data = jobs;\r\n                $w('#otrJobsRepeater').onItemReady(($item, itemData) => {\r\n                    renderOtrJobItem($item, itemData);\r\n                });\r\n            } else {\r\n                // Show fallback content if no OTR jobs available\r\n                $w('#otrJobsRepeater').collapse();\r\n            }\r\n        }\r\n\r\n        // Update stats if element exists\r\n        updateOtrStats(jobs);\r\n\r\n    } catch (error) {\r\n        console.error('Error loading OTR jobs:', error);\r\n        otrJobs = [];\r\n    }\r\n}\r\n\r\n/**\r\n * Render individual OTR job item in repeater\r\n */\r\nfunction renderOtrJobItem($item, jobData) {\r\n    // Carrier name and location\r\n    if ($item('#carrierName')) {\r\n        $item('#carrierName').text = jobData.carrierName || 'Top OTR Carrier';\r\n    }\r\n    if ($item('#jobLocation')) {\r\n        $item('#jobLocation').text = jobData.location || 'Nationwide';\r\n    }\r\n\r\n    // Pay information - emphasize high miles potential\r\n    if ($item('#payRange')) {\r\n        $item('#payRange').text = jobData.payRange || 'Competitive CPM';\r\n    }\r\n    if ($item('#milesInfo')) {\r\n        const avgMiles = calculateAverageMiles(jobData.fleetSize);\r\n        $item('#milesInfo').text = `${avgMiles}+ avg weekly miles`;\r\n    }\r\n\r\n    // Home time and benefits\r\n    if ($item('#homeTime')) {\r\n        $item('#homeTime').text = jobData.homeTime || '2-3 weeks out';\r\n    }\r\n    if ($item('#benefits')) {\r\n        $item('#benefits').text = jobData.benefits || 'Full benefits + 401k';\r\n    }\r\n\r\n    // Equipment age indicator\r\n    if ($item('#truckAge')) {\r\n        const ageText = jobData.truckAge ? `${jobData.truckAge} yr avg truck age` : 'Modern equipment';\r\n        $item('#truckAge').text = ageText;\r\n    }\r\n\r\n    // Apply button\r\n    if ($item('#jobApplyBtn')) {\r\n        $item('#jobApplyBtn').onClick(() => {\r\n            navigateToApplication(jobData._id);\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Load OTR lifestyle benefits content\r\n * Highlights the advantages of OTR driving\r\n */\r\nasync function loadOtrBenefits() {\r\n    const benefits = [\r\n        {\r\n            _id: 'miles',\r\n            title: 'Maximum Miles',\r\n            description: 'OTR drivers average 2,500-3,500 miles per week with consistent freight.',\r\n            icon: 'road',\r\n            stat: '3,000+',\r\n            statLabel: 'Weekly Miles'\r\n        },\r\n        {\r\n            _id: 'pay',\r\n            title: 'Top Pay Rates',\r\n            description: 'Long-haul routes offer premium CPM rates plus mileage bonuses.',\r\n            icon: 'dollar',\r\n            stat: '$0.65+',\r\n            statLabel: 'Per Mile'\r\n        },\r\n        {\r\n            _id: 'adventure',\r\n            title: 'See the Country',\r\n            description: 'Travel coast to coast and experience America from behind the wheel.',\r\n            icon: 'map',\r\n            stat: '48',\r\n            statLabel: 'States'\r\n        },\r\n        {\r\n            _id: 'equipment',\r\n            title: 'Late Model Equipment',\r\n            description: 'Drive modern trucks with the latest safety and comfort features.',\r\n            icon: 'truck',\r\n            stat: '2-3',\r\n            statLabel: 'Year Avg Age'\r\n        },\r\n        {\r\n            _id: 'independence',\r\n            title: 'Independence',\r\n            description: 'Enjoy the freedom of the open road with minimal micromanagement.',\r\n            icon: 'freedom',\r\n            stat: '24/7',\r\n            statLabel: 'Dispatch Support'\r\n        },\r\n        {\r\n            _id: 'bonuses',\r\n            title: 'Performance Bonuses',\r\n            description: 'Earn extra with safety bonuses, fuel efficiency bonuses, and sign-on offers.',\r\n            icon: 'bonus',\r\n            stat: '$5K+',\r\n            statLabel: 'Sign-On Available'\r\n        }\r\n    ];\r\n\r\n    if ($w('#otrBenefitsRepeater').rendered) {\r\n        $w('#otrBenefitsRepeater').data = benefits;\r\n        $w('#otrBenefitsRepeater').onItemReady(($item, itemData) => {\r\n            if ($item('#benefitTitle')) $item('#benefitTitle').text = itemData.title;\r\n            if ($item('#benefitDescription')) $item('#benefitDescription').text = itemData.description;\r\n            if ($item('#benefitStat')) $item('#benefitStat').text = itemData.stat;\r\n            if ($item('#benefitStatLabel')) $item('#benefitStatLabel').text = itemData.statLabel;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Load equipment showcase - types of trucks OTR drivers operate\r\n */\r\nasync function loadEquipmentShowcase() {\r\n    const equipment = [\r\n        {\r\n            _id: 'sleeper',\r\n            name: 'Sleeper Cab',\r\n            description: 'Spacious sleeper berths for comfortable rest on long hauls. Full-size beds, climate control, and storage.',\r\n            features: ['APU/Idle Management', 'Inverter', 'Fridge', 'TV Ready']\r\n        },\r\n        {\r\n            _id: 'automatic',\r\n            name: 'Automatic Transmission',\r\n            description: 'Modern automatic transmissions reduce fatigue on long trips and are easier on new drivers.',\r\n            features: ['Fuel Efficient', 'Less Fatigue', 'Smooth Shifting']\r\n        },\r\n        {\r\n            _id: 'safety',\r\n            name: 'Advanced Safety',\r\n            description: 'Lane departure warning, collision mitigation, and adaptive cruise control for safer miles.',\r\n            features: ['Lane Assist', 'Auto Braking', 'Radar Cruise']\r\n        },\r\n        {\r\n            _id: 'brands',\r\n            name: 'Premium Brands',\r\n            description: 'Freightliner Cascadia, Peterbilt 579, Kenworth T680, and Volvo VNL fleets available.',\r\n            features: ['Freightliner', 'Peterbilt', 'Kenworth', 'Volvo']\r\n        }\r\n    ];\r\n\r\n    if ($w('#equipmentRepeater').rendered) {\r\n        $w('#equipmentRepeater').data = equipment;\r\n        $w('#equipmentRepeater').onItemReady(($item, itemData) => {\r\n            if ($item('#equipmentName')) $item('#equipmentName').text = itemData.name;\r\n            if ($item('#equipmentDescription')) $item('#equipmentDescription').text = itemData.description;\r\n            if ($item('#equipmentFeatures')) {\r\n                $item('#equipmentFeatures').text = itemData.features.join(' | ');\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Load OTR driver testimonials - road warrior stories\r\n */\r\nasync function loadOtrTestimonials() {\r\n    const testimonials = [\r\n        {\r\n            _id: 'testimonial1',\r\n            name: 'Mike T.',\r\n            experience: '15 years OTR',\r\n            quote: 'I\\'ve driven for 3 carriers, but LMDR matched me with a company that actually delivers on their promises. Running 3,200 miles a week now.',\r\n            location: 'Texas',\r\n            highlight: '3,200 weekly miles'\r\n        },\r\n        {\r\n            _id: 'testimonial2',\r\n            name: 'Sarah K.',\r\n            experience: '8 years OTR',\r\n            quote: 'As a woman in trucking, finding the right carrier matters. LMDR helped me find a fleet with respect and the miles I need.',\r\n            location: 'Ohio',\r\n            highlight: 'Solo driver friendly'\r\n        },\r\n        {\r\n            _id: 'testimonial3',\r\n            name: 'James R.',\r\n            experience: '22 years OTR',\r\n            quote: 'After two decades on the road, I know what matters: consistent miles, fair pay, and equipment that runs. Finally found it.',\r\n            location: 'Georgia',\r\n            highlight: '$1,800+ weekly'\r\n        },\r\n        {\r\n            _id: 'testimonial4',\r\n            name: 'Carlos M.',\r\n            experience: '5 years OTR',\r\n            quote: 'Started driving after leaving the military. LMDR matched me with a carrier that values discipline and rewards hard work.',\r\n            location: 'California',\r\n            highlight: 'Veteran-friendly'\r\n        }\r\n    ];\r\n\r\n    if ($w('#otrTestimonialsRepeater').rendered) {\r\n        $w('#otrTestimonialsRepeater').data = testimonials;\r\n        $w('#otrTestimonialsRepeater').onItemReady(($item, itemData) => {\r\n            if ($item('#testimonialName')) $item('#testimonialName').text = itemData.name;\r\n            if ($item('#testimonialExperience')) $item('#testimonialExperience').text = itemData.experience;\r\n            if ($item('#testimonialQuote')) $item('#testimonialQuote').text = `\"${itemData.quote}\"`;\r\n            if ($item('#testimonialLocation')) $item('#testimonialLocation').text = itemData.location;\r\n            if ($item('#testimonialHighlight')) $item('#testimonialHighlight').text = itemData.highlight;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Update OTR statistics display\r\n */\r\nfunction updateOtrStats(jobs) {\r\n    if ($w('#otrStatsText').rendered) {\r\n        const avgPay = calculateAveragePay(jobs);\r\n        $w('#otrStatsText').text = `${jobs.length} OTR positions | Avg ${avgPay}/mile`;\r\n    }\r\n\r\n    if ($w('#totalOtrJobs').rendered) {\r\n        $w('#totalOtrJobs').text = jobs.length.toString();\r\n    }\r\n}\r\n\r\n/**\r\n * Set up page event handlers\r\n */\r\nfunction setupEventHandlers() {\r\n    // Main CTA button\r\n    if ($w('#applyNowButton').rendered) {\r\n        $w('#applyNowButton').onClick(() => {\r\n            wixLocation.to('/apply-for-cdl-driving-jobs?type=OTR');\r\n        });\r\n    }\r\n\r\n    // Filter buttons if present\r\n    if ($w('#filterHighMiles').rendered) {\r\n        $w('#filterHighMiles').onClick(() => filterJobsByMiles(3000));\r\n    }\r\n\r\n    if ($w('#filterTopPay').rendered) {\r\n        $w('#filterTopPay').onClick(() => filterJobsByPay(0.60));\r\n    }\r\n}\r\n\r\n/**\r\n * Navigate to job application with carrier ID\r\n */\r\nfunction navigateToApplication(carrierId) {\r\n    wixLocation.to(`/apply-for-cdl-driving-jobs?carrier=${carrierId}&type=OTR`);\r\n}\r\n\r\n/**\r\n * Filter jobs by minimum weekly miles\r\n */\r\nfunction filterJobsByMiles(minMiles) {\r\n    const filtered = otrJobs.filter(job => {\r\n        const avgMiles = calculateAverageMiles(job.fleetSize);\r\n        return avgMiles >= minMiles;\r\n    });\r\n\r\n    if ($w('#otrJobsRepeater').rendered) {\r\n        $w('#otrJobsRepeater').data = filtered.length > 0 ? filtered : otrJobs;\r\n    }\r\n}\r\n\r\n/**\r\n * Filter jobs by minimum pay rate\r\n */\r\nfunction filterJobsByPay(minPay) {\r\n    const filtered = otrJobs.filter(job => {\r\n        const pay = parsePayRate(job.payRange);\r\n        return pay >= minPay;\r\n    });\r\n\r\n    if ($w('#otrJobsRepeater').rendered) {\r\n        $w('#otrJobsRepeater').data = filtered.length > 0 ? filtered : otrJobs;\r\n    }\r\n}\r\n\r\n/**\r\n * Show/hide loading state\r\n */\r\nfunction showLoadingState(loading) {\r\n    isLoading = loading;\r\n\r\n    if ($w('#loadingIndicator').rendered) {\r\n        loading ? $w('#loadingIndicator').show() : $w('#loadingIndicator').hide();\r\n    }\r\n}\r\n\r\n// Utility functions\r\n\r\nfunction calculateAverageMiles(fleetSize) {\r\n    // Larger fleets typically offer more consistent miles\r\n    if (fleetSize >= 500) return 3200;\r\n    if (fleetSize >= 100) return 2800;\r\n    return 2500;\r\n}\r\n\r\nfunction calculateAveragePay(jobs) {\r\n    if (!jobs || jobs.length === 0) return '$0.58';\r\n\r\n    const payRates = jobs.map(j => parsePayRate(j.payRange)).filter(p => p > 0);\r\n    if (payRates.length === 0) return '$0.58';\r\n\r\n    const avg = payRates.reduce((a, b) => a + b, 0) / payRates.length;\r\n    return `$${avg.toFixed(2)}`;\r\n}\r\n\r\nfunction parsePayRate(payRange) {\r\n    if (!payRange) return 0;\r\n    const match = payRange.match(/\\$?([\\d.]+)/);\r\n    return match ? parseFloat(match[1]) : 0;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Office_Management.dzupr.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\PET_FRIENDLY.js","messages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":45,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":45,"endColumn":73},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":50,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":50,"endColumn":67},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":55,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":55,"endColumn":97}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { \r\n    searchLocations, \r\n    getNearbyLocations, \r\n    getLocationById, \r\n    submitLocation, \r\n    submitReview \r\n} from 'backend/petFriendlyService';\r\n\r\n$w.onReady(function () {\r\n    initPetFriendly();\r\n});\r\n\r\nfunction initPetFriendly() {\r\n    const possibleIds = ['#html1', '#html2', '#html3', '#html4', '#html5', '#petFriendly'];\r\n    \r\n    possibleIds.forEach(id => {\r\n        try {\r\n            const htmlComp = $w(id);\r\n            if (htmlComp && htmlComp.onMessage) {\r\n                console.log('[VELO] Pet Friendly Bridge active on', id);\r\n                attachHandlers(htmlComp);\r\n            }\r\n        } catch (e) { /* skip */ }\r\n    });\r\n}\r\n\r\nfunction attachHandlers(htmlComp) {\r\n    htmlComp.onMessage(async (event) => {\r\n        const msg = event.data;\r\n        if (!msg || !msg.type) return;\r\n\r\n        console.log('[VELO] Pet Friendly message:', msg.type);\r\n\r\n        try {\r\n            switch (msg.type) {\r\n                case 'ready':\r\n                    // Initial load if needed\r\n                    break;\r\n\r\n                case 'searchPetFriendly':\r\n                    await handleSearch(htmlComp, msg.data);\r\n                    break;\r\n\r\n                case 'getLocationDetail':\r\n                    const location = await getLocationById(msg.data.id);\r\n                    htmlComp.postMessage({ type: 'locationDetail', data: location });\r\n                    break;\r\n\r\n                case 'submitLocation':\r\n                    const newLoc = await submitLocation(msg.data);\r\n                    htmlComp.postMessage({ type: 'locationSubmitted', data: newLoc });\r\n                    break;\r\n\r\n                case 'submitReview':\r\n                    const review = await submitReview(msg.data.locationId, msg.data.reviewData);\r\n                    htmlComp.postMessage({ type: 'reviewSubmitted', data: review });\r\n                    break;\r\n\r\n                default:\r\n                    console.warn('[VELO] Unknown pet friendly message:', msg.type);\r\n            }\r\n        } catch (err) {\r\n            console.error('[VELO] Pet friendly handler error:', err);\r\n            htmlComp.postMessage({ type: 'error', data: { message: err.message } });\r\n        }\r\n    });\r\n}\r\n\r\nasync function handleSearch(htmlComp, filters) {\r\n    try {\r\n        let results;\r\n        \r\n        // If we have a text location, we might need geocoding.\r\n        // For MVP, if coordinates aren't passed, we search all or by other filters.\r\n        // If the HTML component can provide lat/lng (e.g. from browser or Google Places), use nearby.\r\n        \r\n        if (filters.lat && filters.lng) {\r\n            results = await getNearbyLocations(filters.lat, filters.lng, filters.radius);\r\n        } else {\r\n            // Fallback to basic search\r\n            const res = await searchLocations({\r\n                location_type: filters.type,\r\n                amenities: filters.amenities\r\n            });\r\n            results = res.items;\r\n        }\r\n\r\n        htmlComp.postMessage({ type: 'searchResults', data: results });\r\n    } catch (error) {\r\n        console.error('handleSearch error:', error);\r\n        throw error;\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Placement Success.tz647.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Post.vjkjy.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Quick Apply - Upload Your CDL & Resume.pa6f5.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'wixWindow' is defined but never used.","line":9,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":267,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":267,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[8464,8465],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'isGuestSubmission' is assigned a value but never used.","line":729,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":729,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'showElement' is defined but never used.","line":1004,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1004,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'hideElement' is defined but never used.","line":1011,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1011,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'setElementText' is defined but never used.","line":1018,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1018,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'setElementSrc' is defined but never used.","line":1025,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1025,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'enableElement' is defined but never used.","line":1032,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1032,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'disableElement' is defined but never used.","line":1039,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1039,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Quick Apply Page - Streamlined document upload flow for CDL drivers\r\n// Allows drivers to quickly upload their CDL, Medical Card, and Resume\r\n// with AI-powered OCR extraction for form auto-fill\r\n\r\nimport { getOrCreateDriverProfile, updateDriverDocuments } from 'backend/driverProfiles';\r\nimport { extractDocumentForAutoFill } from 'backend/ocrService';\r\nimport { submitApplication } from 'backend/applicationService';\r\nimport wixLocation from 'wix-location';\r\nimport wixWindow from 'wix-window';\r\n\r\n// Wix Users - handle gracefully if not available\r\nlet wixUsers;\r\ntry {\r\n  wixUsers = require('wix-users');\r\n} catch (e) {\r\n  console.log('wix-users not available');\r\n}\r\n\r\n// ============================================================================\r\n// CONFIGURATION\r\n// ============================================================================\r\n\r\nconst CONFIG = {\r\n  htmlComponentId: 'quickApplyHtml',\r\n  maxFileSize: 10 * 1024 * 1024, // 10MB\r\n  supportedFormats: ['image/jpeg', 'image/png', 'application/pdf'],\r\n  matchingPageUrl: '/ai-matching',\r\n  dashboardPageUrl: '/driver-dashboard',\r\n  loginPageUrl: '/account/my-account'\r\n};\r\n\r\n// ============================================================================\r\n// GLOBAL STATE\r\n// ============================================================================\r\n\r\nlet cachedUserStatus = null;\r\nlet cachedDriverProfile = null;\r\nlet preSelectedCarrier = null;\r\nlet uploadedDocuments = {\r\n  cdlFront: null,\r\n  cdlBack: null,\r\n  medCard: null,\r\n  mvr: null,\r\n  resume: null\r\n};\r\nlet extractedData = {};\r\n\r\n// ============================================================================\r\n// MESSAGE VALIDATION SYSTEM\r\n// ============================================================================\r\n\r\nconst DEBUG_MESSAGES = true; // Set to false in production\r\n\r\n// Registry of all valid messages - single source of truth\r\nconst MESSAGE_REGISTRY = {\r\n  // Messages FROM HTML that page code handles\r\n  inbound: [\r\n    'quickApplyReady',\r\n    'quickApplyFormReady',  // New: from updated HTML\r\n    'uploadDocument',\r\n    'submitQuickApply',\r\n    'clearDocument',\r\n    'runOCR',\r\n    'extractDocumentOCR',   // New: from updated HTML (OCR request)\r\n    'navigateToMatching',\r\n    'navigateToLogin',\r\n    'navigateToDashboard',\r\n    'checkUserStatus',\r\n    'getProfile',\r\n    'ping' // Health check\r\n  ],\r\n  // Messages TO HTML that page code sends\r\n  outbound: [\r\n    'pageReady',\r\n    'profileLoaded',\r\n    'ocrProcessing',\r\n    'ocrComplete',\r\n    'ocrResult',            // New: for updated HTML\r\n    'ocrError',\r\n    'uploadSuccess',\r\n    'uploadError',\r\n    'applicationSubmitted',\r\n    'applicationError',\r\n    'submitResult',         // New: for updated HTML\r\n    'documentCleared',\r\n    'userStatusUpdate',\r\n    'pong' // Health check response\r\n  ]\r\n};\r\n\r\nfunction validateInboundMessage(action) {\r\n  if (!MESSAGE_REGISTRY.inbound.includes(action)) {\r\n    console.warn(`[Quick Apply] UNREGISTERED INBOUND MESSAGE: \"${action}\" - Add to MESSAGE_REGISTRY.inbound`);\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction logMessageFlow(direction, type, data) {\r\n  if (!DEBUG_MESSAGES) return;\r\n  const arrow = direction === 'in' ? '[IN]' : '[OUT]';\r\n  const label = direction === 'in' ? 'HTML->Velo' : 'Velo->HTML';\r\n  console.log(`${arrow} [${label}] ${type}`, data ? Object.keys(data) : '(no data)');\r\n}\r\n\r\n// ============================================================================\r\n// PAGE INITIALIZATION\r\n// ============================================================================\r\n\r\n$w.onReady(async function () {\r\n  console.log('[Quick Apply] Page Ready');\r\n\r\n  const htmlComponent = getHtmlComponent();\r\n\r\n  if (!htmlComponent) {\r\n    console.error('[Quick Apply] HTML component not found!');\r\n    return;\r\n  }\r\n\r\n  console.log('[Quick Apply] HTML component found:', CONFIG.htmlComponentId);\r\n\r\n  // Check URL params for carrier pre-selection\r\n  await checkUrlParams();\r\n\r\n  // Get initial user status\r\n  cachedUserStatus = await getUserStatus();\r\n  console.log('[Quick Apply] User status:', cachedUserStatus);\r\n\r\n  // If logged in, load driver profile and existing documents\r\n  if (cachedUserStatus.loggedIn) {\r\n    await loadExistingProfile();\r\n  }\r\n\r\n  // Set up message listener\r\n  htmlComponent.onMessage((event) => {\r\n    handleHtmlMessage(event.data);\r\n  });\r\n});\r\n\r\n// ============================================================================\r\n// URL PARAMETER HANDLING\r\n// ============================================================================\r\n\r\nasync function checkUrlParams() {\r\n  try {\r\n    const query = wixLocation.query;\r\n\r\n    // Check for carrier pre-selection (e.g., ?carrier=12345)\r\n    if (query.carrier) {\r\n      preSelectedCarrier = {\r\n        dot: query.carrier,\r\n        name: query.carrierName || null\r\n      };\r\n      console.log('[Quick Apply] Pre-selected carrier:', preSelectedCarrier);\r\n    }\r\n\r\n    // Check for job reference (e.g., ?job=abc123)\r\n    if (query.job) {\r\n      preSelectedCarrier = preSelectedCarrier || {};\r\n      preSelectedCarrier.jobId = query.job;\r\n      console.log('[Quick Apply] Job reference:', query.job);\r\n    }\r\n\r\n    // Check for source tracking\r\n    if (query.source) {\r\n      console.log('[Quick Apply] Traffic source:', query.source);\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] URL param check error:', error);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// USER STATUS DETECTION\r\n// ============================================================================\r\n\r\nasync function getUserStatus() {\r\n  try {\r\n    if (!wixUsers) {\r\n      return { loggedIn: false, isPremium: false, tier: 'guest' };\r\n    }\r\n\r\n    const user = wixUsers.currentUser;\r\n    const loggedIn = user.loggedIn;\r\n\r\n    if (!loggedIn) {\r\n      return { loggedIn: false, isPremium: false, tier: 'guest' };\r\n    }\r\n\r\n    let userEmail = '';\r\n    try {\r\n      userEmail = await user.getEmail();\r\n    } catch (e) {\r\n      console.log('[Quick Apply] Could not get email');\r\n    }\r\n\r\n    const userId = user.id;\r\n\r\n    return {\r\n      loggedIn: true,\r\n      isPremium: true,\r\n      tier: 'premium',\r\n      email: userEmail,\r\n      userId: userId\r\n    };\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] Error checking user status:', error);\r\n    return { loggedIn: false, isPremium: false, tier: 'guest' };\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// PROFILE LOADING\r\n// ============================================================================\r\n\r\nasync function loadExistingProfile() {\r\n  try {\r\n    const profileResult = await getOrCreateDriverProfile();\r\n\r\n    if (profileResult.success) {\r\n      cachedDriverProfile = profileResult.profile;\r\n      console.log('[Quick Apply] Profile loaded:', cachedDriverProfile._id);\r\n      console.log('[Quick Apply] Profile completeness:', cachedDriverProfile.profile_completeness_score);\r\n\r\n      // Check for existing documents\r\n      if (cachedDriverProfile.cdl_front_image) {\r\n        uploadedDocuments.cdlFront = { url: cachedDriverProfile.cdl_front_image, isExisting: true };\r\n      }\r\n      if (cachedDriverProfile.cdl_back_image) {\r\n        uploadedDocuments.cdlBack = { url: cachedDriverProfile.cdl_back_image, isExisting: true };\r\n      }\r\n      if (cachedDriverProfile.med_card_image) {\r\n        uploadedDocuments.medCard = { url: cachedDriverProfile.med_card_image, isExisting: true };\r\n      }\r\n      if (cachedDriverProfile.resume_file) {\r\n        uploadedDocuments.resume = { url: cachedDriverProfile.resume_file, isExisting: true };\r\n      }\r\n\r\n      return cachedDriverProfile;\r\n    } else {\r\n      console.error('[Quick Apply] Profile load failed:', profileResult.error);\r\n      return null;\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] Profile load error:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HTML COMPONENT FINDER\r\n// ============================================================================\r\n\r\nfunction getHtmlComponent() {\r\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\r\n\r\n  for (const id of possibleIds) {\r\n    try {\r\n      const el = $w(`#${id}`);\r\n      if (el && typeof el.onMessage === 'function') {\r\n        CONFIG.htmlComponentId = id;\r\n        return el;\r\n      }\r\n    } catch (e) { }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction getComponent() {\r\n  try {\r\n    return $w(`#${CONFIG.htmlComponentId}`);\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// MESSAGE HANDLER\r\n// ============================================================================\r\n\r\nasync function handleHtmlMessage(msg) {\r\n  if (!msg || !msg.type) return;\r\n\r\n  const action = msg.action || msg.type;\r\n\r\n  // Validate and log inbound message\r\n  validateInboundMessage(action);\r\n  logMessageFlow('in', action, msg.data);\r\n\r\n  switch (action) {\r\n    // Health check\r\n    case 'ping':\r\n      sendToHtml('pong', {\r\n        timestamp: Date.now(),\r\n        registeredInbound: MESSAGE_REGISTRY.inbound.length,\r\n        registeredOutbound: MESSAGE_REGISTRY.outbound.length\r\n      });\r\n      break;\r\n\r\n    // Page ready signal from HTML (both old and new format)\r\n    case 'quickApplyReady':\r\n    case 'quickApplyFormReady':\r\n      await handleQuickApplyReady();\r\n      break;\r\n\r\n    // New: Direct OCR extraction request from HTML (extractDocumentOCR)\r\n    case 'extractDocumentOCR':\r\n      await handleExtractDocumentOCR(msg.data);\r\n      break;\r\n\r\n    // Document upload\r\n    case 'uploadDocument':\r\n      await handleDocumentUpload(msg.data);\r\n      break;\r\n\r\n    // Clear document\r\n    case 'clearDocument':\r\n      await handleClearDocument(msg.data);\r\n      break;\r\n\r\n    // Run OCR on uploaded document\r\n    case 'runOCR':\r\n      await handleRunOCR(msg.data);\r\n      break;\r\n\r\n    // Submit quick apply\r\n    case 'submitQuickApply':\r\n      await handleSubmitQuickApply(msg.data);\r\n      break;\r\n\r\n    // Navigation\r\n    case 'navigateToMatching':\r\n      wixLocation.to(CONFIG.matchingPageUrl);\r\n      break;\r\n\r\n    case 'navigateToDashboard':\r\n      wixLocation.to(CONFIG.dashboardPageUrl);\r\n      break;\r\n\r\n    case 'navigateToLogin':\r\n      await handleNavigateToLogin();\r\n      break;\r\n\r\n    // User status check\r\n    case 'checkUserStatus': {\r\n      const status = await getUserStatus();\r\n      cachedUserStatus = status;\r\n      sendToHtml('userStatusUpdate', status);\r\n      break;\r\n    }\r\n\r\n    // Get profile\r\n    case 'getProfile':\r\n      await handleGetProfile();\r\n      break;\r\n\r\n    default:\r\n      console.log('[Quick Apply] Unknown message type:', action);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Quick Apply Ready\r\n// ============================================================================\r\n\r\nasync function handleQuickApplyReady() {\r\n  console.log('[Quick Apply] HTML Embed Ready - Sending initial state');\r\n\r\n  // Prepare profile data for HTML\r\n  const profileData = cachedDriverProfile ? {\r\n    id: cachedDriverProfile._id,\r\n    displayName: cachedDriverProfile.display_name,\r\n    email: cachedDriverProfile.email,\r\n    phone: cachedDriverProfile.phone,\r\n    homeZip: cachedDriverProfile.home_zip,\r\n    cdlClass: cachedDriverProfile.cdl_class,\r\n    cdlNumber: cachedDriverProfile.cdl_number,\r\n    cdlExpiration: cachedDriverProfile.cdl_expiration,\r\n    medCardExpiration: cachedDriverProfile.med_card_expiration,\r\n    endorsements: cachedDriverProfile.endorsements,\r\n    yearsExperience: cachedDriverProfile.years_experience,\r\n    completeness: cachedDriverProfile.profile_completeness_score,\r\n    isComplete: cachedDriverProfile.is_complete,\r\n    missingFields: cachedDriverProfile.missing_fields,\r\n    // Existing document URLs\r\n    cdlFrontImage: cachedDriverProfile.cdl_front_image,\r\n    cdlBackImage: cachedDriverProfile.cdl_back_image,\r\n    medCardImage: cachedDriverProfile.med_card_image,\r\n    resumeFile: cachedDriverProfile.resume_file\r\n  } : null;\r\n\r\n  sendToHtml('pageReady', {\r\n    userStatus: cachedUserStatus,\r\n    driverProfile: profileData,\r\n    preSelectedCarrier: preSelectedCarrier,\r\n    uploadedDocuments: {\r\n      cdlFront: uploadedDocuments.cdlFront ? { exists: true, isExisting: uploadedDocuments.cdlFront.isExisting } : null,\r\n      cdlBack: uploadedDocuments.cdlBack ? { exists: true, isExisting: uploadedDocuments.cdlBack.isExisting } : null,\r\n      medCard: uploadedDocuments.medCard ? { exists: true, isExisting: uploadedDocuments.medCard.isExisting } : null,\r\n      resume: uploadedDocuments.resume ? { exists: true, isExisting: uploadedDocuments.resume.isExisting } : null\r\n    },\r\n    extractedData: extractedData\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Get Profile\r\n// ============================================================================\r\n\r\nasync function handleGetProfile() {\r\n  try {\r\n    if (!cachedUserStatus.loggedIn) {\r\n      sendToHtml('profileLoaded', { success: false, error: 'Not logged in' });\r\n      return;\r\n    }\r\n\r\n    const profile = await loadExistingProfile();\r\n\r\n    if (profile) {\r\n      sendToHtml('profileLoaded', {\r\n        success: true,\r\n        profile: {\r\n          id: profile._id,\r\n          displayName: profile.display_name,\r\n          email: profile.email,\r\n          phone: profile.phone,\r\n          homeZip: profile.home_zip,\r\n          cdlClass: profile.cdl_class,\r\n          cdlNumber: profile.cdl_number,\r\n          cdlExpiration: profile.cdl_expiration,\r\n          medCardExpiration: profile.med_card_expiration,\r\n          endorsements: profile.endorsements,\r\n          yearsExperience: profile.years_experience,\r\n          completeness: profile.profile_completeness_score,\r\n          cdlFrontImage: profile.cdl_front_image,\r\n          cdlBackImage: profile.cdl_back_image,\r\n          medCardImage: profile.med_card_image,\r\n          resumeFile: profile.resume_file\r\n        }\r\n      });\r\n    } else {\r\n      sendToHtml('profileLoaded', { success: false, error: 'Profile not found' });\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] Get profile error:', error);\r\n    sendToHtml('profileLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Document Upload\r\n// ============================================================================\r\n\r\nasync function handleDocumentUpload(data) {\r\n  if (!data || !data.docType || !data.file) {\r\n    sendToHtml('uploadError', { error: 'Missing document data', docType: data?.docType });\r\n    return;\r\n  }\r\n\r\n  const { docType, file } = data;\r\n  const { base64, name, type, size } = file;\r\n\r\n  console.log(`[Quick Apply] Processing upload: ${docType} - ${name} (${Math.round(size / 1024)}KB)`);\r\n\r\n  // Validate file size\r\n  if (size > CONFIG.maxFileSize) {\r\n    sendToHtml('uploadError', {\r\n      error: `File too large. Maximum size is ${Math.round(CONFIG.maxFileSize / (1024 * 1024))}MB`,\r\n      docType: docType\r\n    });\r\n    return;\r\n  }\r\n\r\n  // Validate file type\r\n  if (!CONFIG.supportedFormats.includes(type)) {\r\n    sendToHtml('uploadError', {\r\n      error: 'Unsupported file format. Please use JPEG, PNG, or PDF.',\r\n      docType: docType\r\n    });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // Store the document data locally\r\n    const docData = {\r\n      data: base64,\r\n      name: name,\r\n      type: type,\r\n      size: size,\r\n      uploadedAt: new Date().toISOString(),\r\n      isExisting: false\r\n    };\r\n\r\n    // Store in appropriate slot\r\n    switch (docType) {\r\n      case 'cdlFront':\r\n      case 'CDL_FRONT':\r\n        uploadedDocuments.cdlFront = docData;\r\n        break;\r\n      case 'cdlBack':\r\n      case 'CDL_BACK':\r\n        uploadedDocuments.cdlBack = docData;\r\n        break;\r\n      case 'medCard':\r\n      case 'MED_CARD':\r\n        uploadedDocuments.medCard = docData;\r\n        break;\r\n      case 'resume':\r\n      case 'RESUME':\r\n        uploadedDocuments.resume = docData;\r\n        break;\r\n      default:\r\n        console.warn('[Quick Apply] Unknown document type:', docType);\r\n    }\r\n\r\n    console.log(`[Quick Apply] Document stored: ${docType}`);\r\n\r\n    sendToHtml('uploadSuccess', {\r\n      docType: docType,\r\n      fileName: name,\r\n      fileSize: size,\r\n      fileType: type\r\n    });\r\n\r\n    // Auto-run OCR for CDL and Med Card\r\n    if (['cdlFront', 'CDL_FRONT', 'cdlBack', 'CDL_BACK', 'medCard', 'MED_CARD'].includes(docType)) {\r\n      // Slight delay to let UI update\r\n      setTimeout(() => {\r\n        handleRunOCR({ docType: docType, base64Data: base64 });\r\n      }, 500);\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] Upload error:', error);\r\n    sendToHtml('uploadError', {\r\n      error: error.message,\r\n      docType: docType\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Clear Document\r\n// ============================================================================\r\n\r\nasync function handleClearDocument(data) {\r\n  if (!data || !data.docType) {\r\n    return;\r\n  }\r\n\r\n  const { docType } = data;\r\n\r\n  switch (docType) {\r\n    case 'cdlFront':\r\n    case 'CDL_FRONT':\r\n      uploadedDocuments.cdlFront = null;\r\n      if (extractedData.cdlFront) delete extractedData.cdlFront;\r\n      break;\r\n    case 'cdlBack':\r\n    case 'CDL_BACK':\r\n      uploadedDocuments.cdlBack = null;\r\n      if (extractedData.cdlBack) delete extractedData.cdlBack;\r\n      break;\r\n    case 'medCard':\r\n    case 'MED_CARD':\r\n      uploadedDocuments.medCard = null;\r\n      if (extractedData.medCard) delete extractedData.medCard;\r\n      break;\r\n    case 'mvr':\r\n    case 'MVR':\r\n      uploadedDocuments.mvr = null;\r\n      break;\r\n    case 'resume':\r\n    case 'RESUME':\r\n      uploadedDocuments.resume = null;\r\n      break;\r\n  }\r\n\r\n  console.log(`[Quick Apply] Document cleared: ${docType}`);\r\n\r\n  sendToHtml('documentCleared', { docType: docType });\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Extract Document OCR (New format from updated HTML)\r\n// ============================================================================\r\n\r\nasync function handleExtractDocumentOCR(data) {\r\n  if (!data || !data.base64Data || !data.docType) {\r\n    sendToHtml('ocrResult', {\r\n      success: false,\r\n      docType: data?.docType,\r\n      error: 'Missing required data for OCR'\r\n    });\r\n    return;\r\n  }\r\n\r\n  const { base64Data, docType, inputId } = data;\r\n\r\n  console.log(`[Quick Apply] OCR extraction requested for ${docType}`);\r\n\r\n  try {\r\n    // Call the OCR service\r\n    const result = await extractDocumentForAutoFill(base64Data, docType);\r\n\r\n    if (result.success) {\r\n      console.log(`[Quick Apply] OCR success for ${docType}:`, result.extracted);\r\n\r\n      // Store extracted data\r\n      const normalizedType = normalizeDocType(docType);\r\n      extractedData[normalizedType] = result.extracted;\r\n\r\n      // Send result back to HTML in expected format\r\n      sendToHtml('ocrResult', {\r\n        success: true,\r\n        docType: docType,\r\n        inputId: inputId,\r\n        confidence: result.confidence,\r\n        consensusMethod: result.consensusMethod,\r\n        extracted: result.extracted\r\n      });\r\n\r\n    } else {\r\n      console.error(`[Quick Apply] OCR failed for ${docType}:`, result.error);\r\n      sendToHtml('ocrResult', {\r\n        success: false,\r\n        docType: docType,\r\n        inputId: inputId,\r\n        error: result.error || 'OCR extraction failed',\r\n        userMessage: result.userMessage\r\n      });\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] OCR error:', error);\r\n    sendToHtml('ocrResult', {\r\n      success: false,\r\n      docType: docType,\r\n      inputId: inputId,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Run OCR\r\n// ============================================================================\r\n\r\nasync function handleRunOCR(data) {\r\n  if (!data || !data.docType) {\r\n    sendToHtml('ocrError', { error: 'Missing document type', docType: data?.docType });\r\n    return;\r\n  }\r\n\r\n  const { docType } = data;\r\n  let base64Data = data.base64Data;\r\n\r\n  // If base64 not provided, get from stored document\r\n  if (!base64Data) {\r\n    const normalizedType = normalizeDocType(docType);\r\n    const doc = uploadedDocuments[normalizedType];\r\n    if (doc && doc.data) {\r\n      base64Data = doc.data;\r\n    } else {\r\n      sendToHtml('ocrError', { error: 'No document found', docType: docType });\r\n      return;\r\n    }\r\n  }\r\n\r\n  // Map to OCR service doc types\r\n  const ocrDocType = mapToOcrDocType(docType);\r\n\r\n  console.log(`[Quick Apply] Running OCR for ${docType} (mapped to ${ocrDocType})`);\r\n\r\n  // Notify HTML that OCR is processing\r\n  sendToHtml('ocrProcessing', { docType: docType });\r\n\r\n  try {\r\n    const result = await extractDocumentForAutoFill(base64Data, ocrDocType);\r\n\r\n    if (result.success) {\r\n      console.log(`[Quick Apply] OCR success for ${docType}:`, result.extracted);\r\n\r\n      // Store extracted data\r\n      const normalizedType = normalizeDocType(docType);\r\n      extractedData[normalizedType] = result.extracted;\r\n\r\n      sendToHtml('ocrComplete', {\r\n        docType: docType,\r\n        confidence: result.confidence,\r\n        consensusMethod: result.consensusMethod,\r\n        extracted: result.extracted\r\n      });\r\n\r\n    } else {\r\n      console.error(`[Quick Apply] OCR failed for ${docType}:`, result.error);\r\n      sendToHtml('ocrError', {\r\n        docType: docType,\r\n        error: result.error || 'OCR extraction failed'\r\n      });\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] OCR error:', error);\r\n    sendToHtml('ocrError', {\r\n      docType: docType,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Submit Quick Apply\r\n// ============================================================================\r\n\r\nasync function handleSubmitQuickApply(data) {\r\n  console.log('[Quick Apply] Submitting application...');\r\n\r\n  // For new HTML format, documents come inside data.documents\r\n  // For old format, they come from uploadedDocuments state\r\n  const hasNewFormat = data && data.documents;\r\n\r\n  // Check if user is logged in (for full submission)\r\n  // Allow guest submissions for profile-only saves\r\n  const isGuestSubmission = !cachedUserStatus.loggedIn;\r\n\r\n  try {\r\n    // Prepare documents for submission\r\n    let documents = {};\r\n\r\n    if (hasNewFormat && data.documents) {\r\n      // New format: documents are in data.documents\r\n      documents = {\r\n        cdlFront: data.documents.cdlFront || null,\r\n        cdlBack: data.documents.cdlBack || null,\r\n        medCard: data.documents.medCard || null,\r\n        mvr: data.documents.mvr || null,\r\n        resume: data.documents.resume || null\r\n      };\r\n    } else {\r\n      // Old format: use uploadedDocuments state\r\n      if (uploadedDocuments.cdlFront && uploadedDocuments.cdlFront.data) {\r\n        documents.cdlFront = {\r\n          data: uploadedDocuments.cdlFront.data,\r\n          name: uploadedDocuments.cdlFront.name,\r\n          type: uploadedDocuments.cdlFront.type\r\n        };\r\n      }\r\n\r\n      if (uploadedDocuments.cdlBack && uploadedDocuments.cdlBack.data) {\r\n        documents.cdlBack = {\r\n          data: uploadedDocuments.cdlBack.data,\r\n          name: uploadedDocuments.cdlBack.name,\r\n          type: uploadedDocuments.cdlBack.type\r\n        };\r\n      }\r\n\r\n      if (uploadedDocuments.medCard && uploadedDocuments.medCard.data) {\r\n        documents.medCard = {\r\n          data: uploadedDocuments.medCard.data,\r\n          name: uploadedDocuments.medCard.name,\r\n          type: uploadedDocuments.medCard.type\r\n        };\r\n      }\r\n\r\n      if (uploadedDocuments.resume && uploadedDocuments.resume.data) {\r\n        documents.resume = {\r\n          data: uploadedDocuments.resume.data,\r\n          name: uploadedDocuments.resume.name,\r\n          type: uploadedDocuments.resume.type\r\n        };\r\n      }\r\n    }\r\n\r\n    // Prepare existing document URLs for reference\r\n    const existingProfileDocs = cachedDriverProfile ? {\r\n      cdl_front_image: cachedDriverProfile.cdl_front_image,\r\n      cdl_back_image: cachedDriverProfile.cdl_back_image,\r\n      med_card_image: cachedDriverProfile.med_card_image,\r\n      resume_file: cachedDriverProfile.resume_file\r\n    } : {};\r\n\r\n    // Merge extracted data with form data\r\n    const cdlData = extractedData.cdlFront || extractedData.cdlBack || {};\r\n    const medCardData = extractedData.medCard || {};\r\n\r\n    // Build application payload\r\n    const applicationPayload = {\r\n      // Carrier info (from URL params or form)\r\n      carrierDOT: data.carrierDOT || preSelectedCarrier?.dot || null,\r\n      carrierName: data.carrierName || preSelectedCarrier?.name || null,\r\n\r\n      // Contact info\r\n      phone: data.phone || cachedDriverProfile?.phone || '',\r\n      email: data.email || cachedDriverProfile?.email || '',\r\n      preferredContact: data.preferredContact || 'phone',\r\n\r\n      // Availability\r\n      availability: data.availability || 'Immediately',\r\n      message: data.message || '',\r\n\r\n      // CDL info (from form or OCR)\r\n      cdlNumber: data.cdlNumber || cdlData.licenseNumber || cachedDriverProfile?.cdl_number || '',\r\n      cdlExpiration: data.cdlExpiration || cdlData.expirationDate || cachedDriverProfile?.cdl_expiration || '',\r\n      medCardExpiration: data.medCardExpiration || medCardData.certificateExpirationDate || cachedDriverProfile?.med_card_expiration || '',\r\n\r\n      // Documents\r\n      documents: documents,\r\n      existingProfileDocs: existingProfileDocs\r\n    };\r\n\r\n    // If no carrier specified, just save documents to profile\r\n    if (!applicationPayload.carrierDOT) {\r\n      console.log('[Quick Apply] No carrier specified - saving documents to profile');\r\n\r\n      const updateResult = await updateDriverDocuments({\r\n        cdlFront: documents.cdlFront || null,\r\n        cdlBack: documents.cdlBack || null,\r\n        medCard: documents.medCard || null,\r\n        resume: documents.resume || null\r\n      });\r\n\r\n      if (updateResult.success) {\r\n        cachedDriverProfile = updateResult.profile;\r\n        const successResponse = {\r\n          success: true,\r\n          type: 'profileUpdate',\r\n          message: 'Documents saved to your profile successfully!',\r\n          profile: {\r\n            completeness: updateResult.profile.profile_completeness_score,\r\n            cdlFrontImage: updateResult.profile.cdl_front_image,\r\n            cdlBackImage: updateResult.profile.cdl_back_image,\r\n            medCardImage: updateResult.profile.med_card_image,\r\n            resumeFile: updateResult.profile.resume_file\r\n          }\r\n        };\r\n        sendToHtml('applicationSubmitted', successResponse);\r\n        sendToHtml('submitResult', successResponse); // Also send for new HTML format\r\n      } else {\r\n        const errorResponse = { success: false, error: updateResult.error || 'Failed to save documents' };\r\n        sendToHtml('applicationError', errorResponse);\r\n        sendToHtml('submitResult', errorResponse); // Also send for new HTML format\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // Submit the application\r\n    console.log('[Quick Apply] Submitting to carrier:', applicationPayload.carrierDOT);\r\n\r\n    const result = await submitApplication(applicationPayload);\r\n\r\n    if (result.success) {\r\n      console.log('[Quick Apply] Application submitted successfully');\r\n\r\n      // Clear uploaded documents (they're now saved)\r\n      uploadedDocuments = {\r\n        cdlFront: null,\r\n        cdlBack: null,\r\n        medCard: null,\r\n        mvr: null,\r\n        resume: null\r\n      };\r\n\r\n      const successResponse = {\r\n        success: true,\r\n        type: 'application',\r\n        carrierDOT: applicationPayload.carrierDOT,\r\n        carrierName: applicationPayload.carrierName,\r\n        applicationId: result.application?._id,\r\n        isNew: result.isNew,\r\n        message: 'Your application has been submitted successfully!'\r\n      };\r\n      sendToHtml('applicationSubmitted', successResponse);\r\n      sendToHtml('submitResult', successResponse); // Also send for new HTML format\r\n\r\n    } else {\r\n      console.error('[Quick Apply] Application failed:', result.error);\r\n      const errorResponse = { success: false, error: result.error || 'Failed to submit application' };\r\n      sendToHtml('applicationError', errorResponse);\r\n      sendToHtml('submitResult', errorResponse); // Also send for new HTML format\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('[Quick Apply] Submit error:', error);\r\n    const errorResponse = { success: false, error: error.message };\r\n    sendToHtml('applicationError', errorResponse);\r\n    sendToHtml('submitResult', errorResponse); // Also send for new HTML format\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HANDLER: Navigate to Login\r\n// ============================================================================\r\n\r\nasync function handleNavigateToLogin() {\r\n  console.log('[Quick Apply] Navigating to login');\r\n\r\n  if (wixUsers) {\r\n    try {\r\n      const user = await wixUsers.promptLogin({ mode: 'login' });\r\n      console.log('[Quick Apply] User logged in:', user.id);\r\n\r\n      // Refresh user status\r\n      cachedUserStatus = await getUserStatus();\r\n\r\n      // Load profile\r\n      await loadExistingProfile();\r\n\r\n      // Notify HTML\r\n      sendToHtml('userStatusUpdate', {\r\n        ...cachedUserStatus,\r\n        justLoggedIn: true\r\n      });\r\n\r\n      // Send updated page state\r\n      await handleQuickApplyReady();\r\n\r\n    } catch (error) {\r\n      console.log('[Quick Apply] Login cancelled:', error);\r\n    }\r\n  } else {\r\n    wixLocation.to(CONFIG.loginPageUrl);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// UTILITY FUNCTIONS\r\n// ============================================================================\r\n\r\nfunction normalizeDocType(docType) {\r\n  switch (docType) {\r\n    case 'cdlFront':\r\n    case 'CDL_FRONT':\r\n      return 'cdlFront';\r\n    case 'cdlBack':\r\n    case 'CDL_BACK':\r\n      return 'cdlBack';\r\n    case 'medCard':\r\n    case 'MED_CARD':\r\n      return 'medCard';\r\n    case 'mvr':\r\n    case 'MVR':\r\n      return 'mvr';\r\n    case 'resume':\r\n    case 'RESUME':\r\n      return 'resume';\r\n    default:\r\n      return docType;\r\n  }\r\n}\r\n\r\nfunction mapToOcrDocType(docType) {\r\n  switch (docType) {\r\n    case 'cdlFront':\r\n    case 'CDL_FRONT':\r\n      return 'CDL_FRONT';\r\n    case 'cdlBack':\r\n    case 'CDL_BACK':\r\n      return 'CDL_BACK';\r\n    case 'medCard':\r\n    case 'MED_CARD':\r\n      return 'MED_CARD';\r\n    default:\r\n      return docType;\r\n  }\r\n}\r\n\r\nfunction sendToHtml(type, data) {\r\n  // Validate outbound message is registered\r\n  if (!MESSAGE_REGISTRY.outbound.includes(type)) {\r\n    console.warn(`[Quick Apply] UNREGISTERED OUTBOUND MESSAGE: \"${type}\" - Add to MESSAGE_REGISTRY.outbound`);\r\n  }\r\n\r\n  logMessageFlow('out', type, data);\r\n\r\n  try {\r\n    const component = getComponent();\r\n    if (component && typeof component.postMessage === 'function') {\r\n      component.postMessage({ type, data, timestamp: Date.now() });\r\n    }\r\n  } catch (error) {\r\n    console.error('[Quick Apply] Error sending to HTML:', error);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// UI ELEMENT HELPERS (for direct Wix element manipulation if needed)\r\n// ============================================================================\r\n\r\nfunction safeGetElement(selector) {\r\n  try {\r\n    const el = $w(selector);\r\n    return el && el.valid !== false ? el : null;\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction showElement(selector) {\r\n  const el = safeGetElement(selector);\r\n  if (el && typeof el.show === 'function') {\r\n    el.show();\r\n  }\r\n}\r\n\r\nfunction hideElement(selector) {\r\n  const el = safeGetElement(selector);\r\n  if (el && typeof el.hide === 'function') {\r\n    el.hide();\r\n  }\r\n}\r\n\r\nfunction setElementText(selector, text) {\r\n  const el = safeGetElement(selector);\r\n  if (el && typeof el.text !== 'undefined') {\r\n    el.text = text;\r\n  }\r\n}\r\n\r\nfunction setElementSrc(selector, src) {\r\n  const el = safeGetElement(selector);\r\n  if (el && typeof el.src !== 'undefined') {\r\n    el.src = src;\r\n  }\r\n}\r\n\r\nfunction enableElement(selector) {\r\n  const el = safeGetElement(selector);\r\n  if (el && typeof el.enable === 'function') {\r\n    el.enable();\r\n  }\r\n}\r\n\r\nfunction disableElement(selector) {\r\n  const el = safeGetElement(selector);\r\n  if (el && typeof el.disable === 'function') {\r\n    el.disable();\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER DRIVER SEARCH.qtecw.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_ATTRIBUTION.f8zdu.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'convertSessionToDriver' is defined but never used.","line":6,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":98},{"ruleId":"no-unused-vars","severity":1,"message":"'wixUsers' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":69,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":69,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2195,2196],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * RECRUITER_ATTRIBUTION Page Code\n * Handles PostMessage bridge for source attribution analytics\n */\n\nimport { getAttributionBreakdown, recordTouchpoint, recordHireAttribution, convertSessionToDriver } from 'backend/recruiterAnalyticsService.jsw';\nimport wixUsers from 'wix-users';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'attributionReady',\n    'getAttributionData',\n    'recordTouchpoint',\n    'recordHireAttribution'\n  ],\n  outbound: [\n    'attributionData',\n    'attributionError',\n    'touchpointResult',\n    'hireAttributionResult'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet carrierDot = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('RECRUITER_ATTRIBUTION page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'attributionReady':\n      console.log('Attribution HTML ready');\n      if (carrierDot) {\n        sendToHtml('carrierContext', { carrierDot });\n      }\n      break;\n\n    case 'getAttributionData':\n      await handleGetAttributionData(msg.data);\n      break;\n\n    case 'recordTouchpoint':\n      await handleRecordTouchpoint(msg.data);\n      break;\n\n    case 'recordHireAttribution':\n      await handleRecordHireAttribution(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetAttributionData(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('attributionError', { error: 'No carrier context' });\n      return;\n    }\n\n    carrierDot = dot;\n\n    const dateRange = data?.dateRange || { start: null, end: null };\n    const metric = data?.metric || 'applications';\n\n    const result = await getAttributionBreakdown(dot, dateRange, metric);\n\n    if (!result.success) {\n      sendToHtml('attributionError', { error: result.error || 'Failed to fetch attribution data' });\n      return;\n    }\n\n    sendToHtml('attributionData', {\n      success: true,\n      breakdown: result.breakdown || [],\n      totals: result.totals || {},\n      metric: metric\n    });\n\n  } catch (error) {\n    console.error('Error fetching attribution data:', error);\n    sendToHtml('attributionError', { error: error.message });\n  }\n}\n\nasync function handleRecordTouchpoint(data) {\n  try {\n    const { driverId, utmParams, pageUrl, sessionId } = data;\n\n    if (!utmParams && !sessionId) {\n      sendToHtml('touchpointResult', { success: false, error: 'Missing UTM params or session' });\n      return;\n    }\n\n    const result = await recordTouchpoint(driverId, utmParams, pageUrl, sessionId);\n    sendToHtml('touchpointResult', result);\n\n  } catch (error) {\n    console.error('Error recording touchpoint:', error);\n    sendToHtml('touchpointResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleRecordHireAttribution(data) {\n  try {\n    const { driverId, attributionModel } = data;\n    const dot = data?.carrierDot || carrierDot;\n\n    if (!driverId || !dot) {\n      sendToHtml('hireAttributionResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await recordHireAttribution(driverId, dot, attributionModel || 'first_touch');\n    sendToHtml('hireAttributionResult', result);\n\n  } catch (error) {\n    console.error('Error recording hire attribution:', error);\n    sendToHtml('hireAttributionResult', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_COMPETITOR_INTEL.hvbs4.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":73,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":73,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2302,2303],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * RECRUITER_COMPETITOR_INTEL Page Code\n * Handles PostMessage bridge for competitor intelligence\n */\n\nimport { addCompetitorIntel, updateCompetitorIntel, verifyCompetitorIntel, getCompetitorComparison, getPayBenchmarks, triggerCompetitorScrape } from 'backend/recruiterAnalyticsService.jsw';\nimport wixUsers from 'wix-users';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'competitorIntelReady',\n    'getCompetitorData',\n    'addIntel',\n    'updateIntel',\n    'verifyIntel',\n    'getPayBenchmarks',\n    'triggerScrape'\n  ],\n  outbound: [\n    'competitorData',\n    'competitorError',\n    'intelResult',\n    'payBenchmarksData',\n    'scrapeResult'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet carrierDot = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('RECRUITER_COMPETITOR_INTEL page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'competitorIntelReady':\n      console.log('Competitor Intel HTML ready');\n      if (carrierDot) {\n        sendToHtml('carrierContext', { carrierDot });\n      }\n      break;\n\n    case 'getCompetitorData':\n      await handleGetCompetitorData(msg.data);\n      break;\n\n    case 'addIntel':\n      await handleAddIntel(msg.data);\n      break;\n\n    case 'updateIntel':\n      await handleUpdateIntel(msg.data);\n      break;\n\n    case 'verifyIntel':\n      await handleVerifyIntel(msg.data);\n      break;\n\n    case 'getPayBenchmarks':\n      await handleGetPayBenchmarks(msg.data);\n      break;\n\n    case 'triggerScrape':\n      await handleTriggerScrape(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetCompetitorData(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (dot) carrierDot = dot;\n\n    const region = data?.region || 'national';\n    const jobType = data?.jobType || 'OTR';\n\n    // Fetch competitor comparison and benchmarks in parallel\n    const [comparisonResult, benchmarksResult] = await Promise.all([\n      getCompetitorComparison(region, jobType),\n      getPayBenchmarks(region, jobType)\n    ]);\n\n    sendToHtml('competitorData', {\n      success: true,\n      competitors: comparisonResult.success ? comparisonResult.competitors : [],\n      benchmarks: benchmarksResult.success ? benchmarksResult.benchmarks : {},\n      region,\n      jobType\n    });\n\n  } catch (error) {\n    console.error('Error fetching competitor data:', error);\n    sendToHtml('competitorError', { error: error.message });\n  }\n}\n\nasync function handleAddIntel(data) {\n  try {\n    if (!data) {\n      sendToHtml('intelResult', { success: false, error: 'No data provided' });\n      return;\n    }\n\n    const result = await addCompetitorIntel(data);\n    sendToHtml('intelResult', result);\n\n  } catch (error) {\n    console.error('Error adding intel:', error);\n    sendToHtml('intelResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleUpdateIntel(data) {\n  try {\n    const { intelId, updates } = data;\n\n    if (!intelId || !updates) {\n      sendToHtml('intelResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await updateCompetitorIntel(intelId, updates);\n    sendToHtml('intelResult', result);\n\n  } catch (error) {\n    console.error('Error updating intel:', error);\n    sendToHtml('intelResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleVerifyIntel(data) {\n  try {\n    const { intelId, verifierId } = data;\n\n    if (!intelId) {\n      sendToHtml('intelResult', { success: false, error: 'Missing intel ID' });\n      return;\n    }\n\n    const currentUser = wixUsers.currentUser;\n    const result = await verifyCompetitorIntel(intelId, verifierId || currentUser.id);\n    sendToHtml('intelResult', result);\n\n  } catch (error) {\n    console.error('Error verifying intel:', error);\n    sendToHtml('intelResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleGetPayBenchmarks(data) {\n  try {\n    const region = data?.region || 'national';\n    const jobType = data?.jobType || 'OTR';\n\n    const result = await getPayBenchmarks(region, jobType);\n    sendToHtml('payBenchmarksData', result);\n\n  } catch (error) {\n    console.error('Error fetching pay benchmarks:', error);\n    sendToHtml('payBenchmarksData', { success: false, error: error.message });\n  }\n}\n\nasync function handleTriggerScrape(data) {\n  try {\n    const { urls } = data;\n\n    if (!Array.isArray(urls) || urls.length === 0) {\n      sendToHtml('scrapeResult', { success: false, error: 'No URLs provided' });\n      return;\n    }\n\n    const result = await triggerCompetitorScrape(urls);\n    sendToHtml('scrapeResult', result);\n\n  } catch (error) {\n    console.error('Error triggering scrape:', error);\n    sendToHtml('scrapeResult', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_COST_ANALYSIS.hc0dz.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'wixUsers' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":74,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":74,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2283,2284],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * RECRUITER_COST_ANALYSIS Page Code\n * Handles PostMessage bridge for cost-per-hire analytics\n */\n\nimport { recordRecruitingSpend, bulkImportSpend, calculateCostPerHire, getChannelROI, getSpendTrend, updateSpendHires } from 'backend/recruiterAnalyticsService.jsw';\nimport wixUsers from 'wix-users';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'costAnalysisReady',\n    'getCostData',\n    'recordSpend',\n    'bulkImportSpend',\n    'updateSpendHires',\n    'getChannelROI',\n    'getSpendTrend'\n  ],\n  outbound: [\n    'costData',\n    'costError',\n    'spendResult',\n    'bulkImportResult',\n    'channelROIData',\n    'spendTrendData'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet carrierDot = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('RECRUITER_COST_ANALYSIS page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'costAnalysisReady':\n      console.log('Cost Analysis HTML ready');\n      if (carrierDot) {\n        sendToHtml('carrierContext', { carrierDot });\n      }\n      break;\n\n    case 'getCostData':\n      await handleGetCostData(msg.data);\n      break;\n\n    case 'recordSpend':\n      await handleRecordSpend(msg.data);\n      break;\n\n    case 'bulkImportSpend':\n      await handleBulkImportSpend(msg.data);\n      break;\n\n    case 'updateSpendHires':\n      await handleUpdateSpendHires(msg.data);\n      break;\n\n    case 'getChannelROI':\n      await handleGetChannelROI(msg.data);\n      break;\n\n    case 'getSpendTrend':\n      await handleGetSpendTrend(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetCostData(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('costError', { error: 'No carrier context' });\n      return;\n    }\n\n    carrierDot = dot;\n\n    const dateRange = data?.dateRange || { start: null, end: null };\n\n    // Fetch cost metrics and ROI in parallel\n    const [costResult, roiResult, trendResult] = await Promise.all([\n      calculateCostPerHire(dot, dateRange),\n      getChannelROI(dot, dateRange),\n      getSpendTrend(dot, 6)\n    ]);\n\n    if (!costResult.success) {\n      sendToHtml('costError', { error: costResult.error || 'Failed to fetch cost data' });\n      return;\n    }\n\n    sendToHtml('costData', {\n      success: true,\n      metrics: costResult.metrics || {},\n      channelROI: roiResult.success ? roiResult.channels : [],\n      trend: trendResult.success ? trendResult.trend : []\n    });\n\n  } catch (error) {\n    console.error('Error fetching cost data:', error);\n    sendToHtml('costError', { error: error.message });\n  }\n}\n\nasync function handleRecordSpend(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('spendResult', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    const spendData = {\n      carrier_dot: dot,\n      ...data\n    };\n\n    const result = await recordRecruitingSpend(spendData);\n    sendToHtml('spendResult', result);\n\n  } catch (error) {\n    console.error('Error recording spend:', error);\n    sendToHtml('spendResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleBulkImportSpend(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot || !Array.isArray(data?.records)) {\n      sendToHtml('bulkImportResult', { success: false, error: 'Invalid import data' });\n      return;\n    }\n\n    const result = await bulkImportSpend(dot, data.records);\n    sendToHtml('bulkImportResult', result);\n\n  } catch (error) {\n    console.error('Error bulk importing spend:', error);\n    sendToHtml('bulkImportResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleUpdateSpendHires(data) {\n  try {\n    const { spendId, hires } = data;\n\n    if (!spendId || hires === undefined) {\n      sendToHtml('spendResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await updateSpendHires(spendId, hires);\n    sendToHtml('spendResult', result);\n\n  } catch (error) {\n    console.error('Error updating spend hires:', error);\n    sendToHtml('spendResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleGetChannelROI(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('channelROIData', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    const dateRange = data?.dateRange || { start: null, end: null };\n    const result = await getChannelROI(dot, dateRange);\n    sendToHtml('channelROIData', result);\n\n  } catch (error) {\n    console.error('Error fetching channel ROI:', error);\n    sendToHtml('channelROIData', { success: false, error: error.message });\n  }\n}\n\nasync function handleGetSpendTrend(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('spendTrendData', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    const months = data?.months || 6;\n    const result = await getSpendTrend(dot, months);\n    sendToHtml('spendTrendData', result);\n\n  } catch (error) {\n    console.error('Error fetching spend trend:', error);\n    sendToHtml('spendTrendData', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_FUNNEL.c87yk.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":74,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":74,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2320,2321],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * RECRUITER_FUNNEL Page Code\n * Handles PostMessage bridge between HTML embed and backend services\n */\n\nimport { getFunnelMetrics, getBottleneckAnalysis, recordStageChange } from 'backend/recruiterAnalyticsService.jsw';\nimport wixUsers from 'wix-users';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'funnelReady',\n    'getFunnelData',\n    'recordStageChange'\n  ],\n  outbound: [\n    'funnelData',\n    'funnelError',\n    'stageChangeResult'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet carrierDot = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('RECRUITER_FUNNEL page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  // Get carrier context\n  const user = wixUsers.currentUser;\n  if (user.loggedIn) {\n    // In a real implementation, fetch carrier DOT from user's carrier account\n    // For now, we'll wait for it from the HTML or use a default\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'funnelReady':\n      console.log('Funnel HTML ready');\n      // Send initial carrier context if available\n      if (carrierDot) {\n        sendToHtml('carrierContext', { carrierDot });\n      }\n      break;\n\n    case 'getFunnelData':\n      await handleGetFunnelData(msg.data);\n      break;\n\n    case 'recordStageChange':\n      await handleRecordStageChange(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetFunnelData(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('funnelError', { error: 'No carrier context' });\n      return;\n    }\n\n    carrierDot = dot;\n\n    const dateRange = data?.dateRange || { start: null, end: null };\n\n    // Fetch funnel metrics and bottleneck analysis in parallel\n    const [metricsResult, bottleneckResult] = await Promise.all([\n      getFunnelMetrics(dot, dateRange),\n      getBottleneckAnalysis(dot, dateRange)\n    ]);\n\n    if (!metricsResult.success) {\n      sendToHtml('funnelError', { error: metricsResult.error || 'Failed to fetch funnel metrics' });\n      return;\n    }\n\n    sendToHtml('funnelData', {\n      success: true,\n      stages: metricsResult.stages || [],\n      totals: metricsResult.totals || {},\n      bottlenecks: bottleneckResult.success ? bottleneckResult.bottlenecks : []\n    });\n\n  } catch (error) {\n    console.error('Error fetching funnel data:', error);\n    sendToHtml('funnelError', { error: error.message });\n  }\n}\n\nasync function handleRecordStageChange(data) {\n  try {\n    const { driverId, toStage, dropReason } = data;\n    const dot = data?.carrierDot || carrierDot;\n\n    if (!driverId || !toStage || !dot) {\n      sendToHtml('stageChangeResult', { success: false, error: 'Missing required fields' });\n      return;\n    }\n\n    const result = await recordStageChange(driverId, dot, toStage, dropReason);\n    sendToHtml('stageChangeResult', result);\n\n  } catch (error) {\n    console.error('Error recording stage change:', error);\n    sendToHtml('stageChangeResult', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_GAMIFICATION.un5u3.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_LEADERBOARD.o6tal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_LIFECYCLE_MONITOR.mmg97.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_ONBOARDING_DASHBOARD.gebww.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getWorkflowStatus' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'getRecruiterCarriers' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'cachedRecruiterProfile' is assigned a value but never used.","line":71,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'methods' is assigned a value but never used.","line":512,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":512,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'customMessage' is assigned a value but never used.","line":512,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":512,"endColumn":45}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\n// RECRUITER ONBOARDING DASHBOARD - Page Code\n// Wires the HTML component (RECRUITER_ONBOARDING_DASHBOARD.html) to backend\n// onboarding workflow and document collection services.\n// ============================================================================\n\nimport {\n  getActiveWorkflows,\n  getWorkflowStatus,\n  updateWorkflowStatus,\n  cancelWorkflow\n} from 'backend/onboardingWorkflowService';\n\nimport {\n  getDocumentStatus,\n  verifyDocument as verifyDoc,\n  sendDocumentReminder,\n  getDocumentOcrData\n} from 'backend/documentCollectionService';\n\nimport {\n  getOrCreateRecruiterProfile,\n  getRecruiterCarriers\n} from 'backend/recruiter_service';\n\nimport wixLocation from 'wix-location';\n\nlet wixUsers;\ntry {\n  wixUsers = require('wix-users');\n} catch (e) {\n  console.log('wix-users not available');\n}\n\n// ============================================================================\n// CONSTANTS\n// ============================================================================\n\nconst HTML_COMPONENT_IDS = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlEmbed1'];\n\nconst DEBUG_MESSAGES = true;\n\n// Registry mirrors the HTML component's MESSAGE_REGISTRY for validation\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'onboardingDashboardReady',\n    'getWorkflows',\n    'verifyDocument',\n    'rejectDocument',\n    'sendReminder',\n    'getDocumentDetails',\n    'cancelWorkflow',\n    'putOnHold',\n    'resumeWorkflow',\n    'markStarted',\n    'navigateTo'\n  ],\n  outbound: [\n    'initOnboardingDashboard',\n    'workflowList',\n    'documentDetails',\n    'actionResult',\n    'workflowUpdate'\n  ]\n};\n\n// ============================================================================\n// STATE\n// ============================================================================\n\nlet cachedRecruiterProfile = null;\nlet cachedCarriers = [];\nlet recruiterId = null;\n\n// ============================================================================\n// MESSAGE HELPERS\n// ============================================================================\n\nfunction validateInboundMessage(action) {\n  if (!MESSAGE_REGISTRY.inbound.includes(action)) {\n    console.warn(`UNREGISTERED INBOUND MESSAGE: \"${action}\" - Add to MESSAGE_REGISTRY.inbound`);\n    return false;\n  }\n  return true;\n}\n\nfunction logMessageFlow(direction, type, data) {\n  if (!DEBUG_MESSAGES) return;\n  const label = direction === 'in' ? 'HTML->Velo' : 'Velo->HTML';\n  console.log(`[${label}] ${type}`, data ? Object.keys(data) : '(no data)');\n}\n\nfunction sendToHtml(component, type, data) {\n  if (!MESSAGE_REGISTRY.outbound.includes(type)) {\n    console.warn(`UNREGISTERED OUTBOUND MESSAGE: \"${type}\" - Add to MESSAGE_REGISTRY.outbound`);\n  }\n  logMessageFlow('out', type, data);\n  try {\n    component.postMessage({ type, data, timestamp: Date.now() });\n  } catch (err) {\n    console.error('sendToHtml error:', err);\n  }\n}\n\n// ============================================================================\n// HTML COMPONENT DISCOVERY (safety-checked)\n// ============================================================================\n\nfunction getHtmlComponents() {\n  const found = [];\n  for (const id of HTML_COMPONENT_IDS) {\n    try {\n      const component = $w(id);\n      if (component && typeof component.onMessage === 'function') {\n        found.push(component);\n      }\n    } catch (error) {\n      // Element not on page - skip\n    }\n  }\n  return found;\n}\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n\n$w.onReady(async function () {\n  console.log('Recruiter Onboarding Dashboard Ready');\n\n  const components = getHtmlComponents();\n\n  if (!components.length) {\n    console.warn('No HTML component found for Onboarding Dashboard page');\n    return;\n  }\n\n  for (const component of components) {\n    component.onMessage(async (event) => {\n      await routeMessage(component, event?.data);\n    });\n  }\n});\n\n// ============================================================================\n// MESSAGE ROUTER\n// ============================================================================\n\nasync function routeMessage(component, message) {\n  if (!message || !message.type) return;\n\n  const action = message.type;\n  validateInboundMessage(action);\n  logMessageFlow('in', action, message.data);\n\n  try {\n    switch (action) {\n      case 'onboardingDashboardReady':\n        await handleDashboardReady(component);\n        break;\n\n      case 'getWorkflows':\n        await handleGetWorkflows(message.data, component);\n        break;\n\n      case 'getDocumentDetails':\n        await handleGetDocumentDetails(message.data, component);\n        break;\n\n      case 'verifyDocument':\n        await handleVerifyDocument(message.data, component);\n        break;\n\n      case 'rejectDocument':\n        await handleRejectDocument(message.data, component);\n        break;\n\n      case 'sendReminder':\n        await handleSendReminder(message.data, component);\n        break;\n\n      case 'cancelWorkflow':\n        await handleCancelWorkflow(message.data, component);\n        break;\n\n      case 'putOnHold':\n        await handlePutOnHold(message.data, component);\n        break;\n\n      case 'resumeWorkflow':\n        await handleResumeWorkflow(message.data, component);\n        break;\n\n      case 'markStarted':\n        await handleMarkStarted(message.data, component);\n        break;\n\n      case 'navigateTo':\n        handleNavigateTo(message.data);\n        break;\n\n      default:\n        console.warn('Unhandled action:', action);\n    }\n  } catch (error) {\n    console.error('Error handling message:', action, error);\n    sendToHtml(component, 'actionResult', {\n      action,\n      success: false,\n      error: error.message || 'Unknown error'\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Dashboard Ready (Auth + Init)\n// ============================================================================\n\nasync function handleDashboardReady(component) {\n  console.log('Onboarding Dashboard ready, checking auth...');\n\n  // Check authentication\n  if (!wixUsers || !wixUsers.currentUser.loggedIn) {\n    console.log('User not logged in, redirecting...');\n    wixLocation.to('/account/my-account');\n    return;\n  }\n\n  // Get recruiter profile\n  const profileResult = await getOrCreateRecruiterProfile();\n  if (!profileResult.success) {\n    console.error('Failed to get recruiter profile:', profileResult.error);\n    sendToHtml(component, 'actionResult', {\n      action: 'init',\n      success: false,\n      error: profileResult.error || 'Failed to load recruiter profile'\n    });\n    return;\n  }\n\n  cachedRecruiterProfile = profileResult.profile;\n  cachedCarriers = profileResult.carriers || [];\n  recruiterId = wixUsers.currentUser.id;\n\n  // Build carrier list for the filter dropdown\n  const carrierList = cachedCarriers.map(c => ({\n    id: c.carrier_dot || c._id || c.id,\n    name: c.carrier_name || c.legal_name || c.title || 'Unknown Carrier'\n  }));\n\n  // Send init data to HTML\n  sendToHtml(component, 'initOnboardingDashboard', {\n    recruiterId,\n    carriers: carrierList\n  });\n}\n\n// ============================================================================\n// HANDLER: Get Workflows\n// ============================================================================\n\nasync function handleGetWorkflows(data, component) {\n  const effectiveRecruiterId = data?.recruiterId || recruiterId;\n\n  if (!effectiveRecruiterId) {\n    sendToHtml(component, 'workflowList', { workflows: [] });\n    return;\n  }\n\n  try {\n    const result = await getActiveWorkflows({\n      recruiterId: effectiveRecruiterId,\n      includeCompleted: false\n    });\n\n    if (!result.success) {\n      sendToHtml(component, 'workflowList', { workflows: [] });\n      return;\n    }\n\n    // Transform workflows to the shape the HTML component expects\n    const workflows = (result.workflows || []).map(transformWorkflowForHtml);\n\n    sendToHtml(component, 'workflowList', { workflows });\n  } catch (error) {\n    console.error('handleGetWorkflows error:', error);\n    sendToHtml(component, 'workflowList', { workflows: [] });\n  }\n}\n\n/**\n * Transform a backend workflow record to the shape the HTML component expects.\n * The HTML renders: id, driverName, driverEmail, carrierId, carrierName,\n * status, documentsStatus, documentsProgress, backgroundStatus, drugTestStatus,\n * orientationStatus, createdDate, startDate, documents[], backgroundCheck, drugTest,\n * complianceIssues[]\n */\nfunction transformWorkflowForHtml(workflow) {\n  const wfId = workflow._id || workflow.id;\n\n  // Parse compliance issues\n  let complianceIssues = [];\n  if (Array.isArray(workflow.compliance_issues)) {\n    complianceIssues = workflow.compliance_issues;\n  } else if (typeof workflow.compliance_issues === 'string') {\n    try {\n      complianceIssues = JSON.parse(workflow.compliance_issues);\n    } catch (e) {\n      // Not parseable\n    }\n  }\n\n  // Build documents array from workflow data if available\n  const documents = (workflow.documents || []).map(doc => ({\n    id: doc._id || doc.id,\n    documentType: doc.document_type || doc.documentType,\n    displayName: doc.display_name || doc.displayName || doc.document_type || 'Document',\n    status: doc.status || 'requested',\n    rejectionReason: doc.rejection_reason || doc.rejectionReason || null\n  }));\n\n  // Build background check object\n  let backgroundCheck = null;\n  if (workflow.background_status && workflow.background_status !== 'not_started') {\n    backgroundCheck = {\n      provider: workflow.background_provider || workflow.metadata?.background_provider || null,\n      status: workflow.background_status,\n      orderedDate: workflow.background_ordered_date || null,\n      estimatedCompletion: workflow.background_estimated_completion || null,\n      completedDate: workflow.background_completed_date || null\n    };\n  }\n\n  // Build drug test object\n  let drugTest = null;\n  if (workflow.drug_test_status && workflow.drug_test_status !== 'not_started') {\n    drugTest = {\n      status: workflow.drug_test_status,\n      appointmentDate: workflow.drug_test_appointment_date || null,\n      completedDate: workflow.drug_test_completed_date || null,\n      collectionSite: workflow.drug_test_collection_site || null\n    };\n  }\n\n  // Count document progress\n  const totalDocs = documents.length;\n  const verifiedDocs = documents.filter(d => d.status === 'verified').length;\n  const documentsProgress = totalDocs > 0 ? `${verifiedDocs}/${totalDocs}` : '';\n\n  return {\n    id: wfId,\n    driverName: workflow.driverName || workflow.metadata?.driver_name || 'Unknown Driver',\n    driverEmail: workflow.driver_email || workflow.metadata?.driver_email || '',\n    carrierId: workflow.carrier_id,\n    carrierName: workflow.carrierName || workflow.metadata?.carrier_name || 'Unknown Carrier',\n    status: workflow.status,\n    documentsStatus: workflow.documents_status || 'pending',\n    documentsProgress,\n    backgroundStatus: workflow.background_status || 'not_started',\n    drugTestStatus: workflow.drug_test_status || 'not_started',\n    orientationStatus: workflow.orientation_status || 'not_started',\n    createdDate: workflow._createdDate || workflow.created_date,\n    startDate: workflow.start_date || null,\n    documents,\n    backgroundCheck,\n    drugTest,\n    complianceIssues\n  };\n}\n\n// ============================================================================\n// HANDLER: Get Document Details (for modal)\n// ============================================================================\n\nasync function handleGetDocumentDetails(data, component) {\n  const { workflowId, documentId } = data || {};\n\n  if (!workflowId || !documentId) {\n    sendToHtml(component, 'documentDetails', {\n      displayName: 'Unknown',\n      error: 'Missing workflowId or documentId'\n    });\n    return;\n  }\n\n  try {\n    // Get document status for the workflow\n    const docStatusResult = await getDocumentStatus(workflowId);\n    let docRecord = null;\n\n    if (docStatusResult.success && docStatusResult.documents) {\n      docRecord = docStatusResult.documents.find(\n        d => (d._id || d.id) === documentId\n      );\n    }\n\n    // Try to get OCR data\n    let ocrData = {};\n    try {\n      const ocrResult = await getDocumentOcrData(documentId);\n      if (ocrResult.success && ocrResult.ocrData) {\n        ocrData = ocrResult.ocrData;\n      }\n    } catch (ocrErr) {\n      // OCR data may not be available - that's OK\n    }\n\n    sendToHtml(component, 'documentDetails', {\n      displayName: docRecord?.display_name || docRecord?.document_type || 'Document',\n      fileUrl: docRecord?.file_url || docRecord?.upload_url || null,\n      fileName: docRecord?.file_name || docRecord?.original_filename || 'document.pdf',\n      submittedDate: docRecord?.submitted_date || docRecord?.uploaded_date || null,\n      ocrData\n    });\n  } catch (error) {\n    console.error('handleGetDocumentDetails error:', error);\n    sendToHtml(component, 'documentDetails', {\n      displayName: 'Error',\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Verify Document\n// ============================================================================\n\nasync function handleVerifyDocument(data, component) {\n  const { workflowId, documentId } = data || {};\n\n  if (!documentId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'verifyDocument',\n      success: false,\n      error: 'Document ID is required'\n    });\n    return;\n  }\n\n  try {\n    const verifierId = recruiterId || wixUsers?.currentUser?.id;\n    const result = await verifyDoc(documentId, verifierId, 'verified');\n\n    sendToHtml(component, 'actionResult', {\n      action: 'verifyDocument',\n      success: result.success,\n      workflowId,\n      documentId,\n      error: result.error\n    });\n  } catch (error) {\n    console.error('handleVerifyDocument error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'verifyDocument',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Reject Document\n// ============================================================================\n\nasync function handleRejectDocument(data, component) {\n  const { workflowId, documentId, rejectionReason } = data || {};\n\n  if (!documentId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'rejectDocument',\n      success: false,\n      error: 'Document ID is required'\n    });\n    return;\n  }\n\n  if (!rejectionReason) {\n    sendToHtml(component, 'actionResult', {\n      action: 'rejectDocument',\n      success: false,\n      error: 'Rejection reason is required'\n    });\n    return;\n  }\n\n  try {\n    const verifierId = recruiterId || wixUsers?.currentUser?.id;\n    const result = await verifyDoc(documentId, verifierId, 'rejected', rejectionReason);\n\n    sendToHtml(component, 'actionResult', {\n      action: 'rejectDocument',\n      success: result.success,\n      workflowId,\n      documentId,\n      error: result.error\n    });\n  } catch (error) {\n    console.error('handleRejectDocument error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'rejectDocument',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Send Reminder\n// ============================================================================\n\nasync function handleSendReminder(data, component) {\n  const { workflowId, methods, customMessage } = data || {};\n\n  if (!workflowId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'sendReminder',\n      success: false,\n      error: 'Workflow ID is required'\n    });\n    return;\n  }\n\n  try {\n    // Get pending/requested documents for this workflow\n    const docStatusResult = await getDocumentStatus(workflowId);\n\n    if (!docStatusResult.success) {\n      sendToHtml(component, 'actionResult', {\n        action: 'sendReminder',\n        success: false,\n        error: docStatusResult.error || 'Failed to get document status'\n      });\n      return;\n    }\n\n    // Find documents that need reminders (requested or rejected)\n    const pendingDocs = (docStatusResult.documents || []).filter(\n      d => d.status === 'requested' || d.status === 'rejected'\n    );\n\n    if (pendingDocs.length === 0) {\n      sendToHtml(component, 'actionResult', {\n        action: 'sendReminder',\n        success: true,\n        workflowId,\n        error: null\n      });\n      return;\n    }\n\n    // Send reminders for each pending document\n    let sentCount = 0;\n    let errors = [];\n\n    for (const doc of pendingDocs) {\n      try {\n        const docId = doc._id || doc.id;\n        const result = await sendDocumentReminder(docId);\n        if (result.success) {\n          sentCount++;\n        } else {\n          errors.push(result.error);\n        }\n      } catch (err) {\n        errors.push(err.message);\n      }\n    }\n\n    sendToHtml(component, 'actionResult', {\n      action: 'sendReminder',\n      success: sentCount > 0,\n      workflowId,\n      remindersSent: sentCount,\n      error: errors.length > 0 ? errors.join('; ') : null\n    });\n  } catch (error) {\n    console.error('handleSendReminder error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'sendReminder',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Cancel Workflow\n// ============================================================================\n\nasync function handleCancelWorkflow(data, component) {\n  const { workflowId } = data || {};\n\n  if (!workflowId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'cancelWorkflow',\n      success: false,\n      error: 'Workflow ID is required'\n    });\n    return;\n  }\n\n  try {\n    const result = await cancelWorkflow(workflowId, 'Cancelled by recruiter');\n\n    sendToHtml(component, 'actionResult', {\n      action: 'cancelWorkflow',\n      success: result.success,\n      workflowId,\n      error: result.error?.message || result.error\n    });\n  } catch (error) {\n    console.error('handleCancelWorkflow error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'cancelWorkflow',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Put On Hold\n// ============================================================================\n\nasync function handlePutOnHold(data, component) {\n  const { workflowId } = data || {};\n\n  if (!workflowId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'putOnHold',\n      success: false,\n      error: 'Workflow ID is required'\n    });\n    return;\n  }\n\n  try {\n    const result = await updateWorkflowStatus(workflowId, 'on_hold', {\n      note: 'Put on hold by recruiter'\n    });\n\n    sendToHtml(component, 'actionResult', {\n      action: 'putOnHold',\n      success: result.success,\n      workflowId,\n      error: result.error?.message || result.error\n    });\n  } catch (error) {\n    console.error('handlePutOnHold error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'putOnHold',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Resume Workflow\n// ============================================================================\n\nasync function handleResumeWorkflow(data, component) {\n  const { workflowId } = data || {};\n\n  if (!workflowId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'resumeWorkflow',\n      success: false,\n      error: 'Workflow ID is required'\n    });\n    return;\n  }\n\n  try {\n    // Resume to in_progress state\n    const result = await updateWorkflowStatus(workflowId, 'in_progress', {\n      note: 'Resumed by recruiter'\n    });\n\n    sendToHtml(component, 'actionResult', {\n      action: 'resumeWorkflow',\n      success: result.success,\n      workflowId,\n      error: result.error?.message || result.error\n    });\n  } catch (error) {\n    console.error('handleResumeWorkflow error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'resumeWorkflow',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Mark Started\n// ============================================================================\n\nasync function handleMarkStarted(data, component) {\n  const { workflowId } = data || {};\n\n  if (!workflowId) {\n    sendToHtml(component, 'actionResult', {\n      action: 'markStarted',\n      success: false,\n      error: 'Workflow ID is required'\n    });\n    return;\n  }\n\n  try {\n    const result = await updateWorkflowStatus(workflowId, 'in_progress', {\n      note: 'Started by recruiter',\n      startDate: new Date().toISOString()\n    });\n\n    sendToHtml(component, 'actionResult', {\n      action: 'markStarted',\n      success: result.success,\n      workflowId,\n      error: result.error?.message || result.error\n    });\n  } catch (error) {\n    console.error('handleMarkStarted error:', error);\n    sendToHtml(component, 'actionResult', {\n      action: 'markStarted',\n      success: false,\n      error: error.message\n    });\n  }\n}\n\n// ============================================================================\n// HANDLER: Navigate To\n// ============================================================================\n\nfunction handleNavigateTo(data) {\n  if (!data || !data.page) return;\n\n  console.log('Navigating to:', data.page);\n\n  const pageRoutes = {\n    'dashboard': '/recruiter-console',\n    'messaging': '/recruiter-console',\n    'new-onboarding': '/recruiter-console',\n    'pipeline': '/recruiter-console',\n    'settings': '/account/my-account',\n    'onboarding': '/recruiter-onboarding-dashboard'\n  };\n\n  const route = pageRoutes[data.page] || `/${data.page}`;\n  wixLocation.to(route);\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\RECRUITER_PREDICTIONS.g78id.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'wixUsers' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":23},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":69,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":69,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2159,2160],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * RECRUITER_PREDICTIONS Page Code\n * Handles PostMessage bridge for predictive hiring analytics\n */\n\nimport { generateHiringForecast, getHiringForecast, getTurnoverRiskAnalysis } from 'backend/recruiterAnalyticsService.jsw';\nimport wixUsers from 'wix-users';\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\nconst CONFIG = {\n  htmlComponentId: 'html1',\n  debugMessages: true\n};\n\n// ============================================================================\n// MESSAGE REGISTRY\n// ============================================================================\nconst MESSAGE_REGISTRY = {\n  inbound: [\n    'predictionsReady',\n    'getPredictionsData',\n    'generateForecast',\n    'getTurnoverRisk'\n  ],\n  outbound: [\n    'predictionsData',\n    'predictionsError',\n    'forecastResult',\n    'turnoverRiskData'\n  ]\n};\n\n// ============================================================================\n// GLOBAL STATE\n// ============================================================================\nlet carrierDot = null;\n\n// ============================================================================\n// PAGE INITIALIZATION\n// ============================================================================\n$w.onReady(async function () {\n  console.log('RECRUITER_PREDICTIONS page ready');\n\n  const htmlComponent = getHtmlComponent();\n  if (!htmlComponent) {\n    console.error('HTML component not found');\n    return;\n  }\n\n  htmlComponent.onMessage((event) => {\n    handleMessage(event.data);\n  });\n});\n\n// ============================================================================\n// HTML COMPONENT FINDER\n// ============================================================================\nfunction getHtmlComponent() {\n  const possibleIds = [CONFIG.htmlComponentId, 'html1', 'html2', 'html3', 'html4', 'html5', 'htmlEmbed1'];\n  for (const id of possibleIds) {\n    try {\n      const el = $w(`#${id}`);\n      if (el && typeof el.onMessage === 'function') {\n        CONFIG.htmlComponentId = id;\n        return el;\n      }\n    } catch (e) { }\n  }\n  return null;\n}\n\nfunction getComponent() {\n  return $w(`#${CONFIG.htmlComponentId}`);\n}\n\n// ============================================================================\n// MESSAGE HANDLER\n// ============================================================================\nasync function handleMessage(msg) {\n  if (!msg || !msg.type) return;\n\n  const action = msg.type;\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Received:', action, msg.data || '(no data)');\n  }\n\n  switch (action) {\n    case 'predictionsReady':\n      console.log('Predictions HTML ready');\n      if (carrierDot) {\n        sendToHtml('carrierContext', { carrierDot });\n      }\n      break;\n\n    case 'getPredictionsData':\n      await handleGetPredictionsData(msg.data);\n      break;\n\n    case 'generateForecast':\n      await handleGenerateForecast(msg.data);\n      break;\n\n    case 'getTurnoverRisk':\n      await handleGetTurnoverRisk(msg.data);\n      break;\n\n    default:\n      console.log('Unknown message type:', action);\n  }\n}\n\n// ============================================================================\n// HANDLERS\n// ============================================================================\nasync function handleGetPredictionsData(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('predictionsError', { error: 'No carrier context' });\n      return;\n    }\n\n    carrierDot = dot;\n\n    // Fetch forecast and turnover risk in parallel\n    const [forecastResult, riskResult] = await Promise.all([\n      getHiringForecast(dot),\n      getTurnoverRiskAnalysis(dot)\n    ]);\n\n    sendToHtml('predictionsData', {\n      success: true,\n      forecast: forecastResult.success ? forecastResult.forecast : null,\n      turnoverRisk: riskResult.success ? riskResult.analysis : null\n    });\n\n  } catch (error) {\n    console.error('Error fetching predictions data:', error);\n    sendToHtml('predictionsError', { error: error.message });\n  }\n}\n\nasync function handleGenerateForecast(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('forecastResult', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    carrierDot = dot;\n\n    const monthsAhead = data?.monthsAhead || 6;\n    const result = await generateHiringForecast(dot, monthsAhead);\n    sendToHtml('forecastResult', result);\n\n  } catch (error) {\n    console.error('Error generating forecast:', error);\n    sendToHtml('forecastResult', { success: false, error: error.message });\n  }\n}\n\nasync function handleGetTurnoverRisk(data) {\n  try {\n    const dot = data?.carrierDot || carrierDot;\n    if (!dot) {\n      sendToHtml('turnoverRiskData', { success: false, error: 'No carrier context' });\n      return;\n    }\n\n    const result = await getTurnoverRiskAnalysis(dot);\n    sendToHtml('turnoverRiskData', result);\n\n  } catch (error) {\n    console.error('Error fetching turnover risk:', error);\n    sendToHtml('turnoverRiskData', { success: false, error: error.message });\n  }\n}\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\nfunction sendToHtml(type, data) {\n  if (CONFIG.debugMessages) {\n    console.log('?? [Velo] Sending:', type, data ? Object.keys(data) : '(no data)');\n  }\n\n  try {\n    const component = getComponent();\n    if (component && typeof component.postMessage === 'function') {\n      component.postMessage({ type, data, timestamp: Date.now() });\n    }\n  } catch (error) {\n    console.error('Error sending to HTML:', error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Rapid Response - Job Description.av1bx.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":608,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":608,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[17739,17740],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":639,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":639,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[18736,18737],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":660,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":660,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[19412,19413],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Rapid Response - Job Description Page\r\n * Urgent/time-sensitive job opportunities with fast apply flow\r\n *\r\n * Focus: Countdown timers, urgency messaging, quick apply for logged-in users\r\n *\r\n * Element IDs:\r\n * - #urgencyBanner - Top banner with urgency messaging\r\n * - #countdownTimer - Countdown to application deadline\r\n * - #jobDetailsSection - Main job details container\r\n * - #quickApplyBtn - One-click apply button for members\r\n * - #similarJobsRepeater - Related urgent opportunities\r\n * - #rapidResponseHtml - HTML component with urgency countdown\r\n *\r\n * @see docs/PAGE_DATA_IMPLEMENTATION_GUIDE.md\r\n */\r\n\r\nimport wixWindow from 'wix-window';\r\nimport wixLocation from 'wix-location';\r\nimport wixUsers from 'wix-users';\r\nimport { getPremiumOpportunities, getTopJobOpportunities } from 'backend/publicStatsService';\r\nimport { getDriverJobById } from 'backend/contentService';\r\nimport { getCarrierByDOT } from 'backend/recruiter_service';\r\nimport { getOrCreateDriverProfile, logCarrierInterest } from 'backend/driverProfiles';\r\n\r\n// Page state\r\nlet currentJob = null;\r\nlet countdownInterval = null;\r\n\r\n$w.onReady(async function () {\r\n  console.log('Rapid Response Job Page initialized');\r\n\r\n  // Get job ID from URL parameters\r\n  const jobId = wixLocation.query.id || wixLocation.query.jobId;\r\n\r\n  await Promise.all([\r\n    loadUrgencyBanner(),\r\n    loadJobDetails(jobId),\r\n    loadUrgentJobs(),\r\n    loadQuickApplyCta()\r\n  ]);\r\n\r\n  // Start countdown timer\r\n  initCountdownTimer();\r\n});\r\n\r\n// ============================================================================\r\n// URGENCY BANNER\r\n// ============================================================================\r\n\r\n/**\r\n * Load and display urgency banner with slots remaining\r\n * Element: #urgencyBanner\r\n */\r\nasync function loadUrgencyBanner() {\r\n  try {\r\n    const banner = $w('#urgencyBanner');\r\n    if (!banner.rendered) return;\r\n\r\n    // Get current urgent opportunities count\r\n    const urgentJobs = await getPremiumOpportunities(10);\r\n    const slotsRemaining = urgentJobs.length > 0 ? Math.min(urgentJobs.length, 5) : 3;\r\n\r\n    // Update banner elements\r\n    const bannerElements = {\r\n      '#slotsRemainingText': `Only ${slotsRemaining} positions remaining!`,\r\n      '#urgencyMessage': 'These positions fill quickly - Apply now before they are gone!'\r\n    };\r\n\r\n    Object.entries(bannerElements).forEach(([selector, value]) => {\r\n      try {\r\n        const element = $w(selector);\r\n        if (element && element.text !== undefined) {\r\n          element.text = value;\r\n        }\r\n      } catch (e) {\r\n        // Element may not exist\r\n      }\r\n    });\r\n\r\n    banner.show();\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load urgency banner:', err);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// COUNTDOWN TIMER\r\n// ============================================================================\r\n\r\n/**\r\n * Initialize countdown timer for application deadline\r\n * Element: #countdownTimer, #rapidResponseHtml\r\n */\r\nfunction initCountdownTimer() {\r\n  try {\r\n    // Set deadline to end of day (or configurable deadline)\r\n    const now = new Date();\r\n    const deadline = new Date(now);\r\n    deadline.setHours(23, 59, 59, 999);\r\n\r\n    // If current job has a validThrough date, use that instead\r\n    if (currentJob && currentJob.validThrough) {\r\n      try {\r\n        const jobDeadline = new Date(currentJob.validThrough);\r\n        if (!isNaN(jobDeadline.getTime()) && jobDeadline > now) {\r\n          deadline.setTime(jobDeadline.getTime());\r\n        }\r\n      } catch (e) {\r\n        // Use default deadline\r\n      }\r\n    }\r\n\r\n    // Update timer immediately\r\n    updateCountdown(deadline);\r\n\r\n    // Update every second\r\n    countdownInterval = setInterval(() => {\r\n      updateCountdown(deadline);\r\n    }, 1000);\r\n\r\n    // Send countdown data to HTML component\r\n    sendCountdownToHtml(deadline);\r\n\r\n  } catch (err) {\r\n    console.error('Failed to initialize countdown timer:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Update countdown display\r\n */\r\nfunction updateCountdown(deadline) {\r\n  const now = new Date();\r\n  const diff = deadline - now;\r\n\r\n  if (diff <= 0) {\r\n    // Deadline passed\r\n    clearInterval(countdownInterval);\r\n    try {\r\n      const timerElement = $w('#countdownTimer');\r\n      if (timerElement.rendered && timerElement.text !== undefined) {\r\n        timerElement.text = 'Application deadline passed';\r\n      }\r\n    } catch (e) {\r\n      // Element may not exist\r\n    }\r\n    return;\r\n  }\r\n\r\n  const hours = Math.floor(diff / (1000 * 60 * 60));\r\n  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\r\n  const seconds = Math.floor((diff % (1000 * 60)) / 1000);\r\n\r\n  const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\r\n\r\n  try {\r\n    const timerElement = $w('#countdownTimer');\r\n    if (timerElement.rendered && timerElement.text !== undefined) {\r\n      timerElement.text = timeString;\r\n    }\r\n  } catch (e) {\r\n    // Element may not exist\r\n  }\r\n\r\n  // Update individual time elements if they exist\r\n  const timeElements = {\r\n    '#countdownHours': hours.toString().padStart(2, '0'),\r\n    '#countdownMinutes': minutes.toString().padStart(2, '0'),\r\n    '#countdownSeconds': seconds.toString().padStart(2, '0')\r\n  };\r\n\r\n  Object.entries(timeElements).forEach(([selector, value]) => {\r\n    try {\r\n      const element = $w(selector);\r\n      if (element && element.text !== undefined) {\r\n        element.text = value;\r\n      }\r\n    } catch (e) {\r\n      // Element may not exist\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Send countdown data to HTML component\r\n */\r\nfunction sendCountdownToHtml(deadline) {\r\n  try {\r\n    const htmlComponent = $w('#rapidResponseHtml');\r\n    if (htmlComponent.rendered && typeof htmlComponent.postMessage === 'function') {\r\n      htmlComponent.postMessage({\r\n        type: 'countdown',\r\n        deadline: deadline.toISOString(),\r\n        job: currentJob\r\n      });\r\n    }\r\n  } catch (e) {\r\n    // HTML component may not exist\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// JOB DETAILS\r\n// ============================================================================\r\n\r\n/**\r\n * Load job details from URL parameter\r\n * Element: #jobDetailsSection\r\n * @param {string} jobId - Job ID from URL\r\n */\r\nasync function loadJobDetails(jobId) {\r\n  try {\r\n    if (!jobId) {\r\n      // No job ID - show featured urgent job\r\n      const urgentJobs = await getPremiumOpportunities(1);\r\n      if (urgentJobs.length > 0) {\r\n        currentJob = urgentJobs[0];\r\n        displayJobDetails(currentJob);\r\n      } else {\r\n        showNoJobMessage();\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Try Carrier lookup first (if it's a DOT number or carrier record ID)\r\n    let carrier = null;\r\n    // Simple heuristic: if it looks like a DOT, try getCarrierByDOT\r\n    if (!isNaN(jobId) && jobId.length >= 4) {\r\n        carrier = await getCarrierByDOT(jobId);\r\n    }\r\n    \r\n    if (carrier) {\r\n        currentJob = formatCarrierJob(carrier);\r\n        displayJobDetails(currentJob);\r\n        return;\r\n    }\r\n\r\n    // Try DriverJob lookup\r\n    const jobRes = await getDriverJobById(jobId);\r\n    if (jobRes.success && jobRes.job) {\r\n        currentJob = formatDriverJob(jobRes.job);\r\n        displayJobDetails(currentJob);\r\n    } else {\r\n        showNoJobMessage();\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load job details:', err);\r\n    showNoJobMessage();\r\n  }\r\n}\r\n\r\n/**\r\n * Format carrier data for display\r\n */\r\nfunction formatCarrierJob(carrier) {\r\n  return {\r\n    _id: carrier._id,\r\n    carrierName: carrier.legal_name || 'LMDR Partner Carrier',\r\n    payRange: formatPayRange(carrier.pay_per_mile_min, carrier.pay_per_mile_max),\r\n    signOnBonus: carrier.sign_on_bonus || null,\r\n    location: `${carrier.city || ''}, ${carrier.state || ''}`.replace(/^, |, $/g, '') || 'Multiple Locations',\r\n    operationType: carrier.operation_type || 'OTR',\r\n    homeTime: carrier.home_time || 'Varies',\r\n    benefits: carrier.benefits_summary || 'Full benefits package',\r\n    fleetSize: carrier.fleet_size,\r\n    urgencyLevel: carrier.urgency_level || 'high',\r\n    openPositions: carrier.open_positions || 1,\r\n    dotNumber: carrier.DOT_NUMBER,\r\n    description: carrier.company_description || '',\r\n    validThrough: carrier.valid_through || null,\r\n    logoUrl: carrier.logo_url || ''\r\n  };\r\n}\r\n\r\n/**\r\n * Format driver job data for display\r\n */\r\nfunction formatDriverJob(job) {\r\n  return {\r\n    _id: job._id,\r\n    carrierName: job.hiring_location || job.company_base || 'LMDR Partner',\r\n    payRange: job.pay_rate || 'Competitive',\r\n    signOnBonus: null,\r\n    location: `${job.city || ''}, ${job.state || ''}`.replace(/^, |, $/g, '') || 'Multiple Locations',\r\n    operationType: job.route_type || 'OTR',\r\n    homeTime: job.home_time || 'Varies',\r\n    benefits: job.benefits || 'Full benefits package',\r\n    fleetSize: null,\r\n    urgencyLevel: 'high',\r\n    openPositions: 1,\r\n    description: job.description || '',\r\n    validThrough: job.valid_through || null,\r\n    logoUrl: job.company_logo || ''\r\n  };\r\n}\r\n\r\n/**\r\n * Display job details in the UI\r\n */\r\nfunction displayJobDetails(job) {\r\n  if (!job) return;\r\n\r\n  const jobElements = {\r\n    '#jobTitle': `Urgent: ${job.operationType} Driver - ${job.carrierName}`,\r\n    '#carrierName': job.carrierName,\r\n    '#payRange': job.payRange,\r\n    '#jobLocation': job.location,\r\n    '#operationType': job.operationType,\r\n    '#homeTime': job.homeTime,\r\n    '#benefitsSummary': job.benefits,\r\n    '#openPositions': `${job.openPositions} position${job.openPositions > 1 ? 's' : ''} available`,\r\n    '#jobDescription': job.description\r\n  };\r\n\r\n  Object.entries(jobElements).forEach(([selector, value]) => {\r\n    try {\r\n      const element = $w(selector);\r\n      if (element) {\r\n        if (element.text !== undefined) {\r\n          element.text = value || '';\r\n        } else if (element.html !== undefined) {\r\n          element.html = value || '';\r\n        }\r\n      }\r\n    } catch (e) {\r\n      // Element may not exist\r\n    }\r\n  });\r\n\r\n  // Show sign-on bonus if available\r\n  if (job.signOnBonus) {\r\n    try {\r\n      const bonusBadge = $w('#signOnBonusBadge');\r\n      if (bonusBadge.rendered) {\r\n        bonusBadge.text = `$${job.signOnBonus.toLocaleString()} Sign-On Bonus!`;\r\n        bonusBadge.show();\r\n      }\r\n    } catch (e) {\r\n      // Element may not exist\r\n    }\r\n  }\r\n\r\n  // Show company logo\r\n  if (job.logoUrl) {\r\n    try {\r\n      const logo = $w('#companyLogo');\r\n      if (logo.rendered && logo.src !== undefined) {\r\n        logo.src = job.logoUrl;\r\n        logo.show();\r\n      }\r\n    } catch (e) {\r\n      // Element may not exist\r\n    }\r\n  }\r\n\r\n  // Show job details section\r\n  try {\r\n    const section = $w('#jobDetailsSection');\r\n    if (section.rendered && section.show) section.show();\r\n  } catch (e) {\r\n    // Section may not exist\r\n  }\r\n\r\n  // Send job data to HTML component\r\n  sendJobToHtml(job);\r\n}\r\n\r\n/**\r\n * Send job data to HTML component\r\n */\r\nfunction sendJobToHtml(job) {\r\n  try {\r\n    const htmlComponent = $w('#rapidResponseHtml');\r\n    if (htmlComponent.rendered && typeof htmlComponent.postMessage === 'function') {\r\n      htmlComponent.postMessage({\r\n        type: 'jobDetails',\r\n        job: job\r\n      });\r\n    }\r\n  } catch (e) {\r\n    // HTML component may not exist\r\n  }\r\n}\r\n\r\n/**\r\n * Show message when no job is found\r\n */\r\nfunction showNoJobMessage() {\r\n  try {\r\n    const section = $w('#jobDetailsSection');\r\n    if (section.rendered && section.collapse) section.collapse();\r\n\r\n    const noJobMessage = $w('#noJobMessage');\r\n    if (noJobMessage.rendered && noJobMessage.show) noJobMessage.show();\r\n  } catch (e) {\r\n    // Elements may not exist\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// URGENT JOBS (Premium Opportunities)\r\n// ============================================================================\r\n\r\n/**\r\n * Load urgent job opportunities\r\n * Element: #similarJobsRepeater\r\n */\r\nasync function loadUrgentJobs() {\r\n  try {\r\n    const urgentJobs = await getPremiumOpportunities(5);\r\n\r\n    if (urgentJobs.length === 0) {\r\n      // Fallback to top job opportunities\r\n      const topJobs = await getTopJobOpportunities(5);\r\n      if (topJobs.length > 0) {\r\n        displaySimilarJobs(topJobs);\r\n      } else {\r\n        hideSimilarJobsSection();\r\n      }\r\n      return;\r\n    }\r\n\r\n    displaySimilarJobs(urgentJobs);\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load urgent jobs:', err);\r\n    hideSimilarJobsSection();\r\n  }\r\n}\r\n\r\n/**\r\n * Display similar/urgent jobs in repeater\r\n */\r\nfunction displaySimilarJobs(jobs) {\r\n  try {\r\n    const repeater = $w('#similarJobsRepeater');\r\n    if (!repeater || repeater.data === undefined) {\r\n      return;\r\n    }\r\n\r\n    // Filter out current job if present\r\n    const filteredJobs = jobs.filter(job =>\r\n      !currentJob || job._id !== currentJob._id\r\n    ).slice(0, 4);\r\n\r\n    if (filteredJobs.length === 0) {\r\n      hideSimilarJobsSection();\r\n      return;\r\n    }\r\n\r\n    repeater.data = filteredJobs.map(job => ({\r\n      _id: job._id,\r\n      carrierName: job.carrierName,\r\n      payRange: job.payRange,\r\n      location: job.location,\r\n      operationType: job.operationType,\r\n      signOnBonus: job.signOnBonus,\r\n      urgencyLevel: job.urgencyLevel || 'normal'\r\n    }));\r\n\r\n    repeater.onItemReady(($item, itemData) => {\r\n      try {\r\n        if ($item('#similarJobCarrier').rendered) $item('#similarJobCarrier').text = itemData.carrierName;\r\n        if ($item('#similarJobPay').rendered) $item('#similarJobPay').text = itemData.payRange;\r\n        if ($item('#similarJobLocation').rendered) $item('#similarJobLocation').text = itemData.location;\r\n        if ($item('#similarJobType').rendered) $item('#similarJobType').text = itemData.operationType;\r\n\r\n        // Urgency badge\r\n        if (itemData.urgencyLevel === 'high' || itemData.signOnBonus) {\r\n          try {\r\n            const urgencyBadge = $item('#urgencyBadge');\r\n            if (urgencyBadge.rendered) {\r\n              urgencyBadge.text = itemData.signOnBonus ? 'Bonus!' : 'Urgent';\r\n              urgencyBadge.show();\r\n            }\r\n          } catch (e) {\r\n            // Element may not exist\r\n          }\r\n        }\r\n\r\n        // View job button\r\n        try {\r\n          const viewBtn = $item('#viewJobBtn');\r\n          if (viewBtn.rendered) {\r\n            viewBtn.onClick(() => {\r\n              wixLocation.to(`/rapid-response-job-description?id=${itemData._id}`);\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // Element may not exist\r\n        }\r\n\r\n        // Quick apply button for similar jobs\r\n        try {\r\n          const quickApplyBtn = $item('#similarQuickApplyBtn');\r\n          if (quickApplyBtn.rendered) {\r\n            quickApplyBtn.onClick(() => {\r\n              handleQuickApply(itemData._id);\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // Element may not exist\r\n        }\r\n      } catch (e) {\r\n        // Element may not exist\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error('Failed to display similar jobs:', err);\r\n    hideSimilarJobsSection();\r\n  }\r\n}\r\n\r\n/**\r\n * Hide similar jobs section\r\n */\r\nfunction hideSimilarJobsSection() {\r\n  try {\r\n    const section = $w('#similarJobsSection');\r\n    if (section.rendered && section.collapse) section.collapse();\r\n  } catch (e) {\r\n    // Section may not exist\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// QUICK APPLY CTA\r\n// ============================================================================\r\n\r\n/**\r\n * Load and configure quick apply button\r\n * Element: #quickApplyBtn\r\n */\r\nasync function loadQuickApplyCta() {\r\n  try {\r\n    const quickApplyBtn = $w('#quickApplyBtn');\r\n    if (!quickApplyBtn.rendered) return;\r\n\r\n    const user = wixUsers.currentUser;\r\n    const isLoggedIn = user.loggedIn;\r\n\r\n    if (isLoggedIn) {\r\n      // Show one-click apply for logged-in users\r\n      quickApplyBtn.label = 'Quick Apply Now';\r\n      quickApplyBtn.onClick(async () => {\r\n        await handleQuickApply(currentJob?._id);\r\n      });\r\n    } else {\r\n      // Show login/signup prompt for guests\r\n      quickApplyBtn.label = 'Sign In to Quick Apply';\r\n      quickApplyBtn.onClick(() => {\r\n        // Store job ID for redirect after login\r\n        if (currentJob?._id) {\r\n          wixWindow.openLightbox('LoginSignup', {\r\n            redirectUrl: `/rapid-response-job-description?id=${currentJob._id}`,\r\n            action: 'apply'\r\n          });\r\n        } else {\r\n          wixLocation.to('/apply-for-cdl-driving-jobs');\r\n        }\r\n      });\r\n    }\r\n\r\n    // Secondary apply button (full application)\r\n    try {\r\n      const fullApplyBtn = $w('#fullApplyBtn');\r\n      if (fullApplyBtn.rendered) {\r\n        fullApplyBtn.onClick(() => {\r\n          wixLocation.to('/apply-for-cdl-driving-jobs');\r\n        });\r\n      }\r\n    } catch (e) {\r\n      // Element may not exist\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load quick apply CTA:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Handle quick apply action\r\n */\r\nasync function handleQuickApply(jobId) {\r\n  try {\r\n    const user = wixUsers.currentUser;\r\n\r\n    if (!user.loggedIn) {\r\n      // Redirect to login\r\n      wixWindow.openLightbox('LoginSignup', {\r\n        redirectUrl: `/rapid-response-job-description?id=${jobId}`,\r\n        action: 'apply'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Show loading state\r\n    try {\r\n      const quickApplyBtn = $w('#quickApplyBtn');\r\n      if (quickApplyBtn.rendered) {\r\n        quickApplyBtn.label = 'Applying...';\r\n        quickApplyBtn.disable();\r\n      }\r\n    } catch (e) { }\r\n\r\n    // Get or create driver profile\r\n    const profileRes = await getOrCreateDriverProfile();\r\n\r\n    if (!profileRes.success || !profileRes.profile) {\r\n      // No profile - redirect to profile creation\r\n      wixLocation.to('/quick-apply-upload-your-cdl-resume');\r\n      return;\r\n    }\r\n\r\n    // Create application/interest record using backend service\r\n    const interestResult = await logCarrierInterest({\r\n      carrierDOT: currentJob?.dotNumber || jobId,\r\n      carrierName: currentJob?.carrierName || '',\r\n      matchScore: 85, // Default for quick apply\r\n      action: 'applied'\r\n    });\r\n\r\n    if (interestResult.success) {\r\n      // Show success message\r\n      try {\r\n        const quickApplyBtn = $w('#quickApplyBtn');\r\n        if (quickApplyBtn.rendered) {\r\n          quickApplyBtn.label = 'Applied!';\r\n        }\r\n\r\n        const successMessage = $w('#applySuccessMessage');\r\n        if (successMessage.rendered) {\r\n          successMessage.show();\r\n        }\r\n      } catch (e) { }\r\n\r\n      // Show success lightbox or notification\r\n      wixWindow.openLightbox('ApplicationSuccess', {\r\n        jobTitle: currentJob?.carrierName || 'CDL Position',\r\n        message: 'Your application has been submitted! The carrier will contact you soon.'\r\n      }).catch(() => {\r\n        // Lightbox may not exist - show inline success\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Quick apply failed:', err);\r\n\r\n    // Reset button and show error\r\n    try {\r\n      const quickApplyBtn = $w('#quickApplyBtn');\r\n      if (quickApplyBtn.rendered) {\r\n        quickApplyBtn.label = 'Quick Apply Now';\r\n        quickApplyBtn.enable();\r\n      }\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HELPER FUNCTIONS\r\n// ============================================================================\r\n\r\n/**\r\n * Format pay range for display\r\n */\r\nfunction formatPayRange(min, max) {\r\n  if (max && min) {\r\n    return `$${min.toFixed(2)}-${max.toFixed(2)}/mi`;\r\n  } else if (max) {\r\n    return `Up to $${max.toFixed(2)}/mi`;\r\n  } else if (min) {\r\n    return `From $${min.toFixed(2)}/mi`;\r\n  }\r\n  return 'Competitive pay';\r\n}\r\n\r\n// ============================================================================\r\n// CLEANUP\r\n// ============================================================================\r\n\r\n// Clean up interval when navigating away\r\nwixLocation.onChange(() => {\r\n  if (countdownInterval) {\r\n    clearInterval(countdownInterval);\r\n  }\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Recruiter Console.zriuj.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getInterviewState' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'getBottleneckAnalysis' is defined but never used.","line":86,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'getPayBenchmarks' is defined but never used.","line":91,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'getInterventionSuggestions' is defined but never used.","line":103,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'getLeaderboardSummary' is defined but never used.","line":109,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// RECRUITER CONSOLE - Page Code\r\n// Supports Agency Model: Recruiters can manage multiple carriers\r\n// ============================================================================\r\n\r\nimport {\r\n  getOrCreateRecruiterProfile,\r\n  addCarrier,\r\n  removeCarrier,\r\n  getRecruiterCarriers,\r\n  validateCarrierDOT,\r\n  getPipelineCandidates,\r\n  updateCandidateStatus,\r\n  getPipelineStats,\r\n  getCandidateDetails,\r\n  addRecruiterNotes,\r\n  updateRecruiterProfile\r\n} from 'backend/recruiter_service';\r\n\r\nimport {\r\n  requestAvailability,\r\n  confirmTimeSlot as confirmInterviewSlot,\r\n  getInterviewState\r\n} from 'backend/interviewScheduler.jsw';\r\n\r\nimport { sendMessage, getConversation, markAsRead } from 'backend/messaging.jsw';\r\nimport { logFeatureInteraction } from 'backend/featureAdoptionService';\r\nimport { setupRecruiterGamification } from 'public/js/gamificationPageHandlers';\r\n\r\n// Driver Search imports\r\nimport { findMatchingDrivers, getDriverProfile } from 'backend/driverMatching.jsw';\r\nimport {\r\n  saveToRecruiterPipeline,\r\n  sendMessageToDriver,\r\n  getQuotaStatus\r\n} from 'backend/driverOutreach.jsw';\r\n\r\n// Saved Search imports\r\nimport {\r\n  createSavedSearch,\r\n  updateSavedSearch,\r\n  deleteSavedSearch,\r\n  getSavedSearches,\r\n  executeSavedSearch\r\n} from 'backend/savedSearchService';\r\n\r\n// Call Outcome imports\r\nimport {\r\n  logCallOutcome,\r\n  getCarrierOutcomes,\r\n  getOutcomeAnalytics,\r\n  getDriverOutcomes\r\n} from 'backend/callOutcomeService';\r\n\r\n// Intervention imports\r\nimport {\r\n  getTemplates as getInterventionTemplates,\r\n  getAllTemplates,\r\n  createTemplate,\r\n  updateTemplate as updateInterventionTemplate,\r\n  deleteTemplate,\r\n  sendIntervention,\r\n  logInterventionOutcome,\r\n  getDriverInterventions\r\n} from 'backend/interventionService';\r\n\r\n// Pipeline Automation imports\r\nimport {\r\n  getAutomationRules,\r\n  createAutomationRule,\r\n  updateAutomationRule,\r\n  deleteAutomationRule,\r\n  toggleRuleStatus,\r\n  getAutomationLog\r\n} from 'backend/pipelineAutomationService';\r\n\r\nimport { getRecruiterHealthStatus } from 'backend/recruiterHealthService.jsw';\r\nimport { routeAIRequest } from 'backend/aiRouterService';\r\nimport { handleAgentTurn, resumeAfterApproval, executeTool } from 'backend/agentService';\nimport { getVoiceConfig } from 'backend/voiceService';\r\nimport { getCampaigns, createCampaign, startCampaign, getCampaignStatus } from 'backend/voiceCampaignService';\r\n\r\n// Recruiter OS  Analytics imports\r\nimport {\r\n  getFunnelMetrics,\r\n  getBottleneckAnalysis,\r\n  calculateCostPerHire,\r\n  getCompetitorComparison,\r\n  generateHiringForecast,\r\n  getTurnoverRiskAnalysis,\r\n  getPayBenchmarks\r\n} from 'backend/recruiterAnalyticsService.jsw';\r\n\r\n// Recruiter OS  Onboarding imports\r\nimport {\r\n  getActiveWorkflows,\r\n  updateWorkflowStatus\r\n} from 'backend/onboardingWorkflowService.jsw';\r\n\r\n// Recruiter OS  Retention imports\r\nimport {\r\n  getCarrierRetentionDashboard,\r\n  getInterventionSuggestions\r\n} from 'backend/retentionService.jsw';\r\n\r\n// Recruiter OS  Leaderboard imports\r\nimport {\r\n  getLeaderboard,\r\n  getLeaderboardSummary,\r\n  getUserLeaderboardPosition\r\n} from 'backend/leaderboardService.jsw';\r\n\r\nimport wixLocation from 'wix-location';\r\n\r\nlet wixUsers;\r\ntry {\r\n  wixUsers = require('wix-users');\r\n} catch (e) {\r\n  console.log('wix-users not available');\r\n}\r\n\r\n// ============================================================================\r\n// STATE\r\n// ============================================================================\r\n\r\nlet cachedRecruiterProfile = null;\r\nlet cachedCarriers = [];\r\nlet currentCarrierDOT = null;\r\n\r\n// ============================================================================\r\n// MESSAGE VALIDATION SYSTEM\r\n// ============================================================================\r\nconst DEBUG_MESSAGES = true; // Set to false in production\r\n\r\n// Registry of all valid messages - single source of truth\r\nconst MESSAGE_REGISTRY = {\r\n  // Messages FROM HTML that page code handles\r\n  inbound: [\r\n    'recruiterDashboardReady',\r\n    'validateCarrier',\r\n    'addCarrier',\r\n    'removeCarrier',\r\n    'switchCarrier',\r\n    'getCarriers',\r\n    'getPipeline',\r\n    'updateCandidateStatus',\r\n    'getStats',\r\n    'getCandidateDetails',\r\n    'addNotes',\r\n    'sendMessage',\r\n    'getConversation',\r\n    'getNewMessages',    // Smart polling request\r\n    'getUnreadCount',    // Unread badge request\r\n    'markAsRead',\r\n    'requestAvailability',\r\n    'confirmTimeSlot',\r\n    'ping', // Health check\r\n    // Driver Search messages\r\n    'driverSearchReady',\r\n    'searchDrivers',\r\n    'viewDriverProfile',\r\n    'saveDriver',\r\n    'contactDriver',\r\n    'getQuotaStatus',\r\n    'getWeightPreferences',\r\n    'saveWeightPreferences',\r\n    'generateAIDraft',\r\n    'navigateTo',\r\n    'logFeatureInteraction', // Feature adoption tracking\r\n    // Saved Search messages\r\n    'saveSearch',\r\n    'loadSavedSearches',\r\n    'runSavedSearch',\r\n    'deleteSavedSearch',\r\n    'updateSavedSearch',\r\n    // Call Outcome messages\r\n    'logCallOutcome',\r\n    'getCallAnalytics',\r\n    'getRecentCalls',\r\n    'getDriverCallHistory',\r\n    // Intervention messages\r\n    'getInterventionTemplates',\r\n    'sendIntervention',\r\n    'saveTemplate',\r\n    'deleteTemplate',\r\n    'logInterventionOutcome',\r\n    'getDriverInterventions',\r\n    // Pipeline Automation messages\r\n    'getAutomationRules',\r\n    'createAutomationRule',\r\n    'updateAutomationRule',\r\n    'deleteAutomationRule',\r\n    'toggleRuleStatus',\r\n    'getAutomationLog',\r\n    'getSystemHealth', // New System Health Check\r\n    // -- Recruiter OS Messages --\r\n    'recruiterOSReady',\r\n    'getFunnelData',\r\n    'getCostData',\r\n    'getCompetitorData',\r\n    'getPredictionsData',\r\n    'getWorkflows',\r\n    'updateWorkflowStep',\r\n    'getRetentionData',\r\n    'getAtRiskDrivers',\r\n    'getLeaderboard',\r\n    'getBadges',\r\n    'getSettingsData',\r\n    // -- Agent & Voice Messages --\r\n    'agentMessage',\r\n    'resolveApprovalGate',\r\n    'getVoiceConfig',\r\n    'getCampaigns',\n    'createCampaign',\n    'startCampaign',\n    'getCampaignStatus',\n    'getPaidMediaState',\n    'createPaidMediaDraft',\n    'updatePaidMediaAdSet',\n    'createPaidMediaCreative',\n    'launchPaidMediaCampaign',\n    'getPaidMediaInsights',\n    'createPaidMediaReportJob',\n    'getPaidMediaReportStatus',\n    'downloadPaidMediaReport',\n    'getPaidMediaOptimizationSuggestions'\n  ],\r\n  // Messages TO HTML that page code sends\r\n  outbound: [\r\n    'recruiterReady',\r\n    'carrierValidated',\r\n    'carrierAdded',\r\n    'carrierRemoved',\r\n    'carrierSwitched',\r\n    'carriersLoaded',\r\n    'pipelineLoaded',\r\n    'statusUpdated',\r\n    'statsLoaded',\r\n    'candidateDetails',\r\n    'notesAdded',\r\n    'conversationData',\r\n    'messageSent',\r\n    'newMessagesData',   // Smart polling response\r\n    'unreadCountData',   // Unread badge data\r\n    'error',\r\n    'pong', // Health check response\r\n    // Driver Search responses\r\n    'driverSearchInit',\r\n    'searchDriversResult',\r\n    'viewDriverProfileResult',\r\n    'saveDriverResult',\r\n    'contactDriverResult',\r\n    'getQuotaStatusResult',\r\n    'getWeightPreferencesResult',\r\n    'saveWeightPreferencesResult',\r\n    'generateAIDraftResult',\r\n    'recruiterProfile',\r\n    // Saved Search responses\r\n    'saveSearchResult',\r\n    'savedSearchesLoaded',\r\n    'savedSearchExecuted',\r\n    'savedSearchDeleted',\r\n    'savedSearchUpdated',\r\n    // Call Outcome responses\r\n    'callOutcomeLogged',\r\n    'callAnalyticsLoaded',\r\n    'recentCallsLoaded',\r\n    'driverCallHistoryLoaded',\r\n    // Intervention responses\r\n    'interventionTemplatesLoaded',\r\n    'interventionSent',\r\n    'templateSaved',\r\n    'templateDeleted',\r\n    'interventionOutcomeLogged',\r\n    'driverInterventionsLoaded',\r\n    // Pipeline Automation responses\r\n    'automationRulesLoaded',\r\n    'automationRuleCreated',\r\n    'automationRuleUpdated',\r\n    'automationRuleDeleted',\r\n    'automationRuleToggled',\r\n    'automationLogLoaded',\r\n    'systemHealthUpdate', // New System Health Response\r\n    // -- Recruiter OS Responses --\r\n    'recruiterOSInit',\r\n    'funnelDataLoaded',\r\n    'costDataLoaded',\r\n    'competitorDataLoaded',\r\n    'predictionsLoaded',\r\n    'workflowsLoaded',\r\n    'workflowUpdated',\r\n    'retentionDataLoaded',\r\n    'atRiskDriversLoaded',\r\n    'leaderboardLoaded',\r\n    'badgesLoaded',\r\n    'settingsDataLoaded',\r\n    // -- Agent & Voice Responses --\r\n    'agentResponse',\r\n    'agentTyping',\r\n    'agentApprovalRequired',\r\n    'voiceReady',\r\n    'campaignsLoaded',\n    'campaignCreated',\n    'campaignStarted',\n    'campaignStatusLoaded',\n    'paidMediaStateLoaded',\n    'paidMediaDraftCreated',\n    'paidMediaAdSetUpdated',\n    'paidMediaCreativeCreated',\n    'paidMediaLaunchResult',\n    'paidMediaInsightsLoaded',\n    'paidMediaReportJobCreated',\n    'paidMediaReportStatusLoaded',\n    'paidMediaReportDownloaded',\n    'paidMediaSuggestionsLoaded'\n  ]\r\n};\r\n\r\nfunction validateInboundMessage(action) {\r\n  if (!MESSAGE_REGISTRY.inbound.includes(action)) {\r\n    console.warn(`?? UNREGISTERED INBOUND MESSAGE: \"${action}\" - Add to MESSAGE_REGISTRY.inbound`);\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction logMessageFlow(direction, type, data) {\r\n  if (!DEBUG_MESSAGES) return;\r\n  const arrow = direction === 'in' ? '??' : '??';\r\n  const label = direction === 'in' ? 'HTML?Velo' : 'Velo?HTML';\r\n  console.log(`${arrow} [${label}] ${type}`, data ? Object.keys(data) : '(no data)');\r\n}\r\n\r\nfunction sendToHtml(component, type, data) {\r\n  // Validate outbound message is registered\r\n  if (!MESSAGE_REGISTRY.outbound.includes(type)) {\r\n    console.warn(`?? UNREGISTERED OUTBOUND MESSAGE: \"${type}\" - Add to MESSAGE_REGISTRY.outbound`);\r\n  }\r\n  logMessageFlow('out', type, data);\r\n  component.postMessage({ type, data, timestamp: Date.now() });\r\n}\r\n\r\n// ============================================================================\r\n// PAGE INITIALIZATION\r\n// ============================================================================\r\n\r\n$w.onReady(async function () {\r\n  console.log('Recruiter Console Ready');\r\n\r\n  const htmlComponent = $w('#htmlRecruiterDashboard');\r\n\r\n  if (!htmlComponent.rendered) {\r\n    console.error('HTML component #htmlRecruiterDashboard not found');\r\n    return;\r\n  }\r\n\r\n  // Set up message listener\r\n  htmlComponent.onMessage(async (event) => {\r\n    await handleHtmlMessage(event.data, htmlComponent);\r\n  });\r\n\r\n  // Set up gamification widget if present\r\n  // Add an HTML component with ID #gamificationHtml pointing to public/recruiter/RECRUITER_GAMIFICATION.html\r\n  try {\r\n    const gamificationWidget = $w('#gamificationHtml');\r\n    if (gamificationWidget.rendered && typeof gamificationWidget.onMessage === 'function') {\r\n      setupRecruiterGamification(gamificationWidget);\r\n      console.log('?? Recruiter gamification widget initialized');\r\n    }\r\n  } catch (e) {\r\n    // Gamification widget not present on page, that's OK\r\n  }\r\n});\r\n\r\n// ============================================================================\r\n// MESSAGE HANDLER\r\n// ============================================================================\r\n\r\nasync function handleHtmlMessage(msg, component) {\r\n  if (!msg || !msg.type) return;\r\n\r\n  const action = msg.action || msg.type;\r\n\r\n  // Validate and log inbound message\r\n  validateInboundMessage(action);\r\n  logMessageFlow('in', action, msg.data);\r\n\r\n  try {\r\n    switch (action) {\r\n      // Health check - respond immediately\r\n      case 'ping':\r\n        sendToHtml(component, 'pong', {\r\n          timestamp: Date.now(),\r\n          registeredInbound: MESSAGE_REGISTRY.inbound.length,\r\n          registeredOutbound: MESSAGE_REGISTRY.outbound.length\r\n        });\r\n        break;\r\n\r\n      case 'recruiterDashboardReady':\r\n        await handleDashboardReady(component);\r\n        break;\r\n\r\n      case 'validateCarrier':\r\n        await handleValidateCarrier(msg.data, component);\r\n        break;\r\n\r\n      case 'addCarrier':\r\n        await handleAddCarrier(msg.data, component);\r\n        break;\r\n\r\n      case 'removeCarrier':\r\n        await handleRemoveCarrier(msg.data, component);\r\n        break;\r\n\r\n      case 'switchCarrier':\r\n        await handleSwitchCarrier(msg.data, component);\r\n        break;\r\n\r\n      case 'getCarriers':\r\n        await handleGetCarriers(component);\r\n        break;\r\n\r\n      case 'getPipeline':\r\n        await handleGetPipeline(msg.data, component);\r\n        break;\r\n\r\n      case 'updateCandidateStatus':\r\n        await handleUpdateStatus(msg.data, component);\r\n        break;\r\n\r\n      case 'getStats':\r\n        await handleGetStats(component);\r\n        break;\r\n\r\n      case 'getCandidateDetails':\r\n        await handleGetDetails(msg.data, component);\r\n        break;\r\n\r\n      case 'addNotes':\r\n        await handleAddNotes(msg.data, component);\r\n        break;\r\n\r\n      case 'sendMessage':\r\n        await handleSendMessage(msg.data, component);\r\n        break;\r\n\r\n      case 'getConversation':\r\n        await handleGetConversation(msg.data, component);\r\n        break;\r\n\r\n      case 'markAsRead':\r\n        await handleMarkAsRead(msg.data, component);\r\n        break;\r\n\r\n      case 'getNewMessages':\r\n        await handleGetNewMessages(msg.data, component);\r\n        break;\r\n\r\n      case 'getUnreadCount':\r\n        await handleGetUnreadCount(component);\r\n        break;\r\n\r\n      case 'requestAvailability':\r\n        await handleRequestAvailability(msg.data, component);\r\n        break;\r\n\r\n      case 'confirmTimeSlot':\r\n        await handleConfirmTimeSlot(msg.data, component);\r\n        break;\r\n\r\n      // ========== Driver Search Handlers ==========\r\n      case 'driverSearchReady':\r\n        await handleDriverSearchReady(component);\r\n        break;\r\n\r\n      case 'searchDrivers':\r\n        await handleSearchDrivers(msg.data, component);\r\n        break;\r\n\r\n      case 'viewDriverProfile':\r\n        await handleViewDriverProfile(msg.data, component);\r\n        break;\r\n\r\n      case 'saveDriver':\r\n        await handleSaveDriver(msg.data, component);\r\n        break;\r\n\r\n      case 'contactDriver':\r\n        await handleContactDriver(msg.data, component);\r\n        break;\r\n\r\n      case 'getQuotaStatus':\r\n        await handleGetQuotaStatus(component);\r\n        break;\r\n\r\n      case 'getWeightPreferences':\r\n        await handleGetWeightPreferences(component);\r\n        break;\r\n\r\n      case 'saveWeightPreferences':\r\n        await handleSaveWeightPreferences(msg.data, component);\r\n        break;\r\n\r\n      case 'generateAIDraft':\r\n        await handleGenerateAIDraft(msg.data, component);\r\n        break;\r\n\r\n      case 'navigateTo':\r\n        handleNavigateTo(msg.data);\r\n        break;\r\n\r\n      case 'logFeatureInteraction':\r\n        // Non-blocking feature tracking\r\n        logFeatureInteraction(msg.data.featureId, msg.data.userId, msg.data.action, msg.data)\r\n          .catch(err => console.warn('Feature tracking failed:', err.message));\r\n        break;\r\n\r\n      // ========== Saved Search Handlers ==========\r\n      case 'saveSearch':\r\n        await handleSaveSearch(msg.data, component);\r\n        break;\r\n      case 'loadSavedSearches':\r\n        await handleLoadSavedSearches(component);\r\n        break;\r\n      case 'runSavedSearch':\r\n        await handleRunSavedSearch(msg.data, component);\r\n        break;\r\n      case 'deleteSavedSearch':\r\n        await handleDeleteSavedSearch(msg.data, component);\r\n        break;\r\n      case 'updateSavedSearch':\r\n        await handleUpdateSavedSearch(msg.data, component);\r\n        break;\r\n\r\n      // ========== Call Outcome Handlers ==========\r\n      case 'logCallOutcome':\r\n        await handleLogCallOutcome(msg.data, component);\r\n        break;\r\n      case 'getCallAnalytics':\r\n        await handleGetCallAnalytics(msg.data, component);\r\n        break;\r\n      case 'getRecentCalls':\r\n        await handleGetRecentCalls(msg.data, component);\r\n        break;\r\n      case 'getDriverCallHistory':\r\n        await handleGetDriverCallHistory(msg.data, component);\r\n        break;\r\n\r\n      // ========== Intervention Handlers ==========\r\n      case 'getInterventionTemplates':\r\n        await handleGetInterventionTemplates(msg.data, component);\r\n        break;\r\n      case 'sendIntervention':\r\n        await handleSendIntervention(msg.data, component);\r\n        break;\r\n      case 'saveTemplate':\r\n        await handleSaveTemplate(msg.data, component);\r\n        break;\r\n      case 'deleteTemplate':\r\n        await handleDeleteTemplate(msg.data, component);\r\n        break;\r\n      case 'logInterventionOutcome':\r\n        await handleLogInterventionOutcome(msg.data, component);\r\n        break;\r\n      case 'getDriverInterventions':\r\n        await handleGetDriverInterventions(msg.data, component);\r\n        break;\r\n\r\n      // ========== Pipeline Automation Handlers ==========\r\n      case 'getAutomationRules':\r\n        await handleGetAutomationRules(component);\r\n        break;\r\n      case 'createAutomationRule':\r\n        await handleCreateAutomationRule(msg.data, component);\r\n        break;\r\n      case 'updateAutomationRule':\r\n        await handleUpdateAutomationRule(msg.data, component);\r\n        break;\r\n      case 'deleteAutomationRule':\r\n        await handleDeleteAutomationRule(msg.data, component);\r\n        break;\r\n      case 'toggleRuleStatus':\r\n        await handleToggleRuleStatus(msg.data, component);\r\n        break;\r\n      case 'getAutomationLog':\r\n        await handleGetAutomationLog(component);\r\n        break;\r\n\r\n      case 'getSystemHealth':\r\n        await handleGetSystemHealth(msg.data, component);\r\n        break;\r\n\r\n      // ========== Recruiter OS Handlers ==========\r\n      case 'recruiterOSReady':\r\n        await handleRecruiterOSReady(component);\r\n        break;\r\n      case 'getFunnelData':\r\n        await handleGetFunnelData(msg.data, component);\r\n        break;\r\n      case 'getCostData':\r\n        await handleGetCostData(msg.data, component);\r\n        break;\r\n      case 'getCompetitorData':\r\n        await handleGetCompetitorData(msg.data, component);\r\n        break;\r\n      case 'getPredictionsData':\r\n        await handleGetPredictionsData(msg.data, component);\r\n        break;\r\n      case 'getWorkflows':\r\n        await handleGetWorkflows(msg.data, component);\r\n        break;\r\n      case 'updateWorkflowStep':\r\n        await handleUpdateWorkflowStep(msg.data, component);\r\n        break;\r\n      case 'getRetentionData':\r\n        await handleGetRetentionData(msg.data, component);\r\n        break;\r\n      case 'getAtRiskDrivers':\r\n        await handleGetAtRiskDrivers(msg.data, component);\r\n        break;\r\n      case 'getLeaderboard':\r\n        await handleGetLeaderboardData(msg.data, component);\r\n        break;\r\n      case 'getBadges':\r\n        await handleGetBadges(msg.data, component);\r\n        break;\r\n      case 'getSettingsData':\r\n        await handleGetSettingsData(component);\r\n        break;\r\n\r\n      // -- Agent & Voice --\r\n      case 'agentMessage': {\r\n        const agentText = msg.data?.text || '';\r\n        const agentCtx = msg.data?.context || {};\r\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\r\n        sendToHtml(component, 'agentTyping', {});\r\n        try {\r\n          const agentResult = await handleAgentTurn('recruiter', recruiterId, agentText, {\r\n            ...agentCtx,\r\n            carrierDot: currentCarrierDOT\r\n          });\r\n          if (agentResult.type === 'approval_required') {\r\n            sendToHtml(component, 'agentApprovalRequired', agentResult);\r\n          } else {\r\n            sendToHtml(component, 'agentResponse', agentResult);\r\n          }\r\n        } catch (err) {\r\n          sendToHtml(component, 'agentResponse', { error: err.message });\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'resolveApprovalGate': {\r\n        const { approvalContext, decision, decidedBy } = msg.data || {};\r\n        sendToHtml(component, 'agentTyping', {});\r\n        try {\r\n          const result = await resumeAfterApproval(approvalContext, decision, decidedBy || 'user');\r\n          sendToHtml(component, 'agentResponse', result);\r\n        } catch (err) {\r\n          sendToHtml(component, 'agentResponse', { error: err.message });\r\n        }\r\n        break;\r\n      }\r\n      case 'getVoiceConfig': {\r\n        try {\r\n          const voiceConf = await getVoiceConfig();\r\n          sendToHtml(component, 'voiceReady', voiceConf);\r\n        } catch (err) {\r\n          console.warn('Voice config failed:', err.message);\r\n        }\r\n        break;\r\n      }\r\n      case 'getCampaigns': {\r\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id;\r\n        if (!recruiterId) { sendToHtml(component, 'campaignsLoaded', { campaigns: [] }); break; }\r\n        const campaigns = await getCampaigns(recruiterId);\r\n        sendToHtml(component, 'campaignsLoaded', { campaigns });\r\n        break;\r\n      }\r\n      case 'createCampaign': {\r\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id;\r\n        const result = await createCampaign(recruiterId, msg.data);\r\n        sendToHtml(component, 'campaignCreated', result);\r\n        break;\r\n      }\r\n      case 'startCampaign': {\r\n        const result = await startCampaign(msg.data?.campaignId);\r\n        sendToHtml(component, 'campaignStarted', result);\r\n        break;\r\n      }\r\n      case 'getCampaignStatus': {\n        const result = await getCampaignStatus(msg.data?.campaignId);\n        sendToHtml(component, 'campaignStatusLoaded', result);\n        break;\n      }\n      case 'getPaidMediaState': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleGetPaidMediaState(recruiterId, msg.data, component);\n        break;\n      }\n      case 'createPaidMediaDraft': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleCreatePaidMediaDraft(recruiterId, msg.data, component);\n        break;\n      }\n      case 'updatePaidMediaAdSet': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleUpdatePaidMediaAdSet(recruiterId, msg.data, component);\n        break;\n      }\n      case 'createPaidMediaCreative': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleCreatePaidMediaCreative(recruiterId, msg.data, component);\n        break;\n      }\n      case 'launchPaidMediaCampaign': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleLaunchPaidMediaCampaign(recruiterId, msg.data, component);\n        break;\n      }\n      case 'getPaidMediaInsights': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleGetPaidMediaInsights(recruiterId, msg.data, component);\n        break;\n      }\n      case 'createPaidMediaReportJob': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleCreatePaidMediaReportJob(recruiterId, msg.data, component);\n        break;\n      }\n      case 'getPaidMediaReportStatus': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleGetPaidMediaReportStatus(recruiterId, msg.data, component);\n        break;\n      }\n      case 'downloadPaidMediaReport': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleDownloadPaidMediaReport(recruiterId, msg.data, component);\n        break;\n      }\n      case 'getPaidMediaOptimizationSuggestions': {\n        const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id || 'recruiter';\n        await handleGetPaidMediaOptimizationSuggestions(recruiterId, msg.data, component);\n        break;\n      }\n\n      default:\n        console.warn('?? Unhandled action:', action);\n    }\r\n  } catch (error) {\r\n    console.error('Error handling message:', error);\r\n    sendToHtml(component, 'error', { message: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// ACTION HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleDashboardReady(component) {\r\n  console.log('Dashboard ready, checking auth...');\r\n\r\n  // Check if user is logged in\r\n  if (!wixUsers || !wixUsers.currentUser.loggedIn) {\r\n    console.log('User not logged in, redirecting...');\r\n    wixLocation.to('/account/my-account');\r\n    return;\r\n  }\r\n\r\n  // Get recruiter profile and carriers\r\n  const result = await getOrCreateRecruiterProfile();\r\n  console.log('Profile result:', result);\r\n\r\n  if (!result.success) {\r\n    console.error('Failed to get profile:', result.error);\r\n    sendToHtml(component, 'error', { message: result.error });\r\n    return;\r\n  }\r\n\r\n  // Cache profile data\r\n  cachedRecruiterProfile = result.profile;\r\n  cachedCarriers = result.carriers || [];\r\n\r\n  // Set current carrier to first one (if any)\r\n  if (cachedCarriers.length > 0) {\r\n    currentCarrierDOT = result.defaultCarrierDOT || cachedCarriers[0].carrier_dot;\r\n  }\r\n\r\n  console.log(`Recruiter authenticated with ${cachedCarriers.length} carriers`);\r\n\r\n  // Send ready message to HTML\r\n  sendToHtml(component, 'recruiterReady', {\r\n    recruiterProfile: result.profile,\r\n    carriers: cachedCarriers,\r\n    defaultCarrier: result.defaultCarrier,\r\n    currentCarrierDOT: currentCarrierDOT,\r\n    needsSetup: result.needsSetup,\r\n    memberId: wixUsers?.currentUser?.id || null\r\n  });\r\n}\r\n\r\nasync function handleValidateCarrier(data, component) {\r\n  console.log('Validating carrier:', data.carrierDOT);\r\n\r\n  const result = await validateCarrierDOT(data.carrierDOT);\r\n  sendToHtml(component, 'carrierValidated', result);\r\n}\r\n\r\nasync function handleAddCarrier(data, component) {\r\n  console.log('Adding carrier:', data.carrierDOT);\r\n\r\n  const result = await addCarrier(data.carrierDOT);\r\n\r\n  if (result.success) {\r\n    // Add to cached carriers\r\n    cachedCarriers.unshift({\r\n      carrier_dot: data.carrierDOT,\r\n      carrier_name: result.carrierInfo?.legal_name || result.carrierInfo?.title || 'Unknown',\r\n      added_date: new Date()\r\n    });\r\n\r\n    // Set as current if first carrier\r\n    if (!currentCarrierDOT) {\r\n      currentCarrierDOT = data.carrierDOT;\r\n    }\r\n  }\r\n\r\n  sendToHtml(component, 'carrierAdded', {\r\n    ...result,\r\n    carriers: cachedCarriers,\r\n    currentCarrierDOT: currentCarrierDOT\r\n  });\r\n}\r\n\r\nasync function handleRemoveCarrier(data, component) {\r\n  console.log('Removing carrier:', data.carrierDOT);\r\n\r\n  const result = await removeCarrier(data.carrierDOT);\r\n\r\n  if (result.success) {\r\n    // Remove from cached carriers\r\n    cachedCarriers = cachedCarriers.filter(c => c.carrier_dot !== data.carrierDOT);\r\n\r\n    // If current carrier was removed, switch to first available\r\n    if (currentCarrierDOT === data.carrierDOT) {\r\n      currentCarrierDOT = cachedCarriers.length > 0 ? cachedCarriers[0].carrier_dot : null;\r\n    }\r\n  }\r\n\r\n  sendToHtml(component, 'carrierRemoved', {\r\n    ...result,\r\n    carriers: cachedCarriers,\r\n    currentCarrierDOT: currentCarrierDOT\r\n  });\r\n}\r\n\r\nasync function handleSwitchCarrier(data, component) {\r\n  console.log('Switching to carrier:', data.carrierDOT);\r\n\r\n  currentCarrierDOT = data.carrierDOT;\r\n\r\n  // Get carrier info\r\n  const carrier = cachedCarriers.find(c => c.carrier_dot === data.carrierDOT);\r\n\r\n  sendToHtml(component, 'carrierSwitched', {\r\n    success: true,\r\n    currentCarrierDOT: currentCarrierDOT,\r\n    carrier: carrier\r\n  });\r\n\r\n  // Auto-load pipeline for new carrier\r\n  await handleGetPipeline({}, component);\r\n}\r\n\r\nasync function handleGetCarriers(component) {\r\n  console.log('Getting carriers list');\r\n\r\n  const result = await getRecruiterCarriers();\r\n\r\n  if (result.success) {\r\n    cachedCarriers = result.carriers;\r\n  }\r\n\r\n  sendToHtml(component, 'carriersLoaded', {\r\n    ...result,\r\n    currentCarrierDOT: currentCarrierDOT\r\n  });\r\n}\r\n\r\nasync function handleGetPipeline(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'pipelineLoaded', {\r\n      success: true,\r\n      candidates: [],\r\n      groupedByStatus: {},\r\n      totalCount: 0,\r\n      noCarrier: true\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.log('Loading pipeline for carrier:', currentCarrierDOT);\r\n\r\n  const result = await getPipelineCandidates(currentCarrierDOT, data?.filters || {});\r\n  sendToHtml(component, 'pipelineLoaded', result);\r\n}\r\n\r\nasync function handleUpdateStatus(data, component) {\r\n  console.log('Updating status:', data.interestId, '->', data.newStatus);\r\n\r\n  const result = await updateCandidateStatus(data.interestId, data.newStatus, data.notes || '');\r\n  sendToHtml(component, 'statusUpdated', result);\r\n}\r\n\r\nasync function handleGetStats(component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'statsLoaded', { success: true, stats: {} });\r\n    return;\r\n  }\r\n\r\n  console.log('Loading stats for carrier:', currentCarrierDOT);\r\n\r\n  const result = await getPipelineStats(currentCarrierDOT);\r\n  sendToHtml(component, 'statsLoaded', result);\r\n}\r\n\r\nasync function handleGetDetails(data, component) {\r\n  console.log('Loading candidate details:', data.interestId);\r\n\r\n  const result = await getCandidateDetails(data.interestId);\r\n  sendToHtml(component, 'candidateDetails', result);\r\n}\r\n\r\nasync function handleAddNotes(data, component) {\r\n  console.log('Adding notes to:', data.interestId);\r\n\r\n  const result = await addRecruiterNotes(data.interestId, data.notes);\r\n  sendToHtml(component, 'notesAdded', result);\r\n}\r\n\r\nasync function handleSendMessage(data, component) {\r\n  try {\r\n    const result = await sendMessage(data.applicationId, data.content, data.receiverId, 'recruiter');\r\n    if (result.success) {\r\n      sendToHtml(component, 'messageSent', { success: true, message: result.message });\r\n    } else {\r\n      sendToHtml(component, 'error', { message: result.error });\r\n    }\r\n  } catch (error) {\r\n    sendToHtml(component, 'error', { message: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetConversation(data, component) {\r\n  try {\r\n    const result = await getConversation(data.applicationId);\r\n    if (result.success) {\r\n      sendToHtml(component, 'conversationData', { applicationId: data.applicationId, messages: result.messages });\r\n    } else {\r\n      sendToHtml(component, 'error', { message: result.error });\r\n    }\r\n  } catch (error) {\r\n    sendToHtml(component, 'error', { message: error.message });\r\n  }\r\n}\r\n\r\nasync function handleMarkAsRead(data, component) {\r\n  try {\r\n    await markAsRead(data.applicationId);\r\n  } catch (error) {\r\n    console.error('Error marking as read:', error);\r\n  }\r\n}\r\n\r\nasync function handleRequestAvailability(data, component) {\r\n  const result = await requestAvailability(data.applicationId);\r\n  if (!result.success) {\r\n    sendToHtml(component, 'error', { message: result.error });\r\n  } else {\r\n    // Refresh conversation to show system message\r\n    await handleGetConversation(data, component);\r\n  }\r\n}\r\n\r\nasync function handleConfirmTimeSlot(data, component) {\r\n  const result = await confirmInterviewSlot(data.applicationId, data.slotIndex);\r\n  if (!result.success) {\r\n    sendToHtml(component, 'error', { message: result.error });\r\n  } else {\r\n    // Refresh conversation to show system message\r\n    await handleGetConversation(data, component);\r\n  }\r\n}\r\n\r\nasync function handleGetNewMessages(data, component) {\r\n  if (!data || !data.applicationId) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const { getNewMessages } = await import('backend/messagingRealtime');\r\n    const result = await getNewMessages(data.applicationId, data.sinceTimestamp);\r\n\r\n    sendToHtml(component, 'newMessagesData', {\r\n      messages: result.messages || [],\r\n      hasNew: result.hasNew || false,\r\n      latestTimestamp: result.latestTimestamp,\r\n      applicationId: data.applicationId\r\n    });\r\n  } catch (error) {\r\n    console.warn('Could not fetch new messages:', error.message);\r\n    sendToHtml(component, 'newMessagesData', {\r\n      messages: [],\r\n      hasNew: false,\r\n      applicationId: data.applicationId\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleGetUnreadCount(component) {\r\n  try {\r\n    const { getUnreadCountForUser } = await import('backend/messagingRealtime');\r\n    const result = await getUnreadCountForUser();\r\n\r\n    sendToHtml(component, 'unreadCountData', {\r\n      count: result.count || 0,\r\n      byApplication: result.byApplication || {}\r\n    });\r\n  } catch (error) {\r\n    console.warn('Could not fetch unread count:', error.message);\r\n    sendToHtml(component, 'unreadCountData', { count: 0, byApplication: {} });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// DRIVER SEARCH HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleDriverSearchReady(component) {\r\n  console.log('Driver Search ready, initializing...');\r\n\r\n  // Check authentication\r\n  if (!wixUsers || !wixUsers.currentUser.loggedIn) {\r\n    sendToHtml(component, 'error', { message: 'Not authenticated' });\r\n    return;\r\n  }\r\n\r\n  // If profile not loaded yet, load it\r\n  if (!cachedRecruiterProfile) {\r\n    const result = await getOrCreateRecruiterProfile();\r\n    if (result.success) {\r\n      cachedRecruiterProfile = result.profile;\r\n      cachedCarriers = result.carriers || [];\r\n      if (cachedCarriers.length > 0 && !currentCarrierDOT) {\r\n        currentCarrierDOT = result.defaultCarrierDOT || cachedCarriers[0].carrier_dot;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Get initial quota status\r\n  let quotaStatus = { tier: 'free', used: 0, limit: 5, remaining: 5 };\r\n  if (currentCarrierDOT) {\r\n    try {\r\n      quotaStatus = await getQuotaStatus(currentCarrierDOT);\r\n    } catch (e) {\r\n      console.warn('Could not get quota status:', e.message);\r\n    }\r\n  }\r\n\r\n  // Send initialization data\r\n  sendToHtml(component, 'driverSearchInit', {\r\n    success: true,\r\n    carriers: cachedCarriers,\r\n    currentCarrierDOT: currentCarrierDOT,\r\n    quotaStatus: quotaStatus,\r\n    recruiterProfile: cachedRecruiterProfile\r\n  });\r\n\r\n  // Also send profile for sidebar\r\n  if (cachedRecruiterProfile) {\r\n    sendToHtml(component, 'recruiterProfile', {\r\n      name: cachedRecruiterProfile.display_name || cachedRecruiterProfile.first_name || 'Recruiter',\r\n      email: cachedRecruiterProfile.email || ''\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleSearchDrivers(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'searchDriversResult', {\r\n      success: false,\r\n      error: 'No carrier selected. Please add a carrier first.'\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.log('Searching drivers for carrier:', currentCarrierDOT);\r\n\r\n  try {\r\n    const result = await findMatchingDrivers(currentCarrierDOT, data, { includeQuotaStatus: true });\r\n\r\n    // Get quota status\r\n    const quotaStatus = await getQuotaStatus(currentCarrierDOT);\r\n\r\n    sendToHtml(component, 'searchDriversResult', {\r\n      success: result.success,\r\n      drivers: result.success ? result.drivers : [],\r\n      total: result.success ? result.total : 0,\r\n      quotaStatus: quotaStatus,\r\n      error: result.error\r\n    });\r\n  } catch (error) {\r\n    console.error('Search drivers error:', error);\r\n    sendToHtml(component, 'searchDriversResult', {\r\n      success: false,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleViewDriverProfile(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'viewDriverProfileResult', {\r\n      success: false,\r\n      error: 'No carrier selected'\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (!data || !data.driverId) {\r\n    sendToHtml(component, 'viewDriverProfileResult', {\r\n      success: false,\r\n      error: 'Driver ID required'\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.log('Viewing driver profile:', data.driverId);\r\n\r\n  try {\r\n    const result = await getDriverProfile(currentCarrierDOT, data.driverId, { recordView: true });\r\n\r\n    // Get updated quota status\r\n    const quotaStatus = await getQuotaStatus(currentCarrierDOT);\r\n\r\n    if (result.success) {\r\n      sendToHtml(component, 'viewDriverProfileResult', {\r\n        success: true,\r\n        driver: result.driver,\r\n        quotaStatus: quotaStatus\r\n      });\r\n    } else if (result.error === 'QUOTA_EXCEEDED') {\r\n      sendToHtml(component, 'viewDriverProfileResult', {\r\n        success: false,\r\n        quotaExceeded: true,\r\n        quotaStatus: quotaStatus,\r\n        error: 'Monthly profile view quota exceeded'\r\n      });\r\n    } else {\r\n      sendToHtml(component, 'viewDriverProfileResult', {\r\n        success: false,\r\n        error: result.error,\r\n        quotaStatus: quotaStatus\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.error('View profile error:', error);\r\n    sendToHtml(component, 'viewDriverProfileResult', {\r\n      success: false,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleSaveDriver(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'saveDriverResult', {\r\n      success: false,\r\n      error: 'No carrier selected'\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (!data || !data.driverId) {\r\n    sendToHtml(component, 'saveDriverResult', {\r\n      success: false,\r\n      error: 'Driver ID required'\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.log('Saving driver to pipeline:', data.driverId);\r\n\r\n  try {\r\n    const result = await saveToRecruiterPipeline(\r\n      currentCarrierDOT,\r\n      data.driverId,\r\n      data.matchScore || 0,\r\n      data.notes || ''\r\n    );\r\n\r\n    sendToHtml(component, 'saveDriverResult', {\r\n      success: result.success,\r\n      interestId: result.interestId,\r\n      alreadyExists: result.alreadyExists,\r\n      error: result.error\r\n    });\r\n  } catch (error) {\r\n    console.error('Save driver error:', error);\r\n    sendToHtml(component, 'saveDriverResult', {\r\n      success: false,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleContactDriver(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'contactDriverResult', {\r\n      success: false,\r\n      error: 'No carrier selected'\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (!data || !data.driverId || !data.message) {\r\n    sendToHtml(component, 'contactDriverResult', {\r\n      success: false,\r\n      error: 'Driver ID and message required'\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.log('Sending message to driver:', data.driverId);\r\n\r\n  try {\r\n    const result = await sendMessageToDriver(currentCarrierDOT, data.driverId, data.message);\r\n\r\n    sendToHtml(component, 'contactDriverResult', {\r\n      success: result.success,\r\n      messageId: result.messageId,\r\n      error: result.error\r\n    });\r\n  } catch (error) {\r\n    console.error('Contact driver error:', error);\r\n    sendToHtml(component, 'contactDriverResult', {\r\n      success: false,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleGetQuotaStatus(component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'getQuotaStatusResult', {\r\n      success: true,\r\n      tier: 'free',\r\n      used: 0,\r\n      limit: 5,\r\n      remaining: 5,\r\n      hasQuota: true\r\n    });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const result = await getQuotaStatus(currentCarrierDOT);\r\n    sendToHtml(component, 'getQuotaStatusResult', result);\r\n  } catch (error) {\r\n    console.error('Get quota status error:', error);\r\n    sendToHtml(component, 'getQuotaStatusResult', {\r\n      success: false,\r\n      error: error.message,\r\n      tier: 'free',\r\n      used: 0,\r\n      limit: 5,\r\n      remaining: 5\r\n    });\r\n  }\r\n}\r\n\r\nasync function handleGetWeightPreferences(component) {\r\n  // Get weight preferences from recruiter profile\r\n  const preferences = cachedRecruiterProfile?.weight_preferences || {\r\n    weight_qualifications: 25,\r\n    weight_experience: 20,\r\n    weight_location: 20,\r\n    weight_availability: 15,\r\n    weight_salary_fit: 10,\r\n    weight_engagement: 10\r\n  };\r\n\r\n  sendToHtml(component, 'getWeightPreferencesResult', {\r\n    success: true,\r\n    preferences: preferences\r\n  });\r\n}\r\n\r\nasync function handleSaveWeightPreferences(data, component) {\r\n  if (!data) {\r\n    sendToHtml(component, 'saveWeightPreferencesResult', {\r\n      success: false,\r\n      error: 'Preferences data required'\r\n    });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // Update recruiter profile with new weight preferences\r\n    const result = await updateRecruiterProfile({\r\n      weight_preferences: {\r\n        weight_qualifications: data.weight_qualifications || 25,\r\n        weight_experience: data.weight_experience || 20,\r\n        weight_location: data.weight_location || 20,\r\n        weight_availability: data.weight_availability || 15,\r\n        weight_salary_fit: data.weight_salary_fit || 10,\r\n        weight_engagement: data.weight_engagement || 10\r\n      }\r\n    });\r\n\r\n    if (result.success && result.profile) {\r\n      cachedRecruiterProfile = result.profile;\r\n    }\r\n\r\n    sendToHtml(component, 'saveWeightPreferencesResult', {\r\n      success: result.success,\r\n      error: result.error\r\n    });\r\n  } catch (error) {\r\n    console.error('Save weight preferences error:', error);\r\n    sendToHtml(component, 'saveWeightPreferencesResult', {\r\n      success: false,\r\n      error: error.message\r\n    });\r\n  }\r\n}\r\n\r\nfunction handleNavigateTo(data) {\r\n  if (!data || !data.page) return;\r\n\r\n  console.log('Navigating to:', data.page);\r\n\r\n  // Map page names to Wix routes\r\n  const pageRoutes = {\r\n    'dashboard': '/recruiter-console',\r\n    'driver-search': '/recruiter-driver-search',\r\n    'pipeline': '/recruiter-console',\r\n    'retention': '/carrier-retention',\r\n    'settings': '/account/my-account',\r\n    'compliance-calendar': '/carrier-compliance-calendar',\r\n    'document-vault': '/carrier-document-vault',\r\n    'dq-tracker': '/carrier-dq-tracker',\r\n    'csa-monitor': '/carrier-csa-monitor',\r\n    'incident-reporting': '/carrier-incident-reporting',\r\n    'carrier-welcome': '/carrier-welcome'\r\n  };\r\n\r\n  const route = pageRoutes[data.page] || data.page;\r\n  wixLocation.to(route);\r\n}\r\n\r\n// ============================================================================\r\n// AI DRAFT HANDLER\r\n// ============================================================================\r\n\r\nasync function handleGenerateAIDraft(data, component) {\r\n  try {\r\n    const driver = data.driver || {};\r\n    const mode = data.mode || 'email';\r\n    const isText = mode === 'text';\r\n\r\n    const driverSummary = [\r\n      driver.name ? `Name: ${driver.name}` : null,\r\n      driver.cdlClass ? `CDL: Class ${driver.cdlClass}` : null,\r\n      driver.endorsements?.length ? `Endorsements: ${driver.endorsements.join(', ')}` : null,\r\n      driver.experienceYears ? `Experience: ${driver.experienceYears} years` : null,\r\n      driver.location ? `Location: ${driver.location}` : null,\r\n      driver.availability ? `Availability: ${driver.availability}` : null,\r\n      driver.equipment?.length ? `Equipment: ${driver.equipment.join(', ')}` : null\r\n    ].filter(Boolean).join('\\n');\r\n\r\n    const prompt = isText\r\n      ? `Write a short, friendly SMS recruitment text message (under 160 characters) to a truck driver. Be professional but casual. Do not include subject lines or greetings like \"Dear\". Just a direct, compelling message. Do not use placeholder brackets like [Company Name]  just say \"we\" or \"our team\".\\n\\nDriver info:\\n${driverSummary}\\n\\nWrite ONLY the text message, nothing else.`\r\n      : `Write a brief, professional recruitment email to a truck driver. Keep it under 150 words. Be warm and specific to their qualifications. Do not use placeholder brackets like [Company Name]  just say \"we\" or \"our team\". Include a subject line on the first line prefixed with \"Subject: \".\\n\\nDriver info:\\n${driverSummary}\\n\\nWrite ONLY the email (subject line + body), nothing else.`;\r\n\r\n    const aiResult = await routeAIRequest('driver_chat', {\r\n      prompt,\r\n      maxTokens: isText ? 100 : 300,\r\n      temperature: 0.8\r\n    });\r\n\r\n    sendToHtml(component, 'generateAIDraftResult', {\r\n      success: true,\r\n      draft: aiResult.content?.trim() || '',\r\n      model: aiResult.model,\r\n      tokensUsed: aiResult.tokensUsed\r\n    });\r\n  } catch (error) {\r\n    console.error('AI draft generation error:', error);\r\n    sendToHtml(component, 'generateAIDraftResult', {\r\n      success: false,\r\n      error: error.message || 'AI generation failed'\r\n    });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// SAVED SEARCH HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleSaveSearch(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'saveSearchResult', { success: false, error: 'No carrier selected' });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await createSavedSearch(currentCarrierDOT, data);\r\n    sendToHtml(component, 'saveSearchResult', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'saveSearchResult', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleLoadSavedSearches(component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'savedSearchesLoaded', { success: true, searches: [] });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getSavedSearches(currentCarrierDOT);\r\n    sendToHtml(component, 'savedSearchesLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'savedSearchesLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleRunSavedSearch(data, component) {\r\n  try {\r\n    const result = await executeSavedSearch(data.searchId);\r\n    sendToHtml(component, 'savedSearchExecuted', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'savedSearchExecuted', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleDeleteSavedSearch(data, component) {\r\n  try {\r\n    const result = await deleteSavedSearch(data.searchId);\r\n    sendToHtml(component, 'savedSearchDeleted', { ...result, searchId: data.searchId });\r\n  } catch (error) {\r\n    sendToHtml(component, 'savedSearchDeleted', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleUpdateSavedSearch(data, component) {\r\n  try {\r\n    const result = await updateSavedSearch(data.searchId, data);\r\n    sendToHtml(component, 'savedSearchUpdated', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'savedSearchUpdated', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// CALL OUTCOME HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleLogCallOutcome(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'callOutcomeLogged', { success: false, error: 'No carrier selected' });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await logCallOutcome(currentCarrierDOT, data);\r\n    sendToHtml(component, 'callOutcomeLogged', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'callOutcomeLogged', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetCallAnalytics(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'callAnalyticsLoaded', { success: true, analytics: {} });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getOutcomeAnalytics(currentCarrierDOT, data || {});\r\n    sendToHtml(component, 'callAnalyticsLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'callAnalyticsLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetRecentCalls(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'recentCallsLoaded', { success: true, outcomes: [] });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getCarrierOutcomes(currentCarrierDOT, data || {});\r\n    sendToHtml(component, 'recentCallsLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'recentCallsLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetDriverCallHistory(data, component) {\r\n  try {\r\n    const result = await getDriverOutcomes(data.driverId);\r\n    sendToHtml(component, 'driverCallHistoryLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'driverCallHistoryLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// INTERVENTION HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleGetInterventionTemplates(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'interventionTemplatesLoaded', { success: true, templatesByRiskType: {} });\r\n    return;\r\n  }\r\n  try {\r\n    const result = data && data.riskType\r\n      ? await getInterventionTemplates(currentCarrierDOT, data.riskType)\r\n      : await getAllTemplates(currentCarrierDOT);\r\n    sendToHtml(component, 'interventionTemplatesLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'interventionTemplatesLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleSendIntervention(data, component) {\r\n  try {\r\n    const result = await sendIntervention(data.templateId, data.driverId, data.overrides || {});\r\n    sendToHtml(component, 'interventionSent', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'interventionSent', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleSaveTemplate(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'templateSaved', { success: false, error: 'No carrier selected' });\r\n    return;\r\n  }\r\n  try {\r\n    let result;\r\n    if (data.templateId) {\r\n      result = await updateInterventionTemplate(data.templateId, data);\r\n    } else {\r\n      result = await createTemplate(currentCarrierDOT, data);\r\n    }\r\n    sendToHtml(component, 'templateSaved', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'templateSaved', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleDeleteTemplate(data, component) {\r\n  try {\r\n    const result = await deleteTemplate(data.templateId);\r\n    sendToHtml(component, 'templateDeleted', { ...result, templateId: data.templateId });\r\n  } catch (error) {\r\n    sendToHtml(component, 'templateDeleted', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleLogInterventionOutcome(data, component) {\r\n  try {\r\n    const result = await logInterventionOutcome(data.interventionId, data.outcome);\r\n    sendToHtml(component, 'interventionOutcomeLogged', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'interventionOutcomeLogged', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetDriverInterventions(data, component) {\r\n  try {\r\n    const result = await getDriverInterventions(data.driverId);\r\n    sendToHtml(component, 'driverInterventionsLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'driverInterventionsLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// PIPELINE AUTOMATION HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleGetAutomationRules(component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'automationRulesLoaded', { success: true, rules: [] });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getAutomationRules(currentCarrierDOT);\r\n    sendToHtml(component, 'automationRulesLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'automationRulesLoaded', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleCreateAutomationRule(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'automationRuleCreated', { success: false, error: 'No carrier selected' });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await createAutomationRule(currentCarrierDOT, data);\r\n    sendToHtml(component, 'automationRuleCreated', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'automationRuleCreated', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleUpdateAutomationRule(data, component) {\r\n  try {\r\n    const result = await updateAutomationRule(data.ruleId, data);\r\n    sendToHtml(component, 'automationRuleUpdated', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'automationRuleUpdated', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleDeleteAutomationRule(data, component) {\r\n  try {\r\n    const result = await deleteAutomationRule(data.ruleId);\r\n    sendToHtml(component, 'automationRuleDeleted', { ...result, ruleId: data.ruleId });\r\n  } catch (error) {\r\n    sendToHtml(component, 'automationRuleDeleted', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleToggleRuleStatus(data, component) {\r\n  try {\r\n    const result = await toggleRuleStatus(data.ruleId, data.isActive);\r\n    sendToHtml(component, 'automationRuleToggled', { ...result, ruleId: data.ruleId });\r\n  } catch (error) {\r\n    sendToHtml(component, 'automationRuleToggled', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetAutomationLog(component) {\r\n  if (!currentCarrierDOT) return;\r\n  const result = await getAutomationLog(currentCarrierDOT);\r\n  sendToHtml(component, 'automationLogLoaded', result);\r\n}\r\n\r\n// ============================================================================\r\n// SYSTEM HEALTH HANDLERS\r\n// ============================================================================\r\n\r\n// ============================================================================\r\n// RECRUITER OS HANDLERS\r\n// ============================================================================\r\n\r\nasync function handleRecruiterOSReady(component) {\r\n  console.log('Recruiter OS ready, initializing...');\r\n\r\n  if (!wixUsers || !wixUsers.currentUser.loggedIn) {\r\n    wixLocation.to('/account/my-account');\r\n    return;\r\n  }\r\n\r\n  // Reuse existing profile/carrier init\r\n  const result = await getOrCreateRecruiterProfile();\r\n  if (!result.success) {\r\n    sendToHtml(component, 'error', { message: result.error });\r\n    return;\r\n  }\r\n\r\n  cachedRecruiterProfile = result.profile;\r\n  cachedCarriers = result.carriers || [];\r\n  if (cachedCarriers.length > 0) {\r\n    currentCarrierDOT = result.defaultCarrierDOT || cachedCarriers[0].carrier_dot;\r\n  }\r\n\r\n  sendToHtml(component, 'recruiterOSInit', {\r\n    profile: {\r\n      name: result.profile.name || result.profile.recruiter_name || '',\r\n      tier: result.profile.subscription_tier || 'Free',\r\n      currentCarrierDOT\r\n    },\r\n    carriers: cachedCarriers.map(c => ({\r\n      dot: c.carrier_dot,\r\n      name: c.carrier_name || c.legal_name || ''\r\n    })),\r\n    memberId: wixUsers?.currentUser?.id || null\r\n  });\r\n}\r\n\r\nasync function handleGetFunnelData(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'funnelDataLoaded', { stages: [] });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getFunnelMetrics(currentCarrierDOT, data?.dateRange);\r\n    sendToHtml(component, 'funnelDataLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'funnelDataLoaded', { error: error.message, stages: [] });\r\n  }\r\n}\r\n\r\nasync function handleGetCostData(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'costDataLoaded', {});\r\n    return;\r\n  }\r\n  try {\r\n    const result = await calculateCostPerHire(currentCarrierDOT, data?.dateRange);\r\n    sendToHtml(component, 'costDataLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'costDataLoaded', { error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetCompetitorData(data, component) {\r\n  try {\r\n    const region = data?.region || 'national';\r\n    const jobType = data?.jobType || 'CDL-A OTR';\r\n    const result = await getCompetitorComparison(region, jobType);\r\n    sendToHtml(component, 'competitorDataLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'competitorDataLoaded', { error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetPredictionsData(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'predictionsLoaded', {});\r\n    return;\r\n  }\r\n  try {\r\n    const [forecast, risk] = await Promise.all([\r\n      generateHiringForecast(currentCarrierDOT, data?.monthsAhead || 3),\r\n      getTurnoverRiskAnalysis(currentCarrierDOT)\r\n    ]);\r\n    sendToHtml(component, 'predictionsLoaded', { forecast, risk });\r\n  } catch (error) {\r\n    sendToHtml(component, 'predictionsLoaded', { error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetWorkflows(data, component) {\r\n  try {\r\n    const filters = data?.filters || {};\r\n    if (currentCarrierDOT) filters.carrierId = currentCarrierDOT;\r\n    const result = await getActiveWorkflows(filters);\r\n    sendToHtml(component, 'workflowsLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'workflowsLoaded', { error: error.message, workflows: [] });\r\n  }\r\n}\r\n\r\nasync function handleUpdateWorkflowStep(data, component) {\r\n  try {\r\n    const result = await updateWorkflowStatus(data.workflowId, data.status, data.metadata || {});\r\n    sendToHtml(component, 'workflowUpdated', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'workflowUpdated', { success: false, error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetRetentionData(data, component) {\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'retentionDataLoaded', {});\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getCarrierRetentionDashboard(currentCarrierDOT);\r\n    sendToHtml(component, 'retentionDataLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'retentionDataLoaded', { error: error.message });\r\n  }\r\n}\r\n\r\nasync function handleGetAtRiskDrivers(data, component) {\r\n  // At-risk drivers come from retention dashboard\r\n  if (!currentCarrierDOT) {\r\n    sendToHtml(component, 'atRiskDriversLoaded', { drivers: [] });\r\n    return;\r\n  }\r\n  try {\r\n    const result = await getCarrierRetentionDashboard(currentCarrierDOT);\r\n    sendToHtml(component, 'atRiskDriversLoaded', {\r\n      drivers: result.atRiskDrivers || result.at_risk_drivers || []\r\n    });\r\n  } catch (error) {\r\n    sendToHtml(component, 'atRiskDriversLoaded', { error: error.message, drivers: [] });\r\n  }\r\n}\r\n\r\nasync function handleGetLeaderboardData(data, component) {\r\n  try {\r\n    const type = data?.type || 'overall';\r\n    const period = data?.period || 'monthly';\r\n    const result = await getLeaderboard(type, period);\r\n    sendToHtml(component, 'leaderboardLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'leaderboardLoaded', { error: error.message, entries: [] });\r\n  }\r\n}\r\n\r\nasync function handleGetBadges(data, component) {\r\n  try {\r\n    const recruiterId = cachedRecruiterProfile?.recruiter_id || cachedRecruiterProfile?._id;\r\n    if (!recruiterId) {\r\n      sendToHtml(component, 'badgesLoaded', { badges: [] });\r\n      return;\r\n    }\r\n    const result = await getUserLeaderboardPosition(recruiterId);\r\n    sendToHtml(component, 'badgesLoaded', result);\r\n  } catch (error) {\r\n    sendToHtml(component, 'badgesLoaded', { error: error.message, badges: [] });\r\n  }\r\n}\r\n\r\nasync function handleGetSettingsData(component) {\r\n  sendToHtml(component, 'settingsDataLoaded', {\r\n    profile: cachedRecruiterProfile,\r\n    carriers: cachedCarriers,\r\n    currentCarrierDOT\r\n  });\r\n}\r\n\r\nasync function handleGetSystemHealth(data, component) {\n  // Use currentCarrierDOT as context if not provided\r\n  const carrierDot = data?.carrierDot || currentCarrierDOT;\r\n\r\n  try {\r\n    const result = await getRecruiterHealthStatus(carrierDot);\r\n    sendToHtml(component, 'systemHealthUpdate', result);\r\n  } catch (error) {\r\n    console.warn('Health check failed:', error);\r\n    sendToHtml(component, 'systemHealthUpdate', {\r\n      status: 'unknown',\r\n      error: error.message\r\n    });\r\n  }\n}\n\nasync function executePaidMediaAction(recruiterId, action, params = {}) {\n  return executeTool(\n    'recruiter_paid_media',\n    { action, params },\n    { userId: recruiterId, runId: `recruiter_paid_media_${Date.now()}` }\n  );\n}\n\nfunction buildPaidMediaContext(data = {}) {\n  return {\n    carrierDot: data.carrierDot || currentCarrierDOT || '',\n    integrationId: data.integrationId || '',\n    adAccountId: data.adAccountId || '',\n    idempotencyKey: data.idempotencyKey || `paid_media_${Date.now()}_${Math.random().toString(36).slice(2, 7)}`\n  };\n}\n\nasync function handleGetPaidMediaState(recruiterId, data, component) {\n  const payload = data || {};\n  sendToHtml(component, 'paidMediaStateLoaded', {\n    success: true,\n    recruiterId,\n    carrierDot: payload.carrierDot || currentCarrierDOT || '',\n    integrationId: payload.integrationId || '',\n    adAccountId: payload.adAccountId || '',\n    generatedAt: new Date().toISOString()\n  });\n}\n\nasync function handleCreatePaidMediaDraft(recruiterId, data, component) {\n  const payload = data || {};\n  const context = buildPaidMediaContext(payload);\n  const campaignDraft = await executePaidMediaAction(recruiterId, 'create_campaign_draft', {\n    campaignId: payload.campaignId || '',\n    name: payload.name || '',\n    objective: payload.objective || '',\n    category: payload.category || 'recruitment',\n    dailyBudget: Number(payload.dailyBudget || 0),\n    startTime: payload.startTime || '',\n    endTime: payload.endTime || '',\n    integrationId: context.integrationId,\n    adAccountId: context.adAccountId,\n    idempotencyKey: `${context.idempotencyKey}_campaign`\n  });\n\n  if (!campaignDraft.success) {\n    sendToHtml(component, 'paidMediaDraftCreated', campaignDraft);\n    return;\n  }\n\n  const campaignId = campaignDraft.campaign?.campaign_id || payload.campaignId || '';\n  const adSetDraft = await executePaidMediaAction(recruiterId, 'create_ad_set_draft', {\n    adSetId: payload.adSetId || '',\n    campaignId,\n    name: payload.adSetName || `${payload.name || 'Campaign'} - Primary Ad Set`,\n    dailyBudget: Number(payload.dailyBudget || 0),\n    targeting: payload.targeting || {\n      regions: payload.regions || [],\n      audience: payload.audience || 'broad',\n      placements: payload.placements || []\n    },\n    schedule: payload.schedule || {\n      start_time: payload.startTime || '',\n      end_time: payload.endTime || ''\n    },\n    integrationId: context.integrationId,\n    adAccountId: context.adAccountId,\n    idempotencyKey: `${context.idempotencyKey}_adset`\n  });\n\n  sendToHtml(component, 'paidMediaDraftCreated', {\n    success: campaignDraft.success && adSetDraft.success,\n    campaign: campaignDraft.campaign || null,\n    adSet: adSetDraft.adSet || null,\n    errors: [campaignDraft.error, adSetDraft.error].filter(Boolean)\n  });\n}\n\nasync function handleUpdatePaidMediaAdSet(recruiterId, data, component) {\n  const payload = data || {};\n  const context = buildPaidMediaContext(payload);\n  const result = await executePaidMediaAction(recruiterId, 'update_ad_set_budget', {\n    adSetId: payload.adSetId || '',\n    dailyBudget: Number(payload.dailyBudget || 0),\n    lifetimeBudget: Number(payload.lifetimeBudget || 0),\n    schedule: payload.schedule || null,\n    targeting: payload.targeting || null,\n    integrationId: context.integrationId,\n    adAccountId: context.adAccountId,\n    idempotencyKey: `${context.idempotencyKey}_adset_update`\n  });\n\n  sendToHtml(component, 'paidMediaAdSetUpdated', result);\n}\n\nasync function handleCreatePaidMediaCreative(recruiterId, data, component) {\n  const payload = data || {};\n  const context = buildPaidMediaContext(payload);\n  const creativeResult = await executePaidMediaAction(recruiterId, 'create_creative_draft', {\n    creativeId: payload.creativeId || '',\n    campaignId: payload.campaignId || '',\n    adSetId: payload.adSetId || '',\n    name: payload.creativeName || `${payload.name || 'Campaign'} Creative`,\n    headline: payload.headline || '',\n    body: payload.body || '',\n    ctaType: payload.ctaType || 'APPLY_NOW',\n    destinationUrl: payload.destinationUrl || '',\n    mediaAssets: payload.mediaAssets || [],\n    integrationId: context.integrationId,\n    adAccountId: context.adAccountId,\n    idempotencyKey: `${context.idempotencyKey}_creative`\n  });\n\n  sendToHtml(component, 'paidMediaCreativeCreated', creativeResult);\n}\n\nasync function handleLaunchPaidMediaCampaign(recruiterId, data, component) {\n  const payload = data || {};\n  const context = buildPaidMediaContext(payload);\n  const launchResult = await executePaidMediaAction(recruiterId, 'create_campaign', {\n    campaignId: payload.campaignId || '',\n    name: payload.name || '',\n    objective: payload.objective || '',\n    category: payload.category || 'recruitment',\n    dailyBudget: Number(payload.dailyBudget || 0),\n    startTime: payload.startTime || '',\n    endTime: payload.endTime || '',\n    status: 'active',\n    integrationId: context.integrationId,\n    adAccountId: context.adAccountId,\n    idempotencyKey: `${context.idempotencyKey}_launch`\n  });\n\n  sendToHtml(component, 'paidMediaLaunchResult', launchResult);\n}\n\nasync function executePaidMediaAnalyticsAction(recruiterId, action, params = {}) {\n  return executeTool(\n    'recruiter_paid_media_analytics',\n    { action, params },\n    { userId: recruiterId, runId: `recruiter_paid_media_analytics_${Date.now()}` }\n  );\n}\n\nasync function executePaidMediaPipelineAction(recruiterId, action, params = {}) {\n  return executeTool(\n    'cross_role_paid_media_pipeline',\n    { action, params },\n    { userId: recruiterId, runId: `cross_role_paid_media_pipeline_${Date.now()}` }\n  );\n}\n\nasync function handleGetPaidMediaInsights(recruiterId, data, component) {\n  const params = data || {};\n  const [campaign, adSet, ad, breakdown, funnel, cplTrend, sourceQuality] = await Promise.all([\n    executePaidMediaAnalyticsAction(recruiterId, 'get_insights_campaign_level', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'get_insights_adset_level', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'get_insights_ad_level', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'get_insights_with_breakdowns', {\n      ...params,\n      breakdownBy: params.breakdownBy || 'placement'\n    }),\n    executePaidMediaPipelineAction(recruiterId, 'get_paid_media_to_pipeline_funnel', params),\n    executePaidMediaPipelineAction(recruiterId, 'get_cpl_to_hire_trend', params),\n    executePaidMediaPipelineAction(recruiterId, 'get_source_quality_score', params)\n  ]);\n\n  sendToHtml(component, 'paidMediaInsightsLoaded', {\n    success: campaign.success && adSet.success && ad.success && breakdown.success,\n    campaign,\n    adSet,\n    ad,\n    breakdown,\n    pipeline: {\n      funnel,\n      cplTrend,\n      sourceQuality\n    }\n  });\n}\n\nasync function handleCreatePaidMediaReportJob(recruiterId, data, component) {\n  const params = data || {};\n  const result = await executePaidMediaAnalyticsAction(recruiterId, 'create_async_report_job', {\n    reportScope: params.reportScope || 'campaign',\n    format: params.format || 'json',\n    dateRange: params.dateRange || {},\n    breakdownBy: params.breakdownBy || ''\n  });\n  sendToHtml(component, 'paidMediaReportJobCreated', result);\n}\n\nasync function handleGetPaidMediaReportStatus(recruiterId, data, component) {\n  const params = data || {};\n  const result = await executePaidMediaAnalyticsAction(recruiterId, 'get_async_report_status', {\n    jobId: params.jobId || ''\n  });\n  sendToHtml(component, 'paidMediaReportStatusLoaded', result);\n}\n\nasync function handleDownloadPaidMediaReport(recruiterId, data, component) {\n  const params = data || {};\n  const result = await executePaidMediaAnalyticsAction(recruiterId, 'download_report', {\n    jobId: params.jobId || ''\n  });\n  sendToHtml(component, 'paidMediaReportDownloaded', result);\n}\n\nasync function handleGetPaidMediaOptimizationSuggestions(recruiterId, data, component) {\n  const params = data || {};\n  const [budget, creative, audience, fatigue, placement] = await Promise.all([\n    executePaidMediaAnalyticsAction(recruiterId, 'suggest_budget_reallocation', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'suggest_creative_rotation', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'suggest_audience_narrowing', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'get_frequency_fatigue_alerts', params),\n    executePaidMediaAnalyticsAction(recruiterId, 'get_placement_performance', params)\n  ]);\n\n  sendToHtml(component, 'paidMediaSuggestionsLoaded', {\n    success: budget.success && creative.success && audience.success && fatigue.success && placement.success,\n    budget,\n    creative,\n    audience,\n    fatigue,\n    placement\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Recruiter_Orientation_Scheduler.ydg3k.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Recruiter_Telemetry.su0k9.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Retention Dashboard.k2ez4.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'wixUsers' is defined but never used.","line":2,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getCarrierRetentionDashboard } from 'backend/retentionService.jsw';\r\nimport wixUsers from 'wix-users';\r\n\r\n/**\r\n * RETENTION COMMAND CENTER v3.0 - Velo Page Code\r\n * \r\n * ARCHITECTURE NOTE:\r\n * This page code is now a \"thin client\". \r\n * All complex logic (ROI, Silence Signal detection, Risk Scoring) \r\n * has been moved to the secure backend service: 'backend/retentionService.jsw'.\r\n */\r\n\r\n$w.onReady(async function () {\r\n    const htmlComponent = $w('#retentionDashboard');\r\n\r\n    async function loadRetentionIntelligence() {\r\n        try {\r\n            console.log(\"?? Loading Retention Command Center...\");\r\n\r\n            // Get current user's carrier context (mocking '12345' if not set)\r\n            // In production, you would fetch the user's linked DOT number\r\n            const carrierDot = '12345';\r\n\r\n            // CALL BACKEND SERVICE\r\n            // This returns the fully processed \"Prevention Engine\" data\r\n            const dashboardData = await getCarrierRetentionDashboard(carrierDot);\r\n\r\n            if (dashboardData.success) {\r\n                // Add Visualization Data (Survival Curve)\r\n                // This visualization data could also be moved to backend if dynamic\r\n                dashboardData.survivalCohort = [100, 98, 85, 82, 78, 75, 68]; // Matching the \"Day 14\" insight\r\n\r\n                // SEND TO HTML COMPONENT\r\n                htmlComponent.postMessage({\r\n                    type: 'updateRetentionDashboard',\r\n                    data: dashboardData\r\n                });\r\n                console.log(\"? Dashboard Data Sent to HTML Component\");\r\n            }\r\n        } catch (error) {\r\n            console.error('? Retention Dashboard Data Error:', error);\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    loadRetentionIntelligence();\r\n\r\n    // Listen for refresh requests\r\n    htmlComponent.onMessage((event) => {\r\n        if (event.data.type === 'retentionDashboardReady' || event.data.type === 'refresh') {\r\n            loadRetentionIntelligence();\r\n        }\r\n    });\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Road Utilities.xzvqe.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'MESSAGE_REGISTRY' is assigned a value but never used.","line":46,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROAD UTILITIES PAGE - Driver Operating System\r\n// Handles communication between DRIVER_ROAD_UTILITIES.html and Velo backend\r\n// ============================================================================\r\n\r\nimport { searchParking, getParkingDetails, reportParkingAvailability } from 'backend/parkingService';\r\nimport { searchFuelPrices, linkFuelCard, getDriverFuelCards, calculateFuelSavings } from 'backend/fuelService';\r\nimport {\r\n    searchWeighStations,\r\n    getStationStatus,\r\n    reportStationStatus,\r\n    getDriverBypassServices,\r\n    saveDriverBypassServices\r\n} from 'backend/weighStationService';\r\nimport {\r\n    getLocationReviews,\r\n    submitReview,\r\n    submitConditionReport,\r\n    voteReview\r\n} from 'backend/restStopService';\r\nimport {\n    getAlertsAtLocation,\n    getRouteWeather,\n    subscribeToAlerts\n} from 'backend/weatherAlertService';\nimport {\r\n    getRouteConditions,\r\n    getTruckRestrictions,\r\n    reportCondition,\r\n    verifyConditionReport,\r\n    getChainRequirements // Moved from weather service\r\n} from 'backend/roadConditionService';\r\nimport { logFeatureInteraction } from 'backend/featureAdoptionService';\r\nimport wixUsers from 'wix-users';\r\nimport wixLocation from 'wix-location';\r\n\r\n// ============================================================================\r\n// CONFIGURATION\r\n// ============================================================================\r\n\r\n// Road Utilities HTML component is #html4\r\nconst POSSIBLE_HTML_IDS = ['#html4', '#html1', '#html2', '#html3', '#html5', '#html6'];\r\n\r\nlet HTML_COMPONENT = null; // Will be set during initialization\r\n\r\nconst MESSAGE_REGISTRY = {\r\n    inbound: [\r\n        'searchParking',\r\n        'getParkingDetails',\r\n        'reportParking',\r\n        'searchFuel',\r\n        'linkFuelCard',\r\n        'getDriverFuelCards',\r\n        'calculateSavings',\r\n        // Phase 3: Weigh Stations\r\n        'searchWeighStations',\r\n        'getStationStatus',\r\n        'reportStationStatus',\r\n        'getDriverBypassServices',\r\n        'saveDriverBypassServices',\r\n        'tabSwitch',\r\n        'tabChanged',            // Legacy alias for tabSwitch\r\n        // Phase 4: Rest Stop Ratings\r\n        'getReviews',\r\n        'submitReview',\r\n        'reportCondition',\r\n        'verifyConditionReport',\r\n        'voteReview',\r\n        // Phase 5: Weather\n        'getWeather',\n        'subscribeAlerts',\n        // Phase 6: Road Conditions\n        'getRoadConditions',\n        'getTruckRestrictions',\r\n        'reportRoadCondition',\r\n        'ping',\r\n        'ready'\r\n    ],\r\n    outbound: [\r\n        'parkingResults',\r\n        'parkingDetails',\r\n        'reportResult',\r\n        'fuelResults',\r\n        'fuelCardsLoaded',\r\n        'fuelCardLinked',\r\n        'savingsResult',\r\n        // Phase 3: Weigh Stations\r\n        'weighStationResults',\r\n        'stationStatusResult',\r\n        'bypassServicesLoaded',\r\n        'bypassServicesSaved',\r\n        'error',\r\n        'pong',\r\n        // Phase 4: Rest Stop Ratings\r\n        'reviewsLoaded',\r\n        'reviewSubmitted',\r\n        'conditionReported',\r\n        'voteRegistered',\r\n        // Phase 5: Weather\n        'weatherResults',\n        'weatherSubscriptionSaved',\n        // Phase 6: Road Conditions\n        'conditionsResults',\n        'restrictionResults',\r\n        'roadConditionReported',\r\n        'init'\r\n    ]\r\n};\r\n\r\n// Default location (Memphis, TN - central US trucking hub)\r\nconst DEFAULT_LOCATION = {\r\n    lat: 35.1495,\r\n    lng: -90.0490\r\n};\r\n\r\n// ============================================================================\r\n// PAGE INITIALIZATION\r\n// ============================================================================\r\n\r\n$w.onReady(function () {\r\n    console.log('[RoadUtilities] Page ready, initializing...');\r\n\r\n    // Find the HTML component by trying multiple possible IDs\r\n    HTML_COMPONENT = findHtmlComponent();\r\n\r\n    if (!HTML_COMPONENT) {\r\n        console.error('[RoadUtilities] HTML component not found. Tried:', POSSIBLE_HTML_IDS.join(', '));\r\n        console.error('[RoadUtilities] Please check the HTML component ID in the Wix editor and update POSSIBLE_HTML_IDS');\r\n        return;\r\n    }\r\n\r\n    // Set up message listener from HTML component\r\n    HTML_COMPONENT.onMessage((event) => {\r\n        handleHtmlMessage(event.data);\r\n    });\r\n\r\n    // Send initial configuration to HTML component once it's ready\r\n    setTimeout(() => {\r\n        sendInitialConfig();\r\n    }, 500);\r\n\r\n    // Track page view\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('road_utilities', userId, 'view', {\r\n        metadata: { source: wixLocation.query?.source || 'direct' }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    console.log('[RoadUtilities] Initialization complete');\r\n});\r\n\r\n// ============================================================================\r\n// MESSAGE HANDLING\r\n// ============================================================================\r\n\r\n/**\r\n * Find HTML component by trying multiple possible IDs\r\n * @returns {Object|null} The HTML component or null if not found\r\n */\r\nfunction findHtmlComponent() {\r\n    for (const htmlId of POSSIBLE_HTML_IDS) {\r\n        try {\r\n            const component = $w(htmlId);\r\n            if (component && component.onMessage) {\r\n                console.log(`[RoadUtilities] Found HTML component: ${htmlId}`);\r\n                return component;\r\n            }\r\n        } catch (e) {\r\n            // Component doesn't exist, try next\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * Send message to HTML component\r\n * @param {string} type - Message type from MESSAGE_REGISTRY.outbound\r\n * @param {Object} data - Payload data\r\n */\r\nfunction sendToHtml(type, data) {\r\n    if (!HTML_COMPONENT) {\r\n        console.error('[RoadUtilities] Cannot send message, HTML component not found');\r\n        return;\r\n    }\r\n\r\n    console.log(`[Velo->HTML] ${type}`, data);\r\n    HTML_COMPONENT.postMessage({ type, data });\r\n}\r\n\r\n/**\r\n * Send initial configuration to HTML component\r\n */\r\nfunction sendInitialConfig() {\r\n    const isLoggedIn = wixUsers.currentUser.loggedIn;\r\n    const userId = isLoggedIn ? wixUsers.currentUser.id : null;\r\n\r\n    sendToHtml('init', {\r\n        isLoggedIn,\r\n        userId,\r\n        defaultLocation: DEFAULT_LOCATION,\r\n        timestamp: Date.now(),\r\n        // Default to Dashboard tab unless deep linked\r\n        initialTab: 'dashboard'\r\n    });\r\n\r\n    // Pre-load data for Dashboard Summary\r\n    if (isLoggedIn) {\r\n        handleGetDriverFuelCards();\r\n        handleGetDriverBypassServices();\r\n    }\r\n}\r\n\r\n/**\r\n * Main message router - handles all inbound messages from HTML\r\n * @param {Object} msg - Message object with type and data\r\n */\r\nasync function handleHtmlMessage(msg) {\r\n    if (!msg || !msg.type) return;\r\n\r\n    const action = msg.type;\r\n    console.log(`[HTML->Velo] ${action}`, msg.data);\r\n\r\n    try {\r\n        switch (action) {\r\n            case 'ping':\r\n                sendToHtml('pong', { timestamp: Date.now() });\r\n                break;\r\n\r\n            case 'ready':\r\n                sendInitialConfig();\r\n                break;\r\n\r\n            case 'searchParking':\r\n                await handleSearchParking(msg.data);\r\n                break;\r\n\r\n            case 'getParkingDetails':\r\n                await handleGetParkingDetails(msg.data);\r\n                break;\r\n\r\n            case 'reportParking':\r\n                await handleReportParking(msg.data);\r\n                break;\r\n\r\n            case 'searchFuel':\r\n                await handleSearchFuelPrices(msg.data);\r\n                break;\r\n\r\n            case 'linkFuelCard':\r\n                await handleLinkFuelCard(msg.data);\r\n                break;\r\n\r\n            case 'getDriverFuelCards':\r\n                await handleGetDriverFuelCards();\r\n                break;\r\n\r\n            case 'calculateSavings':\r\n                await handleCalculateFuelSavings(msg.data);\r\n                break;\r\n\r\n            // Phase 3: Weigh Station Handlers\r\n            case 'searchWeighStations':\r\n                await handleSearchWeighStations(msg.data);\r\n                break;\r\n\r\n            case 'getStationStatus':\r\n                await handleGetStationStatus(msg.data);\r\n                break;\r\n\r\n            case 'reportStationStatus':\r\n                await handleReportStationStatus(msg.data);\r\n                break;\r\n\r\n            case 'getDriverBypassServices':\r\n                await handleGetDriverBypassServices();\r\n                break;\r\n\r\n            case 'saveDriverBypassServices':\r\n                await handleSaveDriverBypassServices(msg.data);\r\n                break;\r\n\r\n            // Phase 4: Rest Stop Ratings Handlers\r\n            case 'getReviews':\r\n                await handleGetLocationReviews(msg.data);\r\n                break;\r\n\r\n            case 'submitReview':\r\n                await handleSubmitReview(msg.data);\r\n                break;\r\n\r\n            case 'reportCondition':\r\n                await handleReportCondition(msg.data);\r\n                break;\r\n\r\n            case 'voteReview':\r\n                await handleVoteReview(msg.data);\r\n                break;\r\n\r\n            // Phase 5: Weather Handlers\r\n            case 'getWeather':\n                await handleGetWeather(msg.data);\n                break;\n            case 'subscribeAlerts':\n                await handleSubscribeAlerts(msg.data);\n                break;\n\r\n            // Phase 6: Road Conditions\r\n            case 'getRoadConditions':\r\n                await handleGetRoadConditions(msg.data);\r\n                break;\r\n\r\n            case 'getTruckRestrictions':\r\n                await handleGetTruckRestrictions(msg.data);\r\n                break;\r\n\r\n            case 'reportRoadCondition':\r\n                await handleReportRoadCondition(msg.data);\r\n                break;\r\n\r\n            case 'verifyConditionReport':\r\n                await handleVerifyConditionReport(msg.data);\r\n                break;\r\n\r\n            case 'tabSwitch':\r\n            case 'tabChanged':\r\n                handleTabSwitch(msg.data);\r\n                break;\r\n\r\n            default:\r\n                console.warn('[RoadUtilities] Unhandled action:', action);\r\n        }\r\n    } catch (error) {\r\n        console.error('[RoadUtilities] Error handling message:', error);\r\n        sendToHtml('error', {\r\n            message: error.message || 'An unexpected error occurred',\r\n            action: action\r\n        });\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// PARKING ACTION HANDLERS\r\n// ============================================================================\r\n\r\n/**\r\n * Handle parking search request\r\n * @param {Object} data - Search parameters (lat, lng, radius, filters, query)\r\n */\r\nasync function handleSearchParking(data) {\r\n    let lat = parseFloat(data.lat);\r\n    let lng = parseFloat(data.lng);\r\n\r\n    // Use default location if coordinates not provided or invalid\r\n    if (isNaN(lat) || isNaN(lng)) {\r\n        lat = DEFAULT_LOCATION.lat;\r\n        lng = DEFAULT_LOCATION.lng;\r\n    }\r\n\r\n    const radius = parseInt(data.radius, 10) || 25;\r\n    const filters = data.filters || {};\r\n\r\n    // Track analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('parking_finder', userId, 'click', {\r\n        metadata: { query: data.query, radius, filters }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await searchParking(lat, lng, radius, filters);\r\n\r\n    if (result.success) {\r\n        sendToHtml('parkingResults', {\r\n            items: result.items,\r\n            fromCache: result.fromCache || false,\r\n            searchCenter: { lat, lng },\r\n            radius\r\n        });\r\n    } else {\r\n        sendToHtml('error', { message: result.error || 'Failed to search parking' });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle request for parking location details\r\n * @param {Object} data - Contains locationId\r\n */\r\nasync function handleGetParkingDetails(data) {\r\n    if (!data.locationId) {\r\n        sendToHtml('error', { message: 'Location ID is required' });\r\n        return;\r\n    }\r\n\r\n    const result = await getParkingDetails(data.locationId);\r\n\r\n    if (result.success) {\r\n        sendToHtml('parkingDetails', { item: result.item });\r\n    } else {\r\n        sendToHtml('error', { message: result.error || 'Failed to get parking details' });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle parking availability report from driver\r\n * @param {Object} data - Report data (locationId, spacesAvailable, notes)\r\n */\r\nasync function handleReportParking(data) {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('error', { message: 'You must be logged in to report parking status' });\r\n        return;\r\n    }\r\n\r\n    if (!data.locationId) {\r\n        sendToHtml('error', { message: 'Location ID is required' });\r\n        return;\r\n    }\r\n\r\n    const report = {\r\n        driver_id: wixUsers.currentUser.id,\r\n        spaces_available: parseInt(data.spacesAvailable, 10) || 0,\r\n        notes: data.notes || ''\r\n    };\r\n\r\n    // Track analytics\r\n    logFeatureInteraction('parking_finder', wixUsers.currentUser.id, 'report', {\r\n        metadata: { locationId: data.locationId, spacesAvailable: report.spaces_available }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await reportParkingAvailability(data.locationId, report);\r\n\r\n    sendToHtml('reportResult', {\r\n        success: result.success,\r\n        message: result.success ? 'Thank you for your report!' : result.error,\r\n        reportId: result.reportId\r\n    });\r\n}\r\n\r\n// ============================================================================\r\n// FUEL ACTION HANDLERS\r\n// ============================================================================\r\n\r\n/**\r\n * Handle fuel price search request\r\n * @param {Object} data - Search parameters (lat, lng, radius, fuelCardType, query)\r\n */\r\nasync function handleSearchFuelPrices(data) {\r\n    const lat = parseFloat(data.lat) || DEFAULT_LOCATION.lat;\r\n    const lng = parseFloat(data.lng) || DEFAULT_LOCATION.lng;\r\n    const radius = parseInt(data.radius, 10) || 50;\r\n    const fuelCardType = data.fuelCardType || 'none';\r\n\r\n    // Track analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('fuel_optimizer', userId, 'click', {\r\n        metadata: { query: data.query, radius, fuelCardType }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await searchFuelPrices(lat, lng, radius, {\r\n        fuelType: 'diesel',\r\n        cardType: fuelCardType\r\n    });\r\n\r\n    console.log('[RoadUtilities] Fuel search result:', {\r\n        success: result.success,\r\n        itemCount: result.items?.length || 0,\r\n        fromCache: result.fromCache\r\n    });\r\n\r\n    if (result.success) {\r\n        // Map results to include savings based on card type\r\n        // Use discount_applied from fuelService (already calculated)\r\n        const items = result.items.map(station => ({\r\n            ...station,\r\n            savings: station.discount_applied || station.savings_per_gallon || 0,\r\n            accepts_card: fuelCardType !== 'none' && station.accepted_cards?.includes(fuelCardType),\r\n            card_type: fuelCardType !== 'none' ? fuelCardType.toUpperCase() : null\r\n        }));\r\n\r\n        sendToHtml('fuelResults', {\r\n            items,\r\n            fromCache: result.fromCache || false,\r\n            searchCenter: { lat, lng },\r\n            radius\r\n        });\r\n    } else {\r\n        sendToHtml('error', { message: result.error || 'Failed to search fuel prices' });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle fuel card linking request\r\n * @param {Object} data - Card info (cardType, cardLast4, nickname)\r\n */\r\nasync function handleLinkFuelCard(data) {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('error', { message: 'You must be logged in to link a fuel card' });\r\n        return;\r\n    }\r\n\r\n    if (!data.cardType) {\r\n        sendToHtml('error', { message: 'Card type is required' });\r\n        return;\r\n    }\r\n\r\n    const cardInfo = {\r\n        card_type: data.cardType,\r\n        card_last4: data.cardLast4 || '',\r\n        nickname: data.nickname || data.cardType.toUpperCase()\r\n    };\r\n\r\n    // Track analytics\r\n    logFeatureInteraction('fuel_optimizer', wixUsers.currentUser.id, 'link_card', {\r\n        metadata: { cardType: data.cardType }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await linkFuelCard(wixUsers.currentUser.id, cardInfo);\r\n\r\n    sendToHtml('fuelCardLinked', {\r\n        success: result.success,\r\n        message: result.success ? 'Fuel card linked successfully!' : result.error,\r\n        card: result.card\r\n    });\r\n\r\n    // Refresh the card list\r\n    if (result.success) {\r\n        await handleGetDriverFuelCards();\r\n    }\r\n}\r\n\r\n/**\r\n * Handle request for driver's linked fuel cards\r\n */\r\nasync function handleGetDriverFuelCards() {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('fuelCardsLoaded', { cards: [] });\r\n        return;\r\n    }\r\n\r\n    const result = await getDriverFuelCards(wixUsers.currentUser.id);\r\n\r\n    if (result.success) {\r\n        sendToHtml('fuelCardsLoaded', { cards: result.cards || [] });\r\n    } else {\r\n        sendToHtml('fuelCardsLoaded', { cards: [] });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle fuel savings calculation request\r\n * @param {Object} data - Trip details for calculation\r\n */\r\nasync function handleCalculateFuelSavings(data) {\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n\r\n    // Track analytics\r\n    logFeatureInteraction('fuel_optimizer', userId, 'calculate', {\r\n        metadata: { gallons: data.gallons, cardType: data.cardType }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const tripDetails = {\r\n        gallons: data.gallons || 150,\r\n        currentPrice: data.currentPrice,\r\n        cardType: data.cardType,\r\n        stateAverage: data.stateAverage\r\n    };\r\n\r\n    const result = await calculateFuelSavings(userId, tripDetails);\r\n\r\n    sendToHtml('savingsResult', {\r\n        success: result.success,\r\n        ...result\r\n    });\r\n}\r\n\r\n// ============================================================================\r\n// UTILITY HANDLERS\r\n// ============================================================================\r\n\r\n/**\r\n * Handle tab switch event for analytics\r\n * @param {Object} data - Tab switch data (tab name)\r\n */\r\nfunction handleTabSwitch(data) {\r\n    const tabName = data.tab || data;\r\n    console.log(`[RoadUtilities] Tab switched to: ${tabName}`);\r\n\r\n    // Track analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('road_utilities', userId, 'tab_switch', {\r\n        metadata: { tab: tabName }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n}\r\n\r\n// ============================================================================\r\n// WEIGH STATION ACTION HANDLERS (Phase 3)\r\n// ============================================================================\r\n\r\n/**\r\n * Handle weigh station search request\r\n * @param {Object} data - Search parameters (lat, lng, radius, state, bypassServices)\r\n */\r\nasync function handleSearchWeighStations(data) {\r\n    const lat = parseFloat(data.lat) || DEFAULT_LOCATION.lat;\r\n    const lng = parseFloat(data.lng) || DEFAULT_LOCATION.lng;\r\n    const radius = parseInt(data.radius, 10) || 100;\r\n\r\n    // Track analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('weigh_station_finder', userId, 'click', {\r\n        metadata: {\r\n            state: data.state,\r\n            radius,\r\n            bypassServices: data.bypassServices\r\n        }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await searchWeighStations(lat, lng, radius, {\r\n        state: data.state || null,\r\n        bypassServices: data.bypassServices || {}\r\n    });\r\n\r\n    console.log('[RoadUtilities] Weigh station search result:', {\r\n        success: result.success,\r\n        itemCount: result.items?.length || 0,\r\n        fromCache: result.fromCache\r\n    });\r\n\r\n    if (result.success) {\r\n        sendToHtml('weighStationResults', {\r\n            items: result.items,\r\n            fromCache: result.fromCache || false,\r\n            searchCenter: { lat, lng },\r\n            radius\r\n        });\r\n    } else {\r\n        sendToHtml('error', { message: result.error || 'Failed to search weigh stations' });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle request for specific station status\r\n * @param {Object} data - Contains stationId\r\n */\r\nasync function handleGetStationStatus(data) {\r\n    if (!data.stationId) {\r\n        sendToHtml('error', { message: 'Station ID is required' });\r\n        return;\r\n    }\r\n\r\n    const result = await getStationStatus(data.stationId);\r\n\r\n    if (result.success) {\r\n        sendToHtml('stationStatusResult', { station: result.station });\r\n    } else {\r\n        sendToHtml('error', { message: result.error || 'Failed to get station status' });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle station status report from driver\r\n * @param {Object} data - Report data (stationId, reportType, waitMinutes, details)\r\n */\r\nasync function handleReportStationStatus(data) {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('stationStatusResult', {\r\n            success: false,\r\n            message: 'You must be logged in to report station status'\r\n        });\r\n        return;\r\n    }\r\n\r\n    if (!data.stationId) {\r\n        sendToHtml('stationStatusResult', {\r\n            success: false,\r\n            message: 'Station ID is required'\r\n        });\r\n        return;\r\n    }\r\n\r\n    if (!data.reportType) {\r\n        sendToHtml('stationStatusResult', {\r\n            success: false,\r\n            message: 'Report type (open/closed) is required'\r\n        });\r\n        return;\r\n    }\r\n\r\n    const report = {\r\n        driver_id: wixUsers.currentUser.id,\r\n        report_type: data.reportType,\r\n        wait_minutes: data.waitMinutes || null,\r\n        notes: data.details?.join(', ') || ''\r\n    };\r\n\r\n    // Track analytics\r\n    logFeatureInteraction('weigh_station_finder', wixUsers.currentUser.id, 'report', {\r\n        metadata: {\r\n            stationId: data.stationId,\r\n            reportType: data.reportType,\r\n            waitMinutes: data.waitMinutes\r\n        }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await reportStationStatus(data.stationId, report);\r\n\r\n    sendToHtml('stationStatusResult', {\r\n        success: result.success,\r\n        message: result.success ? 'Thanks for your report!' : result.error,\r\n        reportId: result.reportId\r\n    });\r\n}\r\n\r\n/**\r\n * Handle request for driver's bypass service preferences\r\n */\r\nasync function handleGetDriverBypassServices() {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('bypassServicesLoaded', { services: { prepass: false, drivewyze: false } });\r\n        return;\r\n    }\r\n\r\n    const result = await getDriverBypassServices(wixUsers.currentUser.id);\r\n\r\n    if (result.success) {\r\n        sendToHtml('bypassServicesLoaded', { services: result.services || { prepass: false, drivewyze: false } });\r\n    } else {\r\n        sendToHtml('bypassServicesLoaded', { services: { prepass: false, drivewyze: false } });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle saving driver's bypass service preferences\r\n * @param {Object} data - Contains prepass and drivewyze boolean flags\r\n */\r\nasync function handleSaveDriverBypassServices(data) {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('bypassServicesSaved', {\r\n            success: false,\r\n            message: 'You must be logged in to save preferences'\r\n        });\r\n        return;\r\n    }\r\n\r\n    const services = {\r\n        prepass: Boolean(data.prepass),\r\n        drivewyze: Boolean(data.drivewyze)\r\n    };\r\n\r\n    const result = await saveDriverBypassServices(wixUsers.currentUser.id, services);\r\n\r\n    sendToHtml('bypassServicesSaved', {\r\n        success: result.success,\r\n        message: result.success ? 'Preferences saved' : result.error\r\n    });\r\n}\r\n// ============================================================================\r\n// REST STOP RATING HANDLERS (Phase 4)\r\n// ============================================================================\r\n\r\n/**\r\n * Handle request for location reviews\r\n */\r\nasync function handleGetLocationReviews(data) {\r\n    if (!data.locationId) {\r\n        sendToHtml('error', { message: 'Location ID is required' });\r\n        return;\r\n    }\r\n\r\n    // Track analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('rest_stop_ratings', userId, 'view', {\r\n        metadata: { locationId: data.locationId, sort: data.options?.sort }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    // 'all' = browse top-rated across all locations\r\n    const locationId = data.locationId === 'all' ? null : data.locationId;\r\n    const result = await getLocationReviews(locationId, data.options);\r\n\r\n    if (result.success) {\r\n        sendToHtml('reviewsLoaded', {\r\n            locationId: data.locationId,\r\n            reviews: result.reviews,\r\n            stats: result.stats\r\n        });\r\n    } else {\r\n        console.error('[RoadUtilities] Failed to get reviews:', result.error);\r\n        sendToHtml('reviewsLoaded', { locationId: data.locationId, reviews: [], stats: null });\r\n    }\r\n}\r\n\r\n/**\r\n * Handle review submission\r\n */\r\nasync function handleSubmitReview(data) {\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('reviewSubmitted', { success: false, message: 'Must be logged in' });\r\n        return;\r\n    }\r\n\r\n    const { locationId, reviewData } = data;\n    if (!reviewData || !reviewData.userLocation) {\n        sendToHtml('reviewSubmitted', {\n            success: false,\n            message: 'GPS verification required. Enable location to submit reviews.'\n        });\n        return;\n    }\n\r\n    // Track analytics\r\n    logFeatureInteraction('rest_stop_ratings', wixUsers.currentUser.id, 'submit', {\r\n        metadata: { locationId, rating: reviewData.rating }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await submitReview(locationId, reviewData);\r\n\r\n    sendToHtml('reviewSubmitted', {\r\n        success: result.success,\r\n        message: result.success ? 'Review submitted successfully' : result.error,\r\n        review: result.review\r\n    });\r\n}\r\n\r\n/**\r\n * Handle condition report\r\n */\r\nasync function handleReportCondition(data) {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        sendToHtml('conditionReported', { success: false, message: 'Must be logged in' });\r\n        return;\r\n    }\r\n\r\n    const { locationId, reportData } = data;\r\n\r\n    // Track analytics\r\n    logFeatureInteraction('rest_stop_ratings', wixUsers.currentUser.id, 'report', {\r\n        metadata: { locationId, type: reportData.reportType }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await submitConditionReport(locationId, reportData);\r\n\r\n    sendToHtml('conditionReported', {\r\n        success: result.success,\r\n        message: result.success ? 'Report submitted' : result.error\r\n    });\r\n}\r\n\r\n/**\r\n * Handle review upvote/downvote\r\n */\r\nasync function handleVoteReview(data) {\r\n    if (!wixUsers.currentUser.loggedIn) return;\r\n\r\n    const { reviewId, isHelpful } = data;\r\n\r\n    // Track analytics\r\n    logFeatureInteraction('rest_stop_ratings', wixUsers.currentUser.id, 'vote', {\r\n        metadata: { reviewId, helpful: isHelpful }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await voteReview(reviewId, isHelpful);\r\n\r\n    if (result.success) {\r\n        sendToHtml('voteRegistered', { reviewId, helpful_votes: result.helpful_votes });\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// WEATHER HANDLERS (Phase 5)\r\n// ============================================================================\r\n\r\n/**\r\n * Handle weather request\r\n */\r\nasync function handleGetWeather(data) {\n    // Analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('weather_alerts', userId, 'view', {\r\n        metadata: { routePoints_count: data.routePoints ? data.routePoints.length : 0 }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    // 1. Get Chain Laws (Phase 6 logic)\r\n    // Pass routePoints if available, otherwise it returns empty or defaults\r\n    const chainLawsResult = await getChainRequirements(data.routePoints || []);\r\n\r\n    // 2. Get Alerts (Use route points from frontend if available)\r\n    let alerts = [];\r\n    if (data.routePoints && data.routePoints.length > 0) {\r\n        const weatherResult = await getRouteWeather(data.routePoints);\r\n        if (weatherResult.success) alerts = weatherResult.alerts;\r\n    } else {\r\n        // Default: Check Donner Pass\r\n        const alertResult = await getAlertsAtLocation(39.31, -120.33);\r\n        if (alertResult.success) alerts = alertResult.alerts;\r\n    }\r\n\r\n    sendToHtml('weatherResults', {\n        alerts: alerts,\n        chainLaws: chainLawsResult.success ? chainLawsResult.requirements : []\n    });\n}\n\n/**\n * Save driver weather alert preferences (Phase 5 completion)\n */\nasync function handleSubscribeAlerts(data) {\n    if (!wixUsers.currentUser.loggedIn) {\n        sendToHtml('weatherSubscriptionSaved', {\n            success: false,\n            message: 'Must be logged in to save weather alert settings'\n        });\n        return;\n    }\n\n    const preferences = data?.preferences || {};\n    const result = await subscribeToAlerts(wixUsers.currentUser.id, preferences);\n\n    sendToHtml('weatherSubscriptionSaved', {\n        success: result.success,\n        message: result.success ? 'Weather alert preferences saved' : (result.error || 'Unable to save preferences')\n    });\n}\n\r\n// ============================================================================\r\n// ROAD CONDITIONS HANDLERS (Phase 6)\r\n// ============================================================================\r\n\r\nasync function handleGetRoadConditions(data) {\r\n    const { routePoints } = data;\r\n\r\n    // Call backend service\r\n    const result = await getRouteConditions(routePoints); // Phase 6 MVP options\r\n\r\n    // Analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('road_conditions', userId, 'view', {\r\n        metadata: { routePoints_count: routePoints ? routePoints.length : 0 }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    if (result.success) {\r\n        sendToHtml('conditionsResults', {\r\n            conditions: result.conditions,\r\n            summary: result.summary,\r\n            restrictions: [] // Phase 6.1\r\n        });\r\n    } else {\r\n        console.error('[RoadUtilities] Failed to get road conditions:', result.error);\r\n        sendToHtml('conditionsResults', { conditions: [], summary: null });\r\n    }\r\n}\r\n\r\nasync function handleGetTruckRestrictions(data) {\r\n    const { routePoints, truckSpecs } = data;\r\n\r\n    // Analytics\r\n    const userId = wixUsers.currentUser.loggedIn ? wixUsers.currentUser.id : 'anonymous';\r\n    logFeatureInteraction('road_conditions', userId, 'filter', {\r\n        metadata: { truckSpecs }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await getTruckRestrictions(routePoints, truckSpecs);\r\n\r\n    if (result.success) {\r\n        sendToHtml('restrictionResults', {\r\n            restrictions: result.restrictions || []\r\n        });\r\n    } else {\r\n        sendToHtml('restrictionResults', { restrictions: [] });\r\n    }\r\n}\r\n\r\nasync function handleReportRoadCondition(data) {\r\n    if (!wixUsers.currentUser.loggedIn) {\r\n        // Allow anonymous reporting for demo? Or restrict\r\n        // For demo purpose, we might allow it or just flag it\r\n    }\r\n\r\n    const { report } = data;\r\n    // Add user ID if logged in\r\n    if (wixUsers.currentUser.loggedIn) {\r\n        report.driverId = wixUsers.currentUser.id;\r\n    } else {\r\n        report.driverId = 'anonymous';\r\n    }\r\n\r\n    // Analytics\r\n    logFeatureInteraction('road_conditions', report.driverId, 'report', {\r\n        metadata: { type: report.type, highway: report.highway }\r\n    }).catch(err => console.warn('[RoadUtilities] Analytics error:', err));\r\n\r\n    const result = await reportCondition(report);\r\n    sendToHtml('roadConditionReported', {\r\n        success: result.success,\r\n        reportId: result.reportId\r\n    });\r\n}\r\n\r\nasync function handleVerifyConditionReport(data) {\r\n    if (!wixUsers.currentUser.loggedIn) return;\r\n    const { reportId } = data;\r\n    const result = await verifyConditionReport(reportId, wixUsers.currentUser.id);\r\n    if (result.success) {\r\n        // Optionally send confirmation back\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Subscription Canceled.exqj3.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'recordCheckoutAbandonment' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":35},{"ruleId":"no-unused-vars","severity":1,"message":"'markAbandonmentRecovered' is defined but never used.","line":16,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":61}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Subscription Canceled Page Code\r\n * Handles checkout abandonment recovery flow\r\n *\r\n * Setup Instructions:\r\n * 1. Create a new page in Wix called \"Subscription Canceled\" (URL: /subscription-canceled)\r\n * 2. Add an HTML iframe component and embed Subscription_Canceled.html\r\n * 3. Copy this code to the page code panel in Wix Editor\r\n *\r\n * Element IDs:\r\n * - #html1 (or similar) - HTML component containing Subscription_Canceled.html\r\n */\r\n\r\nimport wixLocation from 'wix-location';\r\nimport wixWindow from 'wix-window';\r\nimport { recordCheckoutAbandonment, markAbandonmentRecovered } from 'backend/scheduler';\r\n\r\n$w.onReady(async function () {\r\n  console.log('Subscription Canceled page initialized');\r\n\r\n  // Get URL parameters\r\n  const sessionId = wixLocation.query.session_id || null;\r\n  const plan = wixLocation.query.plan || null;\r\n\r\n  console.log(`Abandonment page loaded - Session: ${sessionId}, Plan: ${plan}`);\r\n\r\n  // Initialize HTML component handler\r\n  initAbandonmentPageHandler(sessionId, plan);\r\n});\r\n\r\n/**\r\n * Initialize the abandonment page HTML component handler\r\n * Handles messages from Subscription_Canceled.html\r\n */\r\nfunction initAbandonmentPageHandler(sessionId, plan) {\r\n  // Try multiple possible HTML component IDs\r\n  const possibleIds = ['#html1', '#html2', '#html3', '#html4', '#html5', '#htmlComponent', '#abandonmentHtml'];\r\n  let htmlComponent = null;\r\n\r\n  for (const id of possibleIds) {\r\n    try {\r\n      const component = $w(id);\r\n      if (component && typeof component.onMessage === 'function') {\r\n        htmlComponent = component;\r\n        console.log(`Abandonment handler attached to ${id}`);\r\n        break;\r\n      }\r\n    } catch (e) {\r\n      // Component doesn't exist, try next\r\n    }\r\n  }\r\n\r\n  if (!htmlComponent) {\r\n    console.log('No HTML component found for abandonment page');\r\n    return;\r\n  }\r\n\r\n  // Listen for messages from the HTML component\r\n  htmlComponent.onMessage(async (event) => {\r\n    const msg = event.data;\r\n    if (!msg || !msg.type) return;\r\n\r\n    console.log('Abandonment page received message:', msg.type);\r\n\r\n    // Handle page ready signal - HTML component is loaded\r\n    if (msg.type === 'abandonmentPageReady') {\r\n      console.log('Abandonment page HTML ready:', msg.data);\r\n\r\n      // Record the abandonment if we have session data\r\n      // Note: The actual tracking happens via Stripe webhook (checkout.session.expired)\r\n      // This is just for analytics/logging on the client side\r\n      try {\r\n        if (typeof wixWindow !== 'undefined' && wixWindow.trackEvent) {\r\n          wixWindow.trackEvent('CheckoutAbandoned', {\r\n            sessionId: msg.data?.sessionId || sessionId,\r\n            plan: msg.data?.plan || plan,\r\n            page: 'subscription-canceled'\r\n          });\r\n        }\r\n      } catch (e) {\r\n        console.log('Analytics tracking not available');\r\n      }\r\n    }\r\n\r\n    // Handle return to checkout action\r\n    if (msg.type === 'returnToCheckout') {\r\n      console.log('User returning to checkout');\r\n\r\n      // Track the recovery attempt\r\n      try {\r\n        if (typeof wixWindow !== 'undefined' && wixWindow.trackEvent) {\r\n          wixWindow.trackEvent('AbandonmentRecoveryAttempt', {\r\n            action: 'returnToCheckout',\r\n            sessionId: sessionId,\r\n            plan: plan\r\n          });\r\n        }\r\n      } catch (e) {\r\n        // Non-critical\r\n      }\r\n\r\n      // Redirect back to pricing page\r\n      wixLocation.to('/pricing');\r\n    }\r\n\r\n    // Handle schedule demo action\r\n    if (msg.type === 'scheduleDemo') {\r\n      console.log('User requesting demo');\r\n\r\n      // Track demo request\r\n      try {\r\n        if (typeof wixWindow !== 'undefined' && wixWindow.trackEvent) {\r\n          wixWindow.trackEvent('AbandonmentRecoveryAttempt', {\r\n            action: 'scheduleDemo',\r\n            sessionId: sessionId,\r\n            plan: plan\r\n          });\r\n        }\r\n      } catch (e) {\r\n        // Non-critical\r\n      }\r\n\r\n      // Redirect to contact/demo page\r\n      // Update this URL if you have a dedicated demo scheduling page\r\n      wixLocation.to('/contact');\r\n    }\r\n\r\n    // Handle compare plans action\r\n    if (msg.type === 'comparePlans') {\r\n      console.log('User comparing plans');\r\n\r\n      // Track comparison request\r\n      try {\r\n        if (typeof wixWindow !== 'undefined' && wixWindow.trackEvent) {\r\n          wixWindow.trackEvent('AbandonmentRecoveryAttempt', {\r\n            action: 'comparePlans',\r\n            sessionId: sessionId,\r\n            plan: plan\r\n          });\r\n        }\r\n      } catch (e) {\r\n        // Non-critical\r\n      }\r\n\r\n      // Redirect to pricing page\r\n      wixLocation.to('/pricing');\r\n    }\r\n\r\n    // Handle abandonment feedback submission\r\n    if (msg.type === 'abandonmentFeedback') {\r\n      try {\r\n        const { reason, sessionId: feedbackSessionId, plan: feedbackPlan, timestamp } = msg.data;\r\n\r\n        console.log('Abandonment feedback received:', reason);\r\n\r\n        // Track the feedback\r\n        try {\r\n          if (typeof wixWindow !== 'undefined' && wixWindow.trackEvent) {\r\n            wixWindow.trackEvent('AbandonmentFeedback', {\r\n              reason: reason,\r\n              sessionId: feedbackSessionId || sessionId,\r\n              plan: feedbackPlan || plan,\r\n              timestamp: timestamp\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // Non-critical\r\n        }\r\n\r\n        // Store feedback in database (optional - uncomment if you want to persist feedback)\r\n        // await saveAbandonmentFeedback(feedbackSessionId || sessionId, reason, feedbackPlan || plan);\r\n\r\n        // Send confirmation back to HTML component\r\n        htmlComponent.postMessage({\r\n          type: 'feedbackSubmitted',\r\n          data: { success: true }\r\n        });\r\n\r\n        console.log('Feedback submitted successfully');\r\n\r\n      } catch (error) {\r\n        console.error('Error submitting feedback:', error);\r\n        htmlComponent.postMessage({\r\n          type: 'feedbackSubmitted',\r\n          data: { success: false, error: 'Failed to submit feedback' }\r\n        });\r\n      }\r\n    }\r\n\r\n    // Handle redirect requests from HTML component\r\n    if (msg.type === 'redirectToUrl' && msg.data?.url) {\r\n      wixLocation.to(msg.data.url);\r\n    }\r\n  });\r\n\r\n  // Send initial data to HTML component (session info if available)\r\n  setTimeout(() => {\r\n    htmlComponent.postMessage({\r\n      type: 'initAbandonmentPage',\r\n      data: {\r\n        sessionId: sessionId,\r\n        plan: plan,\r\n        baseUrl: wixLocation.baseUrl\r\n      }\r\n    });\r\n  }, 500);\r\n}\r\n\r\n/**\r\n * Optional: Save abandonment feedback to database\r\n * Uncomment and customize if you want to persist feedback\r\n */\r\n// async function saveAbandonmentFeedback(sessionId, reason, plan) {\r\n//   try {\r\n//     const wixData = await import('wix-data');\r\n//     await wixData.insert('AbandonmentFeedback', {\r\n//       sessionId: sessionId,\r\n//       reason: reason,\r\n//       plan: plan,\r\n//       submittedAt: new Date()\r\n//     }, { suppressAuth: true });\r\n//   } catch (e) {\r\n//     console.error('Failed to save feedback:', e);\r\n//   }\r\n// }\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Subscription Success.o76p8.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Truck Drivers .gsx0g.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":50,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":50,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1783,1784],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":59,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":59,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2004,2005],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":78,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":78,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2498,2499],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":95,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":95,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3376,3377],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":104,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":104,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3624,3625],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":122,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":122,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4083,4084],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":132,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":132,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4353,4354],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":139,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":139,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4516,4517],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":150,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":150,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5043,5044],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":172,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":172,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5563,5564],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":194,"column":15,"nodeType":"BlockStatement","messageId":"unexpected","endLine":194,"endColumn":18,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6189,6190],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Truck Drivers Page\r\n * Landing page for drivers - shows job opportunities, benefits, and drives signups\r\n *\r\n * @see docs/PAGE_DATA_IMPLEMENTATION_GUIDE.md\r\n */\r\n\r\nimport wixLocation from 'wix-location';\r\nimport { getTopJobOpportunities, getJobsByState, getRecentHires } from 'backend/publicStatsService';\r\nimport { getDriverTestimonials } from 'backend/contentService';\r\n\r\n$w.onReady(async function () {\r\n  await Promise.all([\r\n    loadJobHighlights(),\r\n    loadDriverTestimonials(),\r\n    loadLocationBasedJobs(),\r\n    loadRecentHiresTicker()\r\n  ]);\r\n\r\n  // Set up HTML component message handlers\r\n  setupHtmlMessageHandlers();\r\n});\r\n\r\n/**\r\n * Load top job opportunities sorted by pay\r\n * Element: #jobHighlightsRepeater\r\n */\r\nasync function loadJobHighlights() {\r\n  try {\r\n    const jobs = await getTopJobOpportunities(6);\r\n\r\n    const repeater = $w('#jobHighlightsRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = jobs;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#carrierName').rendered) $item('#carrierName').text = itemData.carrierName;\r\n          if ($item('#jobPayRange').rendered) $item('#jobPayRange').text = itemData.payRange;\r\n          if ($item('#jobLocation').rendered) $item('#jobLocation').text = itemData.location;\r\n          if ($item('#jobType').rendered) $item('#jobType').text = itemData.operationType;\r\n          if ($item('#jobBenefits').rendered) $item('#jobBenefits').text = itemData.benefits;\r\n\r\n          const learnMoreBtn = $item('#learnMoreBtn');\r\n          if (learnMoreBtn.rendered) {\r\n            learnMoreBtn.onClick(() => {\r\n              wixLocation.to(`/ai-matching?carrier=${itemData._id}`);\r\n            });\r\n          }\r\n        } catch (e) { }\r\n      });\r\n    }\r\n\r\n    try {\r\n      const htmlJobs = $w('#jobsFeedHtml');\r\n      if (htmlJobs.rendered && htmlJobs.postMessage) {\r\n        htmlJobs.postMessage({ type: 'jobsData', jobs });\r\n      }\r\n    } catch (e) { }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load job highlights:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Load driver testimonials\r\n * Element: #testimonialsRepeater\r\n */\r\nasync function loadDriverTestimonials() {\r\n  try {\r\n    const result = await getDriverTestimonials(3);\r\n\r\n    if (!result.success || result.testimonials.length === 0) {\r\n      try {\r\n        const section = $w('#testimonialsSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#testimonialsRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = result.testimonials;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#testimonialQuote').rendered) $item('#testimonialQuote').text = `\"${itemData.quote}\"`;\r\n          if ($item('#testimonialName').rendered) $item('#testimonialName').text = itemData.driverName;\r\n          if ($item('#testimonialExp').rendered) $item('#testimonialExp').text = `${itemData.yearsExperience} years experience`;\r\n          if ($item('#testimonialType').rendered) $item('#testimonialType').text = itemData.operationType;\r\n          if ($item('#testimonialPhoto').rendered && itemData.photoUrl) {\r\n            $item('#testimonialPhoto').src = itemData.photoUrl;\r\n          }\r\n        } catch (e) { }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load testimonials:', err);\r\n    try {\r\n      const section = $w('#testimonialsSection');\r\n      if (section.rendered && section.collapse) section.collapse();\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\n/**\r\n * Load location-based job suggestions\r\n * Uses URL query param or collapses section\r\n * Element: #locationJobsRepeater\r\n */\r\nasync function loadLocationBasedJobs() {\r\n  try {\r\n    const query = wixLocation.query;\r\n    const userState = query.state || null;\r\n\r\n    if (!userState) {\r\n      try {\r\n        const section = $w('#locationJobsSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    const jobs = await getJobsByState(userState, 4);\r\n\r\n    if (jobs.length === 0) {\r\n      try {\r\n        const section = $w('#locationJobsSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const title = $w('#locationTitle');\r\n      if (title.rendered) title.text = `Jobs in ${userState}`;\r\n    } catch (e) { }\r\n\r\n    const repeater = $w('#locationJobsRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = jobs;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#locJobCarrier').rendered) $item('#locJobCarrier').text = itemData.carrierName;\r\n          if ($item('#locJobPay').rendered) $item('#locJobPay').text = itemData.payRange;\r\n          if ($item('#locJobType').rendered) $item('#locJobType').text = itemData.operationType;\r\n        } catch (e) { }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load location-based jobs:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Load recent hires for social proof ticker\r\n * Element: #hireTicker (HTML component)\r\n */\r\nasync function loadRecentHiresTicker() {\r\n  try {\r\n    const hires = await getRecentHires(10);\r\n\r\n    try {\r\n      const htmlTicker = $w('#hireTicker');\r\n      if (htmlTicker.rendered && htmlTicker.postMessage) {\r\n        htmlTicker.postMessage({ type: 'recentHires', hires });\r\n      }\r\n    } catch (e) { }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load recent hires:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Set up message handlers for HTML components\r\n */\r\nfunction setupHtmlMessageHandlers() {\r\n  try {\r\n    const htmlJobs = $w('#jobsFeedHtml');\r\n    if (htmlJobs.rendered && htmlJobs.onMessage) {\r\n      htmlJobs.onMessage((event) => {\r\n        if (event.data.type === 'navigateToMatching') {\r\n          const carrierId = event.data.data?.preselectedCarrier;\r\n          if (carrierId) wixLocation.to(`/ai-matching?carrier=${carrierId}`);\r\n          else wixLocation.to('/ai-matching');\r\n        }\r\n      });\r\n    }\r\n  } catch (e) { }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\Trucking Companies.iq65y.js","messages":[{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":64,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":64,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[2659,2660],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":86,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":86,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3342,3343],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":94,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":94,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3567,3568],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":113,"column":19,"nodeType":"BlockStatement","messageId":"unexpected","endLine":113,"endColumn":22,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4077,4078],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":126,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":126,"endColumn":24,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4699,4700],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":135,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":135,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4962,4963],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":159,"column":15,"nodeType":"BlockStatement","messageId":"unexpected","endLine":159,"endColumn":18,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[5600,5601],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Trucking Companies Page\r\n * Landing page for carriers - shows platform benefits, pricing, and drives recruiter signups\r\n *\r\n * @see docs/PAGE_DATA_IMPLEMENTATION_GUIDE.md\r\n */\r\n\r\nimport wixLocation from 'wix-location';\r\nimport { getCarrierPlatformStats } from 'backend/publicStatsService';\r\nimport { submitCarrierStaffingRequest, submitCarrierIntakePreferences } from 'backend/carrierLeadsService';\r\nimport { getCarrierTestimonials } from 'backend/contentService';\r\n\r\n$w.onReady(async function () {\r\n  console.log('[VELO] ? Trucking Companies page onReady fired');\r\n\r\n  // Setup form handler for embedded HTML component\r\n  setupCarrierFormHandler();\r\n\r\n  await Promise.all([\r\n    loadCarrierStats(),\r\n    loadCarrierTestimonials(),\r\n    initROICalculator()\r\n  ]);\r\n});\r\n\r\n/**\r\n * Setup handler for carrier staffing form in HTML component\r\n */\r\nfunction setupCarrierFormHandler() {\r\n  const possibleIds = ['#html1', '#html2', '#html3', '#html4', '#html5', '#carrierFormHtml', '#truckingFormHtml'];\r\n\r\n  possibleIds.forEach(htmlId => {\r\n    try {\r\n      const htmlComponent = $w(htmlId);\r\n      if (htmlComponent.rendered && htmlComponent.onMessage) {\r\n        htmlComponent.onMessage(async (event) => {\r\n          if (!event.data || typeof event.data !== 'object') return;\r\n\r\n          if (event.data.type === 'submitCarrierStaffingRequest') {\r\n            try {\r\n              const result = await submitCarrierStaffingRequest(event.data.data);\r\n              htmlComponent.postMessage({ type: 'staffingRequestResult', data: { success: true, leadId: result?.leadId || result?._id || 'unknown' } });\r\n              if (result.success && result.leadId) {\r\n                setTimeout(() => { wixLocation.to(`/checkout?id=${result.leadId}`); }, 1500);\r\n              }\r\n            } catch (error) {\r\n              htmlComponent.postMessage({ type: 'staffingRequestResult', success: false, error: error.message });\r\n            }\r\n          }\r\n\r\n          if (event.data.type === 'submitCarrierIntakePreferences') {\r\n            try {\r\n              await submitCarrierIntakePreferences(event.data.data);\r\n              htmlComponent.postMessage({ type: 'intakePreferencesResult', data: { success: true } });\r\n            } catch (error) {\r\n              htmlComponent.postMessage({ type: 'intakePreferencesResult', data: { success: false, error: error.message } });\r\n            }\r\n          }\r\n\r\n          if (event.data.type === 'navigateToPreferences') wixLocation.to('/recruiter-driver-search?openSettings=true');\r\n          if (event.data.type === 'navigateToDashboard') wixLocation.to('/recruiter-console');\r\n        });\r\n      }\r\n    } catch (e) { }\r\n  });\r\n}\r\n\r\n/**\r\n * Load platform stats formatted for carrier audience\r\n */\r\nasync function loadCarrierStats() {\r\n  try {\r\n    const stats = await getCarrierPlatformStats();\r\n\r\n    const statElements = {\r\n      '#statQualifiedDrivers': stats.qualifiedDrivers.toLocaleString(),\r\n      '#statAvgTimeToHire': `${stats.avgDaysToHire} days`,\r\n      '#statRetentionRate': `${stats.retentionRate}%`,\r\n      '#statCostPerHire': `$${stats.avgCostPerHire}`\r\n    };\r\n\r\n    Object.entries(statElements).forEach(([selector, value]) => {\r\n      try {\r\n        const element = $w(selector);\r\n        if (element.rendered && element.text !== undefined) element.text = value;\r\n      } catch (e) { }\r\n    });\r\n\r\n    try {\r\n      const htmlStats = $w('#carrierStatsHtml');\r\n      if (htmlStats.rendered && htmlStats.postMessage) {\r\n        htmlStats.postMessage({ type: 'carrierStats', stats });\r\n      }\r\n    } catch (e) { }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load carrier stats:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Load carrier testimonials\r\n * Element: #carrierTestimonialsRepeater\r\n */\r\nasync function loadCarrierTestimonials() {\r\n  try {\r\n    const result = await getCarrierTestimonials(3);\r\n\r\n    if (!result.success || result.testimonials.length === 0) {\r\n      try {\r\n        const section = $w('#carrierTestimonialsSection');\r\n        if (section.rendered && section.collapse) section.collapse();\r\n      } catch (e) { }\r\n      return;\r\n    }\r\n\r\n    const repeater = $w('#carrierTestimonialsRepeater');\r\n    if (repeater.rendered && repeater.data !== undefined) {\r\n      repeater.data = result.testimonials;\r\n\r\n      repeater.onItemReady(($item, itemData) => {\r\n        try {\r\n          if ($item('#testimonialQuote').rendered) $item('#testimonialQuote').text = `\"${itemData.quote}\"`;\r\n          if ($item('#testimonialCompany').rendered) $item('#testimonialCompany').text = itemData.carrierName;\r\n          if ($item('#testimonialLogo').rendered && itemData.logoUrl) $item('#testimonialLogo').src = itemData.logoUrl;\r\n        } catch (e) { }\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Failed to load carrier testimonials:', err);\r\n    try {\r\n      const section = $w('#carrierTestimonialsSection');\r\n      if (section.rendered && section.collapse) section.collapse();\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize ROI Calculator HTML component\r\n */\r\nasync function initROICalculator() {\r\n  try {\r\n    const htmlCalc = $w('#roiCalculatorHtml');\r\n    if (!htmlCalc || !htmlCalc.postMessage) return;\r\n\r\n    const marketData = {\r\n      avgCostPerHireTraditional: 8500, avgCostPerHireLMDR: 299,\r\n      avgTimeToHireTraditional: 45, avgTimeToHireLMDR: 14,\r\n      avgTurnoverCost: 12000\r\n    };\r\n\r\n    htmlCalc.postMessage({ type: 'marketData', data: marketData });\r\n\r\n    htmlCalc.onMessage((event) => {\r\n      if (event.data.type === 'navigateToCarrierSignup') wixLocation.to('/carrier-welcome');\r\n    });\r\n\r\n  } catch (e) { }\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\pages\\masterPage.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\TruckingCompaniesForm.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\_TEMPLATE_bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\_TEMPLATE_html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\__mocks__\\wix-data.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\__mocks__\\wix-fetch.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\__mocks__\\wix-media-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\__mocks__\\wix-members-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\__mocks__\\wix-secrets-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\__mocks__\\wix-users-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\achievementService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminAgent.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminAiRouter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminAuditLog.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminAuditLog.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminBillingManagement.test.js","messages":[],"suppressedMessages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\Z.","line":328,"column":120,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":328,"endColumn":121,"suggestions":[{"messageId":"removeEscape","fix":{"range":[13621,13622],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[13621,13621],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminCarriers.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminCommissions.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminContent.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminContent.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminDashboard.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminDashboard.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminDrivers.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminDrivers.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminFeatureAdoption.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminFeatureAdoption.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminGamificationAnalytics.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminGamificationAnalytics.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminInvoicing.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminMatches.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminMatches.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminModeration.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminModeration.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminObservability.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminObservability.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminRevenueDashboard.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminRouters.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\adminUtilityExpansion.backend.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\agentEvaluationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\agentService.e2e.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\agentService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\aiMatching.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\aiMatching.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\airtableClient.fieldMappings.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\airtableStrictSchema.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\apiAuthService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\apiGateway.external.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\apiWebhookJobs.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\apiWebhookService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\applicationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\arrayUtils.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\autopilotService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bAccountDetail.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bAccountDetail.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bAnalytics.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bAnalytics.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bBridgeService.test.js","messages":[],"suppressedMessages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":259,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":259,"endColumn":74,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bCampaigns.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bCampaigns.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bDashboard.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bDashboard.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bLeadCapture.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bLeadCapture.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bOutreach.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bOutreach.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bPipeline.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bPipeline.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bResearchPanel.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bResearchPanel.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\b2bSecurityService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\anomalyDetection.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\costOptimizer.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\emailTemplateService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\experimentService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\flagService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\notificationRulesService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\backend\\observabilityService.persistence.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\badgeService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\callOutcomeService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierAgent.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierAnnouncements.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierAnnouncements.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierB2BRouters.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierFleetDashboard.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierFleetDashboard.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierLeadsService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierPolicies.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierPolicies.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierStatusService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierWelcome.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\carrierWelcome.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\challengeService.test.js","messages":[],"suppressedMessages":[{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":62,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":62,"endColumn":49,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":63,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":63,"endColumn":64,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\challenges.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\challenges.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\checkout.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\checkout.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\compendiumService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\complianceCalendar.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\complianceCalendar.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\crossRolePaidMediaPipelineRouter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\crossRoleRouters.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\csaMonitor.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\csaMonitor.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\csaMonitorService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\documentCollectionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\documentVault.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\documentVault.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\dqTracker.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\dqTracker.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverAgent.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverAnnouncements.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverAnnouncements.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverBadges.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverBadges.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverDashboard.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverDashboard.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverForums.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverForums.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverGamification.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverGamification.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverNormalizer.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverPolicies.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverPolicies.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\driverRouters.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\emailCampaignService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalApiPlatformPhase8.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalApiPlatformPhase8Flows.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalDocumentApi.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalEngagementApi.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalFuelApi.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalIntelligenceApi.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalMatchingApi.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalParkingApi.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\externalSafetyApis.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\featureAdoptionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\feedbackLoopService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\fleetDashboard.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\forumService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\gamificationConfig.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\gamificationIntegration.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\gamificationPageHandlers.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\gamificationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\healthService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\incidentReporting.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\incidentReporting.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\interventionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\jobBoardService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\leaderboardService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\marketIntelligenceService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\matchExplanationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\matchNotifications.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\mentorService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaAdsAuthService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaAttributionBridgeService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaGovernanceRouter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaGovernanceService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaInsightsService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaOptimizationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaPaidMediaServices.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\metaReliabilityService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\moderationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\mutualInterestService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\onboardingWorkflowService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\petFriendlyService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\pipelineAutomationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\pipelineExecutionAgent.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\quickApply.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\quickApply.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\rateLimitService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterAgent.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterAnalyticsService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterAttribution.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterAttribution.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterCompetitorIntel.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterCompetitorIntel.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterConsole.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterConsole.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterCostAnalysis.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterCostAnalysis.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterDriverSearch.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterDriverSearch.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterFunnel.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterFunnel.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterGamification.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterGamification.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterLeaderboard.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterLeaderboard.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterLifecycleMonitor.html.test.js","messages":[],"suppressedMessages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":19,"column":49,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":19,"endColumn":50,"suggestions":[{"messageId":"removeEscape","fix":{"range":[720,721],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[720,720],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":19,"column":56,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":19,"endColumn":57,"suggestions":[{"messageId":"removeEscape","fix":{"range":[727,728],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[727,727],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":23,"column":52,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":23,"endColumn":53,"suggestions":[{"messageId":"removeEscape","fix":{"range":[843,844],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[843,843],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":23,"column":62,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":23,"endColumn":63,"suggestions":[{"messageId":"removeEscape","fix":{"range":[853,854],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[853,853],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":27,"column":49,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":27,"endColumn":50,"suggestions":[{"messageId":"removeEscape","fix":{"range":[961,962],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[961,961],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":27,"column":62,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":27,"endColumn":63,"suggestions":[{"messageId":"removeEscape","fix":{"range":[974,975],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[974,974],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":99,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":99,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[3616,3617],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[3616,3616],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":99,"column":60,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":99,"endColumn":61,"suggestions":[{"messageId":"removeEscape","fix":{"range":[3639,3640],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[3639,3639],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":121,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":121,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4423,4424],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4423,4423],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":121,"column":52,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":121,"endColumn":53,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4438,4439],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4438,4438],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":125,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":125,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4536,4537],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4536,4536],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":125,"column":52,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":125,"endColumn":53,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4551,4552],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4551,4551],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":125,"column":68,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":125,"endColumn":69,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4567,4568],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4567,4567],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":125,"column":74,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":125,"endColumn":75,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4573,4574],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4573,4573],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":163,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":163,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[5901,5902],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[5901,5901],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":163,"column":50,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":163,"endColumn":51,"suggestions":[{"messageId":"removeEscape","fix":{"range":[5914,5915],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[5914,5914],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":167,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":167,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6017,6018],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6017,6017],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":167,"column":57,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":167,"endColumn":58,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6037,6038],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6037,6037],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":171,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":171,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6141,6142],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6141,6141],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":171,"column":54,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":171,"endColumn":55,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6158,6159],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6158,6158],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":175,"column":40,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":175,"endColumn":41,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6296,6297],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6296,6296],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":175,"column":53,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":175,"endColumn":54,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6309,6310],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6309,6309],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":176,"column":40,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":176,"endColumn":41,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6357,6358],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6357,6357],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":176,"column":56,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":176,"endColumn":57,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6373,6374],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6373,6373],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":177,"column":40,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":177,"endColumn":41,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6421,6422],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6421,6421],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":177,"column":53,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":177,"endColumn":54,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6434,6435],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6434,6434],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":178,"column":40,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":178,"endColumn":41,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6482,6483],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6482,6482],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":178,"column":49,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":178,"endColumn":50,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6491,6492],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6491,6491],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":182,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":182,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6588,6589],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6588,6588],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":182,"column":54,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":182,"endColumn":55,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6605,6606],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6605,6605],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":196,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":196,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7146,7147],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7146,7146],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":196,"column":51,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":196,"endColumn":52,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7160,7161],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7160,7160],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":200,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":200,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7271,7272],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7271,7271],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":200,"column":58,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":200,"endColumn":59,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7292,7293],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7292,7292],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":204,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":204,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7388,7389],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7388,7388],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":204,"column":51,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":204,"endColumn":52,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7402,7403],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7402,7402],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":215,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":215,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7867,7868],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7867,7867],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":215,"column":54,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":215,"endColumn":55,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7884,7885],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7884,7884],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":219,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":219,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[7989,7990],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[7989,7989],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":219,"column":56,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":219,"endColumn":57,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8008,8009],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8008,8008],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":223,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":223,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8126,8127],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8126,8126],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":223,"column":61,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":223,"endColumn":62,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8150,8151],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8150,8150],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":227,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":227,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8252,8253],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8252,8252],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":227,"column":51,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":227,"endColumn":52,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8266,8267],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8266,8266],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":231,"column":37,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":231,"endColumn":38,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8371,8372],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8371,8371],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\\".","line":231,"column":52,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":231,"endColumn":53,"suggestions":[{"messageId":"removeEscape","fix":{"range":[8386,8387],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[8386,8386],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterOS.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterOS.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterOnboarding.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterOnboarding.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterPaidMediaAnalyticsRouter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterPaidMediaRouter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterPredictions.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterPredictions.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\recruiterRouters.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\referralService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\reputationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\restStopService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\retentionDashboard.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\retentionDashboard.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\retentionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\retentionServiceCarrier.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\roadConditionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\roadUtilities.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\roadUtilities.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\savedSearchService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\seasonalEventService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\selfHealingService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\smsCampaignService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\socialPostingService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\staffingFormBridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\streakService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\stripeWebhookCommission.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\subscriptionSuccess.bridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\subscriptionSuccess.html.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\voiceBridge.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\voiceService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\weatherAlertService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\__tests__\\weighStationService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\admin-agent-kpis.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\admin-agent.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'gateId' is assigned a value but never used.","line":178,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":178,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ADMIN-AGENT  VelocityMatch Admin Agent Chat Overlay\r\n// Floating chat FAB + sliding panel for conversational admin management\r\n// ============================================================================\r\n\r\n(function () {\r\n  'use strict';\r\n\r\n  let panelOpen = false;\r\n  let messages = [];\r\n\r\n  // -- Build UI --\r\n  function init() {\r\n    if (document.getElementById('vm-agent-fab')) return;\r\n\r\n    // FAB button\r\n    const fab = document.createElement('button');\r\n    fab.id = 'vm-agent-fab';\r\n    fab.innerHTML = `<span style=\"font-size:22px;font-weight:700;font-family:Inter,sans-serif;letter-spacing:-0.5px\">VM</span>`;\r\n    Object.assign(fab.style, {\r\n      position: 'fixed', bottom: '90px', right: '24px', width: '48px', height: '48px',\r\n      borderRadius: '50%', border: 'none', cursor: 'pointer', zIndex: '9998',\r\n      background: 'linear-gradient(135deg, #2563eb, #1e40af)',\r\n      color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n      boxShadow: '0 4px 16px rgba(37,99,235,0.4)', transition: 'transform 0.2s'\r\n    });\r\n    fab.addEventListener('mouseenter', () => { fab.style.transform = 'scale(1.1)'; });\r\n    fab.addEventListener('mouseleave', () => { fab.style.transform = 'scale(1)'; });\r\n    fab.addEventListener('click', togglePanel);\r\n    document.body.appendChild(fab);\r\n\r\n    // Panel\r\n    const panel = document.createElement('div');\r\n    panel.id = 'vm-agent-panel';\r\n    Object.assign(panel.style, {\r\n      position: 'fixed', top: '0', right: '-380px', width: '360px', height: '100%',\r\n      background: '#0f172a', borderLeft: '1px solid #1e293b', zIndex: '9999',\r\n      display: 'flex', flexDirection: 'column', transition: 'right 0.3s ease',\r\n      fontFamily: 'Inter, sans-serif'\r\n    });\r\n    panel.innerHTML = `\r\n      <div style=\"padding:16px 20px;border-bottom:1px solid #1e293b;display:flex;align-items:center;justify-content:space-between\">\r\n        <div style=\"display:flex;align-items:center;gap:10px\">\r\n          <div style=\"width:32px;height:32px;border-radius:10px;background:linear-gradient(135deg,#2563eb,#1e40af);display:flex;align-items:center;justify-content:center\">\r\n            <span style=\"font-size:12px;font-weight:700;color:#fff\">VM</span>\r\n          </div>\r\n          <div>\r\n            <div style=\"font-size:14px;font-weight:600;color:#f8fafc\">Admin Assistant</div>\r\n            <div style=\"font-size:11px;color:#94a3b8\">VelocityMatch AI</div>\r\n          </div>\r\n        </div>\r\n        <button id=\"vm-agent-close\" style=\"background:none;border:none;cursor:pointer;color:#94a3b8;font-size:20px\">&times;</button>\r\n      </div>\r\n      <div id=\"vm-agent-messages\" style=\"flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:12px\"></div>\r\n      <div style=\"padding:12px 16px;border-top:1px solid #1e293b;display:flex;gap:8px\">\r\n        <input id=\"vm-agent-input\" type=\"text\" placeholder=\"Ask about system health, drivers, AI usage...\"\r\n          style=\"flex:1;background:#1e293b;border:1px solid #334155;border-radius:10px;padding:10px 14px;color:#f8fafc;font-size:13px;outline:none\" />\r\n        <button id=\"vm-agent-send\"\r\n          style=\"background:linear-gradient(135deg,#2563eb,#1e40af);border:none;border-radius:10px;width:40px;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#fff;font-size:16px\">&#10148;</button>\r\n      </div>`;\r\n    document.body.appendChild(panel);\r\n\r\n    document.getElementById('vm-agent-close').addEventListener('click', togglePanel);\r\n    document.getElementById('vm-agent-send').addEventListener('click', sendMessage);\r\n    document.getElementById('vm-agent-input').addEventListener('keydown', (e) => {\r\n      if (e.key === 'Enter') sendMessage();\r\n    });\r\n\r\n    // Welcome message\r\n    addBotMessage('Welcome! I can help you check system health, review AI usage, manage drivers, resolve alerts, and more. What would you like to do?');\r\n\r\n    // Init voice if available\r\n    if (window.VoiceAgent) {\r\n      window.VoiceAgent.init({\r\n        containerId: 'vm-agent-panel',\r\n        branding: { name: 'VelocityMatch', logo: 'VM', primaryColor: '#2563eb' }\r\n      });\r\n    }\r\n  }\r\n\r\n  function togglePanel() {\r\n    panelOpen = !panelOpen;\r\n    const panel = document.getElementById('vm-agent-panel');\r\n    if (panel) {\r\n      panel.style.right = panelOpen ? '0' : '-380px';\r\n    }\r\n  }\r\n\r\n  function sendMessage() {\r\n    const input = document.getElementById('vm-agent-input');\r\n    if (!input) return;\r\n    const text = input.value.trim();\r\n    if (!text) return;\r\n    input.value = '';\r\n\r\n    addUserMessage(text);\r\n    showTyping();\r\n\r\n    // Send to page code via postMessage\r\n    window.parent.postMessage({ action: 'agentMessage', payload: { text } }, '*');\r\n  }\r\n\r\n  function addUserMessage(text) {\r\n    const container = document.getElementById('vm-agent-messages');\r\n    if (!container) return;\r\n    const div = document.createElement('div');\r\n    div.style.cssText = 'display:flex;justify-content:flex-end';\r\n    div.innerHTML = `<div style=\"background:linear-gradient(135deg,#2563eb,#1e40af);color:#fff;padding:10px 14px;border-radius:14px 14px 4px 14px;font-size:13px;max-width:85%;line-height:1.5\">${escapeHtml(text)}</div>`;\r\n    container.appendChild(div);\r\n    container.scrollTop = container.scrollHeight;\r\n    messages.push({ role: 'user', text });\r\n  }\r\n\r\n  function addBotMessage(text) {\r\n    removeTyping();\r\n    const container = document.getElementById('vm-agent-messages');\r\n    if (!container) return;\r\n    const div = document.createElement('div');\r\n    div.style.cssText = 'display:flex;gap:8px';\r\n    div.innerHTML = `\r\n      <div style=\"width:24px;height:24px;border-radius:8px;background:linear-gradient(135deg,#2563eb,#1e40af);display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px\">\r\n        <span style=\"font-size:9px;font-weight:700;color:#fff\">VM</span>\r\n      </div>\r\n      <div style=\"background:#1e293b;color:#e2e8f0;padding:10px 14px;border-radius:14px 14px 14px 4px;font-size:13px;max-width:85%;line-height:1.5\">${text}</div>`;\r\n    container.appendChild(div);\r\n    container.scrollTop = container.scrollHeight;\r\n    messages.push({ role: 'assistant', text });\r\n  }\r\n\r\n  function showTyping() {\r\n    removeTyping();\r\n    const container = document.getElementById('vm-agent-messages');\r\n    if (!container) return;\r\n    const div = document.createElement('div');\r\n    div.id = 'vm-agent-typing';\r\n    div.style.cssText = 'display:flex;gap:8px';\r\n    div.innerHTML = `\r\n      <div style=\"width:24px;height:24px;border-radius:8px;background:linear-gradient(135deg,#2563eb,#1e40af);display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px\">\r\n        <span style=\"font-size:9px;font-weight:700;color:#fff\">VM</span>\r\n      </div>\r\n      <div style=\"background:#1e293b;padding:12px 16px;border-radius:14px 14px 14px 4px;display:flex;gap:4px\">\r\n        <span class=\"vm-typing-dot\" style=\"width:6px;height:6px;border-radius:50%;background:#64748b;animation:vmTypePulse 1.4s ease-in-out infinite\"></span>\r\n        <span class=\"vm-typing-dot\" style=\"width:6px;height:6px;border-radius:50%;background:#64748b;animation:vmTypePulse 1.4s ease-in-out 0.2s infinite\"></span>\r\n        <span class=\"vm-typing-dot\" style=\"width:6px;height:6px;border-radius:50%;background:#64748b;animation:vmTypePulse 1.4s ease-in-out 0.4s infinite\"></span>\r\n      </div>`;\r\n    container.appendChild(div);\r\n    container.scrollTop = container.scrollHeight;\r\n  }\r\n\r\n  function removeTyping() {\r\n    const el = document.getElementById('vm-agent-typing');\r\n    if (el) el.remove();\r\n  }\r\n\r\n  function escapeHtml(str) {\r\n    const d = document.createElement('div');\r\n    d.textContent = str;\r\n    return d.innerHTML;\r\n  }\r\n\r\n  // -- Listen for responses from page code --\r\n  window.addEventListener('message', (event) => {\r\n    if (!event.data || event.source !== window.parent) return;\r\n    const { action, payload } = event.data;\r\n\r\n    if (action === 'agentResponse' && payload) {\r\n      const text = payload.error || payload.response || payload.content || 'Done.';\r\n      addBotMessage(text);\r\n    }\r\n\r\n    if (action === 'agentApprovalRequired' && payload) {\r\n      onApprovalRequired(payload);\r\n    }\r\n  });\r\n\r\n  function onApprovalRequired(payload) {\r\n    removeTyping();\r\n    const { gateId, toolName, toolDescription, args, riskLevel } = payload;\r\n    const container = document.getElementById('vm-agent-messages');\r\n    if (!container) return;\r\n\r\n    const argsSummary = Object.entries(args || {})\r\n      .map(([k, v]) => `<span style=\"color:#64748b\">${k}:</span> ${String(v).substring(0, 60)}`)\r\n      .join('<br>');\r\n\r\n    const cardDiv = document.createElement('div');\r\n    cardDiv.style.cssText = 'display:flex;gap:8px';\r\n    cardDiv.innerHTML = `\r\n      <div style=\"width:24px;height:24px;border-radius:8px;background:linear-gradient(135deg,#2563eb,#1e40af);display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px\">\r\n        <span style=\"font-size:9px;font-weight:700;color:#fff\">VM</span>\r\n      </div>\r\n      <div style=\"border:2px solid rgba(96,165,250,0.4);background:rgba(239,246,255,0.9);padding:12px 14px;border-radius:14px 14px 14px 4px;font-size:12px;max-width:85%;line-height:1.5;color:#1e293b;\">\r\n        <div style=\"font-weight:600;color:#1d4ed8;margin-bottom:6px;\">Approval Required</div>\r\n        <div style=\"margin-bottom:4px;font-weight:500;\">${escapeHtml(toolDescription || toolName)}</div>\r\n        <div style=\"font-size:11px;margin-bottom:8px;opacity:0.7;line-height:1.6;\">${argsSummary}</div>\r\n        <div style=\"font-size:10px;color:#2563eb;margin-bottom:8px;\">Risk: ${escapeHtml(riskLevel)} &middot; Tool: ${escapeHtml(toolName)}</div>\r\n        <div style=\"display:flex;gap:8px;\">\r\n          <button data-gate-decision=\"rejected\"\r\n            style=\"padding:5px 12px;border-radius:8px;background:#fee2e2;color:#dc2626;font-size:11px;font-weight:500;border:none;cursor:pointer;\">Reject</button>\r\n          <button data-gate-decision=\"approved\"\r\n            style=\"padding:5px 12px;border-radius:8px;background:#dcfce7;color:#16a34a;font-size:11px;font-weight:500;border:none;cursor:pointer;\">Approve</button>\r\n        </div>\r\n      </div>`;\r\n\r\n    cardDiv.querySelectorAll('button[data-gate-decision]').forEach(btn => {\r\n      btn.addEventListener('click', function() {\r\n        const decision = this.getAttribute('data-gate-decision');\r\n        cardDiv.querySelectorAll('button').forEach(b => { b.disabled = true; b.style.opacity = '0.5'; });\r\n        showTyping();\r\n        window.parent.postMessage({\r\n          action: 'resolveApprovalGate',\r\n          payload: { approvalContext: payload, decision, decidedBy: 'admin' }\r\n        }, '*');\r\n      });\r\n    });\r\n\r\n    container.appendChild(cardDiv);\r\n    container.scrollTop = container.scrollHeight;\r\n  }\r\n\r\n  // -- Inject typing animation --\r\n  const style = document.createElement('style');\r\n  style.textContent = `@keyframes vmTypePulse{0%,100%{opacity:.3;transform:scale(.8)}50%{opacity:1;transform:scale(1)}}`;\r\n  document.head.appendChild(style);\r\n\r\n  // -- Auto-init on DOM ready --\r\n  if (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', init);\r\n  } else {\r\n    init();\r\n  }\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\admin-run-monitor.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\b2b-agent.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\ticket-bridge.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'TicketBridge' is assigned a value but never used.","line":4,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Ticket PostMessage Bridge\r\n */\r\nconst TicketBridge = {\r\n    init() {\r\n        window.addEventListener('message', (event) => {\r\n            const { action, payload, message } = event.data;\r\n            if (!action) return;\r\n\r\n            switch (action) {\r\n                case 'init':\r\n                    if (payload && payload.userId) TICKET_STATE.currentUserId = payload.userId;\r\n                    TicketUI.refresh();\r\n                    break;\r\n                case 'ticketsLoaded':\r\n                    TicketUI.handleTicketsLoaded(payload);\r\n                    break;\r\n                case 'ticketCreated':\r\n                    TicketUI.handleActionSuccess('Ticket created successfully');\r\n                    TicketUI.closeCreateModal();\r\n                    TicketUI.refresh();\r\n                    break;\r\n                case 'actionSuccess':\r\n                    TicketUI.handleActionSuccess(message);\r\n                    TicketUI.refresh();\r\n                    break;\r\n                case 'actionError':\r\n                    TicketUI.handleActionError(message);\r\n                    break;\r\n            }\r\n        });\r\n    },\r\n\r\n    send(action, payload = {}) {\r\n        window.parent.postMessage({ action, ...payload }, '*');\r\n    },\r\n\r\n    getTickets(filters, pagination, sort) {\r\n        this.send('getTicketsList', { filters, pagination, sort });\r\n    },\r\n\r\n    createTicket(ticketData) {\r\n        this.send('createTicket', { ticketData });\r\n    },\r\n\r\n    assignToMe(ticketId) {\r\n        if (!TICKET_STATE.currentUserId) {\r\n            console.error('No current user ID for assignment');\r\n            return;\r\n        }\r\n        this.send('assignTicket', { ticketId, agentId: TICKET_STATE.currentUserId });\r\n    }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\ticket-config.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'TICKET_CONFIG' is assigned a value but never used.","line":4,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'TICKET_STATE' is assigned a value but never used.","line":35,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Ticket System Configuration & Constants\r\n */\r\nconst TICKET_CONFIG = {\r\n    ENDPOINTS: {\r\n        GET_TICKETS: 'getTicketsList',\r\n        CREATE_TICKET: 'createTicket',\r\n        UPDATE_TICKET: 'updateTicket',\r\n        ASSIGN_TICKET: 'assignTicket',\r\n        GET_TICKET: 'getTicket'\r\n    },\r\n    STATUS_MAP: {\r\n        'open': { label: 'Open', color: 'bg-emerald-500/10 text-emerald-500 border-emerald-500/20' },\r\n        'pending': { label: 'Pending', color: 'bg-amber-500/10 text-amber-500 border-amber-500/20' },\r\n        'resolved': { label: 'Resolved', color: 'bg-blue-500/10 text-blue-500 border-blue-500/20' },\r\n        'closed': { label: 'Closed', color: 'bg-slate-500/10 text-slate-500 border-slate-500/20' }\r\n    },\r\n    PRIORITY_MAP: {\r\n        'urgent': { label: 'Urgent', color: 'text-rose-500 bg-rose-500/10', icon: 'error' },\r\n        'high': { label: 'High', color: 'text-orange-500 bg-orange-500/10', icon: 'priority_high' },\r\n        'medium': { label: 'Medium', color: 'text-amber-500 bg-amber-500/10', icon: 'remove' },\r\n        'low': { label: 'Low', color: 'text-emerald-500 bg-emerald-500/10', icon: 'keyboard_arrow_down' }\r\n    },\r\n    CATEGORY_LABELS: {\r\n        'general': 'General',\r\n        'billing': 'Billing',\r\n        'technical': 'Technical',\r\n        'carrier': 'Carrier Issue'\r\n    },\r\n    PAGINATION: {\r\n        DEFAULT_SIZE: 15\r\n    }\r\n};\r\n\r\nlet TICKET_STATE = {\r\n    tickets: [],\r\n    totalCount: 0,\r\n    currentPage: 1,\r\n    pageSize: 15,\r\n    filters: {\r\n        status: 'all',\r\n        priority: 'all',\r\n        category: 'all',\r\n        search: '',\r\n        queue: 'all'\r\n    },\r\n    sort: { field: 'created_at', direction: 'desc' },\r\n    loading: false,\r\n    currentUserId: null\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\ticket-logic.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'TicketUI' is assigned a value but never used.","line":4,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Ticket UI Controller\r\n */\r\nconst TicketUI = {\r\n    init() {\r\n        TicketBridge.init();\r\n        this.updateTabs();\r\n    },\r\n\r\n    refresh() {\r\n        TICKET_STATE.loading = true;\r\n        this.showSkeleton();\r\n        \r\n        // Prepare filters: if queue is 'mine', add assigned_to filter\r\n        const filters = { ...TICKET_STATE.filters };\r\n        if (filters.queue === 'mine' && TICKET_STATE.currentUserId) {\r\n            filters.assigned_to = TICKET_STATE.currentUserId;\r\n        } else if (filters.queue === 'unassigned') {\r\n            filters.assigned_to = null;\r\n        } else if (filters.queue === 'urgent') {\r\n            filters.priority = 'urgent';\r\n        }\r\n\r\n        TicketBridge.getTickets(\r\n            filters,\r\n            { page: TICKET_STATE.currentPage, pageSize: TICKET_STATE.pageSize },\r\n            TICKET_STATE.sort\r\n        );\r\n    },\r\n\r\n    handleTicketsLoaded(payload) {\r\n        TICKET_STATE.loading = false;\r\n        TICKET_STATE.tickets = payload.items || [];\r\n        TICKET_STATE.totalCount = payload.totalCount || 0;\r\n        \r\n        TicketRender.renderTable(TICKET_STATE.tickets);\r\n        TicketRender.updatePagination(TICKET_STATE.totalCount, TICKET_STATE.currentPage, TICKET_STATE.pageSize);\r\n    },\r\n\r\n    setQueue(queue) {\r\n        TICKET_STATE.filters.queue = queue;\r\n        TICKET_STATE.currentPage = 1;\r\n        this.updateTabs();\r\n        this.refresh();\r\n    },\r\n\r\n    updateTabs() {\r\n        document.querySelectorAll('.tab-btn').forEach(btn => {\r\n            const isActive = btn.dataset.queue === TICKET_STATE.filters.queue;\r\n            btn.classList.toggle('bg-white', isActive);\r\n            btn.classList.toggle('dark:bg-slate-700', isActive);\r\n            btn.classList.toggle('shadow-sm', isActive);\r\n            btn.classList.toggle('text-lmdr-blue', isActive && btn.dataset.queue !== 'urgent');\r\n            btn.classList.toggle('text-slate-600', !isActive && btn.dataset.queue !== 'urgent');\r\n            btn.classList.toggle('dark:text-slate-400', !isActive && btn.dataset.queue !== 'urgent');\r\n        });\r\n    },\r\n\r\n    toggleFilters() {\r\n        const panel = document.getElementById('filterPanel');\r\n        panel.classList.toggle('hidden');\r\n    },\r\n\r\n    applyFilter(key, value) {\r\n        TICKET_STATE.filters[key] = value;\r\n        TICKET_STATE.currentPage = 1;\r\n        this.refresh();\r\n    },\r\n\r\n    resetFilters() {\r\n        TICKET_STATE.filters = {\r\n            status: 'all',\r\n            priority: 'all',\r\n            category: 'all',\r\n            search: '',\r\n            queue: TICKET_STATE.filters.queue\r\n        };\r\n        document.getElementById('ticketSearch').value = '';\r\n        this.refresh();\r\n    },\r\n\r\n    debouncedSearch() {\r\n        clearTimeout(this.searchTimer);\r\n        this.searchTimer = setTimeout(() => {\r\n            const val = document.getElementById('ticketSearch').value;\r\n            TICKET_STATE.filters.search = val;\r\n            TICKET_STATE.currentPage = 1;\r\n            this.refresh();\r\n        }, 400);\r\n    },\r\n\r\n    nextPage() {\r\n        TICKET_STATE.currentPage++;\r\n        this.refresh();\r\n    },\r\n\r\n    prevPage() {\r\n        if (TICKET_STATE.currentPage > 1) {\r\n            TICKET_STATE.currentPage--;\r\n            this.refresh();\r\n        }\r\n    },\r\n\r\n    assignToMe(ticketId) {\r\n        TicketBridge.assignToMe(ticketId);\r\n    },\r\n\r\n    openCreateModal() {\r\n        document.getElementById('createModal').classList.remove('hidden');\r\n    },\r\n\r\n    closeCreateModal() {\r\n        document.getElementById('createModal').classList.add('hidden');\r\n    },\r\n\r\n    handleCreate(event) {\r\n        event.preventDefault();\r\n        const formData = new FormData(event.target);\r\n        const data = {\r\n            subject: formData.get('subject'),\r\n            priority: formData.get('priority'),\r\n            category: formData.get('category'),\r\n            description: formData.get('description')\r\n        };\r\n        \r\n        TicketBridge.createTicket(data);\r\n    },\r\n\r\n    handleActionSuccess(msg) {\r\n        // In a real implementation, we might show a nice toast. \r\n        // For now, console log and reload suffice.\r\n        console.log('Action Success:', msg);\r\n    },\r\n\r\n    handleActionError(msg) {\r\n        alert('Error: ' + msg);\r\n    },\r\n\r\n    showSkeleton() {\r\n        const body = document.getElementById('ticketTableBody');\r\n        body.innerHTML = Array(5).fill(0).map(() => `\r\n            <tr class=\"animate-pulse\">\r\n                <td class=\"px-4 py-6\"><div class=\"h-4 bg-slate-200 dark:bg-slate-800 rounded w-3/4\"></div></td>\r\n                <td class=\"px-4 py-6\"><div class=\"h-4 bg-slate-200 dark:bg-slate-800 rounded w-1/2\"></div></td>\r\n                <td class=\"px-4 py-6\"><div class=\"h-8 bg-slate-200 dark:bg-slate-800 rounded-full w-16\"></div></td>\r\n                <td class=\"px-4 py-6\"><div class=\"h-4 bg-slate-200 dark:bg-slate-800 rounded w-12\"></div></td>\r\n                <td class=\"px-4 py-6\"><div class=\"h-4 bg-slate-200 dark:bg-slate-800 rounded w-20\"></div></td>\r\n                <td class=\"px-4 py-6 text-right\"><div class=\"h-8 bg-slate-200 dark:bg-slate-800 rounded w-8 ml-auto\"></div></td>\r\n            </tr>\r\n        `).join('');\r\n    }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\admin\\js\\ticket-render.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'TicketRender' is assigned a value but never used.","line":4,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Ticket DOM Rendering Engine\r\n */\r\nconst TicketRender = {\r\n    renderTable(tickets) {\r\n        const body = document.getElementById('ticketTableBody');\r\n        if (!tickets || tickets.length === 0) {\r\n            body.innerHTML = `\r\n                <tr>\r\n                    <td colspan=\"6\" class=\"px-6 py-12 text-center text-slate-500\">\r\n                        <div class=\"flex flex-col items-center gap-2\">\r\n                            <span class=\"material-symbols-outlined text-4xl opacity-20\">inbox</span>\r\n                            <p class=\"text-sm font-medium\">No tickets found matching your criteria.</p>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            `;\r\n            return;\r\n        }\r\n\r\n        body.innerHTML = tickets.map(ticket => this.renderRow(ticket)).join('');\r\n    },\r\n\r\n    renderRow(ticket) {\r\n        const status = TICKET_CONFIG.STATUS_MAP[ticket.status] || TICKET_CONFIG.STATUS_MAP.open;\r\n        const priority = TICKET_CONFIG.PRIORITY_MAP[ticket.priority] || TICKET_CONFIG.PRIORITY_MAP.medium;\r\n        const createdAt = new Date(ticket.created_at).toLocaleDateString();\r\n        \r\n        // SLA Logic\r\n        const slaStatus = this.getSLAStatus(ticket);\r\n        const slaLabel = this.getSLALabel(ticket);\r\n\r\n        return `\r\n            <tr class=\"hover:bg-slate-50 dark:hover:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800/50 transition-colors group\">\r\n                <td class=\"px-4 py-4 ${slaStatus.border} transition-all\">\r\n                    <div class=\"flex flex-col\">\r\n                        <span class=\"text-xs font-bold text-slate-400 mb-0.5 tracking-tight\">${ticket.ticket_number}</span>\r\n                        <a href=\"ADMIN_TICKET_DETAIL.html?id=${ticket._id}\" class=\"text-sm font-semibold hover:text-lmdr-blue hover:underline decoration-2 underline-offset-4 transition-all\">\r\n                            ${ticket.subject}\r\n                        </a>\r\n                        <span class=\"text-[10px] text-slate-400 mt-1\">${TICKET_CONFIG.CATEGORY_LABELS[ticket.category] || 'General'}</span>\r\n                    </div>\r\n                </td>\r\n                <td class=\"px-4 py-4\">\r\n                    <div class=\"flex flex-col\">\r\n                        <span class=\"text-sm font-medium truncate max-w-[150px]\">${ticket.user_email}</span>\r\n                        <span class=\"text-[10px] text-slate-400 uppercase tracking-wider\">${ticket.user_role}</span>\r\n                    </div>\r\n                </td>\r\n                <td class=\"px-4 py-4\">\r\n                    <span class=\"px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border ${status.color}\">\r\n                        ${status.label}\r\n                    </span>\r\n                </td>\r\n                <td class=\"px-4 py-4\">\r\n                    <div class=\"flex items-center gap-1.5 ${priority.color.split(' ')[0]}\">\r\n                        <span class=\"material-symbols-outlined text-[16px]\">${priority.icon}</span>\r\n                        <span class=\"text-[10px] font-bold uppercase tracking-wider\">${priority.label}</span>\r\n                    </div>\r\n                </td>\r\n                <td class=\"px-4 py-4\">\r\n                    <div class=\"flex flex-col\">\r\n                        <span class=\"text-[11px] font-bold ${slaStatus.text}\">${slaLabel}</span>\r\n                        <span class=\"text-[10px] text-slate-400\">${createdAt}</span>\r\n                    </div>\r\n                </td>\r\n                <td class=\"px-4 py-4 text-right\">\r\n                    <div class=\"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                        <button onclick=\"TicketUI.assignToMe('${ticket._id}')\" class=\"p-2 hover:bg-lmdr-blue hover:text-white rounded-lg transition-all\" title=\"Assign to Me\">\r\n                            <span class=\"material-symbols-outlined text-[18px]\">person_add</span>\r\n                        </button>\r\n                        <a href=\"ADMIN_TICKET_DETAIL.html?id=${ticket._id}\" class=\"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-all\" title=\"View Detail\">\r\n                            <span class=\"material-symbols-outlined text-[18px]\">visibility</span>\r\n                        </a>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        `;\r\n    },\r\n\r\n    getSLAStatus(ticket) {\r\n        if (ticket.status === 'resolved' || ticket.status === 'closed') return { border: 'sla-healthy', text: 'text-emerald-500' };\r\n        \r\n        const now = new Date();\r\n        const due = new Date(ticket.resolution_due);\r\n        const hoursLeft = (due - now) / (1000 * 60 * 60);\r\n\r\n        if (hoursLeft < 0) return { border: 'sla-critical', text: 'text-rose-500' };\r\n        if (hoursLeft < 4) return { border: 'sla-warning', text: 'text-amber-500' };\r\n        return { border: 'sla-healthy', text: 'text-emerald-500' };\r\n    },\r\n\r\n    getSLALabel(ticket) {\r\n        if (ticket.status === 'resolved' || ticket.status === 'closed') return 'Completed';\r\n        \r\n        const now = new Date();\r\n        const due = new Date(ticket.resolution_due);\r\n        const hoursLeft = (due - now) / (1000 * 60 * 60);\r\n\r\n        if (hoursLeft < 0) return `Overdue by ${Math.abs(Math.floor(hoursLeft))}h`;\r\n        if (hoursLeft < 24) return `Due in ${Math.floor(hoursLeft)}h`;\r\n        return `Due in ${Math.floor(hoursLeft / 24)}d`;\r\n    },\r\n\r\n    updatePagination(totalCount, page, size) {\r\n        const info = document.getElementById('paginationInfo');\r\n        const start = (page - 1) * size + 1;\r\n        const end = Math.min(page * size, totalCount);\r\n        \r\n        info.textContent = `Showing ${totalCount > 0 ? start : 0}-${end} of ${totalCount} tickets`;\r\n        \r\n        document.getElementById('prevBtn').disabled = page <= 1;\r\n        document.getElementById('nextBtn').disabled = end >= totalCount;\r\n    }\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-accordion.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-agent.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-bridge.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isValidOrigin' is defined but never used.","line":55,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'validateMessageSchema' is defined but never used.","line":70,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'validateInboundMessage' is defined but never used.","line":78,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'verifyConnection' is defined but never used.","line":110,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ai-matching-bridge.js  PostMessage bridge + security hardening\n// Depends on: ai-matching-helpers.js\n\nconst DEBUG_MESSAGES = true; // Set to false in production\n\n// Registry of all valid messages - single source of truth\nconst MESSAGE_REGISTRY = {\n  // Messages FROM Velo that HTML handles\n  inbound: [\n    'pageReady',\n    'matchResults',\n    'matchError',\n    'enrichmentUpdate',\n    'enrichmentComplete',\n    'interestLogged',\n    'userStatusUpdate',\n    'loginSuccess',\n    'loginCancelled',\n    'applicationSubmitted',\n    'driverProfileLoaded',\n    'savedCarriersLoaded',\n    'discoverabilityUpdated',\n    'mutualInterestData', // Phase 1: Mutual interest response\n    'matchExplanation', // Phase 3: Match explanation result\n    'pong', // Health check response\n    'agentResponse', // Agent orchestration response\n    'agentTyping', // Agent is processing\n    'agentToolResult', // Agent tool execution result\n    'voiceReady' // Voice configuration ready\n  ],\n  // Messages TO Velo that HTML sends\n  outbound: [\n    'carrierMatchingReady',\n    'findMatches',\n    'logInterest',\n    'retryEnrichment',\n    'navigateToSignup',\n    'navigateToLogin',\n    'checkUserStatus',\n    'getDriverProfile',\n    'navigateToSavedCarriers',\n    'submitApplication',\n    'logFeatureInteraction', // Feature adoption tracking\n    'getMutualInterest', // Phase 1: Fetch mutual interests\n    'loginForApplication', // Trigger Wix login from application submit\n    'getMatchExplanation', // Phase 3: Request match explanation\n    'agentMessage', // Send message to agent\n    'startVoiceCall', // Initiate voice call\n    'endVoiceCall', // End voice call\n    'getVoiceConfig', // Request voice configuration\n    'ping' // Health check\n  ]\n};\n\nfunction isValidOrigin(event) {\n  // In Wix HTML components, messages from Velo come from parent frame\n  // We verify we're in an iframe and the source is our parent\n  if (window.parent === window) {\n    console.warn('?? SECURITY: Not running in iframe context');\n    return false;\n  }\n  if (event.source !== window.parent) {\n    console.warn('?? SECURITY: Message not from parent frame');\n    return false;\n  }\n  return true;\n}\n\n// Schema validation - ensures message has required structure\nfunction validateMessageSchema(msg) {\n  if (!msg || typeof msg !== 'object') return false;\n  if (typeof msg.type !== 'string' || msg.type.length === 0) return false;\n  // data can be undefined, null, or object - all valid\n  if (msg.data !== undefined && msg.data !== null && typeof msg.data !== 'object') return false;\n  return true;\n}\n\nfunction validateInboundMessage(type) {\n  if (!MESSAGE_REGISTRY.inbound.includes(type)) {\n    console.warn(`?? UNREGISTERED INBOUND MESSAGE: \"${type}\" - Add to MESSAGE_REGISTRY.inbound`);\n    return false;\n  }\n  return true;\n}\n\nfunction logMessageFlow(direction, type, data) {\n  if (!DEBUG_MESSAGES) return;\n  const arrow = direction === 'in' ? '??' : '??';\n  const label = direction === 'in' ? 'Velo?HTML' : 'HTML?Velo';\n  console.log(`${arrow} [${label}] ${type}`, data ? Object.keys(data) : '(no data)');\n}\n\nfunction sendToWix(action, data) {\n  // Validate outbound message\n  if (!MESSAGE_REGISTRY.outbound.includes(action)) {\n    console.warn(`?? UNREGISTERED OUTBOUND MESSAGE: \"${action}\" - Add to MESSAGE_REGISTRY.outbound`);\n  }\n  logMessageFlow('out', action, data);\n\n  if (window.parent) {\n    window.parent.postMessage({\n      type: 'carrierMatching',\n      action: action,\n      data: data\n    }, '*');\n  }\n}\n\nlet connectionVerified = false;\nfunction verifyConnection() {\n  if (connectionVerified) return;\n  sendToWix('ping', { timestamp: Date.now() });\n  setTimeout(() => {\n    if (!connectionVerified) {\n      console.warn('?? CONNECTION CHECK: No pong received from Velo within 3s');\n    }\n  }, 3000);\n}\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-helpers.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'showToast' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'formatBasicName' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'formatAISummary' is defined but never used.","line":37,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'categorizeFleet' is defined but never used.","line":64,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'extractDomain' is defined but never used.","line":71,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'safeJsonParse' is defined but never used.","line":81,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'checkValidData' is defined but never used.","line":89,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'highlightField' is defined but never used.","line":95,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'stripHtml' is defined but never used.","line":101,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'safeSetText' is defined but never used.","line":109,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'formatStatus' is defined but never used.","line":113,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":113,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'formatAppStatus' is defined but never used.","line":124,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":124,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'getStatusIcon' is defined but never used.","line":138,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":138,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ai-matching-helpers.js  Pure utility functions for AI Matching\r\n// Loaded first (no dependencies)\r\n\r\nfunction showToast(message, type = 'error', duration = 4000) {\r\n  let container = document.getElementById('toast-container');\r\n  if (!container) {\r\n    container = document.createElement('div');\r\n    container.id = 'toast-container';\r\n    container.style.cssText = 'position:fixed;top:20px;left:50%;transform:translateX(-50%);z-index:99999;display:flex;flex-direction:column;gap:8px;pointer-events:none;';\r\n    document.body.appendChild(container);\r\n  }\r\n  const toast = document.createElement('div');\r\n  const bg = type === 'error' ? '#ef4444' : type === 'success' ? '#22c55e' : '#3b82f6';\r\n  toast.style.cssText = `background:${bg};color:#fff;padding:12px 20px;border-radius:8px;font-size:14px;font-weight:500;box-shadow:0 4px 12px rgba(0,0,0,0.3);pointer-events:auto;opacity:0;transition:opacity 0.3s;max-width:400px;text-align:center;`;\r\n  toast.textContent = message;\r\n  container.appendChild(toast);\r\n  requestAnimationFrame(() => toast.style.opacity = '1');\r\n  setTimeout(() => {\r\n    toast.style.opacity = '0';\r\n    setTimeout(() => toast.remove(), 300);\r\n  }, duration);\r\n}\r\n\r\nfunction formatBasicName(key) {\r\n  const names = {\r\n    'unsafe_driving': 'Unsafe Driving',\r\n    'hours_of_service': 'Hours of Service',\r\n    'driver_fitness': 'Driver Fitness',\r\n    'drugs_alcohol': 'Controlled Substances/Alcohol',\r\n    'vehicle_maintenance': 'Vehicle Maintenance',\r\n    'hazmat': 'Hazardous Materials',\r\n    'crash_indicator': 'Crash Indicator'\r\n  };\r\n  return names[key] || key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n}\r\n\r\nfunction formatAISummary(text) {\r\n  if (!text) return '';\r\n  // Split on bullet markers () or newlines\r\n  const lines = text.split(/\\n|(?= )/).map(l => l.trim()).filter(Boolean);\r\n  const isBulleted = lines.some(l => l.startsWith(''));\r\n  if (isBulleted) {\r\n    const items = lines\r\n      .map(l => l.replace(/^[-]\\s*/, ''))\r\n      .filter(Boolean)\r\n      .map(l => {\r\n        // Bold **word** ? <strong>word</strong>, then escape the rest\r\n        const safe = escapeHtml(l);\r\n        return safe.replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>');\r\n      });\r\n    return '<ul class=\"ai-summary-bullets\">' + items.map(i => `<li>${i}</li>`).join('') + '</ul>';\r\n  }\r\n  // Fallback: plain paragraph (old-style summaries from cache)\r\n  return escapeHtml(text);\r\n}\r\n\r\nfunction escapeHtml(text) {\r\n  if (!text) return '';\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nfunction categorizeFleet(units) {\r\n  if (!units) return 'Unknown';\r\n  if (units < 50) return 'Small Fleet';\r\n  if (units < 500) return 'Mid-Size';\r\n  return 'Large Fleet';\r\n}\r\n\r\nfunction extractDomain(url) {\r\n  if (!url || !url.startsWith('http')) return url;\r\n  try {\r\n    const hostname = new URL(url).hostname;\r\n    return hostname.replace('www.', '');\r\n  } catch (e) {\r\n    return 'External Source';\r\n  }\r\n}\r\n\r\nfunction safeJsonParse(val) {\r\n  if (Array.isArray(val)) return val;\r\n  if (typeof val === 'string') {\r\n    try { return JSON.parse(val); } catch (e) { return []; }\r\n  }\r\n  return [];\r\n}\r\n\r\nfunction checkValidData(val) {\r\n  if (!val) return false;\r\n  const invalid = ['not found', 'n/a', 'none found', 'contact carrier', 'unknown', 'market rate'];\r\n  return !invalid.includes(val.toLowerCase());\r\n}\r\n\r\nfunction highlightField(el) {\r\n  if (!el) return;\r\n  el.classList.add('highlight-pulse');\r\n  setTimeout(() => el.classList.remove('highlight-pulse'), 2000);\r\n}\r\n\r\nfunction stripHtml(str) {\r\n  if (typeof str !== 'string') return '';\r\n  const div = document.createElement('div');\r\n  div.textContent = str;\r\n  return div.innerHTML;\r\n}\r\n\r\n// Safe text content setter - use instead of innerHTML for user content\r\nfunction safeSetText(element, text) {\r\n  if (element) element.textContent = text;\r\n}\r\n\r\nfunction formatStatus(status) {\r\n  const labels = {\r\n    'applied': 'Applied',\r\n    'in_review': 'In Review',\r\n    'contacted': 'Contacted',\r\n    'offer': 'Offer Received',\r\n    'hired': 'Hired'\r\n  };\r\n  return labels[status] || status;\r\n}\r\n\r\nfunction formatAppStatus(status) {\r\n  const labels = {\r\n    'applied': 'Applied',\r\n    'in_review': 'In Review',\r\n    'viewed': 'Viewed',\r\n    'contacted': 'Contacted',\r\n    'offer': 'Offer Received',\r\n    'hired': 'Hired',\r\n    'rejected': 'Not Selected',\r\n    'withdrawn': 'Withdrawn'\r\n  };\r\n  return labels[status] || status;\r\n}\r\n\r\nfunction getStatusIcon(status) {\r\n  const icons = {\r\n    'applied': '<i class=\"fa-solid fa-paper-plane\"></i>',\r\n    'in_review': '<i class=\"fa-solid fa-clipboard-check\"></i>',\r\n    'viewed': '<i class=\"fa-solid fa-eye\"></i>',\r\n    'contacted': '<i class=\"fa-solid fa-phone\"></i>',\r\n    'hired': '<i class=\"fa-solid fa-check-circle\"></i>',\r\n    'rejected': '<i class=\"fa-solid fa-circle-xmark\"></i>',\r\n    'withdrawn': '<i class=\"fa-solid fa-ban\"></i>'\r\n  };\r\n  return icons[status] || '<i class=\"fa-solid fa-circle-info\"></i>';\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-modals.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'showInterestModal' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'hideInterestModal' is defined but never used.","line":39,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'fileToBase64' is defined but never used.","line":96,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'handleFileChange' is defined but never used.","line":111,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'handleOCRResult' is defined but never used.","line":118,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":118,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'showApplicationModal' is defined but never used.","line":149,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":149,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'hideApplicationModal' is defined but never used.","line":210,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":210,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'hideLoginPrompt' is defined but never used.","line":223,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'triggerLoginForApplication' is defined but never used.","line":228,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":228,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'submitApplication' is defined but never used.","line":424,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":424,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'handleApplicationSubmitted' is defined but never used.","line":603,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":603,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ai-matching-modals.js  Interest modal, application modal, login prompt\n// Depends on: ai-matching-helpers.js, ai-matching-bridge.js, ai-matching-renderers.js\n\nfunction showInterestModal(carrierData) {\n  if (!carrierData) return;\n  if (typeof FeatureTracker !== 'undefined') FeatureTracker.view('matching_carrier_interest', { carrierName: carrierData.name, dotNumber: carrierData.dotNumber });\n\n  // Populate modal with carrier data\n  document.getElementById('modalCarrierName').textContent = carrierData.name;\n  document.getElementById('modalCarrierFullName').textContent = carrierData.name;\n  document.getElementById('modalCarrierDOT').textContent = carrierData.dotNumber;\n\n  // Handle phone\n  const phoneRow = document.getElementById('modalPhoneRow');\n  const phoneLink = document.getElementById('modalCarrierPhone');\n  if (carrierData.phone) {\n    phoneRow.style.display = 'flex';\n    phoneLink.href = `tel:${carrierData.phone}`;\n    phoneLink.textContent = carrierData.phone;\n  } else {\n    phoneRow.style.display = 'none';\n  }\n\n  // Handle email\n  const emailRow = document.getElementById('modalEmailRow');\n  const emailLink = document.getElementById('modalCarrierEmail');\n  if (carrierData.email) {\n    emailRow.style.display = 'flex';\n    emailLink.href = `mailto:${carrierData.email}`;\n    emailLink.textContent = carrierData.email;\n  } else {\n    emailRow.style.display = 'none';\n  }\n\n  // Show modal\n  interestModal.style.display = 'flex';\n}\n\nfunction hideInterestModal() {\n  interestModal.style.display = 'none';\n  pendingInterestCarrier = null;\n}\n\nfunction compressImageForUpload(file) {\n  return new Promise(function (resolve, reject) {\n    if (!file) { resolve(null); return; }\n\n    // Skip compression for non-images (PDFs)\n    if (file.type === 'application/pdf') {\n      var reader = new FileReader();\n      reader.onload = function () { resolve(reader.result); };\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n      return;\n    }\n\n    // Compression settings for upload (more aggressive than OCR)\n    var maxWidth = 800, maxHeight = 1000, quality = 0.6;\n\n    var img = new Image();\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n\n    img.onload = function () {\n      var w = img.width, h = img.height;\n\n      // Scale down if needed\n      if (w > maxWidth) { h = Math.round(h * (maxWidth / w)); w = maxWidth; }\n      if (h > maxHeight) { w = Math.round(w * (maxHeight / h)); h = maxHeight; }\n\n      canvas.width = w;\n      canvas.height = h;\n\n      // White background for transparency\n      ctx.fillStyle = '#FFFFFF';\n      ctx.fillRect(0, 0, w, h);\n      ctx.drawImage(img, 0, 0, w, h);\n\n      var compressed = canvas.toDataURL('image/jpeg', quality);\n      var origKB = Math.round(file.size / 1024);\n      var compKB = Math.round((compressed.length * 3) / 4 / 1024);\n      console.log('?? Upload compression: ' + origKB + 'KB ? ' + compKB + 'KB (' + Math.round((1 - compKB / origKB) * 100) + '% reduction)');\n      resolve(compressed);\n    };\n\n    img.onerror = function () { reject(new Error('Failed to load image for compression')); };\n\n    var imageReader = new FileReader();\n    imageReader.onload = function (e) { img.src = e.target.result; };\n    imageReader.onerror = reject;\n    imageReader.readAsDataURL(file);\n  });\n}\n\n// Convert file to base64 (delegates to OCRHandler or fallback)\nfunction fileToBase64(file) {\n  if (window.OCRHandler && window.OCRHandler.isInitialized()) {\n    return window.OCRHandler.fileToBase64(file);\n  }\n  // Fallback if OCRHandler not loaded\n  return new Promise((resolve, reject) => {\n    if (!file) { resolve(null); return; }\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsDataURL(file);\n  });\n}\n\n// Handle file input change - delegates to OCRHandler\nfunction handleFileChange(inputId) {\n  if (window.OCRHandler && window.OCRHandler.isInitialized()) {\n    window.OCRHandler.handleFileChange(inputId);\n  }\n}\n\n// Handle OCR result - delegates to OCRHandler\nfunction handleOCRResult(data) {\n  if (window.OCRHandler && window.OCRHandler.isInitialized()) {\n    window.OCRHandler.handleOCRResult(data);\n  }\n}\n\n// Remove uploaded file - delegates to OCRHandler\nfunction removeFile(inputId) {\n  if (window.OCRHandler && window.OCRHandler.isInitialized()) {\n    window.OCRHandler.removeFile(inputId);\n  } else {\n    // Fallback\n    const input = document.getElementById(inputId);\n    const box = document.getElementById(inputId + 'Box');\n    const nameEl = document.getElementById(inputId + 'Name');\n    if (input) input.value = '';\n    uploadedFiles[inputId] = null;\n    if (box) box.classList.remove('has-file');\n    if (nameEl) nameEl.textContent = '';\n  }\n}\n\n// Reset all file uploads - delegates to OCRHandler\nfunction resetFileUploads() {\n  if (window.OCRHandler && window.OCRHandler.isInitialized()) {\n    window.OCRHandler.resetFileUploads();\n  } else {\n    ['cdlFront', 'cdlBack', 'medCard'].forEach(id => removeFile(id));\n  }\n}\n\nfunction showApplicationModal(carrierData) {\n  if (!carrierData) return;\n\n  currentApplicationCarrier = carrierData;\n\n  // Populate carrier info in form\n  document.getElementById('appModalCarrierName').textContent = carrierData.name;\n  document.getElementById('appFormCarrierName').textContent = carrierData.name;\n  document.getElementById('appFormCarrierDOT').textContent = carrierData.dotNumber;\n\n  // Reset form state\n  applicationForm.reset();\n  resetFileUploads();\n\n  // Auto-populate from Profile (Phase 4H)\n  if (driverProfile) {\n    console.log('?? Auto-populating application from profile');\n\n    // CDL Details\n    if (driverProfile.cdl_number) document.getElementById('cdlNumber').value = driverProfile.cdl_number;\n    if (driverProfile.cdl_expiration) document.getElementById('cdlExpiration').value = driverProfile.cdl_expiration;\n    if (driverProfile.med_card_expiration) document.getElementById('medCardExpiration').value = driverProfile.med_card_expiration;\n\n    // Contact\n    if (driverProfile.phone) document.getElementById('appPhone').value = driverProfile.phone;\n    if (driverProfile.email) document.getElementById('appEmail').value = driverProfile.email;\n\n    // Documents - Show \"Attached\" status if URLs exist\n    checkPreFilledDocs();\n  }\n\n  applicationFormContent.style.display = 'block';\n  applicationFormLoading.classList.remove('show');\n  applicationFormSuccess.classList.remove('show');\n\n  // Clear any error states\n  document.querySelectorAll('.form-group input.error, .form-group select.error').forEach(el => {\n    el.classList.remove('error');\n  });\n  document.querySelectorAll('.error-message').forEach(el => {\n    el.classList.remove('show');\n  });\n  document.querySelectorAll('.file-upload-box').forEach(el => {\n    el.classList.remove('error');\n  });\n\n  // Reset accordion to initial state and check for pre-filled completions\n  if (typeof resetAccordion === 'function') {\n    resetAccordion();\n    // Check completion states after a delay to account for pre-filled data\n    setTimeout(() => {\n      if (typeof checkAllSections === 'function') {\n        checkAllSections();\n      }\n    }, 300);\n  }\n\n  // Show modal\n  applicationModal.style.display = 'flex';\n}\n\nfunction hideApplicationModal() {\n  applicationModal.style.display = 'none';\n  currentApplicationCarrier = null;\n}\n\nfunction showLoginPrompt() {\n  if (!loginPromptOverlay) return;\n  // Reset to default state\n  if (loginPromptContent) loginPromptContent.style.display = 'block';\n  if (loginPromptLoading) loginPromptLoading.classList.remove('show');\n  loginPromptOverlay.classList.add('show');\n}\n\nfunction hideLoginPrompt() {\n  if (!loginPromptOverlay) return;\n  loginPromptOverlay.classList.remove('show');\n}\n\nfunction triggerLoginForApplication(mode) {\n  // Switch to loading state\n  if (loginPromptContent) loginPromptContent.style.display = 'none';\n  if (loginPromptLoading) loginPromptLoading.classList.add('show');\n\n  const loadingText = document.getElementById('loginPromptLoadingText');\n  if (loadingText) loadingText.textContent = mode === 'login' ? 'Waiting for log-in...' : 'Waiting for sign-up...';\n\n  // Send to Velo to trigger Wix auth\n  sendToWix('loginForApplication', { mode: mode });\n}\n\nfunction validateApplicationForm() {\n  let isValid = true;\n  const phone = document.getElementById('appPhone');\n  const email = document.getElementById('appEmail');\n  const phoneError = document.getElementById('phoneError');\n  const emailError = document.getElementById('emailError');\n  const cdlError = document.getElementById('cdlError');\n  const medCardError = document.getElementById('medCardError');\n\n  // Reset errors\n  phone.classList.remove('error');\n  email.classList.remove('error');\n  phoneError.classList.remove('show');\n  emailError.classList.remove('show');\n  cdlError.classList.remove('show');\n  medCardError.classList.remove('show');\n  document.querySelectorAll('.file-upload-box').forEach(el => el.classList.remove('error'));\n\n  // Reset DOB and name field errors\n  const appDOB = document.getElementById('appDOB');\n  const dobErrorEl = document.getElementById('dobError');\n  const appFirstName = document.getElementById('appFirstName');\n  const firstNameError = document.getElementById('firstNameError');\n  const appLastName = document.getElementById('appLastName');\n  const lastNameError = document.getElementById('lastNameError');\n  if (appDOB) appDOB.classList.remove('error');\n  if (dobErrorEl) dobErrorEl.classList.remove('show');\n  if (appFirstName) appFirstName.classList.remove('error');\n  if (firstNameError) firstNameError.classList.remove('show');\n  if (appLastName) appLastName.classList.remove('error');\n  if (lastNameError) lastNameError.classList.remove('show');\n\n  // CDL validation (both front and back required)\n  const hasCdlFront = uploadedFiles.cdlFront || (driverProfile && driverProfile.cdl_front_image);\n  const hasCdlBack = uploadedFiles.cdlBack || (driverProfile && driverProfile.cdl_back_image);\n\n  if (!hasCdlFront || !hasCdlBack) {\n    if (!hasCdlFront) document.getElementById('cdlFrontBox').classList.add('error');\n    if (!hasCdlBack) document.getElementById('cdlBackBox').classList.add('error');\n    cdlError.classList.add('show');\n    isValid = false;\n  }\n\n  // Medical card validation\n  const hasMedCard = uploadedFiles.medCard || (driverProfile && driverProfile.med_card_image);\n  if (!hasMedCard) {\n    document.getElementById('medCardBox').classList.add('error');\n    medCardError.classList.add('show');\n    isValid = false;\n  }\n\n  // First name validation\n  const firstName = document.getElementById('appFirstName');\n  const firstNameErr = document.getElementById('firstNameError');\n  if (!firstName.value.trim()) {\n    firstName.classList.add('error');\n    firstNameErr.classList.add('show');\n    isValid = false;\n  } else {\n    firstName.classList.remove('error');\n    firstNameErr.classList.remove('show');\n  }\n\n  // Last name validation\n  const lastName = document.getElementById('appLastName');\n  const lastNameErr = document.getElementById('lastNameError');\n  if (!lastName.value.trim()) {\n    lastName.classList.add('error');\n    lastNameErr.classList.add('show');\n    isValid = false;\n  } else {\n    lastName.classList.remove('error');\n    lastNameErr.classList.remove('show');\n  }\n\n  // Date of Birth validation (required for driver profiles)\n  const dob = document.getElementById('appDOB');\n  const dobError = document.getElementById('dobError');\n  if (!dob.value) {\n    dob.classList.add('error');\n    dobError.classList.add('show');\n    isValid = false;\n    console.log('? DOB validation failed - field is empty');\n  } else {\n    dob.classList.remove('error');\n    dobError.classList.remove('show');\n    console.log('? DOB validation passed:', dob.value);\n  }\n\n  // CDL number validation\n  const cdlNumber = document.getElementById('cdlNumber');\n  const cdlNumberError = document.getElementById('cdlNumberError');\n  if (!cdlNumber.value.trim()) {\n    cdlNumber.classList.add('error');\n    cdlNumberError.classList.add('show');\n    isValid = false;\n  } else {\n    cdlNumber.classList.remove('error');\n    cdlNumberError.classList.remove('show');\n  }\n\n  // CDL expiration validation\n  const cdlExpiration = document.getElementById('cdlExpiration');\n  const cdlExpirationError = document.getElementById('cdlExpirationError');\n  if (!cdlExpiration.value) {\n    cdlExpiration.classList.add('error');\n    cdlExpirationError.classList.add('show');\n    isValid = false;\n  } else {\n    cdlExpiration.classList.remove('error');\n    cdlExpirationError.classList.remove('show');\n  }\n\n  // Medical card expiration validation\n  const medCardExpiration = document.getElementById('medCardExpiration');\n  const medCardExpirationError = document.getElementById('medCardExpirationError');\n  if (!medCardExpiration.value) {\n    medCardExpiration.classList.add('error');\n    medCardExpirationError.classList.add('show');\n    isValid = false;\n  } else {\n    medCardExpiration.classList.remove('error');\n    medCardExpirationError.classList.remove('show');\n  }\n\n  // Phone validation\n  const phoneValue = phone.value.trim();\n  if (!phoneValue || phoneValue.length < 10) {\n    phone.classList.add('error');\n    phoneError.classList.add('show');\n    isValid = false;\n  }\n\n  // Email validation\n  const emailValue = email.value.trim();\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailValue || !emailRegex.test(emailValue)) {\n    email.classList.add('error');\n    emailError.classList.add('show');\n    isValid = false;\n  }\n\n  // Companies count validation\n  const companiesCount = document.getElementById('appCompaniesCount');\n  const companiesCountError = document.getElementById('companiesCountError');\n  if (!companiesCount.value) {\n    companiesCount.classList.add('error');\n    companiesCountError.classList.add('show');\n    isValid = false;\n  } else {\n    companiesCount.classList.remove('error');\n    companiesCountError.classList.remove('show');\n  }\n\n  // Employer 1 validation (required when companies >= 1)\n  const companiesCountVal = parseInt(companiesCount.value) || 0;\n  if (companiesCountVal >= 1) {\n    const employer1Name = document.getElementById('appEmployer1Name');\n    const employer1NameError = document.getElementById('employer1NameError');\n    const employer1Duration = document.getElementById('appEmployer1Duration');\n    const employer1DurationError = document.getElementById('employer1DurationError');\n\n    if (!employer1Name.value.trim()) {\n      employer1Name.classList.add('error');\n      employer1NameError.classList.add('show');\n      isValid = false;\n    } else {\n      employer1Name.classList.remove('error');\n      employer1NameError.classList.remove('show');\n    }\n\n    if (!employer1Duration.value) {\n      employer1Duration.classList.add('error');\n      employer1DurationError.classList.add('show');\n      isValid = false;\n    } else {\n      employer1Duration.classList.remove('error');\n      employer1DurationError.classList.remove('show');\n    }\n  }\n\n  return isValid;\n}\n\nasync function submitApplication() {\n  if (!validateApplicationForm()) return;\n  if (!currentApplicationCarrier) return;\n  if (typeof FeatureTracker !== 'undefined') FeatureTracker.click('matching_submit_application', { carrierName: currentApplicationCarrier.name, dotNumber: currentApplicationCarrier.dotNumber });\n\n  // LOGIN GATE: If not logged in, prompt sign-up instead of submitting\n  if (!userStatus.loggedIn) {\n    console.log('?? User not logged in - showing login prompt');\n    pendingApplicationData = { carrierData: currentApplicationCarrier };\n    showLoginPrompt();\n    return;\n  }\n\n  // Show loading state\n  applicationFormContent.style.display = 'none';\n  applicationFormLoading.classList.add('show');\n\n  // Get loading text element\n  const loadingText = document.getElementById('applicationLoadingText');\n  if (loadingText) loadingText.textContent = 'Submitting your application...';\n\n  // Show OCR processing message after 2 seconds (documents are uploaded first, then OCR runs)\n  appOcrTimeout = setTimeout(() => {\n    if (loadingText) loadingText.textContent = 'Gemini AI is extracting your document data...';\n  }, 2000);\n\n  // Show profile update message after 5 seconds\n  appProfileTimeout = setTimeout(() => {\n    if (loadingText) loadingText.textContent = 'Updating your driver profile...';\n  }, 5000);\n\n  try {\n    // Compress and convert files to base64 (prevents 413 Payload Too Large errors)\n    const [cdlFrontData, cdlBackData, medCardData] = await Promise.all([\n      compressImageForUpload(uploadedFiles.cdlFront),\n      compressImageForUpload(uploadedFiles.cdlBack),\n      compressImageForUpload(uploadedFiles.medCard)\n    ]);\n\n    // Collect multi-select values\n    const getCheckedValues = (name) => {\n      return Array.from(document.querySelectorAll(`input[name=\"${name}\"]:checked`)).map(el => el.value);\n    };\n\n    // Get form data with all fields matching seeded driver schema\n    const formData = {\n      // Carrier info\n      carrierDOT: currentApplicationCarrier.dotNumber,\n      carrierName: currentApplicationCarrier.name,\n      matchScore: currentApplicationCarrier.matchScore || 0,\n\n      // Driver identity (NEW - from OCR or manual)\n      firstName: document.getElementById('appFirstName').value.trim(),\n      lastName: document.getElementById('appLastName').value.trim(),\n      dob: document.getElementById('appDOB')?.value || null, // Date of Birth from OCR\n\n      // Contact info\n      phone: document.getElementById('appPhone').value.trim(),\n      email: document.getElementById('appEmail').value.trim(),\n      preferredContact: document.querySelector('input[name=\"preferredContact\"]:checked')?.value || 'phone',\n\n      // Location (NEW)\n      city: document.getElementById('appCity').value.trim(),\n      state: document.getElementById('appState').value,\n      homeZip: document.getElementById('appZip').value.trim(),\n\n      // CDL info\n      cdlNumber: document.getElementById('cdlNumber').value.trim(),\n      cdlExpiration: document.getElementById('cdlExpiration').value,\n      cdlClass: document.querySelector('input[name=\"cdlClass\"]:checked')?.value || '', // NEW\n      endorsements: getCheckedValues('endorsements'), // NEW - array\n      cdlRestrictions: window.extractedRestrictions || 'NONE', // From OCR - \"NONE\" = no restrictions (favorable)\n      medCardExpiration: document.getElementById('medCardExpiration').value,\n\n      // Experience (NEW)\n      yearsExperience: parseInt(document.getElementById('appYearsExperience').value) || 0,\n      equipmentExperience: getCheckedValues('equipmentExperience'), // NEW - array\n      mvrStatus: document.getElementById('appMvrStatus').value, // NEW\n\n      // Safety Record (NEW) - Use camelCase to match page code expectations\n      accidentsLast3Years: parseInt(document.getElementById('appAccidents').value) || 0,\n      violationsLast3Years: parseInt(document.getElementById('appViolations').value) || 0,\n\n      // Work History (NEW) - Use camelCase to match page code expectations\n      companiesLast3Years: parseInt(document.getElementById('appCompaniesCount').value) || 0,\n      employer1Name: document.getElementById('appEmployer1Name').value.trim(),\n      employer1Duration: document.getElementById('appEmployer1Duration').value,\n      employer2Name: document.getElementById('appEmployer2Name').value.trim(),\n      employer2Duration: document.getElementById('appEmployer2Duration').value,\n      employer3Name: document.getElementById('appEmployer3Name').value.trim(),\n      employer3Duration: document.getElementById('appEmployer3Duration').value,\n\n      // Preferences (NEW)\n      preferredRoutes: getCheckedValues('preferredRoutes'), // NEW - array\n      homeTimePreference: document.getElementById('appHomeTime').value, // NEW\n      availability: document.getElementById('appAvailability').value,\n\n      // Message\n      message: document.getElementById('appMessage').value.trim(),\n\n      // Documents\n      documents: {\n        cdlFront: uploadedFiles.cdlFront ? { data: cdlFrontData, name: uploadedFiles.cdlFront.name, type: uploadedFiles.cdlFront.type } : null,\n        cdlBack: uploadedFiles.cdlBack ? { data: cdlBackData, name: uploadedFiles.cdlBack.name, type: uploadedFiles.cdlBack.type } : null,\n        medCard: uploadedFiles.medCard ? { data: medCardData, name: uploadedFiles.medCard.name, type: uploadedFiles.medCard.type } : null\n      },\n      existingProfileDocs: {\n        cdl_front_image: driverProfile?.cdl_front_image,\n        cdl_back_image: driverProfile?.cdl_back_image,\n        med_card_image: driverProfile?.med_card_image,\n        resume_file: driverProfile?.resume_file\n      }\n    };\n\n    // DEBUG: Log all collected form data\n    console.log('=== APPLICATION FORM DATA DEBUG ===');\n    console.log('firstName:', formData.firstName);\n    console.log('lastName:', formData.lastName);\n    console.log('dob:', formData.dob);\n    console.log('dob element exists:', !!document.getElementById('appDOB'));\n    console.log('dob element value:', document.getElementById('appDOB')?.value);\n    console.log('city:', formData.city);\n    console.log('state:', formData.state);\n    console.log('homeZip:', formData.homeZip);\n    console.log('cdlClass:', formData.cdlClass);\n    console.log('endorsements:', formData.endorsements);\n    console.log('cdlRestrictions:', formData.cdlRestrictions);\n    console.log('yearsExperience:', formData.yearsExperience);\n    console.log('equipmentExperience:', formData.equipmentExperience);\n    console.log('mvrStatus:', formData.mvrStatus);\n    console.log('accidentsLast3Years:', formData.accidentsLast3Years);\n    console.log('violationsLast3Years:', formData.violationsLast3Years);\n    console.log('companiesLast3Years:', formData.companiesLast3Years);\n    console.log('employer1Name:', formData.employer1Name);\n    console.log('employer1Duration:', formData.employer1Duration);\n    console.log('employer2Name:', formData.employer2Name);\n    console.log('employer2Duration:', formData.employer2Duration);\n    console.log('employer3Name:', formData.employer3Name);\n    console.log('employer3Duration:', formData.employer3Duration);\n    console.log('preferredRoutes:', formData.preferredRoutes);\n    console.log('homeTimePreference:', formData.homeTimePreference);\n    console.log('=== END DEBUG ===');\n\n    console.log('Submitting application with documents');\n    sendToWix('submitApplication', formData);\n  } catch (error) {\n    // Clear OCR animation timeouts\n    if (appOcrTimeout) clearTimeout(appOcrTimeout);\n    if (appProfileTimeout) clearTimeout(appProfileTimeout);\n\n    console.error('Error processing files:', error);\n    applicationFormLoading.classList.remove('show');\n    applicationFormContent.style.display = 'block';\n    showToast('Error processing files. Please try again.');\n  }\n}\n\nfunction checkPreFilledDocs() {\n  if (!driverProfile) return;\n\n  const docs = [\n    { id: 'cdlFront', url: driverProfile.cdl_front_image },\n    { id: 'cdlBack', url: driverProfile.cdl_back_image },\n    { id: 'medCard', url: driverProfile.med_card_image }\n  ];\n\n  docs.forEach(doc => {\n    if (doc.url) {\n      const box = document.getElementById(doc.id + 'Box');\n      const nameEl = document.getElementById(doc.id + 'Name');\n      if (box && nameEl) {\n        box.classList.add('has-file');\n        box.style.borderColor = 'var(--color-success)';\n        nameEl.innerHTML = `<i class=\"fa-solid fa-check-circle\" style=\"color: var(--color-success)\"></i> Attached from Profile`;\n      }\n    }\n  });\n}\n\nfunction handleApplicationSubmitted(data) {\n  // Clear OCR animation timeouts\n  if (appOcrTimeout) clearTimeout(appOcrTimeout);\n  if (appProfileTimeout) clearTimeout(appProfileTimeout);\n\n  // Hide loading\n  applicationFormLoading.classList.remove('show');\n\n  if (data.success) {\n    // Show success state\n    applicationFormSuccess.classList.add('show');\n\n    // Update the card to show \"Applied\" status\n    updateCardToApplied(data.carrierDOT);\n  } else if (data.isDuplicate) {\n    // Handle duplicate submission - show friendly message and update card\n    console.log('?? Duplicate application detected:', data.existingStatus);\n\n    // Still update the card since they already applied\n    updateCardToApplied(currentApplicationCarrier?.dot);\n\n    // Show success state with modified message\n    applicationFormSuccess.classList.add('show');\n    const successTitle = applicationFormSuccess.querySelector('h3');\n    const successMsg = applicationFormSuccess.querySelector('p');\n    if (successTitle) successTitle.textContent = 'Already Applied!';\n    if (successMsg) successMsg.textContent = `You've already applied to this carrier. Your application is currently \"${formatStatus(data.existingStatus)}\". Check your dashboard to track progress.`;\n  } else {\n    // Show form again with error\n    applicationFormContent.style.display = 'block';\n    showToast('Error submitting application: ' + (data.error || 'Unknown error'));\n  }\n}\n\nfunction updateCardToApplied(carrierDOT) {\n  if (!carrierDOT) return;\n\n  const dotStr = String(carrierDOT);\n  appliedCarrierDOTs.add(dotStr);\n  const card = document.querySelector(`.match-card[data-dot=\"${dotStr}\"]`);\n  if (card) {\n    // Add the tag\n    const tagsContainer = card.querySelector('.match-tags');\n    if (tagsContainer && !tagsContainer.querySelector('.match-tag.applied')) {\n      tagsContainer.insertAdjacentHTML('afterbegin',\n        '<span class=\"match-tag applied\" style=\"background: #10b98115; color: #10b981; border: 1px solid #10b98130; font-weight: 800;\"><i class=\"fa-solid fa-check-circle\"></i> Applied</span>');\n    }\n    // Update the button\n    const btn = card.querySelector('.interested-btn');\n    if (btn) {\n      btn.classList.add('applied');\n      btn.disabled = true;\n      btn.innerHTML = '<i class=\"fa-solid fa-check\"></i> Application Sent';\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-renderers.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'renderMatchCard' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'renderErrorState' is defined but never used.","line":450,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":450,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'renderApplications' is defined but never used.","line":481,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":481,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ai-matching-renderers.js  Match card + FMCSA + AI Intel rendering\n// Depends on: ai-matching-helpers.js, ai-matching-bridge.js\n\nfunction renderMatchCard(match, rank) {\n  const carrier = match.carrier || {};\n  const enrichment = match.enrichment || {};\n  const fmcsa = enrichment.fmcsa || match.fmcsa || {};\n  const fromCache = match.fromCache;\n\n  const carrierName = carrier.LEGAL_NAME || carrier.DBA_NAME || 'Unknown Carrier';\n  const location = `${carrier.PHY_CITY || ''}, ${carrier.PHY_STATE || ''}`.replace(/^, |, $/g, '') || 'Location Unknown';\n  const dotNumber = carrier.DOT_NUMBER || 'N/A';\n  const payDisplay = carrier.PAY_CPM ? `$${carrier.PAY_CPM.toFixed(2)}` : 'N/A';\n  const fleetDisplay = carrier.NBR_POWER_UNIT || 'N/A';\n  const turnoverDisplay = carrier.TURNOVER_PERCENT ? `${carrier.TURNOVER_PERCENT.toFixed(0)}%` : 'N/A';\n  const truckAgeDisplay = carrier.AVG_TRUCK_AGE ? `${carrier.AVG_TRUCK_AGE.toFixed(1)} yr` : 'N/A';\n\n  const fmcsaHTML = renderFMCSASection(fmcsa, dotNumber);\n\n  let aiIntelHTML = '';\n  if (enrichment && !enrichment.error && enrichment.ai_summary) {\n    aiIntelHTML = renderAIIntelBlock(enrichment);\n  } else if (match.needsEnrichment) {\n    if (String(dotNumber) === String(window._autoEnrichDot)) {\n      // This DOT is being auto-enriched  show loading state\n      aiIntelHTML = `\n        <div class=\"ai-intel-section\">\n          <div class=\"ai-intel-loading\" id=\"loading-${dotNumber}\">\n            <i class=\"fa-solid fa-robot fa-bounce\"></i>\n            <div class=\"ai-intel-loading-text\">AI Researching...</div>\n            <div class=\"ai-intel-loading-sub\">Searching job boards & driver reviews</div>\n            <div class=\"ai-intel-loading-progress\">\n              <div class=\"ai-intel-loading-progress-bar\"></div>\n            </div>\n          </div>\n        </div>\n      `;\n    } else {\n      // Other matches: on-demand button\n      aiIntelHTML = `\n        <div class=\"ai-intel-section\">\n          <div class=\"ai-intel-ondemand\" id=\"ondemand-${dotNumber}\">\n            <button class=\"btn-get-ai-profile\" onclick=\"window.retryEnrichment('${dotNumber}')\">\n              <i class=\"fa-solid fa-brain\"></i> Get AI Profile\n            </button>\n            <div class=\"ai-intel-ondemand-sub\">Pay data, driver reviews & hiring intel</div>\n          </div>\n        </div>\n      `;\n    }\n  }\n\n  const tags = [];\n\n  // Add \"Applied\" tag if driver has already applied\n  if (appliedCarrierDOTs.has(String(dotNumber))) {\n    tags.push(`<span class=\"match-tag applied\" style=\"background: #10b98115; color: #10b981; border: 1px solid #10b98130; font-weight: 800;\"><i class=\"fa-solid fa-check-circle\"></i> Applied</span>`);\n  }\n\n  tags.push(`<span class=\"match-tag operation\">${match.inferredOpType || 'Regional'}</span>`);\n  tags.push(`<span class=\"match-tag fleet\">${categorizeFleet(carrier.NBR_POWER_UNIT)}</span>`);\n  if (fromCache) {\n    tags.push(`<span class=\"match-tag cached\"><i class=\"fa-solid fa-bolt\"></i> Instant</span>`);\n  }\n  if (carrier.isClient) {\n    tags.push(`<span class=\"match-tag client\"><i class=\"fa-solid fa-star\"></i> Partner</span>`);\n  }\n\n  // Add Responsiveness Signal\n  const stats = match.recruiterStats;\n  if (stats && stats.badge) {\n    tags.push(`<span class=\"match-tag\" style=\"background: ${stats.badge_color}15; color: ${stats.badge_color}; border: 1px solid ${stats.badge_color}30; font-weight: 800;\"><i class=\"fa-solid fa-bolt-lightning\"></i> ${stats.badge}</span>`);\n  }\n\n  return `\n    <div class=\"match-card\" data-dot=\"${dotNumber}\">\n      \n      <div class=\"match-card-header\">\n        <div class=\"match-rank\">${rank}</div>\n        <div class=\"match-info\">\n          <div class=\"match-name\">${escapeHtml(carrierName)}</div>\n          <div class=\"match-location\">\n            <i class=\"fa-solid fa-location-dot\"></i> ${escapeHtml(location)}\n         </div>\n          <div class=\"match-dot-number\">DOT: ${dotNumber}</div>\n       </div>\n        <div class=\"match-score-block\">\n          <div class=\"match-score-value\">${match.overallScore || 0}%</div>\n          <div class=\"match-score-label\">Match Score</div>\n       </div>\n     </div>\n      \n      ${fmcsaHTML}\n      \n      <div class=\"carrier-metrics\">\n        <div class=\"carrier-metric\">\n          <div class=\"carrier-metric-value\">${payDisplay}</div>\n          <div class=\"carrier-metric-label\">CPM</div>\n       </div>\n        <div class=\"carrier-metric\">\n          <div class=\"carrier-metric-value\">${fleetDisplay}</div>\n          <div class=\"carrier-metric-label\">Fleet Size</div>\n       </div>\n        <div class=\"carrier-metric\">\n          <div class=\"carrier-metric-value\">${turnoverDisplay}</div>\n          <div class=\"carrier-metric-label\">Turnover</div>\n       </div>\n        <div class=\"carrier-metric\">\n          <div class=\"carrier-metric-value\">${truckAgeDisplay}</div>\n          <div class=\"carrier-metric-label\">Truck Age</div>\n       </div>\n     </div>\n      \n      <div class=\"match-tags\">\n        ${tags.join('')}\n     </div>\n      \n     ${match.isMutualMatch ? `\n        <div class=\"mutual-interest-panel\">\n           <div class=\"mutual-header\">\n              <div class=\"mutual-badge\">\n                 <i class=\"fa-solid fa-handshake\"></i> Mutual Match\n              </div>\n              <div class=\"mutual-strength ${match.mutualStrength || 'weak'}\">\n                 Signal Strength: <span>${(match.mutualStrength || 'Weak').toUpperCase()}</span>\n              </div>\n           </div>\n           <div class=\"mutual-timeline\">\n              ${match.mutualSignals && match.mutualSignals.includes('viewed') ? `\n                 <div class=\"mutual-event\">\n                    <i class=\"fa-solid fa-eye\"></i> Carrier viewed your profile\n                 </div>\n              ` : ''}\n               ${match.mutualSignals && match.mutualSignals.includes('pipeline') ? `\n                 <div class=\"mutual-event\">\n                    <i class=\"fa-solid fa-user-plus\"></i> Added to shortlist\n                 </div>\n              ` : ''}\n               ${match.mutualSignals && match.mutualSignals.includes('contacted') ? `\n                 <div class=\"mutual-event strong\">\n                    <i class=\"fa-solid fa-envelope\"></i> Contacted you directly\n                 </div>\n              ` : ''}\n           </div>\n        </div>\n     ` : ''}\n\n      ${aiIntelHTML}\n\n      ${match.rationale && match.rationale.length > 0 ? `\n        <div class=\"match-rationale\" id=\"rationale-${dotNumber}\">\n          <div class=\"rationale-header\"><i class=\"fa-solid fa-list-check\"></i> Why this is a match</div>\n          <ul class=\"rationale-list\">\n            ${match.rationale.map(r => `\n              <li class=\"rationale-item\"><i class=\"fa-solid fa-check\"></i> ${escapeHtml(r)}</li>\n            `).join('')}\n          </ul>\n       </div>\n      ` : ''}\n      \n      <div class=\"match-actions\">\n        <button class=\"${appliedCarrierDOTs.has(String(dotNumber)) ? 'interested-btn applied' : 'interested-btn'}\"\n          data-dot=\"${dotNumber}\"\n          data-name=\"${escapeHtml(carrierName)}\"\n          data-score=\"${match.overallScore || 0}\"\n          ${appliedCarrierDOTs.has(String(dotNumber)) ? 'disabled' : ''}>\n          <i class=\"fa-solid ${appliedCarrierDOTs.has(String(dotNumber)) ? 'fa-check' : 'fa-heart'}\"></i> \n          ${appliedCarrierDOTs.has(String(dotNumber)) ? 'Application Sent' : \"I'm Interested\"}\n        </button>\n        <button class=\"analysis-btn expand-explanation-btn\" id=\"analysis-btn-${dotNumber}\"\n          data-carrier-dot=\"${dotNumber}\" data-driver-id=\"${match.driverId || 'CURRENT_USER'}\">\n          <span>Why this job?</span> <i class=\"fa-solid fa-chevron-down\"></i>\n        </button>\n        <button class=\"match-btn secondary\" \n                onclick=\"window.open('https://safer.fmcsa.dot.gov/query.asp?searchtype=ANY&query_type=queryCarrierSnapshot&query_param=USDOT&query_string=${dotNumber}', '_blank')\">\n          <i class=\"fa-solid fa-shield-halved\"></i> FMCSA\n        </button>\n     </div>\n\n     <!-- Explanation Panel (Hidden by default) -->\n     <div class=\"explanation-panel\">\n        <div class=\"explanation-content\">\n            <!-- Content injected via JS -->\n        </div>\n     </div>\n   </div>\n  `;\n}\n\nfunction renderFMCSASection(fmcsa, dotNumber) {\n  if (!fmcsa || fmcsa.error) {\n    return `\n      <div class=\"fmcsa-section error\">\n        <div class=\"fmcsa-header\">\n          <div class=\"fmcsa-badge unknown\">\n            <i class=\"fa-solid fa-question-circle\"></i>\n            FMCSA: Verification Pending\n         </div>\n          <div class=\"fmcsa-source\">\n            <a href=\"https://safer.fmcsa.dot.gov/query.asp?searchtype=ANY&query_type=queryCarrierSnapshot&query_param=USDOT&query_string=${fmcsa?.dot_number || dotNumber}\" target=\"_blank\">\n              <i class=\"fa-solid fa-external-link-alt\"></i> Check FMCSA Directly\n            </a>\n         </div>\n       </div>\n        <p style=\"font-size: 13px; color: #92400e; margin: 0;\">\n          ${fmcsa?.error_message || 'Safety data is being retrieved. Check back shortly or verify directly with FMCSA.'}\n        </p>\n     </div>\n    `;\n  }\n\n  const rating = (fmcsa.safety_rating || 'UNKNOWN').toUpperCase();\n  let sectionClass = 'unknown';\n  let badgeClass = 'unknown';\n  let ratingDisplay = 'Not Rated';\n  let ratingIcon = 'fa-question-circle';\n\n  if (rating === 'SATISFACTORY') {\n    sectionClass = '';\n    badgeClass = 'satisfactory';\n    ratingDisplay = 'Satisfactory';\n    ratingIcon = 'fa-shield-check';\n  } else if (rating === 'CONDITIONAL') {\n    sectionClass = 'conditional';\n    badgeClass = 'conditional';\n    ratingDisplay = 'Conditional';\n    ratingIcon = 'fa-triangle-exclamation';\n  } else if (rating === 'UNSATISFACTORY') {\n    sectionClass = 'unsatisfactory';\n    badgeClass = 'unsatisfactory';\n    ratingDisplay = 'Unsatisfactory';\n    ratingIcon = 'fa-times-circle';\n  } else if (rating === 'NOT RATED' || rating === 'N') {\n    sectionClass = 'not-rated';\n    badgeClass = 'not-rated';\n    ratingDisplay = 'Not Rated';\n    ratingIcon = 'fa-minus-circle';\n  }\n\n  const inspections = fmcsa.inspections_24mo || {};\n  const driverOOS = inspections.driver_oos_rate;\n  const vehicleOOS = inspections.vehicle_oos_rate;\n  const nationalDriverOOS = inspections.national_avg_driver_oos || 5.51;\n  const nationalVehicleOOS = inspections.national_avg_vehicle_oos || 20.72;\n  const totalInspections = inspections.total || 0;\n\n  const crashes = fmcsa.crashes_24mo || {};\n  const totalCrashes = crashes.total || 0;\n  const fatalCrashes = crashes.fatal || 0;\n\n  const isAuthorized = fmcsa.is_authorized !== false && fmcsa.operating_status !== 'NOT AUTHORIZED';\n\n  const basics = fmcsa.basics || {};\n  const alerts = [];\n  Object.entries(basics).forEach(([key, value]) => {\n    if (value && value.alert) {\n      alerts.push(formatBasicName(key));\n    }\n  });\n\n  const driverOOSClass = driverOOS !== null && driverOOS !== undefined\n    ? (driverOOS < nationalDriverOOS ? 'good' : driverOOS > nationalDriverOOS * 1.5 ? 'danger' : 'warning')\n    : 'neutral';\n  const driverOOSCompare = driverOOS !== null && driverOOS !== undefined\n    ? (driverOOS < nationalDriverOOS ? 'better' : 'worse')\n    : '';\n\n  const vehicleOOSClass = vehicleOOS !== null && vehicleOOS !== undefined\n    ? (vehicleOOS < nationalVehicleOOS ? 'good' : vehicleOOS > nationalVehicleOOS * 1.5 ? 'danger' : 'warning')\n    : 'neutral';\n  const vehicleOOSCompare = vehicleOOS !== null && vehicleOOS !== undefined\n    ? (vehicleOOS < nationalVehicleOOS ? 'better' : 'worse')\n    : '';\n\n  const crashClass = totalCrashes === 0 ? 'good' : totalCrashes > 5 ? 'danger' : 'warning';\n\n  return `\n    <div class=\"fmcsa-section ${sectionClass}\">\n      <div class=\"fmcsa-header\">\n        <div style=\"display: flex; align-items: center; gap: 12px; flex-wrap: wrap;\">\n          <div class=\"fmcsa-badge ${badgeClass}\">\n            <i class=\"fa-solid ${ratingIcon}\"></i>\n            FMCSA: ${ratingDisplay}\n         </div>\n          ${isAuthorized\n      ? `<div class=\"fmcsa-auth-status authorized\"><i class=\"fa-solid fa-check\"></i> Authorized</div>`\n      : `<div class=\"fmcsa-auth-status not-authorized\"><i class=\"fa-solid fa-ban\"></i> Not Authorized</div>`\n    }\n       </div>\n        <div class=\"fmcsa-source\">\n          <i class=\"fa-solid fa-check-circle\"></i> Federal Safety Data\n          <a href=\"https://safer.fmcsa.dot.gov/query.asp?searchtype=ANY&query_type=queryCarrierSnapshot&query_param=USDOT&query_string=${fmcsa.dot_number || dotNumber}\" target=\"_blank\" style=\"margin-left: 8px;\">\n            View Full Report\n          </a>\n       </div>\n     </div>\n      \n      <div class=\"fmcsa-grid\">\n        <div class=\"fmcsa-stat\">\n          <div class=\"fmcsa-stat-value ${driverOOSClass}\">\n            ${driverOOS !== null && driverOOS !== undefined ? driverOOS.toFixed(1) + '%' : 'N/A'}\n         </div>\n          <div class=\"fmcsa-stat-label\">Driver OOS Rate</div>\n          <div class=\"fmcsa-stat-compare ${driverOOSCompare}\">\n            ${driverOOS !== null && driverOOS !== undefined\n      ? (driverOOS < nationalDriverOOS ? '? Below' : '? Above') + ` ${nationalDriverOOS}% avg`\n      : 'Nat\\'l avg: ' + nationalDriverOOS + '%'}\n         </div>\n       </div>\n        <div class=\"fmcsa-stat\">\n          <div class=\"fmcsa-stat-value ${vehicleOOSClass}\">\n            ${vehicleOOS !== null && vehicleOOS !== undefined ? vehicleOOS.toFixed(1) + '%' : 'N/A'}\n         </div>\n          <div class=\"fmcsa-stat-label\">Vehicle OOS Rate</div>\n          <div class=\"fmcsa-stat-compare ${vehicleOOSCompare}\">\n            ${vehicleOOS !== null && vehicleOOS !== undefined\n      ? (vehicleOOS < nationalVehicleOOS ? '? Below' : '? Above') + ` ${nationalVehicleOOS}% avg`\n      : 'Nat\\'l avg: ' + nationalVehicleOOS + '%'}\n         </div>\n       </div>\n        <div class=\"fmcsa-stat\">\n          <div class=\"fmcsa-stat-value ${crashClass}\">\n            ${totalCrashes}\n         </div>\n          <div class=\"fmcsa-stat-label\">Crashes (24mo)</div>\n          <div class=\"fmcsa-stat-compare\">\n            ${fatalCrashes > 0 ? `<span style=\"color: var(--color-danger);\">${fatalCrashes} fatal</span>` : 'No fatalities'}\n         </div>\n       </div>\n        <div class=\"fmcsa-stat\">\n          <div class=\"fmcsa-stat-value neutral\">${totalInspections || 'N/A'}</div>\n          <div class=\"fmcsa-stat-label\">Inspections</div>\n          <div class=\"fmcsa-stat-compare\">Last 24 months</div>\n       </div>\n     </div>\n      \n      ${alerts.length > 0 ? `\n        <div class=\"basic-alerts\">\n          <div class=\"basic-alerts-title\">\n            <i class=\"fa-solid fa-triangle-exclamation\"></i> BASIC Score Alerts\n         </div>\n          ${alerts.map(a => `\n            <div class=\"basic-alert-item\">\n              <i class=\"fa-solid fa-exclamation-circle\"></i> ${a}\n           </div>\n          `).join('')}\n       </div>\n      ` : ''}\n      \n      ${fmcsa.fromCache ? `\n        <div style=\"margin-top: 12px; font-size: 11px; color: #94a3b8;\">\n          <i class=\"fa-solid fa-clock\"></i> Data cached ${fmcsa.cache_age_days ? fmcsa.cache_age_days + ' days ago' : 'recently'}\n       </div>\n      ` : ''}\n   </div>\n  `;\n}\n\nfunction renderAIIntelBlock(data) {\n  const confidence = data.data_confidence || 'Low';\n  const confidenceClass = confidence.toLowerCase();\n  const isLowConfidence = confidence === 'Low' || confidence === 'None';\n\n  const pros = safeJsonParse(data.sentiment_pros);\n  const cons = safeJsonParse(data.sentiment_cons);\n  const sources = safeJsonParse(data.sources_found);\n\n  const hasPayData = checkValidData(data.pay_cpm_range);\n  const hasSignOnBonus = checkValidData(data.sign_on_bonus);\n  const hasAnyIntel = hasPayData || checkValidData(data.freight_types) || checkValidData(data.home_time);\n\n  // Use partial styling for low confidence\n  const containerClass = isLowConfidence && hasAnyIntel ? 'ai-intel-partial' : 'ai-intel-content';\n\n  return `\n    <div class=\"ai-intel-section\">\n      <div class=\"${containerClass}\">\n        <div class=\"ai-intel-header\">\n          <span class=\"ai-intel-title\">\n            <i class=\"fa-solid fa-brain\"></i> AI Market Intel\n          </span>\n          <span class=\"confidence-pill ${confidenceClass}\">${confidence} Confidence</span>\n       </div>\n        \n        ${isLowConfidence ? `\n          <div class=\"ai-intel-partial-notice\">\n            <i class=\"fa-solid fa-info-circle\"></i>\n            Limited data available. Some details inferred from industry standards.\n         </div>\n        ` : ''}\n\n        <div class=\"ai-intel-body\">\n          \n          ${hasPayData ? `\n            <div class=\"pay-highlight-box\">\n              <div class=\"pay-highlight-icon\"><i class=\"fa-solid fa-dollar-sign\"></i></div>\n              <div>\n                <div class=\"pay-highlight-value\">${escapeHtml(data.pay_cpm_range)}</div>\n                <div class=\"pay-highlight-bonus\">\n                  ${hasSignOnBonus ? 'Sign-on: ' + escapeHtml(data.sign_on_bonus) : 'Based on 2025 market data'}\n               </div>\n             </div>\n           </div>\n          ` : ''}\n          \n          <div class=\"ai-intel-grid\">\n            ${renderIntelItem('Freight', data.freight_types, isLowConfidence)}\n            ${renderIntelItem('Routes', data.route_types, isLowConfidence)}\n            ${renderIntelItem('Home Time', data.home_time, isLowConfidence)}\n            ${renderIntelItem('Benefits', data.benefits, isLowConfidence)}\n            ${renderIntelItem('Hiring Status', data.hiring_status, false)}\n            ${renderIntelItem('Driver Sentiment', data.driver_sentiment, false)}\n         </div>\n          \n          ${(pros.length > 0 || cons.length > 0) ? `\n            <div class=\"sentiment-row\">\n              <div class=\"sentiment-title\"><i class=\"fa-solid fa-comments\"></i> Driver Consensus</div>\n              <div class=\"sentiment-pills\">\n                ${pros.slice(0, 3).map(p => `<span class=\"sentiment-pill pro\"><i class=\"fa-solid fa-thumbs-up\"></i> ${escapeHtml(p)}</span>`).join('')}\n                ${cons.slice(0, 3).map(c => `<span class=\"sentiment-pill con\"><i class=\"fa-solid fa-thumbs-down\"></i> ${escapeHtml(c)}</span>`).join('')}\n             </div>\n           </div>\n          ` : ''}\n          \n          ${data.ai_summary ? `<div class=\"ai-summary\">${formatAISummary(data.ai_summary)}</div>` : ''}\n          \n          ${sources.length > 0 ? `\n            <div class=\"ai-sources-container\">\n              <div class=\"ai-sources-label\"><i class=\"fa-solid fa-link\"></i> Sources</div>\n              <div class=\"ai-sources-list\">\n                ${sources.map(src => {\n    const domain = extractDomain(src);\n    const isUrl = src.startsWith('http');\n    return isUrl\n      ? `<a href=\"${src}\" target=\"_blank\" class=\"source-badge\">\n                         <i class=\"fa-solid fa-arrow-up-right-from-square\"></i> ${domain}\n                       </a>`\n      : `<span class=\"source-text-only\">${escapeHtml(src)}</span>`;\n  }).join('')}\n             </div>\n           </div>\n          ` : ''}\n\n       </div>\n     </div>\n   </div>\n  `;\n}\n\nfunction renderErrorState(data, dotNumber, carrier) {\n  return `\n    <div class=\"ai-intel-partial error\">\n      <div style=\"margin-bottom: 8px;\">\n        <i class=\"fa-solid fa-triangle-exclamation\"></i>\n        AI profile unavailable for <strong>${carrier.LEGAL_NAME || 'this carrier'}</strong>.\n      </div>\n      <button class=\"btn-get-ai-profile btn-retry\" onclick=\"window.retryEnrichment('${dotNumber}')\">\n        <i class=\"fa-solid fa-rotate-right\"></i> Retry AI Profile\n      </button>\n   </div>\n  `;\n}\n\nfunction renderIntelItem(label, value) {\n  if (!value) return '';\n  const isGeneric = !checkValidData(value);\n\n  // Don't show items that are clearly just placeholders\n  if (isGeneric && ['Contact Carrier', 'Unknown', 'N/A'].includes(value)) {\n    return '';\n  }\n\n  return `\n    <div class=\"ai-intel-item\">\n      <strong>${label}</strong>\n      <span>${escapeHtml(value)}</span>\n   </div>\n    `;\n}\n\nfunction renderApplications(apps) {\n  const list = document.getElementById('applicationsList');\n  if (!list) return;\n\n  if (!apps || apps.length === 0) {\n    list.innerHTML = `\n            <div style=\"text-align: center; padding: 40px; color: #64748b;\">\n                <i class=\"fa-solid fa-file-circle-xmark\" style=\"font-size: 48px; margin-bottom: 16px; opacity: 0.5;\"></i>\n                <h3>No Applications Yet</h3>\n                <p>When you apply to carriers, they will appear here.</p>\n                <button class=\"modal-btn primary\" onclick=\"document.querySelector('.nav-tab[data-tab=\\\\'find\\\\']').click()\" style=\"margin-top: 16px; max-width: 200px; margin-left: auto; margin-right: auto;\">Find Carriers</button>\n            </div>\n        `;\n    return;\n  }\n\n  const html = apps.map(app => `\n        <div class=\"app-card\">\n          <div class=\"app-header\">\n            <div>\n              <div class=\"app-carrier-name\">${app.carrierName}</div>\n              <div class=\"app-date\">Applied ${new Date(app.submittedDate).toLocaleDateString()}</div>\n            </div>\n            <div class=\"app-status-badge ${app.status}\">\n              ${getStatusIcon(app.status)} ${formatAppStatus(app.status)}\n            </div>\n          </div>\n          \n          <div class=\"app-timeline\">\n            ${(app.statusHistory || app.timeline || []).map((event, index, arr) => `\n                <div class=\"timeline-item ${index === arr.length - 1 ? 'active' : ''}\">\n                  <div class=\"timeline-dot\"></div>\n                  <div class=\"timeline-content\">\n                    <div class=\"timeline-status\">${event.status}</div>\n                    <div class=\"timeline-date\">${new Date(event.date).toLocaleString()}</div>\n                  </div>\n                </div>\n            `).join('')}\n          </div>\n        </div>\n    `).join('');\n\n  list.innerHTML = html;\n\n  // Update badge\n  const badge = document.getElementById('appCountBadge');\n  if (badge) {\n    badge.textContent = apps.length;\n    badge.style.display = apps.length > 0 ? 'inline-block' : 'none';\n  }\n}\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\driver\\js\\ai-matching-results.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'showLoading' is defined but never used.","line":61,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'showResults' is defined but never used.","line":89,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'updateCardEnrichment' is defined but never used.","line":170,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":170,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'handlePageReady' is defined but never used.","line":319,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":319,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'handleLoginSuccess' is defined but never used.","line":336,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":336,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'handleMatchExplanationResult' is defined but never used.","line":456,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":456,"endColumn":38},{"ruleId":"no-unused-vars","severity":1,"message":"'loadApplications' is defined but never used.","line":515,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":515,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ai-matching-results.js  Results display, enrichment, profile pre-fill\n// Depends on: ai-matching-helpers.js, ai-matching-bridge.js, ai-matching-renderers.js\n\nfunction renderFilteredResults() {\n  let displayMatches = [...allMatches];\n\n  // 1. Filter\n  if (filterMutualOnly) {\n    displayMatches = displayMatches.filter(m => m.isMutualMatch);\n  }\n\n  // 2. Sort\n  displayMatches.sort((a, b) => {\n    if (currentSort === 'mutual') {\n      // Mutual interest first, then strength\n      if (a.isMutualMatch && !b.isMutualMatch) return -1;\n      if (!a.isMutualMatch && b.isMutualMatch) return 1;\n\n      if (a.isMutualMatch && b.isMutualMatch) {\n        const strengthOrder = { 'strong': 3, 'moderate': 2, 'weak': 1 };\n        const scoreA = strengthOrder[a.mutualStrength] || 0;\n        const scoreB = strengthOrder[b.mutualStrength] || 0;\n        if (scoreA !== scoreB) return scoreB - scoreA;\n      }\n    } else if (currentSort === 'pay') {\n      const payA = a.carrier?.PAY_CPM || 0;\n      const payB = b.carrier?.PAY_CPM || 0;\n      if (payA !== payB) return payB - payA;\n    }\n\n    // Default / Tie-breaker: Overall Score\n    const scoreA = a.overallScore || 0;\n    const scoreB = b.overallScore || 0;\n    return scoreB - scoreA;\n  });\n\n  currentMatches = displayMatches; // Update current view reference\n\n  if (displayMatches.length === 0) {\n    matchesList.innerHTML = `\n          <div class=\"no-results\">\n            <i class=\"fa-solid fa-truck-ramp-box\"></i>\n            <h3>No Matches Found</h3>\n            <p>Try adjusting your filters or checking back later.</p>\n         </div>\n        `;\n    matchCountEl.textContent = '0';\n  } else {\n    matchesList.innerHTML = displayMatches.map((match, index) =>\n      renderMatchCard(match, index + 1)\n    ).join('');\n\n    // Re-attach listeners\n    document.querySelectorAll('.interested-btn').forEach(btn => {\n      btn.addEventListener('click', handleInterestClick);\n    });\n    matchCountEl.textContent = displayMatches.length;\n  }\n}\n\nfunction showLoading() {\n  formSection.style.display = 'none';\n  const errorBanner = document.getElementById('searchErrorBanner');\n  if (errorBanner) errorBanner.remove();\n  loadingSection.classList.add('active');\n  resultsSection.style.display = ''; // Clear any inline override\n  resultsSection.classList.remove('active');\n\n  const steps = ['step1', 'step2', 'step3', 'step4'];\n  steps.forEach((id, i) => {\n    setTimeout(() => {\n      for (let j = 0; j < i; j++) {\n        const prev = document.getElementById(steps[j]);\n        prev.classList.remove('active');\n        prev.classList.add('complete');\n        prev.querySelector('i').className = 'fa-solid fa-check';\n      }\n      const curr = document.getElementById(id);\n      curr.classList.add('active');\n      curr.querySelector('i').className = 'fa-solid fa-circle-notch fa-spin';\n    }, i * 800);\n  });\n}\n\nfunction hideLoading() {\n  loadingSection.classList.remove('active');\n}\n\nfunction showResults(data) {\n  hideLoading();\n  formSection.style.display = 'none';\n  resultsSection.style.display = ''; // Clear any inline override\n  resultsSection.classList.add('active');\n  const errorBanner = document.getElementById('searchErrorBanner');\n  if (errorBanner) errorBanner.remove();\n\n  allMatches = data.matches || [];\n  currentMatches = allMatches;\n  window._autoEnrichDot = data.autoEnrichDot || null;\n\n  // Update stats based on full data\n  totalScoredEl.textContent = data.totalScored || 0;\n\n  // Phase 1: Merge mutual interests if available\n  if (mutualInterestMap.size > 0) {\n    allMatches.forEach(m => {\n      const interest = mutualInterestMap.get(String(m.carrier?.DOT_NUMBER));\n      if (interest) {\n        m.isMutualMatch = true;\n        m.mutualStrength = interest.strength || 'weak';\n        m.mutualSignals = interest.signals || ['viewed'];\n      }\n    });\n  }\n\n  // Tier status from response\n  const isPremium = data.isPremium || false;\n  userStatus.isPremium = isPremium;\n  userStatus.tier = isPremium ? 'premium' : 'free';\n\n  // Render with current filters\n  renderFilteredResults();\n\n  // Update tier status from response - already done above\n\n\n  // Update tier badge\n  if (userTierBadge) {\n    if (isPremium) {\n      userTierBadge.innerHTML = '<span class=\"premium-badge\"><i class=\"fa-solid fa-crown\"></i> Premium</span>';\n    } else {\n      userTierBadge.innerHTML = '<span class=\"free-badge\"><i class=\"fa-solid fa-user\"></i> Free Tier</span>';\n    }\n  }\n\n  // Show appropriate banner\n  if (isPremium) {\n    if (upsellBanner) upsellBanner.style.display = 'none';\n    if (premiumBanner) premiumBanner.style.display = 'flex';\n  } else {\n    if (premiumBanner) premiumBanner.style.display = 'none';\n\n    // Show upsell if more matches available\n    const totalMatches = data.totalMatches || data.totalScored || 0;\n    const hiddenCount = Math.max(0, Math.min(totalMatches - currentMatches.length, 8));\n\n    if (data.upsellMessage || hiddenCount > 0) {\n      if (upsellBanner) upsellBanner.style.display = 'flex';\n      if (hiddenMatchCount) hiddenMatchCount.textContent = hiddenCount;\n      if (upsellText && data.upsellMessage) {\n        upsellText.textContent = data.upsellMessage;\n      }\n    } else {\n      if (upsellBanner) upsellBanner.style.display = 'none';\n    }\n  }\n\n  // Wire up signup/login buttons\n  const signupBtn = document.getElementById('signupBtn');\n  const loginBtn = document.getElementById('loginBtn');\n\n  if (signupBtn) {\n    signupBtn.onclick = () => sendToWix('navigateToSignup', {});\n  }\n  if (loginBtn) {\n    loginBtn.onclick = () => sendToWix('navigateToLogin', {});\n  }\n}\n\nfunction updateCardEnrichment(data) {\n  const dotNumber = data.dot_number;\n  const card = document.querySelector(`[data-dot=\"${dotNumber}\"]`);\n  if (!card) {\n    console.log('Card not found for DOT:', dotNumber);\n    return;\n  }\n\n  // Find the matching carrier data\n  const matchData = currentMatches.find(m => String(m.carrier?.DOT_NUMBER) === String(dotNumber));\n  const carrier = matchData?.carrier || {};\n\n  let container = card.querySelector('.ai-intel-section');\n  if (!container) {\n    const actionsDiv = card.querySelector('.match-actions');\n    if (actionsDiv) {\n      container = document.createElement('div');\n      container.className = 'ai-intel-section';\n      actionsDiv.parentNode.insertBefore(container, actionsDiv);\n    }\n  }\n\n  if (!container) return;\n\n  // Handle loading state\n  if (data.status === 'loading') {\n    container.innerHTML = `\n      <div class=\"ai-intel-loading\">\n        <i class=\"fa-solid fa-robot fa-bounce\"></i>\n        <div class=\"ai-intel-loading-text\">${data.message || 'AI Researching...'}</div>\n        <div class=\"ai-intel-loading-sub\">\n          ${data.position ? `Carrier ${data.position} of ${data.total}` : 'Searching job boards & reviews...'}\n       </div>\n        <div class=\"ai-intel-loading-progress\">\n          <div class=\"ai-intel-loading-progress-bar\"></div>\n       </div>\n     </div>\n    `;\n    return;\n  }\n\n  // Handle \"building\" state  enrichment running in background, retry to get cached result\n  if (data.building || data.status === 'building') {\n    container.innerHTML = `\n      <div class=\"ai-intel-ondemand\" id=\"ondemand-${dotNumber}\">\n        <i class=\"fa-solid fa-microchip\" style=\"font-size:24px; color:#8b5cf6; margin-bottom:8px;\"></i>\n        <div style=\"color:#e2e8f0; font-weight:600; margin-bottom:4px;\">AI Profile Building</div>\n        <div class=\"ai-intel-ondemand-sub\" style=\"margin-bottom:12px;\">Analysis takes 10-15 seconds. Click below when ready.</div>\n        <button class=\"btn-get-ai-profile\" onclick=\"window.retryEnrichment('${dotNumber}')\">\n          <i class=\"fa-solid fa-rotate-right\"></i> Load AI Profile\n        </button>\n      </div>\n    `;\n    return;\n  }\n\n  // Handle error state - use improved error renderer\n  if (data.error || data.status === 'error') {\n    container.innerHTML = renderErrorState(data, dotNumber, carrier).replace('<div class=\"ai-intel-section\">', '').replace('</div><!-- end -->', '');\n    return;\n  }\n\n  // Update FMCSA section if present in the enrichment\n  if (data.fmcsa && !data.fmcsa.error) {\n    const fmcsaContainer = card.querySelector('.fmcsa-section');\n    if (fmcsaContainer) {\n      const newFmcsaHTML = renderFMCSASection(data.fmcsa, dotNumber);\n      const temp = document.createElement('div');\n      temp.innerHTML = newFmcsaHTML;\n      const newSection = temp.querySelector('.fmcsa-section');\n      if (newSection) {\n        fmcsaContainer.outerHTML = newSection.outerHTML;\n      }\n    }\n  }\n\n  // Success - render full AI intel\n  const aiIntelHTML = renderAIIntelBlock(data);\n  const tempDiv = document.createElement('div');\n  tempDiv.innerHTML = aiIntelHTML;\n  const innerContent = tempDiv.querySelector('.ai-intel-content, .ai-intel-partial');\n\n  if (innerContent) {\n    container.innerHTML = innerContent.outerHTML;\n  } else {\n    container.innerHTML = aiIntelHTML;\n  }\n\n  // Add \"Instant\" tag if enrichment came from cache\n  if (data.fromCache) {\n    const tagsContainer = card.querySelector('.match-tags');\n    if (tagsContainer && !tagsContainer.querySelector('.match-tag.cached')) {\n      tagsContainer.insertAdjacentHTML('beforeend',\n        '<span class=\"match-tag cached\"><i class=\"fa-solid fa-bolt\"></i> Instant</span>'\n      );\n    }\n  }\n}\n\nfunction handleInterestClick(e) {\n  const btn = e.currentTarget;\n  const dotNumber = btn.dataset.dot;\n\n  // Find full carrier data from currentMatches\n  const matchData = currentMatches.find(m => String(m.carrier?.DOT_NUMBER) === String(dotNumber));\n  const carrier = matchData?.carrier || {};\n\n  // Store carrier data for modal\n  pendingInterestCarrier = {\n    dotNumber: dotNumber,\n    name: btn.dataset.name || carrier.LEGAL_NAME || 'Unknown Carrier',\n    phone: carrier.TELEPHONE || null,\n    email: carrier.EMAIL_ADDRESS || null,\n    location: `${carrier.PHY_CITY || ''}, ${carrier.PHY_STATE || ''} `.replace(/^, |, $/g, ''),\n    matchScore: parseInt(btn.dataset.score) || 0\n  };\n\n  sendToWix('logInterest', {\n    carrierDOT: dotNumber,\n    carrierName: pendingInterestCarrier.name,\n    driverZip: driverPrefs.homeZip,\n    driverName: driverPrefs.driverName,\n    matchScore: pendingInterestCarrier.matchScore,\n    action: 'interested'\n  });\n\n  btn.innerHTML = '<i class=\"fa-solid fa-spinner fa-spin\"></i> Saving...';\n  btn.disabled = true;\n}\n\nwindow.retryEnrichment = function (dot) {\n  sendToWix('retryEnrichment', { dot: dot });\n  const card = document.querySelector(`[data-dot=\"${dot}\"]`);\n  if (card) {\n    const container = card.querySelector('.ai-intel-section');\n    if (container) {\n      container.innerHTML = `\n    <div class=\"ai-intel-loading\">\n          <i class=\"fa-solid fa-rotate-right fa-spin\"></i>\n          <div class=\"ai-intel-loading-text\">Retrying...</div>\n          <div class=\"ai-intel-loading-progress\">\n            <div class=\"ai-intel-loading-progress-bar\"></div>\n         </div>\n       </div>\n    `;\n    }\n  }\n};\n\nfunction handlePageReady(data) {\n  console.log('? Page ready with user status:', data.userStatus);\n\n  if (data.userStatus) {\n    userStatus = data.userStatus;\n    updateUserUIState();\n  }\n\n  if (data.driverProfile) {\n    prefillForm(data.driverProfile);\n  }\n\n  // Phase 1: Fetch mutual interests for the driver\n  console.log('? Fetching mutual interests...');\n  sendToWix('getMutualInterest', { driverId: data.memberId });\n}\n\nfunction handleLoginSuccess(data) {\n  console.log('? Login success:', data);\n  userStatus = data.userStatus || { loggedIn: true, isPremium: true, tier: 'premium' };\n\n  updateUserUIState();\n\n  if (data.driverProfile) {\n    prefillForm(data.driverProfile);\n  }\n\n  // Check if we have a pending application to auto-resubmit\n  if (pendingApplicationData) {\n    console.log('?? Auto-resubmitting pending application after login');\n    pendingApplicationData = null;\n\n    // Update login prompt to show submitting state\n    const loginLoadingText = document.getElementById('loginPromptLoadingText');\n    if (loginLoadingText) loginLoadingText.textContent = 'Submitting your application...';\n\n    // Hide login prompt and auto-resubmit after brief delay\n    setTimeout(() => {\n      hideLoginPrompt();\n      submitApplication();\n    }, 500);\n    return;\n  }\n\n  // Normal login flow (not triggered by application submit)\n  const name = data.driverProfile?.displayName || '';\n  const welcome = name ? `, ${name} ` : '';\n  showToast(`Welcome back${welcome}! You now have Premium access. Click \"Find My Matches\" to see all 10 results.`, 'success', 5000);\n}\n\nfunction updateUserUIState() {\n  // Update form badge for premium users\n  const formBadge = document.querySelector('.form-badge');\n  if (formBadge && userStatus.isPremium) {\n    formBadge.innerHTML = '<i class=\"fa-solid fa-crown\"></i> Premium Member  FMCSA Verified';\n    formBadge.style.background = 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)';\n    formBadge.style.color = '#0f172a';\n  }\n\n  // Set body class for CSS targeting\n  if (userStatus.loggedIn) {\n    document.body.classList.add('user-logged-in');\n  } else {\n    document.body.classList.remove('user-logged-in');\n  }\n}\n\nfunction prefillForm(profile, isAI = false) {\n  console.log('?? Pre-filling form with ' + (isAI ? 'AI' : 'profile') + ' data');\n\n  // Store globally for application pre-fill (Phase 4H)\n  if (!isAI) driverProfile = profile;\n\n  if (profile.homeZip) {\n    const el = document.getElementById('homeZip');\n    el.value = profile.homeZip;\n    if (isAI) highlightField(el);\n  }\n  if (profile.maxDistance) {\n    const el = document.getElementById('maxDistance');\n    el.value = profile.maxDistance;\n    if (isAI) highlightField(el);\n  }\n  if (profile.minCPM) {\n    const el = document.getElementById('minCPM');\n    el.value = profile.minCPM;\n    if (isAI) highlightField(el);\n  }\n  if (profile.operationType) {\n    const el = document.getElementById('operationType');\n    el.value = profile.operationType;\n    if (isAI) highlightField(el);\n  }\n  if (profile.maxTurnover) {\n    const el = document.getElementById('maxTurnover');\n    el.value = profile.maxTurnover;\n    if (isAI) highlightField(el);\n  }\n  if (profile.maxTruckAge) {\n    const el = document.getElementById('maxTruckAge');\n    el.value = profile.maxTruckAge;\n    if (isAI) highlightField(el);\n  }\n  if (profile.displayName || profile.driverName) {\n    const el = document.getElementById('driverName');\n    el.value = profile.displayName || profile.driverName;\n    if (isAI) highlightField(el);\n  }\n\n  if (profile.fleetSize) {\n    const radio = document.querySelector(`input[name=\"fleetSize\"][value=\"${profile.fleetSize}\"]`);\n    if (radio) {\n      radio.checked = true;\n      if (isAI) highlightField(radio.parentElement);\n    }\n  }\n\n  // Update header if name is present\n  const name = profile.displayName || profile.driverName;\n  if (name) {\n    const title = document.querySelector('.form-title');\n    if (title) title.innerText = (isAI ? `Okay, ${name}` : `Welcome Back, ${name}`);\n\n    const subtitle = document.querySelector('.form-subtitle');\n    if (subtitle) subtitle.innerText = isAI ? \"I've adjusted your filters based on your request.\" : \"We've loaded your preferences for a quick match.\";\n  }\n\n  // Auto-trigger search if the profile is complete (Phase 2 Requirement)\n  if (profile.isComplete === true) {\n    console.log('? Profile is complete - auto-triggering search');\n    const submitBtn = document.getElementById('submitBtn');\n    if (submitBtn) {\n      setTimeout(() => submitBtn.click(), 500);\n    }\n  }\n}\n\nfunction handleMatchExplanationResult(data) {\n  const card = document.querySelector(`.match-card[data-dot=\"${data.carrierDot}\"]`);\n  if (!card) return;\n\n  const panel = card.querySelector('.explanation-panel');\n  if (!panel) return;\n\n  if (!data.success) {\n    panel.querySelector('.explanation-content').innerHTML = `\n      <div style=\"text-align: center; color: #ef4444; padding: 20px;\">\n        <i class=\"fa-solid fa-circle-exclamation\"></i> Could not load explanation.\n      </div>\n    `;\n    panel.dataset.loaded = \"true\";\n    return;\n  }\n\n  const exp = data.explanation;\n\n  // Render Categories\n  const categoriesHtml = exp.categories.map(cat => `\n    <div class=\"category-row\">\n      <div class=\"category-label\">\n        <i class=\"fa-solid fa-check-circle\" style=\"color: ${cat.score >= 70 ? 'var(--color-success)' : '#cbd5e1'}\"></i>\n        ${cat.label}\n      </div>\n      <div>\n        <div class=\"category-bar-container\">\n          <div class=\"category-bar-fill ${cat.status}\" style=\"width: ${cat.score}%\"></div>\n        </div>\n        <div class=\"explanation-text\">${cat.text}</div>\n      </div>\n      <div class=\"category-score\">${cat.score}%</div>\n    </div>\n  `).join('');\n\n  const html = `\n    <div class=\"explanation-header\">\n      <div class=\"explanation-title\">\n        <i class=\"fa-solid fa-wand-magic-sparkles\" style=\"color: var(--lmdr-purple)\"></i>\n        AI Match Analysis\n      </div>\n      <div class=\"explanation-summary\">${exp.summary}</div>\n    </div>\n\n    ${categoriesHtml}\n\n    <div class=\"tip-box\">\n      <i class=\"fa-solid fa-lightbulb tip-icon\"></i>\n      <div>\n        <strong>Pro Tip:</strong> ${exp.tip}\n      </div>\n    </div>\n  `;\n\n  panel.querySelector('.explanation-content').innerHTML = html;\n  panel.dataset.loaded = \"true\";\n}\n\nfunction loadApplications() {\n  const list = document.getElementById('applicationsList');\n  if (!list) return;\n\n  // Show loading spinner\n  list.innerHTML = '<div class=\"loading-spinner\" style=\"margin: 40px auto;\"></div>';\n\n  // Request applications from parent page\n  if (window.parent) {\n    console.log('?? Requesting driver applications from backend...');\n    window.parent.postMessage({ type: 'getDriverApplications' }, '*');\n\n    // Set a timeout to show mock data if no response (for development/demo)\n    // In production, this would handle the error case\n    window.appLoadTimeout = setTimeout(() => {\n      console.warn('?? No response from backend, loading mock data for demo...');\n      loadMockApplications();\n    }, 3000);\n  } else {\n    // Standalone mode - load mock data\n    loadMockApplications();\n  }\n}\n\nfunction loadMockApplications() {\n  const mockApps = [\n    {\n      id: 'app_1',\n      carrierName: 'Swift Transportation (Demo)',\n      status: 'viewed',\n      submittedDate: '2025-01-28T10:00:00Z',\n      statusHistory: [\n        { status: 'Applied', date: '2025-01-28T10:00:00Z' },\n        { status: 'Viewed by Carrier', date: '2025-01-29T14:30:00Z' }\n      ]\n    },\n    {\n      id: 'app_2',\n      carrierName: 'J.B. Hunt (Demo)',\n      status: 'applied',\n      submittedDate: '2025-01-30T09:15:00Z',\n      statusHistory: [\n        { status: 'Applied', date: '2025-01-30T09:15:00Z' }\n      ]\n    }\n  ];\n  renderApplications(mockApps);\n}\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\feature-tracker.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\gamificationPageHandlers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\lmdr-experiment.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\lmdr-flags.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\lmdr-html-bridge.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\ocr-handler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\utm-tracker.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\voice-agent-bridge.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\js\\voice-agent-ui.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\lmdr-config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-bridge.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-chat.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-settings.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-shell.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'TOOLS' is assigned a value but never used.","line":10,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-SHELL  Layout Builder\r\n// Renders topbar, left rail, drawers, dock, command bar\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const CFG = ROS.config;\r\n  const TOOLS = ROS.TOOL_REGISTRY;\r\n\r\n  // -- State --\r\n  let openDrawers = new Set();\r\n\r\n  // -- Init --\r\n  ROS.shell = { init, toggleDrawer, openDrawer, closeDrawer };\r\n\r\n  function init() {\r\n    const root = document.getElementById('ros-root');\r\n    if (!root) { console.error('ROS: #ros-root not found'); return; }\r\n    root.innerHTML = buildLayout();\r\n    startClock();\r\n    bindMobileHamburger();\r\n  }\r\n\r\n  // -- Full Layout --\r\n  function buildLayout() {\r\n    return `\r\n      ${buildTopbar()}\r\n      <div class=\"flex flex-1 min-h-0 relative\">\r\n        <div class=\"rail-overlay\" id=\"railOverlay\"></div>\r\n        ${buildRail()}\r\n        <div class=\"flex-1 overflow-y-auto relative pb-24 px-5 ws-grid\" id=\"ros-stage\">\r\n          <div id=\"ros-view-container\" class=\"h-full\"></div>\r\n        </div>\r\n        ${buildChatThread()}\r\n      </div>\r\n      ${buildDock()}\r\n      ${buildCommandBar()}\r\n      ${buildSpotlight()}\r\n    `;\r\n  }\r\n\r\n  // -- Topbar --\r\n  function buildTopbar() {\r\n    return `\r\n    <header id=\"ros-topbar\">\r\n      <div class=\"flex items-center gap-6\">\r\n        <button class=\"hamburger-btn\" id=\"hamburgerBtn\">\r\n          <span class=\"material-symbols-outlined\">menu</span>\r\n        </button>\r\n        <div class=\"flex items-center gap-2\">\r\n          <div class=\"w-7 h-7 rounded-lg bg-white/10 flex items-center justify-center\">\r\n            <span class=\"material-symbols-outlined text-lmdr-yellow text-[16px]\">${CFG.brand.icon}</span>\r\n          </div>\r\n          <span class=\"text-[13px] font-black tracking-[3px] text-white\">${CFG.brand.logo}</span>\r\n        </div>\r\n        <nav class=\"flex gap-5\">\r\n          <span class=\"text-[11px] text-white/50 hover:text-white cursor-pointer font-semibold transition-colors\">File</span>\r\n          <span class=\"text-[11px] text-white/50 hover:text-white cursor-pointer font-semibold transition-colors\">View</span>\r\n          <span class=\"text-[11px] text-white/50 hover:text-white cursor-pointer font-semibold transition-colors\">Tools</span>\r\n          <span class=\"text-[11px] text-white/50 hover:text-white cursor-pointer font-semibold transition-colors\">Automations</span>\r\n        </nav>\r\n      </div>\r\n      <div class=\"flex items-center gap-4\">\r\n        <div class=\"search-pill flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-white/[.08] cursor-pointer hover:bg-white/[.12] transition-colors\" onclick=\"ROS.spotlight.open()\">\r\n          <span class=\"material-symbols-outlined text-white/40 text-[14px]\">search</span>\r\n          <span class=\"text-[10px] text-white/30 font-medium\">Search</span>\r\n          <span class=\"text-[9px] text-white/20 font-bold bg-white/[0.06] px-1.5 py-0.5 rounded ml-2\">\\u2318K</span>\r\n        </div>\r\n        <div class=\"relative cursor-pointer\">\r\n          <span class=\"material-symbols-outlined text-white/50 text-[18px] hover:text-lmdr-yellow transition-colors\">notifications</span>\r\n          <span class=\"absolute -top-1 -right-1.5 bg-red-500 text-white text-[8px] font-bold px-1 rounded-full leading-tight\" id=\"notifBadge\">0</span>\r\n        </div>\r\n        <span id=\"ros-clock\" class=\"text-[11px] text-white/50 font-semibold tracking-wide\"></span>\r\n      </div>\r\n    </header>`;\r\n  }\r\n\r\n  // -- Left Rail --\r\n  function buildRail() {\r\n    const drawers = CFG.drawers.map(d => buildDrawer(d)).join('');\r\n    return `\r\n    <div id=\"ros-rail\">\r\n      <div class=\"flex items-center px-3 py-2 neu-ins rounded-full mb-1 cursor-pointer\" onclick=\"ROS.spotlight.open()\">\r\n        <span class=\"material-symbols-outlined text-tan text-[16px]\">search</span>\r\n        <span class=\"text-[11px] text-tan/50 ml-2 font-medium flex-1\">Search tools...</span>\r\n        <span class=\"text-[9px] text-tan/40 font-bold bg-beige-d px-1.5 py-0.5 rounded\">\\u2318K</span>\r\n      </div>\r\n      ${drawers}\r\n    </div>`;\r\n  }\r\n\r\n  // -- Single Drawer --\r\n  function buildDrawer(drawer) {\r\n    const tools = ROS.getDrawerTools(drawer.id);\r\n    const cols = drawer.id === 'rank' ? 2 : 3;\r\n    const toolGrid = tools.map(t => buildToolOrb(t)).join('');\r\n\r\n    // Rank drawer has extra XP bar\r\n    let extra = '';\r\n    if (drawer.id === 'rank') {\r\n      extra = `\r\n        <div class=\"p-2 neu-ins rounded-lg flex items-center gap-2 mt-2\">\r\n          <div class=\"w-7 h-7 rounded-full bg-gradient-to-br from-lmdr-yellow to-amber-500 flex items-center justify-center text-lmdr-dark font-black text-[10px]\" id=\"ros-rank-avatar\">--</div>\r\n          <div class=\"flex-1\">\r\n            <p class=\"text-[9px] font-bold text-lmdr-dark\" id=\"ros-rank-label\">-- \\u00b7 0 XP</p>\r\n            <div class=\"h-1 w-full bg-beige-d rounded-full mt-0.5 overflow-hidden\">\r\n              <div class=\"h-full bg-gradient-to-r from-lmdr-yellow to-amber-500 rounded-full\" style=\"width:0%\" id=\"ros-rank-bar\"></div>\r\n            </div>\r\n          </div>\r\n        </div>`;\r\n    }\r\n\r\n    return `\r\n    <div class=\"neu-s rounded-xl overflow-hidden\">\r\n      <div class=\"flex items-center gap-2 px-3.5 py-2.5 cursor-pointer hover:bg-beige-d/30 transition-colors\" onclick=\"ROS.shell.toggleDrawer('${drawer.id}')\">\r\n        <div class=\"w-6 h-6 rounded-md bg-gradient-to-br ${drawer.iconGradient} flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined ${drawer.id === 'anl' ? 'text-lmdr-yellow' : 'text-white'} text-[14px]\">${drawer.icon}</span>\r\n        </div>\r\n        <span class=\"text-[11px] font-bold text-lmdr-dark flex-1\">${drawer.label}</span>\r\n        <span class=\"text-[9px] text-tan font-bold\">${tools.length}</span>\r\n        <span class=\"material-symbols-outlined text-tan text-[16px] drawer-chev\" id=\"ch-${drawer.id}\">expand_more</span>\r\n      </div>\r\n      <div class=\"drawer-body\" id=\"dr-${drawer.id}\">\r\n        <div class=\"grid grid-cols-${cols} gap-1.5\">\r\n          ${toolGrid}\r\n        </div>\r\n        ${extra}\r\n      </div>\r\n    </div>`;\r\n  }\r\n\r\n  // -- Tool Orb --\r\n  function buildToolOrb(tool) {\r\n    const badgeClass = tool.badge ? ' ndot' : '';\r\n    const animStyle = tool.animate ? ` style=\"animation:${tool.animate} 4s infinite\"` : '';\r\n    const iconColor = tool.iconColor || 'text-white';\r\n    const clickAction = tool.view\r\n      ? `ROS.views.showView('${tool.view}')`\r\n      : `ROS.chat.flashMsg('${tool.name}  Coming Soon')`;\r\n\r\n    return `\r\n      <div class=\"tool-orb neu-x rounded-lg p-2 flex flex-col items-center gap-1 text-center${badgeClass}\" onclick=\"${clickAction}\">\r\n        <div class=\"w-8 h-8 rounded-md bg-gradient-to-br ${tool.gradient} flex items-center justify-center\"${animStyle}>\r\n          <span class=\"material-symbols-outlined ${iconColor} text-[16px]\">${tool.icon}</span>\r\n        </div>\r\n        <span class=\"text-[8px] font-bold text-lmdr-dark leading-tight\">${tool.name}</span>\r\n      </div>`;\r\n  }\r\n\r\n  // -- Chat Thread --\r\n  function buildChatThread() {\r\n    return `\r\n    <div class=\"chat-thread\" id=\"chatThread\">\r\n      <div class=\"thread-head\">\r\n        <div class=\"flex items-center gap-2.5\">\r\n          <div class=\"w-8 h-8 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep flex items-center justify-center\">\r\n            <span class=\"material-symbols-outlined text-white text-[16px]\">smart_toy</span>\r\n          </div>\r\n          <div>\r\n            <span class=\"text-[13px] font-extrabold text-lmdr-dark\">Command Center</span>\r\n            <div class=\"flex items-center gap-1 mt-0.5\">\r\n              <div class=\"w-1.5 h-1.5 rounded-full bg-emerald-500\" style=\"animation:pulse 2s infinite\"></div>\r\n              <span class=\"text-[9px] text-tan font-medium\">Online</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <button onclick=\"ROS.chat.closeThread()\" class=\"w-7 h-7 neu-x rounded-lg flex items-center justify-center hover:bg-beige-d transition-colors\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">close</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"thread-msgs\" id=\"chatMsgs\"></div>\r\n    </div>`;\r\n  }\r\n\r\n  // -- Dock --\r\n  function buildDock() {\r\n    const items = CFG.dock.map(d => {\r\n      const activeClass = d.view === 'home' ? ' active' : '';\r\n      const badge = d.badge ? '<span class=\"dk-badge\"></span>' : '';\r\n      return `\r\n        <div class=\"dk-i${activeClass}\" data-view=\"${d.view}\" onclick=\"ROS.shell.dockNav('${d.view}', this)\">\r\n          <span class=\"material-symbols-outlined\">${d.icon}</span>\r\n          <span class=\"dk-tip\">${d.label}</span>\r\n          ${badge}\r\n        </div>`;\r\n    }).join('');\r\n\r\n    return `<div class=\"dock-pill\" id=\"dockPill\">${items}</div>`;\r\n  }\r\n\r\n  // -- Command Bar --\r\n  function buildCommandBar() {\r\n    return `\r\n    <div class=\"cmd-bar\" id=\"cmdBar\">\r\n      <div class=\"cmd-chips\">\r\n        <button onclick=\"ROS.chat.send('Find top matches')\"><span class=\"material-symbols-outlined text-[14px]\">person_search</span>Find Drivers</button>\r\n        <button onclick=\"ROS.chat.send('Open pipeline')\"><span class=\"material-symbols-outlined text-[14px]\">view_kanban</span>Pipeline</button>\r\n        <button onclick=\"ROS.chat.send('Run funnel report')\"><span class=\"material-symbols-outlined text-[14px]\">insights</span>Analytics</button>\r\n        <button onclick=\"ROS.chat.send('Start onboarding')\"><span class=\"material-symbols-outlined text-[14px]\">verified</span>Onboard</button>\r\n        <button onclick=\"ROS.chat.send('Open messages')\"><span class=\"material-symbols-outlined text-[14px]\">chat</span>Messages</button>\r\n      </div>\r\n      <div class=\"cmd-chat\">\r\n        <div class=\"w-8 h-8 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep flex items-center justify-center shrink-0\">\r\n          <span class=\"material-symbols-outlined text-white text-[16px]\">smart_toy</span>\r\n        </div>\r\n        <input id=\"chatInput\" type=\"text\" placeholder=\"Ask the AI anything \\u2014 try 'find drivers near Dallas'...\" onkeydown=\"if(event.key==='Enter'){ROS.chat.handleSend()}\"/>\r\n        <button class=\"send-btn\" onclick=\"ROS.chat.handleSend()\">\r\n          <span class=\"material-symbols-outlined text-white text-[16px]\">arrow_upward</span>\r\n        </button>\r\n      </div>\r\n    </div>`;\r\n  }\r\n\r\n  // -- Spotlight (container only, logic in ros-spotlight.js) --\r\n  function buildSpotlight() {\r\n    return `\r\n    <div class=\"spot-ov\" id=\"spot\" onclick=\"if(event.target===this)ROS.spotlight.close()\">\r\n      <div class=\"spot-box w-[520px] rounded-2xl overflow-hidden shadow-2xl\">\r\n        <div class=\"bg-lmdr-dark p-4 flex items-center gap-3 border-b border-white/5\">\r\n          <span class=\"material-symbols-outlined text-white/30 text-[20px]\">search</span>\r\n          <input id=\"slIn\" class=\"flex-1 bg-transparent border-none outline-none text-white text-[16px] font-medium placeholder-white/25\" placeholder=\"Search tools, drivers, commands...\" oninput=\"ROS.spotlight.filter(this.value)\"/>\r\n          <span class=\"text-[9px] text-white/20 font-bold bg-white/[0.06] px-2 py-0.5 rounded border border-white/[0.06]\">ESC</span>\r\n        </div>\r\n        <div class=\"bg-lmdr-dark p-2 max-h-[320px] overflow-y-auto\" id=\"slR\"></div>\r\n      </div>\r\n    </div>`;\r\n  }\r\n\r\n  // -- Drawer Toggle --\r\n  function toggleDrawer(id) {\r\n    const body = document.getElementById('dr-' + id);\r\n    const chev = document.getElementById('ch-' + id);\r\n    if (!body || !chev) return;\r\n\r\n    if (openDrawers.has(id)) {\r\n      body.classList.remove('open');\r\n      chev.classList.remove('open');\r\n      openDrawers.delete(id);\r\n    } else {\r\n      body.classList.add('open');\r\n      chev.classList.add('open');\r\n      openDrawers.add(id);\r\n    }\r\n  }\r\n\r\n  function openDrawer(id) {\r\n    if (!openDrawers.has(id)) toggleDrawer(id);\r\n  }\r\n\r\n  function closeDrawer(id) {\r\n    if (openDrawers.has(id)) toggleDrawer(id);\r\n  }\r\n\r\n  // -- Dock Navigation --\r\n  ROS.shell.dockNav = function(view, el) {\r\n    document.querySelectorAll('.dock-pill .dk-i').forEach(d => d.classList.remove('active'));\r\n    if (el) el.classList.add('active');\r\n    ROS.views.showView(view);\r\n  };\r\n\r\n  ROS.shell.syncDock = function(viewId) {\r\n    document.querySelectorAll('.dock-pill .dk-i').forEach(d => {\r\n      d.classList.toggle('active', d.dataset.view === viewId);\r\n    });\r\n  };\r\n\r\n  // -- Chat Push Layout --\r\n  ROS.shell.pushChatLayout = function(open) {\r\n    const cmdBar = document.getElementById('cmdBar');\r\n    const dock = document.getElementById('dockPill');\r\n    if (open) {\r\n      if (cmdBar) cmdBar.style.right = '400px';\r\n      if (dock) dock.style.left = 'calc(50% - 75px)';\r\n    } else {\r\n      if (cmdBar) cmdBar.style.right = '0';\r\n      if (dock) dock.style.left = 'calc(50% + 125px)';\r\n    }\r\n  };\r\n\r\n  // -- Clock --\r\n  function startClock() {\r\n    const update = () => {\r\n      const el = document.getElementById('ros-clock');\r\n      if (el) el.textContent = new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });\r\n    };\r\n    update();\r\n    setInterval(update, 30000);\r\n  }\r\n\r\n  // -- Mobile Hamburger --\r\n  function bindMobileHamburger() {\r\n    document.addEventListener('click', (e) => {\r\n      const btn = e.target.closest('#hamburgerBtn');\r\n      const overlay = document.getElementById('railOverlay');\r\n      const rail = document.getElementById('ros-rail');\r\n      if (btn && rail) {\r\n        rail.classList.toggle('open');\r\n        if (overlay) overlay.classList.toggle('vis', rail.classList.contains('open'));\r\n      }\r\n      if (e.target === overlay && rail) {\r\n        rail.classList.remove('open');\r\n        overlay.classList.remove('vis');\r\n      }\r\n    });\r\n  }\r\n\r\n  // Close rail when a tool is clicked on mobile\r\n  ROS.shell.closeMobileRail = function() {\r\n    const rail = document.getElementById('ros-rail');\r\n    const overlay = document.getElementById('railOverlay');\r\n    if (rail) rail.classList.remove('open');\r\n    if (overlay) overlay.classList.remove('vis');\r\n  };\r\n\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-spotlight.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-views.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'id' is assigned a value but never used.","line":80,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEWS  View Lifecycle Manager\r\n// register, mount, unmount, showView, comingSoonTemplate\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const registry = {};\r\n  let currentViewId = null;\r\n\r\n  ROS.views = { registerView, showView, getCurrentView, comingSoonTemplate };\r\n\r\n  /**\r\n   * Register a view module\r\n   * @param {string} id - View identifier (e.g. 'search', 'pipeline')\r\n   * @param {object} opts - { render, onMount, onUnmount, onMessage, messages }\r\n   */\r\n  function registerView(id, opts) {\r\n    registry[id] = {\r\n      render: opts.render || (() => ''),\r\n      onMount: opts.onMount || (() => {}),\r\n      onUnmount: opts.onUnmount || (() => {}),\r\n      onMessage: opts.onMessage || (() => {}),\r\n      messages: opts.messages || []\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Switch to a view  unmounts current, mounts new with fade\r\n   * @param {string} id - View ID to switch to\r\n   */\r\n  function showView(id) {\r\n    const container = document.getElementById('ros-view-container');\r\n    if (!container) return;\r\n\r\n    // Check if tool is 'future' status and has no registered view\r\n    const tool = ROS.getTool(id);\r\n    if (!registry[id] && tool && tool.status === 'future') {\r\n      mountComingSoon(container, tool);\r\n      currentViewId = id;\r\n      if (ROS.shell && ROS.shell.syncDock) ROS.shell.syncDock(id);\r\n      if (ROS.shell && ROS.shell.closeMobileRail) ROS.shell.closeMobileRail();\r\n      return;\r\n    }\r\n\r\n    // Fallback: if no view registered, show coming soon with generic info\r\n    if (!registry[id]) {\r\n      mountComingSoon(container, { name: id, icon: 'construction', gradient: 'from-slate-500 to-slate-700' });\r\n      currentViewId = id;\r\n      if (ROS.shell && ROS.shell.syncDock) ROS.shell.syncDock(id);\r\n      return;\r\n    }\r\n\r\n    // Unmount current\r\n    if (currentViewId && registry[currentViewId]) {\r\n      try { registry[currentViewId].onUnmount(); } catch (e) { console.warn('ROS unmount error:', e); }\r\n    }\r\n\r\n    // Render new view\r\n    const view = registry[id];\r\n    container.innerHTML = `<div class=\"center-view active flex-col\" style=\"animation:fadeUp .4s ease\">${view.render()}</div>`;\r\n\r\n    // Mount\r\n    currentViewId = id;\r\n    try { view.onMount(container.firstElementChild); } catch (e) { console.warn('ROS mount error:', e); }\r\n\r\n    // Sync dock\r\n    if (ROS.shell && ROS.shell.syncDock) ROS.shell.syncDock(id);\r\n    if (ROS.shell && ROS.shell.closeMobileRail) ROS.shell.closeMobileRail();\r\n  }\r\n\r\n  /**\r\n   * Route an inbound message to the active view\r\n   * @param {string} type - Message type\r\n   * @param {*} data - Message payload\r\n   */\r\n  ROS.views.routeMessage = function(type, data) {\r\n    // Route to whichever view declared this message type\r\n    for (const [id, view] of Object.entries(registry)) {\r\n      if (view.messages.includes(type)) {\r\n        try { view.onMessage(type, data); } catch (e) { console.warn('ROS message error:', e); }\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  function getCurrentView() { return currentViewId; }\r\n\r\n  /**\r\n   * \"Coming Soon\" placeholder card\r\n   */\r\n  function comingSoonTemplate(name, icon, gradient) {\r\n    return `\r\n      <div class=\"coming-soon-card\">\r\n        <div class=\"cs-icon bg-gradient-to-br ${gradient}\">\r\n          <span class=\"material-symbols-outlined\">${icon}</span>\r\n        </div>\r\n        <h2>${name}</h2>\r\n        <p>This tool is being built for a future release. It will appear here when ready.</p>\r\n        <span class=\"coming-soon-badge\">Coming Soon</span>\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"mt-4 px-5 py-2.5 rounded-xl neu-s text-[12px] font-bold text-tan hover:text-lmdr-blue transition-colors\">\r\n          <span class=\"material-symbols-outlined text-[14px] align-middle mr-1\">arrow_back</span>Back to Home\r\n        </button>\r\n      </div>`;\r\n  }\r\n\r\n  function mountComingSoon(container, tool) {\r\n    const gradient = tool.gradient || 'from-slate-500 to-slate-700';\r\n    const icon = tool.icon || 'construction';\r\n    const name = tool.name || tool.id || 'Unknown Tool';\r\n    container.innerHTML = `<div class=\"center-view active flex-col items-center justify-center h-full\" style=\"animation:fadeUp .4s ease\">${comingSoonTemplate(name, icon, gradient)}</div>`;\r\n  }\r\n\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\ros-voice.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-attribution.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-campaigns.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-carriers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-funnel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'funnelData' is assigned a value but never used.","line":11,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'costData' is assigned a value but never used.","line":12,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-FUNNEL  Analytics: Funnel + Cost/Hire (merged)\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'funnel';\r\n  const MESSAGES = ['funnelDataLoaded', 'costDataLoaded', 'bottleneckAnalysis'];\r\n\r\n  let funnelData = null;\r\n  let costData = null;\r\n\r\n  function render() {\r\n    return `\r\n      <div class=\"flex items-center gap-3\">\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n        </button>\r\n        <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-lmdr-dark to-slate-700 flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-lmdr-yellow text-[16px]\">insights</span>\r\n        </div>\r\n        <h2 class=\"text-lg font-bold text-lmdr-dark\">Analytics Dashboard</h2>\r\n      </div>\r\n\r\n      <!-- KPI Cards -->\r\n      <div class=\"grid grid-cols-4 gap-4 mt-4\">\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Pipeline</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"funnel-pipeline\">--</h3>\r\n          <span class=\"text-[11px] text-sg font-bold\" id=\"funnel-pipeline-trend\"></span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Hires/Mo</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"funnel-hires\">--</h3>\r\n          <div class=\"h-1.5 w-full neu-ins rounded-full overflow-hidden mt-2\"><div class=\"h-full bg-lmdr-blue rounded-full\" style=\"width:0%\" id=\"funnel-hires-bar\"></div></div>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Cost/Hire</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"funnel-cost\">--</h3>\r\n          <span class=\"text-[11px] text-sg font-bold\" id=\"funnel-cost-trend\"></span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Conversion</p>\r\n          <h3 class=\"text-[28px] font-black text-sg mt-1\" id=\"funnel-conversion\">--</h3>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Funnel Chart + Conversion -->\r\n      <div class=\"grid grid-cols-3 gap-5 mt-4\">\r\n        <div class=\"col-span-2 neu rounded-2xl p-6\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">Hiring Funnel</h3>\r\n          <div id=\"funnel-bars\" class=\"flex flex-col gap-2\">\r\n            <div class=\"text-center text-[12px] text-tan py-4\">Loading funnel data...</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"neu rounded-2xl p-6\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">Conversion</h3>\r\n          <div class=\"flex flex-col items-center justify-center h-[calc(100%-30px)]\">\r\n            <div class=\"text-[48px] font-black text-lmdr-blue leading-none\" id=\"funnel-rate\">--</div>\r\n            <div class=\"text-[11px] font-bold text-tan uppercase mt-2\">Overall Rate</div>\r\n            <div class=\"text-[11px] text-sg font-bold mt-1 italic\" id=\"funnel-rate-trend\"></div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('getFunnelData', {});\r\n    ROS.bridge.sendToVelo('getCostData', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    funnelData = null;\r\n    costData = null;\r\n  }\r\n\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'funnelDataLoaded':\r\n        funnelData = data;\r\n        renderFunnel(data);\r\n        break;\r\n      case 'costDataLoaded':\r\n        costData = data;\r\n        renderCost(data);\r\n        break;\r\n      case 'bottleneckAnalysis':\r\n        // Future: render bottleneck insights\r\n        break;\r\n    }\r\n  }\r\n\r\n  function renderFunnel(data) {\r\n    if (!data) return;\r\n    const stages = data.stages || [\r\n      { label: 'Applied', count: data.applied || 0 },\r\n      { label: 'Screened', count: data.screened || 0 },\r\n      { label: 'Offered', count: data.offered || 0 },\r\n      { label: 'Hired', count: data.hired || 0 }\r\n    ];\r\n\r\n    const max = Math.max(...stages.map(s => s.count), 1);\r\n    const bars = document.getElementById('funnel-bars');\r\n    if (bars) {\r\n      bars.innerHTML = stages.map(s => {\r\n        const pct = Math.round((s.count / max) * 100);\r\n        return `\r\n          <div class=\"flex items-center gap-3\">\r\n            <span class=\"w-16 text-right text-[10px] font-bold text-tan uppercase\">${s.label}</span>\r\n            <div class=\"flex-1 h-8 neu-ins rounded-lg relative overflow-hidden\">\r\n              <div class=\"absolute inset-y-0 left-0 bg-lmdr-blue/25 rounded-lg\" style=\"width:${pct}%\"></div>\r\n              <span class=\"absolute inset-0 flex items-center justify-end pr-3 text-[12px] font-bold\">${s.count}</span>\r\n            </div>\r\n          </div>`;\r\n      }).join('');\r\n    }\r\n\r\n    // Update KPIs\r\n    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };\r\n    setText('funnel-pipeline', data.totalPipeline || stages[0].count || '--');\r\n    setText('funnel-hires', data.hired || stages[stages.length - 1].count || '--');\r\n    setText('funnel-conversion', data.conversionRate ? data.conversionRate + '%' : '--');\r\n    setText('funnel-rate', data.conversionRate ? data.conversionRate + '%' : '--');\r\n  }\r\n\r\n  function renderCost(data) {\r\n    if (!data) return;\r\n    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };\r\n    setText('funnel-cost', data.costPerHire ? '$' + data.costPerHire : '--');\r\n    setText('funnel-cost-trend', data.trend || '');\r\n  }\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-home.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-intel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'intelData' is assigned a value but never used.","line":12,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-INTEL  Competitor Intelligence\r\n// Pay rates, hiring velocity, driver sentiment, threat levels\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'intel';\r\n  const MESSAGES = ['competitorDataLoaded', 'intelAdded'];\r\n\r\n  let intelData = null;\r\n\r\n  function render() {\r\n    return `\r\n      <div class=\"flex items-center gap-3\">\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n        </button>\r\n        <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-white text-[16px]\">visibility</span>\r\n        </div>\r\n        <h2 class=\"text-lg font-bold text-lmdr-dark\">Competitor Intelligence</h2>\r\n        <span class=\"ml-auto text-[11px] text-tan font-medium\" id=\"intel-updated\">--</span>\r\n      </div>\r\n\r\n      <!-- Top KPI Cards -->\r\n      <div class=\"grid grid-cols-4 gap-4 mt-4\">\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Your Avg CPM</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"intel-your-cpm\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">cents/mile</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Market Avg</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-blue mt-1\" id=\"intel-market-cpm\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">cents/mile</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Tracked</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"intel-tracked\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">competitors</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Threat Level</p>\r\n          <h3 class=\"text-[22px] font-black mt-1\" id=\"intel-threat\">--</h3>\r\n          <div class=\"h-1.5 w-full neu-ins rounded-full overflow-hidden mt-2\">\r\n            <div class=\"h-full rounded-full transition-all\" id=\"intel-threat-bar\" style=\"width:0%\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"grid grid-cols-2 gap-5 mt-4\">\r\n        <!-- Pay Rate Comparison -->\r\n        <div class=\"neu rounded-2xl p-6\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">Pay Rate Comparison</h3>\r\n          <div class=\"flex flex-col gap-3\" id=\"intel-pay-bars\">\r\n            <div class=\"text-center text-[12px] text-tan py-4\">Loading pay data...</div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Hiring Velocity Table -->\r\n        <div class=\"neu rounded-2xl p-6\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">Hiring Velocity</h3>\r\n          <div class=\"overflow-auto\">\r\n            <table class=\"w-full text-[11px]\">\r\n              <thead>\r\n                <tr class=\"text-left text-tan font-bold uppercase tracking-wider\">\r\n                  <th class=\"pb-2\">Competitor</th>\r\n                  <th class=\"pb-2 text-center\">Hires/Mo</th>\r\n                  <th class=\"pb-2 text-center\">Trend</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody id=\"intel-velocity-rows\">\r\n                <tr><td colspan=\"3\" class=\"text-center text-tan py-4\">Loading...</td></tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Driver Sentiment -->\r\n      <div class=\"neu rounded-2xl p-6 mt-4\">\r\n        <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">Driver Sentiment by Carrier</h3>\r\n        <div class=\"flex flex-col gap-2\" id=\"intel-sentiment-list\">\r\n          <div class=\"text-center text-[12px] text-tan py-4\">Loading sentiment data...</div>\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('getCompetitorData', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    intelData = null;\r\n  }\r\n\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'competitorDataLoaded':\r\n        intelData = data;\r\n        renderIntel(data);\r\n        break;\r\n\r\n      case 'intelAdded':\r\n        showToast('Intel entry added');\r\n        ROS.bridge.sendToVelo('getCompetitorData', {});\r\n        break;\r\n    }\r\n  }\r\n\r\n  function renderIntel(data) {\r\n    if (!data) return;\r\n    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };\r\n\r\n    setText('intel-your-cpm', data.yourCPM || '--');\r\n    setText('intel-market-cpm', data.marketCPM || '--');\r\n    setText('intel-tracked', data.competitorsTracked || '0');\r\n    setText('intel-updated', data.lastUpdated ? 'Updated ' + data.lastUpdated : '');\r\n\r\n    // Threat level\r\n    const threatEl = document.getElementById('intel-threat');\r\n    const threatBar = document.getElementById('intel-threat-bar');\r\n    const threat = data.threatLevel || 'Low';\r\n    const threatConfig = {\r\n      'Critical': { color: 'text-red-500', barColor: 'bg-red-500', pct: 100 },\r\n      'High':     { color: 'text-orange-500', barColor: 'bg-orange-500', pct: 75 },\r\n      'Medium':   { color: 'text-amber-500', barColor: 'bg-amber-500', pct: 50 },\r\n      'Low':      { color: 'text-sg', barColor: 'bg-emerald-500', pct: 25 }\r\n    };\r\n    const tc = threatConfig[threat] || threatConfig['Low'];\r\n    if (threatEl) { threatEl.textContent = threat; threatEl.className = 'text-[22px] font-black mt-1 ' + tc.color; }\r\n    if (threatBar) { threatBar.style.width = tc.pct + '%'; threatBar.className = 'h-full rounded-full transition-all ' + tc.barColor; }\r\n\r\n    // Pay rate bars\r\n    if (data.payComparison) renderPayBars(data.payComparison);\r\n\r\n    // Hiring velocity table\r\n    if (data.hiringVelocity) renderVelocityTable(data.hiringVelocity);\r\n\r\n    // Driver sentiment\r\n    if (data.driverSentiment) renderSentiment(data.driverSentiment);\r\n  }\r\n\r\n  function renderPayBars(comparisons) {\r\n    const container = document.getElementById('intel-pay-bars');\r\n    if (!container || !Array.isArray(comparisons)) return;\r\n\r\n    const max = Math.max(...comparisons.map(c => c.cpm || c.rate || 0), 1);\r\n\r\n    container.innerHTML = comparisons.map(c => {\r\n      const name = c.name || c.carrier || 'Unknown';\r\n      const rate = c.cpm || c.rate || 0;\r\n      const pct = Math.round((rate / max) * 100);\r\n      const isYou = c.isYou || c.isSelf;\r\n      const barColor = isYou ? 'bg-gradient-to-r from-violet-500 to-purple-500' : 'bg-lmdr-blue/25';\r\n      const textClass = isYou ? 'text-violet-600 font-black' : 'text-lmdr-dark';\r\n\r\n      return `\r\n        <div>\r\n          <div class=\"flex items-center justify-between mb-1\">\r\n            <span class=\"text-[11px] font-bold ${textClass}\">${escapeHtml(name)} ${isYou ? '(You)' : ''}</span>\r\n            <span class=\"text-[11px] font-bold text-lmdr-dark\">${rate}\\u00a2</span>\r\n          </div>\r\n          <div class=\"h-3 w-full neu-ins rounded-full overflow-hidden\">\r\n            <div class=\"h-full ${barColor} rounded-full\" style=\"width:${pct}%\"></div>\r\n          </div>\r\n        </div>`;\r\n    }).join('');\r\n  }\r\n\r\n  function renderVelocityTable(velocity) {\r\n    const tbody = document.getElementById('intel-velocity-rows');\r\n    if (!tbody || !Array.isArray(velocity)) return;\r\n\r\n    tbody.innerHTML = velocity.map(v => {\r\n      const name = v.name || v.carrier || 'Unknown';\r\n      const hires = v.hiresPerMonth || v.hires || 0;\r\n      const trend = v.trend || 'flat';\r\n      const trendIcon = trend === 'up' ? 'trending_up' : trend === 'down' ? 'trending_down' : 'trending_flat';\r\n      const trendColor = trend === 'up' ? 'text-sg' : trend === 'down' ? 'text-red-400' : 'text-tan';\r\n\r\n      return `\r\n        <tr class=\"border-t border-beige-d/30\">\r\n          <td class=\"py-2.5 text-[12px] font-bold text-lmdr-dark\">${escapeHtml(name)}</td>\r\n          <td class=\"py-2.5 text-center text-[12px] font-bold text-lmdr-dark\">${hires}</td>\r\n          <td class=\"py-2.5 text-center\">\r\n            <span class=\"material-symbols-outlined text-[16px] ${trendColor}\">${trendIcon}</span>\r\n          </td>\r\n        </tr>`;\r\n    }).join('');\r\n  }\r\n\r\n  function renderSentiment(sentiment) {\r\n    const list = document.getElementById('intel-sentiment-list');\r\n    if (!list || !Array.isArray(sentiment)) return;\r\n\r\n    list.innerHTML = sentiment.map(s => {\r\n      const name = s.name || s.carrier || 'Unknown';\r\n      const rating = s.rating || s.score || 0;\r\n      const maxStars = 5;\r\n      const fullStars = Math.floor(rating);\r\n      const halfStar = rating % 1 >= 0.5;\r\n      const stars = Array.from({ length: maxStars }, (_, i) => {\r\n        if (i < fullStars) return '<span class=\"material-symbols-outlined text-[14px] text-amber-400\">star</span>';\r\n        if (i === fullStars && halfStar) return '<span class=\"material-symbols-outlined text-[14px] text-amber-400\">star_half</span>';\r\n        return '<span class=\"material-symbols-outlined text-[14px] text-tan/30\">star</span>';\r\n      }).join('');\r\n      const reviews = s.reviewCount || s.reviews || 0;\r\n\r\n      return `\r\n        <div class=\"flex items-center gap-3 p-2.5 neu-x rounded-xl\">\r\n          <div class=\"flex-1\">\r\n            <div class=\"text-[12px] font-bold text-lmdr-dark\">${escapeHtml(name)}</div>\r\n          </div>\r\n          <div class=\"flex items-center gap-1\">${stars}</div>\r\n          <span class=\"text-[10px] text-tan font-medium\">${rating.toFixed(1)} (${reviews})</span>\r\n        </div>`;\r\n    }).join('');\r\n  }\r\n\r\n  function showToast(msg) {\r\n    const t = document.createElement('div');\r\n    t.className = 'fixed top-16 right-4 z-[9999] px-4 py-2.5 rounded-xl neu-s text-[12px] font-bold text-lmdr-dark';\r\n    t.style.animation = 'fadeUp .3s ease';\r\n    t.textContent = msg;\r\n    document.body.appendChild(t);\r\n    setTimeout(() => t.remove(), 3000);\r\n  }\r\n\r\n  function escapeHtml(s) { if (!s) return ''; const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-leaderboard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-lifecycle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-messages.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-onboard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-pipeline.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'initials' is assigned a value but never used.","line":144,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":144,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-PIPELINE  Kanban Pipeline\r\n// Extracted from Recruiter_Pipeline_Page.html\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'pipeline';\r\n  const MESSAGES = [\r\n    'pipelineLoaded', 'statusUpdated', 'statsLoaded', 'candidateDetails',\r\n    'notesAdded', 'error'\r\n  ];\r\n\r\n  const STAGES = [\r\n    { id: 'interested', label: 'Interested', color: 'text-amber-600' },\r\n    { id: 'contacted', label: 'Contacted', color: 'text-lmdr-blue' },\r\n    { id: 'review',    label: 'Review',    color: 'text-violet-600' },\r\n    { id: 'offer',     label: 'Offer',     color: 'text-orange-600' },\r\n    { id: 'hired',     label: 'Hired',     color: 'text-emerald-600' }\r\n  ];\r\n\r\n  let candidates = {};\r\n  let stats = {};\r\n\r\n  function render() {\r\n    const columns = STAGES.map(s => `\r\n      <div class=\"flex flex-col flex-1 min-w-[180px]\">\r\n        <div class=\"px-3 py-2 rounded-lg neu-ins text-[10px] font-black uppercase tracking-wider ${s.color} text-center mb-3\">\r\n          ${s.label} \\u00b7 <span id=\"pipe-count-${s.id}\">0</span>\r\n        </div>\r\n        <div class=\"flex-1 flex flex-col gap-2 min-h-[100px]\" id=\"pipe-col-${s.id}\" data-stage=\"${s.id}\"></div>\r\n      </div>`).join('');\r\n\r\n    return `\r\n      <div class=\"flex items-center gap-3\">\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n        </button>\r\n        <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-lmdr-yb to-amber-500 flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-lmdr-dark text-[16px]\">view_kanban</span>\r\n        </div>\r\n        <h2 class=\"text-lg font-bold text-lmdr-dark\">Candidate Pipeline</h2>\r\n        <span class=\"text-[11px] text-tan font-medium ml-auto\" id=\"pipe-total\">0 total</span>\r\n      </div>\r\n\r\n      <!-- Stats Row -->\r\n      <div class=\"grid grid-cols-4 gap-4 mt-4\" id=\"pipe-stats\">\r\n        <div class=\"neu-s p-4 rounded-xl text-center\">\r\n          <p class=\"text-[9px] font-bold uppercase tracking-widest text-tan\">Total</p>\r\n          <h3 class=\"text-[22px] font-black text-lmdr-dark mt-1\" id=\"stat-total\">--</h3>\r\n        </div>\r\n        <div class=\"neu-s p-4 rounded-xl text-center\">\r\n          <p class=\"text-[9px] font-bold uppercase tracking-widest text-tan\">This Week</p>\r\n          <h3 class=\"text-[22px] font-black text-lmdr-blue mt-1\" id=\"stat-week\">--</h3>\r\n        </div>\r\n        <div class=\"neu-s p-4 rounded-xl text-center\">\r\n          <p class=\"text-[9px] font-bold uppercase tracking-widest text-tan\">Conversion</p>\r\n          <h3 class=\"text-[22px] font-black text-sg mt-1\" id=\"stat-conversion\">--</h3>\r\n        </div>\r\n        <div class=\"neu-s p-4 rounded-xl text-center\">\r\n          <p class=\"text-[9px] font-bold uppercase tracking-widest text-tan\">Avg Days</p>\r\n          <h3 class=\"text-[22px] font-black text-lmdr-dark mt-1\" id=\"stat-days\">--</h3>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Kanban Board -->\r\n      <div class=\"grid grid-cols-5 gap-4 mt-4 flex-1 overflow-x-auto\">${columns}</div>`;\r\n  }\r\n\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('getPipeline', {});\r\n    ROS.bridge.sendToVelo('getStats', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    candidates = {};\r\n  }\r\n\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'pipelineLoaded':\r\n        if (data && data.candidates) {\r\n          groupCandidates(data.candidates);\r\n          renderColumns();\r\n        }\r\n        break;\r\n\r\n      case 'statsLoaded':\r\n        stats = data || {};\r\n        renderStats();\r\n        break;\r\n\r\n      case 'statusUpdated':\r\n        // Refresh pipeline\r\n        ROS.bridge.sendToVelo('getPipeline', {});\r\n        break;\r\n\r\n      case 'candidateDetails':\r\n        if (data) showCandidateDetail(data);\r\n        break;\r\n\r\n      case 'notesAdded':\r\n        showToast('Note added');\r\n        break;\r\n    }\r\n  }\r\n\r\n  function groupCandidates(list) {\r\n    candidates = {};\r\n    STAGES.forEach(s => candidates[s.id] = []);\r\n    (list || []).forEach(c => {\r\n      const stage = (c.status || c.stage || 'interested').toLowerCase();\r\n      if (candidates[stage]) {\r\n        candidates[stage].push(c);\r\n      } else {\r\n        candidates['interested'].push(c);\r\n      }\r\n    });\r\n  }\r\n\r\n  function renderColumns() {\r\n    let total = 0;\r\n    STAGES.forEach(s => {\r\n      const col = document.getElementById('pipe-col-' + s.id);\r\n      const count = document.getElementById('pipe-count-' + s.id);\r\n      const items = candidates[s.id] || [];\r\n      total += items.length;\r\n\r\n      if (count) count.textContent = items.length;\r\n      if (col) {\r\n        col.innerHTML = items.length === 0\r\n          ? '<div class=\"text-center text-[10px] text-tan/50 py-4\">Empty</div>'\r\n          : items.map(c => renderCard(c, s.id)).join('');\r\n      }\r\n    });\r\n\r\n    const totalEl = document.getElementById('pipe-total');\r\n    if (totalEl) totalEl.textContent = total + ' total';\r\n  }\r\n\r\n  function renderCard(candidate, stage) {\r\n    const name = candidate.name || candidate.driver_name || 'Unknown';\r\n    const initials = name.split(' ').map(w => w[0]).join('').toUpperCase().slice(0, 2);\r\n    const details = candidate.cdl_type || candidate.location || '';\r\n    const id = candidate._id || candidate.id || '';\r\n    const badge = candidate.badge || '';\r\n    const badgeColors = {\r\n      'New Match': 'bg-amber-100 text-amber-700',\r\n      'AI Found': 'bg-blue-100 text-blue-700',\r\n      'Replied': 'bg-emerald-100 text-emerald-700',\r\n      'Docs Pending': 'bg-violet-100 text-violet-700',\r\n      'Onboarding': 'bg-emerald-100 text-emerald-700'\r\n    };\r\n    const badgeClass = badgeColors[badge] || 'bg-slate-100 text-slate-600';\r\n\r\n    return `\r\n      <div class=\"p-3 neu-x rounded-xl cursor-pointer hover:shadow-neu-s transition-shadow\"\r\n           onclick=\"ROS.views._pipeline.viewCandidate('${id}')\">\r\n        <div class=\"text-[12px] font-bold\">${escapeHtml(name)}</div>\r\n        <div class=\"text-[10px] text-tan mt-1\">${escapeHtml(details)}</div>\r\n        ${badge ? `<span class=\"inline-block mt-2 px-2 py-0.5 rounded text-[9px] font-bold ${badgeClass}\">${escapeHtml(badge)}</span>` : ''}\r\n      </div>`;\r\n  }\r\n\r\n  function renderStats() {\r\n    const el = (id, val) => { const e = document.getElementById(id); if (e) e.textContent = val; };\r\n    el('stat-total', stats.totalCandidates || stats.total || '--');\r\n    el('stat-week', stats.thisWeek || '--');\r\n    el('stat-conversion', stats.conversionRate ? stats.conversionRate + '%' : '--');\r\n    el('stat-days', stats.avgDays || '--');\r\n  }\r\n\r\n  function showCandidateDetail(data) {\r\n    showToast('Viewing: ' + (data.name || data.driver_name || 'candidate'));\r\n  }\r\n\r\n  function showToast(msg) {\r\n    const t = document.createElement('div');\r\n    t.className = 'fixed top-16 right-4 z-[9999] px-4 py-2.5 rounded-xl neu-s text-[12px] font-bold text-lmdr-dark';\r\n    t.style.animation = 'fadeUp .3s ease';\r\n    t.textContent = msg;\r\n    document.body.appendChild(t);\r\n    setTimeout(() => t.remove(), 3000);\r\n  }\r\n\r\n  function escapeHtml(s) { if (!s) return ''; const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }\r\n\r\n  // Public API\r\n  ROS.views._pipeline = {\r\n    viewCandidate: function(id) {\r\n      ROS.bridge.sendToVelo('getCandidateDetails', { candidateId: id });\r\n    },\r\n    updateStatus: function(id, status) {\r\n      ROS.bridge.sendToVelo('updateCandidateStatus', { candidateId: id, status });\r\n    }\r\n  };\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-predict.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'predictions' is assigned a value but never used.","line":12,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'showToast' is defined but never used.","line":177,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":177,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-PREDICT  AI Predictions Dashboard\r\n// Hire Forecast, Attrition Risk, Market Demand, Pipeline Velocity\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'predict';\r\n  const MESSAGES = ['predictionsLoaded', 'forecastGenerated'];\r\n\r\n  let predictions = null;\r\n\r\n  function render() {\r\n    return `\r\n      <div class=\"flex items-center gap-3\">\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n        </button>\r\n        <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-fuchsia-600 flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-white text-[16px]\">auto_awesome</span>\r\n        </div>\r\n        <h2 class=\"text-lg font-bold text-lmdr-dark\">AI Predictions</h2>\r\n        <span class=\"ml-auto px-3 py-1 rounded-full text-[10px] font-bold bg-purple-100 text-purple-700\">\r\n          <span class=\"material-symbols-outlined text-[12px] align-middle\">auto_awesome</span> AI-Powered\r\n        </span>\r\n      </div>\r\n\r\n      <!-- Top KPI Cards -->\r\n      <div class=\"grid grid-cols-4 gap-4 mt-4\">\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Hire Forecast</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"pred-hire-forecast\">--</h3>\r\n          <span class=\"text-[11px] font-bold\" id=\"pred-hire-confidence\">--</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Attrition Risk</p>\r\n          <h3 class=\"text-[28px] font-black text-red-400 mt-1\" id=\"pred-attrition\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">flagged drivers</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Market Demand</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-blue mt-1\" id=\"pred-market\">--</h3>\r\n          <span class=\"text-[11px] text-sg font-bold\" id=\"pred-market-trend\"></span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Pipeline Velocity</p>\r\n          <h3 class=\"text-[28px] font-black text-sg mt-1\" id=\"pred-velocity\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">hires/week</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"grid grid-cols-3 gap-5 mt-4\">\r\n        <!-- Pipeline Velocity Forecast (weekly bars) -->\r\n        <div class=\"col-span-2 neu rounded-2xl p-6\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">Weekly Pipeline Velocity</h3>\r\n          <div class=\"flex items-end gap-2 h-[160px]\" id=\"pred-velocity-bars\">\r\n            <div class=\"text-center text-[12px] text-tan py-4 w-full\">Loading forecast...</div>\r\n          </div>\r\n          <div class=\"flex justify-between mt-2\" id=\"pred-velocity-labels\"></div>\r\n        </div>\r\n\r\n        <!-- At-Risk Drivers -->\r\n        <div class=\"neu rounded-2xl p-6\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark mb-4\">At-Risk Drivers</h3>\r\n          <div class=\"flex flex-col gap-2\" id=\"pred-atrisk-list\">\r\n            <div class=\"text-center text-[12px] text-tan py-4\">Loading...</div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('getPredictionsData', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    predictions = null;\r\n  }\r\n\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'predictionsLoaded':\r\n        predictions = data;\r\n        renderPredictions(data);\r\n        break;\r\n\r\n      case 'forecastGenerated':\r\n        if (data && data.weeklyForecast) renderVelocityBars(data.weeklyForecast);\r\n        break;\r\n    }\r\n  }\r\n\r\n  function renderPredictions(data) {\r\n    if (!data) return;\r\n    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };\r\n\r\n    // Hire Forecast\r\n    setText('pred-hire-forecast', data.hireForecast || '--');\r\n    const confEl = document.getElementById('pred-hire-confidence');\r\n    if (confEl && data.hireConfidence) {\r\n      const confPct = Math.round(data.hireConfidence);\r\n      confEl.textContent = confPct + '% confidence';\r\n      confEl.className = 'text-[11px] font-bold ' + (confPct >= 80 ? 'text-sg' : confPct >= 60 ? 'text-amber-500' : 'text-red-400');\r\n    }\r\n\r\n    // Attrition\r\n    setText('pred-attrition', data.attritionCount || '0');\r\n\r\n    // Market Demand\r\n    setText('pred-market', data.marketDemand || '--');\r\n    setText('pred-market-trend', data.marketTrend || '');\r\n\r\n    // Pipeline Velocity\r\n    setText('pred-velocity', data.pipelineVelocity || '--');\r\n\r\n    // Render weekly bars\r\n    if (data.weeklyForecast) renderVelocityBars(data.weeklyForecast);\r\n\r\n    // Render at-risk drivers\r\n    if (data.atRiskDrivers) renderAtRiskDrivers(data.atRiskDrivers);\r\n  }\r\n\r\n  function renderVelocityBars(weeks) {\r\n    const container = document.getElementById('pred-velocity-bars');\r\n    const labels = document.getElementById('pred-velocity-labels');\r\n    if (!container || !Array.isArray(weeks) || weeks.length === 0) return;\r\n\r\n    const max = Math.max(...weeks.map(w => w.value || w.count || 0), 1);\r\n\r\n    container.innerHTML = weeks.map(w => {\r\n      const val = w.value || w.count || 0;\r\n      const pct = Math.round((val / max) * 100);\r\n      const isPredicted = w.predicted || w.forecast;\r\n      return `\r\n        <div class=\"flex-1 flex flex-col items-center justify-end h-full\">\r\n          <span class=\"text-[10px] font-bold text-lmdr-dark mb-1\">${val}</span>\r\n          <div class=\"w-full rounded-t-lg ${isPredicted ? 'bg-purple-400/40 border-2 border-dashed border-purple-400' : 'bg-gradient-to-t from-purple-500 to-fuchsia-500'}\"\r\n               style=\"height:${Math.max(pct, 5)}%\"></div>\r\n        </div>`;\r\n    }).join('');\r\n\r\n    if (labels) {\r\n      labels.innerHTML = weeks.map(w =>\r\n        `<span class=\"flex-1 text-center text-[9px] text-tan font-bold uppercase\">${w.label || w.week || ''}</span>`\r\n      ).join('');\r\n    }\r\n  }\r\n\r\n  function renderAtRiskDrivers(drivers) {\r\n    const list = document.getElementById('pred-atrisk-list');\r\n    if (!list) return;\r\n\r\n    if (!drivers || drivers.length === 0) {\r\n      list.innerHTML = '<div class=\"text-center text-[12px] text-sg py-4\"><span class=\"material-symbols-outlined text-[20px] block mb-1\">check_circle</span>No at-risk drivers</div>';\r\n      return;\r\n    }\r\n\r\n    list.innerHTML = drivers.slice(0, 5).map(d => {\r\n      const name = d.name || d.driver_name || 'Unknown';\r\n      const risk = d.risk_level || d.riskLevel || 'Medium';\r\n      const riskColors = { 'Critical': 'bg-red-100 text-red-700', 'High': 'bg-orange-100 text-orange-700', 'Medium': 'bg-amber-100 text-amber-700', 'Low': 'bg-emerald-100 text-emerald-700' };\r\n      const riskClass = riskColors[risk] || riskColors['Medium'];\r\n\r\n      return `\r\n        <div class=\"flex items-center gap-3 p-2.5 neu-x rounded-xl\">\r\n          <span class=\"material-symbols-outlined text-red-400 text-[16px]\">warning</span>\r\n          <div class=\"flex-1\">\r\n            <div class=\"text-[12px] font-bold text-lmdr-dark\">${escapeHtml(name)}</div>\r\n            <div class=\"text-[10px] text-tan\">${escapeHtml(d.reason || '')}</div>\r\n          </div>\r\n          <span class=\"px-2 py-0.5 rounded-full text-[9px] font-bold ${riskClass}\">${risk}</span>\r\n        </div>`;\r\n    }).join('');\r\n  }\r\n\r\n  function showToast(msg) {\r\n    const t = document.createElement('div');\r\n    t.className = 'fixed top-16 right-4 z-[9999] px-4 py-2.5 rounded-xl neu-s text-[12px] font-bold text-lmdr-dark';\r\n    t.style.animation = 'fadeUp .3s ease';\r\n    t.textContent = msg;\r\n    document.body.appendChild(t);\r\n    setTimeout(() => t.remove(), 3000);\r\n  }\r\n\r\n  function escapeHtml(s) { if (!s) return ''; const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-retention.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'retentionData' is assigned a value but never used.","line":12,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-RETENTION  Driver Retention Dashboard\r\n// Retention rate, at-risk count, avg tenure, NPS, intervention actions\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'retention';\r\n  const MESSAGES = ['retentionDataLoaded', 'atRiskDriversLoaded', 'interventionSent'];\r\n\r\n  let retentionData = null;\r\n  let atRiskDrivers = [];\r\n\r\n  function render() {\r\n    return `\r\n      <div class=\"flex items-center gap-3\">\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n        </button>\r\n        <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-red-600 to-rose-700 flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-white text-[16px]\">shield</span>\r\n        </div>\r\n        <h2 class=\"text-lg font-bold text-lmdr-dark\">Retention Dashboard</h2>\r\n      </div>\r\n\r\n      <!-- Stats Row -->\r\n      <div class=\"grid grid-cols-4 gap-4 mt-4\">\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Retention Rate</p>\r\n          <h3 class=\"text-[28px] font-black text-sg mt-1\" id=\"ret-rate\">--</h3>\r\n          <div class=\"h-1.5 w-full neu-ins rounded-full overflow-hidden mt-2\">\r\n            <div class=\"h-full bg-sg rounded-full transition-all\" id=\"ret-rate-bar\" style=\"width:0%\"></div>\r\n          </div>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">At-Risk</p>\r\n          <h3 class=\"text-[28px] font-black text-red-400 mt-1\" id=\"ret-atrisk\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">drivers flagged</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Avg Tenure</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"ret-tenure\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">months</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">NPS Score</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-blue mt-1\" id=\"ret-nps\">--</h3>\r\n          <span class=\"text-[11px] font-bold\" id=\"ret-nps-label\">--</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- At-Risk Drivers -->\r\n      <div class=\"neu rounded-2xl p-5 mt-4 flex-1\">\r\n        <div class=\"flex items-center justify-between mb-4\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark\">At-Risk Drivers</h3>\r\n          <span class=\"text-[10px] text-tan font-medium\" id=\"ret-atrisk-count\">0 flagged</span>\r\n        </div>\r\n        <div class=\"flex flex-col gap-2\" id=\"ret-atrisk-list\">\r\n          <div class=\"text-center py-8 text-tan text-[13px]\">Loading retention data...</div>\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('getRetentionData', {});\r\n    ROS.bridge.sendToVelo('getAtRiskDrivers', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    retentionData = null;\r\n    atRiskDrivers = [];\r\n  }\r\n\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'retentionDataLoaded':\r\n        retentionData = data;\r\n        renderRetentionStats(data);\r\n        break;\r\n\r\n      case 'atRiskDriversLoaded':\r\n        atRiskDrivers = (data && data.drivers) || data || [];\r\n        if (Array.isArray(atRiskDrivers)) renderAtRiskDrivers();\r\n        break;\r\n\r\n      case 'interventionSent':\r\n        showToast(data && data.success ? 'Intervention sent successfully' : 'Failed to send intervention');\r\n        ROS.bridge.sendToVelo('getAtRiskDrivers', {});\r\n        break;\r\n    }\r\n  }\r\n\r\n  function renderRetentionStats(data) {\r\n    if (!data) return;\r\n    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };\r\n\r\n    // Retention Rate\r\n    const rate = data.retentionRate || 0;\r\n    setText('ret-rate', rate + '%');\r\n    const rateBar = document.getElementById('ret-rate-bar');\r\n    if (rateBar) rateBar.style.width = rate + '%';\r\n\r\n    // At-Risk Count\r\n    setText('ret-atrisk', data.atRiskCount || '0');\r\n\r\n    // Avg Tenure\r\n    setText('ret-tenure', data.avgTenure ? data.avgTenure.toFixed(1) : '--');\r\n\r\n    // NPS\r\n    const nps = data.npsScore;\r\n    setText('ret-nps', nps !== undefined && nps !== null ? nps : '--');\r\n    const npsLabel = document.getElementById('ret-nps-label');\r\n    if (npsLabel && nps !== undefined && nps !== null) {\r\n      if (nps >= 50) {\r\n        npsLabel.textContent = 'Excellent';\r\n        npsLabel.className = 'text-[11px] font-bold text-sg';\r\n      } else if (nps >= 0) {\r\n        npsLabel.textContent = 'Good';\r\n        npsLabel.className = 'text-[11px] font-bold text-amber-500';\r\n      } else {\r\n        npsLabel.textContent = 'Needs Work';\r\n        npsLabel.className = 'text-[11px] font-bold text-red-400';\r\n      }\r\n    }\r\n  }\r\n\r\n  function renderAtRiskDrivers() {\r\n    const list = document.getElementById('ret-atrisk-list');\r\n    const countEl = document.getElementById('ret-atrisk-count');\r\n    if (!list) return;\r\n\r\n    if (countEl) countEl.textContent = atRiskDrivers.length + ' flagged';\r\n\r\n    if (atRiskDrivers.length === 0) {\r\n      list.innerHTML = `\r\n        <div class=\"text-center py-8 text-sg text-[13px]\">\r\n          <span class=\"material-symbols-outlined text-[32px] block mb-2\">verified_user</span>\r\n          No at-risk drivers detected\r\n        </div>`;\r\n      return;\r\n    }\r\n\r\n    const riskConfig = {\r\n      'Critical': { bg: 'bg-red-100', text: 'text-red-700', border: 'border-l-red-500' },\r\n      'High':     { bg: 'bg-orange-100', text: 'text-orange-700', border: 'border-l-orange-500' },\r\n      'Medium':   { bg: 'bg-amber-100', text: 'text-amber-700', border: 'border-l-amber-500' },\r\n      'Low':      { bg: 'bg-emerald-100', text: 'text-emerald-700', border: 'border-l-emerald-500' }\r\n    };\r\n\r\n    list.innerHTML = atRiskDrivers.map(d => {\r\n      const name = d.name || d.driver_name || 'Unknown';\r\n      const risk = d.risk_level || d.riskLevel || 'Medium';\r\n      const config = riskConfig[risk] || riskConfig['Medium'];\r\n      const reason = d.reason || d.risk_reason || 'Multiple risk factors detected';\r\n      const tenure = d.tenure ? d.tenure + ' mo' : '';\r\n      const lastContact = d.last_contact || d.lastContact || '';\r\n      const driverId = d._id || d.id || d.driver_id || '';\r\n\r\n      return `\r\n        <div class=\"flex items-center gap-3 p-3 neu-x rounded-xl border-l-4 ${config.border}\">\r\n          <div class=\"flex-1\">\r\n            <div class=\"flex items-center gap-2\">\r\n              <span class=\"text-[13px] font-bold text-lmdr-dark\">${escapeHtml(name)}</span>\r\n              <span class=\"px-2 py-0.5 rounded-full text-[9px] font-bold ${config.bg} ${config.text}\">${risk}</span>\r\n            </div>\r\n            <div class=\"text-[10px] text-tan mt-1\">${escapeHtml(reason)}</div>\r\n            <div class=\"text-[10px] text-tan mt-0.5\">${tenure ? 'Tenure: ' + tenure : ''} ${lastContact ? '\\u00b7 Last contact: ' + escapeHtml(lastContact) : ''}</div>\r\n          </div>\r\n          <button onclick=\"ROS.views._retention.sendIntervention('${driverId}', '${escapeAttr(name)}')\"\r\n                  class=\"px-3 py-2 rounded-lg bg-gradient-to-br from-red-600 to-rose-700 text-white text-[10px] font-bold shadow-md hover:shadow-lg transition-shadow flex items-center gap-1\">\r\n            <span class=\"material-symbols-outlined text-[12px]\">outgoing_mail</span> Intervene\r\n          </button>\r\n        </div>`;\r\n    }).join('');\r\n  }\r\n\r\n  function escapeAttr(s) {\r\n    if (!s) return '';\r\n    return s.replace(/'/g, \"\\\\'\").replace(/\"/g, '&quot;');\r\n  }\r\n\r\n  function showToast(msg) {\r\n    const t = document.createElement('div');\r\n    t.className = 'fixed top-16 right-4 z-[9999] px-4 py-2.5 rounded-xl neu-s text-[12px] font-bold text-lmdr-dark';\r\n    t.style.animation = 'fadeUp .3s ease';\r\n    t.textContent = msg;\r\n    document.body.appendChild(t);\r\n    setTimeout(() => t.remove(), 3000);\r\n  }\r\n\r\n  function escapeHtml(s) { if (!s) return ''; const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }\r\n\r\n  // Public API\r\n  ROS.views._retention = {\r\n    sendIntervention: function(driverId, driverName) {\r\n      if (!driverId) return;\r\n      ROS.bridge.sendToVelo('sendIntervention', { driverId, driverName });\r\n    }\r\n  };\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-search.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getScoreClass' is defined but never used.","line":63,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":25},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":381,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":381,"endColumn":51},{"ruleId":"no-case-declarations","severity":1,"message":"Unexpected lexical declaration in case block.","line":382,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":382,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-SEARCH  Driver Search + AI Match + Saved Searches\r\n// Full feature parity with RECRUITER_DRIVER_SEARCH.html\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'search';\r\n  const MESSAGES = [\r\n    'searchDriversResult', 'viewDriverProfileResult', 'saveDriverResult',\r\n    'contactDriverResult', 'getQuotaStatusResult', 'getWeightPreferencesResult',\r\n    'saveWeightPreferencesResult', 'recruiterProfile', 'driverSearchInit',\r\n    'saveSearchResult', 'savedSearchesLoaded', 'savedSearchExecuted',\r\n    'savedSearchDeleted', 'savedSearchUpdated', 'generateAIDraftResult',\r\n    'noCarrierAssigned'\r\n  ];\r\n\r\n  // -- State --\r\n  let allDrivers = [];\r\n  let drivers = [];\r\n  let totalCount = 0;\r\n  let currentPage = 0;\r\n  const PAGE_SIZE = 5;\r\n  let filters = {};\r\n  let savedSearches = [];\r\n  let quotaStatus = null;\r\n  let selectedDriver = null;\r\n  let selectedDriverData = null;\r\n  let messageMode = 'email';\r\n  const viewedDriverIds = new Set();\r\n  let sortField = 'matchScore';\r\n  let isSearching = false;\r\n  let hasCarrier = true; // assume true until told otherwise\r\n  let weights = {\r\n    qualifications: 25, experience: 20, location: 20,\r\n    availability: 15, salary_fit: 10, engagement: 10\r\n  };\r\n\r\n  // -- Filter Definitions --\r\n  const FILTER_GROUPS = {\r\n    cdlClass: { label: 'CDL Class', type: 'multi', options: ['A', 'B'] },\r\n    endorsements: { label: 'Endorsements', type: 'multi', options: ['HazMat', 'Tanker', 'Doubles/Triples', 'Passenger', 'School Bus'] },\r\n    experience: { label: 'Experience', type: 'radio', options: [\r\n      { value: '', label: 'Any' }, { value: '1', label: '1+ yr' },\r\n      { value: '3', label: '3+ yr' }, { value: '5', label: '5+ yr' }\r\n    ]},\r\n    availability: { label: 'Availability', type: 'radio', options: [\r\n      { value: '', label: 'Any' }, { value: 'immediate', label: 'Immediate' },\r\n      { value: '2_weeks', label: '2 Weeks' }\r\n    ]},\r\n    equipment: { label: 'Equipment', type: 'multi', options: ['Dry Van', 'Reefer', 'Flatbed', 'Tanker', 'Step Deck'] }\r\n  };\r\n\r\n  // -- Helpers --\r\n  function escapeHtml(str) {\r\n    if (!str) return '';\r\n    const d = document.createElement('div');\r\n    d.textContent = str;\r\n    return d.innerHTML;\r\n  }\r\n\r\n  function getScoreClass(score) {\r\n    if (score >= 85) return 'score-excellent';\r\n    if (score >= 70) return 'score-good';\r\n    if (score >= 50) return 'score-fair';\r\n    return 'score-poor';\r\n  }\r\n\r\n  function getScoreColor(score) {\r\n    if (score >= 85) return 'text-emerald-500';\r\n    if (score >= 70) return 'text-lmdr-blue';\r\n    if (score >= 50) return 'text-amber-500';\r\n    return 'text-red-400';\r\n  }\r\n\r\n  function getSourceBadge(source) {\r\n    if (!source || source === 'driver_profiles') return '';\r\n    const map = {\r\n      scored: { cls: 'source-scored', label: 'Scored' },\r\n      application: { cls: 'source-application', label: 'Applied' },\r\n      fb_campaign: { cls: 'source-fb', label: 'Campaign' },\r\n      legacy_lead: { cls: 'source-legacy', label: 'Lead' }\r\n    };\r\n    const badge = map[source] || { cls: 'source-legacy', label: source };\r\n    return `<span class=\"source-badge ${badge.cls}\">${badge.label}</span>`;\r\n  }\r\n\r\n  function showToast(msg, type) {\r\n    const toast = document.createElement('div');\r\n    const icon = type === 'error' ? 'error' : 'check_circle';\r\n    const color = type === 'error' ? 'text-red-400' : 'text-emerald-500';\r\n    toast.className = 'fixed top-16 right-4 z-[10000] px-4 py-2.5 rounded-xl neu-s text-[12px] font-bold text-lmdr-dark flex items-center gap-2';\r\n    toast.style.animation = 'fadeUp .3s ease';\r\n    toast.innerHTML = `<span class=\"material-symbols-outlined ${color} text-[16px]\">${icon}</span>${escapeHtml(msg)}`;\r\n    document.body.appendChild(toast);\r\n    setTimeout(() => toast.remove(), 3000);\r\n  }\r\n\r\n  // -- Render --\r\n  function render() {\r\n    return `\r\n      <!-- Header Row -->\r\n      <div class=\"flex items-center justify-between flex-wrap gap-2\">\r\n        <div class=\"flex items-center gap-3\">\r\n          <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center hover:shadow-none transition-shadow\">\r\n            <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n          </button>\r\n          <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-lmdr-blue to-lmdr-deep flex items-center justify-center\">\r\n            <span class=\"material-symbols-outlined text-white text-[16px]\">person_search</span>\r\n          </div>\r\n          <h2 class=\"text-lg font-bold text-lmdr-dark\">Driver Search</h2>\r\n        </div>\r\n        <div class=\"flex items-center gap-2 flex-wrap\">\r\n          <div id=\"search-quota-bar\" class=\"flex items-center gap-2\"></div>\r\n          <span class=\"text-[11px] text-tan font-medium\" id=\"search-count\">0 results</span>\r\n          <button onclick=\"ROS.views._search.openSaveModal()\" class=\"px-3 py-1.5 text-[10px] font-bold rounded-full neu-x text-tan hover:text-lmdr-blue transition-colors\">\r\n            <span class=\"material-symbols-outlined text-[12px] align-middle\">save</span> Save\r\n          </button>\r\n          <button onclick=\"ROS.views._search.loadSaved()\" class=\"px-3 py-1.5 text-[10px] font-bold rounded-full neu-x text-tan hover:text-lmdr-blue transition-colors\">\r\n            <span class=\"material-symbols-outlined text-[12px] align-middle\">bookmark</span> Saved\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Search Bar + Sort -->\r\n      <div class=\"flex gap-2 mt-4 items-center flex-wrap\">\r\n        <div class=\"flex-1 flex items-center px-4 py-3 neu-in rounded-xl min-w-[200px]\">\r\n          <span class=\"material-symbols-outlined text-tan text-[18px]\">search</span>\r\n          <input id=\"search-input\" class=\"bg-transparent border-none focus:ring-0 text-base text-lmdr-dark placeholder-tan/50 w-full ml-2 outline-none font-medium\"\r\n                 placeholder=\"Name, CDL type, location, endorsements...\"\r\n                 onkeydown=\"if(event.key==='Enter')ROS.views._search.doSearch()\"/>\r\n        </div>\r\n        <select id=\"search-sort\" class=\"px-3 py-3 rounded-xl neu-in text-[12px] font-bold text-lmdr-dark outline-none cursor-pointer\" onchange=\"ROS.views._search.doSort()\">\r\n          <option value=\"matchScore\">Match Score</option>\r\n          <option value=\"experience\">Experience</option>\r\n          <option value=\"location\">Location</option>\r\n        </select>\r\n        <button onclick=\"ROS.views._search.doSearch()\" class=\"px-5 py-3 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-sm font-bold flex items-center gap-2 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/40 transition-shadow whitespace-nowrap\">\r\n          <span class=\"material-symbols-outlined text-[18px]\">search</span>Search\r\n        </button>\r\n        <button onclick=\"ROS.views._search.toggleWeights()\" class=\"px-3 py-3 rounded-xl neu-x text-tan hover:text-lmdr-blue transition-colors\" title=\"Match Weight Preferences\">\r\n          <span class=\"material-symbols-outlined text-[18px]\">tune</span>\r\n        </button>\r\n      </div>\r\n\r\n      <!-- Filter Orbs -->\r\n      <div class=\"mt-3 flex flex-col gap-2\" id=\"search-filter-orbs\">\r\n        ${renderFilterOrbs()}\r\n      </div>\r\n\r\n      <!-- Location Row -->\r\n      <div class=\"flex gap-3 mt-2 items-center\">\r\n        <div class=\"flex items-center gap-2 px-3 py-2 neu-in rounded-xl flex-1 max-w-[200px]\">\r\n          <span class=\"material-symbols-outlined text-tan text-[14px]\">location_on</span>\r\n          <input id=\"filter-zip\" class=\"bg-transparent border-none focus:ring-0 text-[12px] text-lmdr-dark placeholder-tan/50 w-full outline-none font-medium\"\r\n                 placeholder=\"ZIP code\" maxlength=\"5\"/>\r\n        </div>\r\n        <select id=\"filter-radius\" class=\"px-3 py-2 rounded-xl neu-in text-[11px] font-bold text-lmdr-dark outline-none cursor-pointer\">\r\n          <option value=\"25\">25 mi</option>\r\n          <option value=\"50\" selected>50 mi</option>\r\n          <option value=\"100\">100 mi</option>\r\n          <option value=\"200\">200 mi</option>\r\n          <option value=\"\">Any</option>\r\n        </select>\r\n        <div class=\"flex-1\"></div>\r\n        <button onclick=\"ROS.views._search.clearFilters()\" class=\"px-3 py-1.5 text-[10px] font-bold rounded-full neu-x text-red-400 hover:text-red-500 transition-colors\">\r\n          <span class=\"material-symbols-outlined text-[12px] align-middle\">filter_list_off</span> Clear All\r\n        </button>\r\n      </div>\r\n\r\n      <!-- Active Filters Summary -->\r\n      <div id=\"search-active-filters\" class=\"flex gap-2 flex-wrap mt-2\"></div>\r\n\r\n      <!-- Results -->\r\n      <div class=\"flex flex-col gap-3 mt-4\" id=\"search-results\">\r\n        <div id=\"search-empty-state\" class=\"text-center py-12 text-tan text-[13px]\">\r\n          <span class=\"material-symbols-outlined text-[48px] text-tan/30 block mb-3\">person_search</span>\r\n          Select your filters and click Search to find matching drivers\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Pagination -->\r\n      <div class=\"flex items-center justify-center gap-1 mt-4 flex-wrap\" id=\"search-pagination\" style=\"display:none\"></div>\r\n\r\n      <!-- Saved Searches Panel (hidden by default) -->\r\n      <div id=\"saved-searches-panel\" style=\"display:none\" class=\"mt-4 neu rounded-2xl p-4\">\r\n        <div class=\"flex items-center justify-between mb-3\">\r\n          <h3 class=\"text-[13px] font-bold text-lmdr-dark\">Saved Searches</h3>\r\n          <button onclick=\"document.getElementById('saved-searches-panel').style.display='none'\" class=\"text-tan hover:text-lmdr-dark\">\r\n            <span class=\"material-symbols-outlined text-[16px]\">close</span>\r\n          </button>\r\n        </div>\r\n        <div id=\"saved-searches-list\" class=\"flex flex-col gap-2\"></div>\r\n      </div>`;\r\n  }\r\n\r\n  // -- Filter Orbs --\r\n  function renderFilterOrbs() {\r\n    let html = '';\r\n    for (const [groupKey, group] of Object.entries(FILTER_GROUPS)) {\r\n      html += `<div class=\"flex items-center gap-2 flex-wrap\">\r\n        <span class=\"text-[10px] font-bold text-tan uppercase tracking-wider w-[80px] shrink-0\">${group.label}</span>\r\n        <div class=\"flex gap-1.5 flex-wrap filter-orb-scroll\">`;\r\n\r\n      if (group.type === 'multi') {\r\n        group.options.forEach(opt => {\r\n          const filterKey = groupKey === 'cdlClass' ? `cdl_${opt}` : `${groupKey}_${opt.replace(/[/\\\\s]/g,'_')}`;\r\n          html += `<button class=\"filter-orb px-3 py-1.5 text-[10px] font-bold rounded-full neu-x text-tan transition-all\"\r\n                    data-filter-group=\"${groupKey}\" data-filter-value=\"${opt}\" id=\"orb-${filterKey}\"\r\n                    onclick=\"ROS.views._search.toggleOrb(this,'${groupKey}','${escapeHtml(opt)}')\">${escapeHtml(opt)}</button>`;\r\n        });\r\n      } else {\r\n        group.options.forEach(opt => {\r\n          const isDefault = opt.value === '';\r\n          const filterKey = `${groupKey}_${opt.value || 'any'}`;\r\n          html += `<button class=\"filter-orb px-3 py-1.5 text-[10px] font-bold rounded-full ${isDefault ? 'filter-orb-active' : 'neu-x'} text-tan transition-all\"\r\n                    data-filter-group=\"${groupKey}\" data-filter-value=\"${opt.value}\" id=\"orb-${filterKey}\"\r\n                    onclick=\"ROS.views._search.selectRadioOrb(this,'${groupKey}','${opt.value}')\">${opt.label}</button>`;\r\n        });\r\n      }\r\n      html += `</div></div>`;\r\n    }\r\n    return html;\r\n  }\r\n\r\n  // -- onMount --\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('driverSearchReady', {});\r\n    ROS.bridge.sendToVelo('getQuotaStatus', {});\r\n    ROS.bridge.sendToVelo('getWeightPreferences', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    allDrivers = [];\r\n    drivers = [];\r\n    totalCount = 0;\r\n    currentPage = 0;\r\n    filters = {};\r\n    selectedDriver = null;\r\n    selectedDriverData = null;\r\n    viewedDriverIds.clear();\r\n    isSearching = false;\r\n    // Clean up floating elements\r\n    const alertEl = document.getElementById('no-carrier-alert');\r\n    if (alertEl) alertEl.remove();\r\n    const orbEl = document.getElementById('weights-orb');\r\n    if (orbEl) orbEl.remove();\r\n  }\r\n\r\n  // -- onMessage --\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'driverSearchInit':\r\n        if (data && data.quotaStatus) {\r\n          quotaStatus = data.quotaStatus;\r\n          renderQuotaBar();\r\n        }\r\n        if (data && data.currentCarrierDOT) {\r\n          hasCarrier = true;\r\n        } else if (data && data.carriers && data.carriers.length === 0) {\r\n          hasCarrier = false;\r\n          renderNoCarrierState();\r\n        }\r\n        break;\r\n\r\n      case 'searchDriversResult':\r\n        isSearching = false;\r\n        if (data && data.success) {\r\n          allDrivers = data.drivers || [];\r\n          totalCount = allDrivers.length;\r\n          if (data.quotaStatus) {\r\n            quotaStatus = data.quotaStatus;\r\n            renderQuotaBar();\r\n          }\r\n          currentPage = 0;\r\n          applySortAndPaginate();\r\n        } else {\r\n          const err = data && data.error ? data.error : 'Search failed';\r\n          if (err.toLowerCase().includes('no carrier')) {\r\n            hasCarrier = false;\r\n            renderNoCarrierState();\r\n          } else {\r\n            renderError(err);\r\n          }\r\n        }\r\n        break;\r\n\r\n      case 'viewDriverProfileResult':\r\n        if (data && data.success) {\r\n          if (data.quotaStatus) {\r\n            quotaStatus = data.quotaStatus;\r\n            renderQuotaBar();\r\n          }\r\n          selectedDriverData = data.driver;\r\n          if (selectedDriver) viewedDriverIds.add(selectedDriver);\r\n          renderProfileModal(data.driver);\r\n        } else if (data && data.quotaExceeded) {\r\n          if (data.quotaStatus) {\r\n            quotaStatus = data.quotaStatus;\r\n            renderQuotaBar();\r\n          }\r\n          renderQuotaExceededModal();\r\n        } else {\r\n          showToast(data && data.error ? data.error : 'Failed to load profile', 'error');\r\n        }\r\n        break;\r\n\r\n      case 'saveDriverResult':\r\n        if (data && data.success) {\r\n          showToast(data.alreadyExists ? 'Driver already in pipeline' : 'Driver saved to pipeline');\r\n        } else {\r\n          showToast(data && data.error ? data.error : 'Failed to save driver', 'error');\r\n        }\r\n        break;\r\n\r\n      case 'contactDriverResult':\r\n        closeModal('message-modal');\r\n        showToast(data && data.success ? 'Message sent successfully' : (data && data.error ? data.error : 'Failed to send message'), data && data.success ? 'success' : 'error');\r\n        break;\r\n\r\n      case 'getQuotaStatusResult':\r\n        quotaStatus = data;\r\n        renderQuotaBar();\r\n        break;\r\n\r\n      case 'generateAIDraftResult':\r\n        handleAIDraftResult(data);\r\n        break;\r\n\r\n      case 'savedSearchesLoaded':\r\n        savedSearches = (data && data.searches) || [];\r\n        renderSavedSearches();\r\n        break;\r\n\r\n      case 'savedSearchExecuted':\r\n        if (data && data.success) {\r\n          allDrivers = data.drivers || [];\r\n          totalCount = allDrivers.length;\r\n          currentPage = 0;\r\n          applySortAndPaginate();\r\n          showToast('Saved search executed');\r\n        }\r\n        break;\r\n\r\n      case 'savedSearchDeleted':\r\n        showToast('Search deleted');\r\n        ROS.bridge.sendToVelo('loadSavedSearches', {});\r\n        break;\r\n\r\n      case 'saveSearchResult':\r\n        closeModal('save-search-modal');\r\n        showToast(data && data.success ? 'Search saved' : 'Failed to save search', data && data.success ? 'success' : 'error');\r\n        break;\r\n\r\n      case 'getWeightPreferencesResult':\r\n        if (data && data.success && data.preferences) {\r\n          loadWeightsFromVelo(data.preferences);\r\n        }\r\n        break;\r\n\r\n      case 'saveWeightPreferencesResult':\r\n        handleWeightSaveResult(data);\r\n        break;\r\n\r\n      case 'noCarrierAssigned':\r\n        hasCarrier = false;\r\n        renderNoCarrierState();\r\n        break;\r\n    }\r\n  }\r\n\r\n  // -- Sort & Paginate (client-side) --\r\n  function applySortAndPaginate() {\r\n    // Sort\r\n    const sorted = [...allDrivers].sort((a, b) => {\r\n      switch (sortField) {\r\n        case 'experience':\r\n          return (b.years_experience || b.experienceYears || 0) - (a.years_experience || a.experienceYears || 0);\r\n        case 'location':\r\n          const locA = a.city || a.location || '';\r\n          const locB = b.city || b.location || '';\r\n          return locA.localeCompare(locB);\r\n        default: // matchScore\r\n          return (b.matchScore || b.match_score || 0) - (a.matchScore || a.match_score || 0);\r\n      }\r\n    });\r\n\r\n    totalCount = sorted.length;\r\n    const start = currentPage * PAGE_SIZE;\r\n    drivers = sorted.slice(start, start + PAGE_SIZE);\r\n    renderResults();\r\n    renderPagination();\r\n  }\r\n\r\n  // -- Render Results --\r\n  function renderResults() {\r\n    const container = document.getElementById('search-results');\r\n    const countEl = document.getElementById('search-count');\r\n    if (!container) return;\r\n\r\n    if (countEl) countEl.textContent = totalCount + ' results';\r\n\r\n    if (isSearching) {\r\n      container.innerHTML = renderSkeletons(3);\r\n      return;\r\n    }\r\n\r\n    if (totalCount === 0 && allDrivers.length === 0) {\r\n      container.innerHTML = '<div class=\"text-center py-8 text-tan text-[13px]\">No drivers found matching your criteria</div>';\r\n      return;\r\n    }\r\n\r\n    container.innerHTML = drivers.map(d => renderDriverCard(d)).join('');\r\n  }\r\n\r\n  function renderSkeletons(count) {\r\n    let html = '';\r\n    for (let i = 0; i < count; i++) {\r\n      html += `<div class=\"flex items-center gap-4 p-4 neu-s rounded-xl skeleton-card\">\r\n        <div class=\"w-12 h-12 rounded-xl skeleton-shimmer\"></div>\r\n        <div class=\"flex-1 space-y-2\">\r\n          <div class=\"h-4 w-3/4 rounded skeleton-shimmer\"></div>\r\n          <div class=\"h-3 w-1/2 rounded skeleton-shimmer\"></div>\r\n        </div>\r\n        <div class=\"w-12 h-12 rounded skeleton-shimmer\"></div>\r\n      </div>`;\r\n    }\r\n    return html;\r\n  }\r\n\r\n  function renderDriverCard(driver) {\r\n    const name = driver.name || driver.full_name || 'Unknown';\r\n    const initials = name.split(' ').map(w => w[0]).join('').toUpperCase().slice(0, 2);\r\n    const matchScore = Math.round(driver.matchScore || driver.match_score || 0);\r\n    const cdl = driver.cdl_type || driver.cdlType || driver.cdlClass || '';\r\n    const rawEndorsements = driver.endorsements || '';\r\n    const endorseStr = Array.isArray(rawEndorsements) ? rawEndorsements.join(', ') : rawEndorsements;\r\n    const location = driver.city ? `${driver.city}, ${driver.state}` : (driver.location || '');\r\n    const expYears = driver.years_experience || driver.experienceYears || 0;\r\n    const exp = expYears ? `${expYears}yr exp` : '';\r\n    const details = [cdl ? `CDL-${cdl}` : '', endorseStr, location, exp].filter(Boolean).join(' \\u00b7 ');\r\n    const rationale = driver.rationale || driver.match_rationale || '';\r\n\r\n    const colors = ['from-lmdr-yb to-amber-500', 'from-lmdr-blue to-lmdr-deep', 'from-emerald-400 to-teal-600', 'from-violet-400 to-purple-600', 'from-amber-400 to-orange-500'];\r\n    const colorIdx = name.charCodeAt(0) % colors.length;\r\n    const textColor = colorIdx === 0 ? 'text-lmdr-dark' : 'text-white';\r\n    const scoreColor = getScoreColor(matchScore);\r\n    const source = driver.source || driver._source || '';\r\n    const sourceBadge = getSourceBadge(source);\r\n\r\n    const driverId = driver._id || driver.id || driver.record_id || '';\r\n    const isViewed = viewedDriverIds.has(driverId);\r\n\r\n    return `\r\n      <div class=\"flex items-center gap-4 p-4 neu-s rounded-xl cursor-pointer hover:shadow-none transition-shadow group\"\r\n           onclick=\"ROS.views._search.viewProfile('${driverId}', ${matchScore})\">\r\n        <div class=\"w-12 h-12 rounded-xl bg-gradient-to-br ${colors[colorIdx]} flex items-center justify-center font-black ${textColor} text-[14px] shrink-0\">${initials}</div>\r\n        <div class=\"flex-1 min-w-0\">\r\n          <div class=\"flex items-center gap-2 flex-wrap\">\r\n            <span class=\"text-[14px] font-bold text-lmdr-dark group-hover:text-lmdr-blue transition-colors\">${escapeHtml(name)}</span>\r\n            ${sourceBadge}\r\n            ${driver.isMutualMatch ? '<span class=\"source-badge source-scored\">Mutual</span>' : ''}\r\n          </div>\r\n          <div class=\"text-[12px] text-tan mt-0.5 truncate\">${escapeHtml(details)}</div>\r\n          ${rationale ? `<div class=\"text-[10px] text-tan/70 mt-0.5 truncate italic\">${escapeHtml(typeof rationale === 'string' ? rationale : rationale.join(' '))}</div>` : ''}\r\n        </div>\r\n        <div class=\"text-right shrink-0\">\r\n          <div class=\"text-2xl font-black ${scoreColor}\">${matchScore}%</div>\r\n          <div class=\"text-[9px] font-bold text-tan uppercase tracking-wider\">Match</div>\r\n        </div>\r\n        <button class=\"px-3 py-2 rounded-lg ${isViewed ? 'bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white' : 'neu-x text-tan'} text-[11px] font-bold shadow-md hover:shadow-lg transition-all shrink-0\"\r\n                onclick=\"event.stopPropagation();ROS.views._search.saveDriver('${driverId}', ${matchScore})\"\r\n                title=\"${isViewed ? 'Add to Pipeline' : 'View profile first to save'}\">+ Pipeline</button>\r\n      </div>`;\r\n  }\r\n\r\n  function renderError(msg) {\r\n    const container = document.getElementById('search-results');\r\n    if (container) container.innerHTML = `<div class=\"text-center py-8 text-red-400 text-[13px]\"><span class=\"material-symbols-outlined text-[32px] block mb-2\">error</span>${escapeHtml(msg)}</div>`;\r\n  }\r\n\r\n  // -- Pagination (numbered) --\r\n  function renderPagination() {\r\n    const container = document.getElementById('search-pagination');\r\n    if (!container) return;\r\n\r\n    const totalPages = Math.ceil(totalCount / PAGE_SIZE);\r\n    if (totalPages <= 1) {\r\n      container.style.display = 'none';\r\n      return;\r\n    }\r\n    container.style.display = 'flex';\r\n\r\n    let html = '';\r\n\r\n    // Prev button\r\n    html += `<button onclick=\"ROS.views._search.goToPage(${currentPage - 1})\" class=\"px-2.5 py-1.5 rounded-lg neu-x text-[11px] font-bold text-tan ${currentPage === 0 ? 'opacity-40 pointer-events-none' : 'hover:text-lmdr-blue'}\" ${currentPage === 0 ? 'disabled' : ''}>\r\n      <span class=\"material-symbols-outlined text-[14px]\">chevron_left</span>\r\n    </button>`;\r\n\r\n    // Page numbers with ellipsis\r\n    const pages = getPageNumbers(currentPage, totalPages);\r\n    pages.forEach(p => {\r\n      if (p === '...') {\r\n        html += `<span class=\"px-1.5 py-1.5 text-[11px] text-tan\">...</span>`;\r\n      } else {\r\n        const isActive = p === currentPage;\r\n        html += `<button onclick=\"ROS.views._search.goToPage(${p})\" class=\"w-8 h-8 rounded-lg ${isActive ? 'bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white shadow-md' : 'neu-x text-tan hover:text-lmdr-blue'} text-[11px] font-bold transition-all\">${p + 1}</button>`;\r\n      }\r\n    });\r\n\r\n    // Next button\r\n    html += `<button onclick=\"ROS.views._search.goToPage(${currentPage + 1})\" class=\"px-2.5 py-1.5 rounded-lg neu-x text-[11px] font-bold text-tan ${currentPage >= totalPages - 1 ? 'opacity-40 pointer-events-none' : 'hover:text-lmdr-blue'}\" ${currentPage >= totalPages - 1 ? 'disabled' : ''}>\r\n      <span class=\"material-symbols-outlined text-[14px]\">chevron_right</span>\r\n    </button>`;\r\n\r\n    container.innerHTML = html;\r\n  }\r\n\r\n  function getPageNumbers(current, total) {\r\n    if (total <= 7) return Array.from({length: total}, (_, i) => i);\r\n    const pages = [];\r\n    pages.push(0);\r\n    if (current > 2) pages.push('...');\r\n    for (let i = Math.max(1, current - 1); i <= Math.min(total - 2, current + 1); i++) {\r\n      pages.push(i);\r\n    }\r\n    if (current < total - 3) pages.push('...');\r\n    pages.push(total - 1);\r\n    return pages;\r\n  }\r\n\r\n  // -- Quota Bar --\r\n  function renderQuotaBar() {\r\n    const container = document.getElementById('search-quota-bar');\r\n    if (!container || !quotaStatus) return;\r\n\r\n    const used = quotaStatus.used || 0;\r\n    const limit = quotaStatus.limit || 5;\r\n    const isUnlimited = limit === 'Unlimited' || limit === -1;\r\n    const pct = isUnlimited ? 10 : Math.min((used / limit) * 100, 100);\r\n    const barColor = pct >= 90 ? 'bg-red-400' : pct >= 50 ? 'bg-amber-400' : 'bg-emerald-400';\r\n    const tier = (quotaStatus.tier || 'free').charAt(0).toUpperCase() + (quotaStatus.tier || 'free').slice(1);\r\n\r\n    container.innerHTML = `\r\n      <div class=\"flex items-center gap-2\">\r\n        <span class=\"text-[9px] font-bold text-tan uppercase\">${escapeHtml(tier)}</span>\r\n        <div class=\"w-16 h-1.5 rounded-full bg-tan/20 overflow-hidden\">\r\n          <div class=\"h-full rounded-full ${barColor} transition-all\" style=\"width:${pct}%\"></div>\r\n        </div>\r\n        <span class=\"text-[10px] font-bold ${pct >= 90 ? 'text-red-400' : 'text-tan'}\">${used}/${isUnlimited ? '\\u221e' : limit}</span>\r\n        ${pct >= 50 && !isUnlimited ? `<button onclick=\"ROS.views._search.upgrade()\" class=\"text-[9px] font-bold text-lmdr-blue hover:underline\">Upgrade</button>` : ''}\r\n      </div>`;\r\n  }\r\n\r\n  // -- Profile Modal --\r\n  function renderProfileModal(driver) {\r\n    closeModal('profile-modal');\r\n    const name = driver.name || driver.full_name || 'Unknown';\r\n    const initials = name.split(' ').map(w => w[0]).join('').toUpperCase().slice(0, 2);\r\n    const matchScore = Math.round(driver.matchScore || driver.match_score || 0);\r\n    const cdl = driver.cdl_type || driver.cdlType || driver.cdlClass || '';\r\n    const rawEndorsements = driver.endorsements || [];\r\n    const endorsements = Array.isArray(rawEndorsements) ? rawEndorsements : (typeof rawEndorsements === 'string' && rawEndorsements ? rawEndorsements.split(',').map(e => e.trim()) : []);\r\n    const location = driver.city ? `${driver.city}, ${driver.state}` : (driver.location || 'Unknown');\r\n    const expYears = driver.years_experience || driver.experienceYears || 0;\r\n    const scoreColor = getScoreColor(matchScore);\r\n    const availability = driver.availability || 'Unknown';\r\n    const equipment = Array.isArray(driver.equipment) ? driver.equipment : (Array.isArray(driver.equipment_experience) ? driver.equipment_experience : []);\r\n    const preferredRoutes = Array.isArray(driver.preferredRoutes) ? driver.preferredRoutes : (Array.isArray(driver.preferred_routes) ? driver.preferred_routes : []);\r\n    const homeTime = driver.homeTime || driver.home_time_preference || '';\r\n    const salaryExpectation = driver.salaryExpectation || driver.salary_expectation || '';\r\n    const mvrStatus = driver.mvrStatus || driver.mvr_status || '';\r\n    const rationale = driver.rationale || [];\r\n    const rationaleArr = Array.isArray(rationale) ? rationale : [rationale];\r\n\r\n    const modal = document.createElement('div');\r\n    modal.id = 'profile-modal';\r\n    modal.className = 'fixed inset-0 z-[9999] flex items-center justify-center p-4';\r\n    modal.style.animation = 'fadeIn .2s ease';\r\n    modal.innerHTML = `\r\n      <div class=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" onclick=\"ROS.views._search.closeModal('profile-modal')\"></div>\r\n      <div class=\"relative w-full max-w-lg max-h-[85vh] overflow-y-auto neu rounded-2xl p-6\" style=\"animation:fadeUp .3s ease\">\r\n\r\n        <!-- Header -->\r\n        <div class=\"flex items-center gap-4 mb-4\">\r\n          <div class=\"w-14 h-14 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep flex items-center justify-center font-black text-white text-[16px] shrink-0\">${initials}</div>\r\n          <div class=\"flex-1 min-w-0\">\r\n            <h3 class=\"text-[16px] font-bold text-lmdr-dark\">${escapeHtml(name)}</h3>\r\n            <div class=\"text-[12px] text-tan mt-0.5\">${cdl ? `CDL-${escapeHtml(cdl)}` : ''} ${endorsements.length ? '\\u00b7 ' + escapeHtml(endorsements.join(', ')) : ''}</div>\r\n            <div class=\"text-[11px] text-tan\">${escapeHtml(location)} ${expYears ? `\\u00b7 ${expYears}yr exp` : ''}</div>\r\n          </div>\r\n          <div class=\"text-center shrink-0\">\r\n            <div class=\"text-3xl font-black ${scoreColor}\">${matchScore}%</div>\r\n            <div class=\"text-[9px] font-bold text-tan uppercase\">Match</div>\r\n          </div>\r\n          <button onclick=\"ROS.views._search.closeModal('profile-modal')\" class=\"absolute top-4 right-4 text-tan hover:text-lmdr-dark\">\r\n            <span class=\"material-symbols-outlined text-[20px]\">close</span>\r\n          </button>\r\n        </div>\r\n\r\n        <!-- Match Rationale -->\r\n        ${rationaleArr.length > 0 ? `\r\n        <div class=\"p-3 rounded-xl bg-blue-50/50 neu-ins mb-4\">\r\n          <div class=\"text-[10px] font-bold text-lmdr-blue uppercase mb-1.5\">Why This Match</div>\r\n          ${rationaleArr.map(r => `<div class=\"flex items-start gap-2 text-[11px] text-lmdr-dark mb-1\">\r\n            <span class=\"material-symbols-outlined text-[14px] text-emerald-500 shrink-0 mt-0.5\">check_circle</span>\r\n            <span>${escapeHtml(r)}</span>\r\n          </div>`).join('')}\r\n        </div>` : ''}\r\n\r\n        <!-- 2x2 Grid -->\r\n        <div class=\"grid grid-cols-2 gap-3 mb-4\">\r\n          <!-- Qualifications -->\r\n          <div class=\"p-3 rounded-xl neu-x\">\r\n            <div class=\"text-[10px] font-bold text-tan uppercase mb-2\">Qualifications</div>\r\n            <div class=\"text-[11px] text-lmdr-dark space-y-1\">\r\n              ${cdl ? `<div><span class=\"font-bold\">CDL:</span> Class ${escapeHtml(cdl)}</div>` : ''}\r\n              ${endorsements.length ? `<div><span class=\"font-bold\">Endorsements:</span> ${escapeHtml(endorsements.join(', '))}</div>` : ''}\r\n              ${mvrStatus ? `<div><span class=\"font-bold\">MVR:</span> ${escapeHtml(mvrStatus)}</div>` : ''}\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Equipment -->\r\n          <div class=\"p-3 rounded-xl neu-x\">\r\n            <div class=\"text-[10px] font-bold text-tan uppercase mb-2\">Equipment</div>\r\n            <div class=\"flex flex-wrap gap-1\">\r\n              ${equipment.length ? equipment.map(e => `<span class=\"px-2 py-0.5 rounded-full bg-lmdr-blue/10 text-[10px] font-bold text-lmdr-blue\">${escapeHtml(e)}</span>`).join('') : '<span class=\"text-[11px] text-tan\">Not specified</span>'}\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Preferences -->\r\n          <div class=\"p-3 rounded-xl neu-x\">\r\n            <div class=\"text-[10px] font-bold text-tan uppercase mb-2\">Preferences</div>\r\n            <div class=\"text-[11px] text-lmdr-dark space-y-1\">\r\n              ${preferredRoutes.length ? `<div><span class=\"font-bold\">Routes:</span> ${escapeHtml(preferredRoutes.join(', '))}</div>` : ''}\r\n              ${homeTime ? `<div><span class=\"font-bold\">Home Time:</span> ${escapeHtml(homeTime)}</div>` : ''}\r\n              ${salaryExpectation ? `<div><span class=\"font-bold\">Pay:</span> ${escapeHtml(String(salaryExpectation))}</div>` : ''}\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Availability -->\r\n          <div class=\"p-3 rounded-xl neu-x\">\r\n            <div class=\"text-[10px] font-bold text-tan uppercase mb-2\">Availability</div>\r\n            <div class=\"text-[11px] text-lmdr-dark\">\r\n              <div class=\"flex items-center gap-2\">\r\n                <span class=\"w-2 h-2 rounded-full ${availability === 'immediate' ? 'bg-emerald-400' : availability === '2_weeks' ? 'bg-amber-400' : 'bg-slate-300'}\"></span>\r\n                <span class=\"font-bold\">${escapeHtml(availability === 'immediate' ? 'Immediately Available' : availability === '2_weeks' ? 'Available in 2 Weeks' : availability)}</span>\r\n              </div>\r\n              ${expYears ? `<div class=\"mt-1\"><span class=\"font-bold\">Experience:</span> ${expYears} years</div>` : ''}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Action Buttons -->\r\n        <div class=\"flex gap-2 flex-wrap\">\r\n          <button onclick=\"ROS.views._search.saveDriverFromModal()\" class=\"flex-1 px-4 py-2.5 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-[12px] font-bold flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transition-shadow\">\r\n            <span class=\"material-symbols-outlined text-[16px]\">person_add</span>Save to Pipeline\r\n          </button>\r\n          <button onclick=\"ROS.views._search.openMessageModal('email')\" class=\"px-4 py-2.5 rounded-xl neu-x text-[12px] font-bold text-tan hover:text-lmdr-blue transition-colors flex items-center gap-2\">\r\n            <span class=\"material-symbols-outlined text-[16px]\">mail</span>Email\r\n          </button>\r\n          <button onclick=\"ROS.views._search.openMessageModal('text')\" class=\"px-4 py-2.5 rounded-xl neu-x text-[12px] font-bold text-tan hover:text-lmdr-blue transition-colors flex items-center gap-2\">\r\n            <span class=\"material-symbols-outlined text-[16px]\">sms</span>Text\r\n          </button>\r\n        </div>\r\n      </div>`;\r\n\r\n    document.body.appendChild(modal);\r\n  }\r\n\r\n  // -- Quota Exceeded Modal --\r\n  function renderQuotaExceededModal() {\r\n    closeModal('profile-modal');\r\n    const modal = document.createElement('div');\r\n    modal.id = 'profile-modal';\r\n    modal.className = 'fixed inset-0 z-[9999] flex items-center justify-center p-4';\r\n    modal.style.animation = 'fadeIn .2s ease';\r\n    modal.innerHTML = `\r\n      <div class=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" onclick=\"ROS.views._search.closeModal('profile-modal')\"></div>\r\n      <div class=\"relative w-full max-w-sm neu rounded-2xl p-6 text-center\" style=\"animation:fadeUp .3s ease\">\r\n        <span class=\"material-symbols-outlined text-[48px] text-amber-400 block mb-3\">lock</span>\r\n        <h3 class=\"text-[16px] font-bold text-lmdr-dark mb-2\">Profile View Quota Exceeded</h3>\r\n        <p class=\"text-[12px] text-tan mb-4\">You've used all your profile views for this period. Upgrade your plan for more views.</p>\r\n        <div class=\"flex gap-2 justify-center\">\r\n          <button onclick=\"ROS.views._search.upgrade()\" class=\"px-5 py-2.5 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-[12px] font-bold shadow-lg\">Upgrade Plan</button>\r\n          <button onclick=\"ROS.views._search.closeModal('profile-modal')\" class=\"px-5 py-2.5 rounded-xl neu-x text-[12px] font-bold text-tan\">Close</button>\r\n        </div>\r\n      </div>`;\r\n    document.body.appendChild(modal);\r\n  }\r\n\r\n  // -- Message Compose Modal --\r\n  function openMessageModal(mode) {\r\n    closeModal('message-modal');\r\n    messageMode = mode;\r\n    const isText = mode === 'text';\r\n    const driverName = selectedDriverData ? (selectedDriverData.name || selectedDriverData.full_name || 'the driver') : 'the driver';\r\n\r\n    const modal = document.createElement('div');\r\n    modal.id = 'message-modal';\r\n    modal.className = 'fixed inset-0 z-[10000] flex items-center justify-center p-4';\r\n    modal.style.animation = 'fadeIn .2s ease';\r\n    modal.innerHTML = `\r\n      <div class=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" onclick=\"ROS.views._search.closeModal('message-modal')\"></div>\r\n      <div class=\"relative w-full max-w-md neu rounded-2xl p-6\" style=\"animation:fadeUp .3s ease\">\r\n        <div class=\"flex items-center justify-between mb-4\">\r\n          <h3 class=\"text-[15px] font-bold text-lmdr-dark\">${isText ? 'Send Text Message' : 'Send Email'}</h3>\r\n          <button onclick=\"ROS.views._search.closeModal('message-modal')\" class=\"text-tan hover:text-lmdr-dark\">\r\n            <span class=\"material-symbols-outlined text-[20px]\">close</span>\r\n          </button>\r\n        </div>\r\n        <p class=\"text-[12px] text-tan mb-3\">To: <span class=\"font-bold text-lmdr-dark\">${escapeHtml(driverName)}</span></p>\r\n        <textarea id=\"msg-textarea\" class=\"w-full p-3 rounded-xl neu-in text-[13px] text-lmdr-dark placeholder-tan/50 outline-none resize-none font-medium\"\r\n                  rows=\"${isText ? 3 : 6}\" placeholder=\"${isText ? 'Short message (160 chars recommended)...' : \"Write your message or click 'Generate with AI' for a personalized draft...\"}\"\r\n                  oninput=\"document.getElementById('msg-char-count').textContent=this.value.length+' characters'\"></textarea>\r\n        <div class=\"flex items-center justify-between mt-2 mb-4\">\r\n          <span id=\"msg-char-count\" class=\"text-[10px] text-tan\">0 characters</span>\r\n          <button id=\"ai-draft-btn\" onclick=\"ROS.views._search.generateAIDraft()\" class=\"flex items-center gap-1.5 px-3 py-1.5 rounded-full neu-x text-[10px] font-bold text-lmdr-blue hover:shadow-none transition-shadow\">\r\n            <span class=\"material-symbols-outlined text-[14px]\">auto_awesome</span>\r\n            <span id=\"ai-draft-btn-text\">Generate with AI</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"flex gap-2\">\r\n          <button onclick=\"ROS.views._search.sendMessage()\" class=\"flex-1 px-4 py-2.5 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-[12px] font-bold shadow-lg hover:shadow-xl transition-shadow\">\r\n            ${isText ? 'Send Text' : 'Send Email'}\r\n          </button>\r\n          <button onclick=\"ROS.views._search.closeModal('message-modal')\" class=\"px-4 py-2.5 rounded-xl neu-x text-[12px] font-bold text-tan\">Cancel</button>\r\n        </div>\r\n      </div>`;\r\n    document.body.appendChild(modal);\r\n  }\r\n\r\n  function handleAIDraftResult(data) {\r\n    const btn = document.getElementById('ai-draft-btn');\r\n    const btnText = document.getElementById('ai-draft-btn-text');\r\n    if (btn) {\r\n      btn.disabled = false;\r\n      btn.classList.remove('opacity-50');\r\n    }\r\n    if (data && data.success && data.draft) {\r\n      const textarea = document.getElementById('msg-textarea');\r\n      const charCount = document.getElementById('msg-char-count');\r\n      if (textarea) {\r\n        textarea.value = data.draft;\r\n        if (charCount) charCount.textContent = data.draft.length + ' characters';\r\n      }\r\n      if (btnText) btnText.textContent = 'Generate with AI';\r\n      showToast('AI draft generated \\u2014 review and edit before sending');\r\n    } else {\r\n      if (btnText) btnText.textContent = 'Generate with AI';\r\n      showToast(data && data.error ? data.error : 'AI draft failed', 'error');\r\n    }\r\n  }\r\n\r\n  // -- Save Search Modal --\r\n  function openSaveSearchModal() {\r\n    closeModal('save-search-modal');\r\n    const modal = document.createElement('div');\r\n    modal.id = 'save-search-modal';\r\n    modal.className = 'fixed inset-0 z-[10000] flex items-center justify-center p-4';\r\n    modal.style.animation = 'fadeIn .2s ease';\r\n    modal.innerHTML = `\r\n      <div class=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" onclick=\"ROS.views._search.closeModal('save-search-modal')\"></div>\r\n      <div class=\"relative w-full max-w-sm neu rounded-2xl p-6\" style=\"animation:fadeUp .3s ease\">\r\n        <h3 class=\"text-[15px] font-bold text-lmdr-dark mb-4\">Save This Search</h3>\r\n        <div class=\"space-y-3\">\r\n          <div>\r\n            <label class=\"text-[10px] font-bold text-tan uppercase\">Search Name</label>\r\n            <input id=\"save-search-name\" class=\"w-full mt-1 px-3 py-2 rounded-xl neu-in text-[12px] text-lmdr-dark placeholder-tan/50 outline-none font-medium\"\r\n                   placeholder=\"e.g. CDL-A OTR Drivers Near Dallas\"/>\r\n          </div>\r\n          <div>\r\n            <label class=\"text-[10px] font-bold text-tan uppercase\">Alert Frequency</label>\r\n            <select id=\"save-search-freq\" class=\"w-full mt-1 px-3 py-2 rounded-xl neu-in text-[12px] font-bold text-lmdr-dark outline-none cursor-pointer\">\r\n              <option value=\"daily\">Daily</option>\r\n              <option value=\"weekly\">Weekly</option>\r\n              <option value=\"never\">Never</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label class=\"text-[10px] font-bold text-tan uppercase mb-1 block\">Alert Channel</label>\r\n            <div class=\"flex gap-3\">\r\n              <label class=\"flex items-center gap-1.5 text-[11px] text-lmdr-dark cursor-pointer\">\r\n                <input type=\"radio\" name=\"save-alert-ch\" value=\"in_app\" checked class=\"accent-blue-600\"> In-App\r\n              </label>\r\n              <label class=\"flex items-center gap-1.5 text-[11px] text-lmdr-dark cursor-pointer\">\r\n                <input type=\"radio\" name=\"save-alert-ch\" value=\"email\" class=\"accent-blue-600\"> Email\r\n              </label>\r\n              <label class=\"flex items-center gap-1.5 text-[11px] text-lmdr-dark cursor-pointer\">\r\n                <input type=\"radio\" name=\"save-alert-ch\" value=\"both\" class=\"accent-blue-600\"> Both\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"flex gap-2 mt-5\">\r\n          <button onclick=\"ROS.views._search.submitSaveSearch()\" class=\"flex-1 px-4 py-2.5 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-[12px] font-bold shadow-lg\">Save Search</button>\r\n          <button onclick=\"ROS.views._search.closeModal('save-search-modal')\" class=\"px-4 py-2.5 rounded-xl neu-x text-[12px] font-bold text-tan\">Cancel</button>\r\n        </div>\r\n      </div>`;\r\n    document.body.appendChild(modal);\r\n  }\r\n\r\n  // -- Saved Searches Panel --\r\n  function renderSavedSearches() {\r\n    const list = document.getElementById('saved-searches-list');\r\n    const panel = document.getElementById('saved-searches-panel');\r\n    if (!list || !panel) return;\r\n    panel.style.display = 'block';\r\n\r\n    if (savedSearches.length === 0) {\r\n      list.innerHTML = '<div class=\"text-[12px] text-tan text-center py-2\">No saved searches yet</div>';\r\n      return;\r\n    }\r\n    list.innerHTML = savedSearches.map(s => {\r\n      const newBadge = s.new_matches_since_last > 0 ? `<span class=\"ml-1 px-1.5 py-0.5 rounded-full bg-lmdr-blue text-white text-[9px] font-bold\">${s.new_matches_since_last} new</span>` : '';\r\n      return `\r\n      <div class=\"flex items-center gap-3 p-2.5 neu-x rounded-xl\">\r\n        <span class=\"material-symbols-outlined text-lmdr-blue text-[16px]\">bookmark</span>\r\n        <div class=\"flex-1 min-w-0\">\r\n          <div class=\"text-[12px] font-bold text-lmdr-dark truncate\">${escapeHtml(s.name || s.search_name || 'Unnamed')}${newBadge}</div>\r\n          <div class=\"text-[10px] text-tan\">${s.resultCount || s.result_count || 0} results \\u00b7 ${escapeHtml(s.alert_frequency || s.frequency || 'daily')}</div>\r\n        </div>\r\n        <button onclick=\"ROS.views._search.runSaved('${s._id || s.id}')\" class=\"text-[10px] font-bold text-lmdr-blue hover:underline\">Run</button>\r\n        <button onclick=\"ROS.views._search.deleteSaved('${s._id || s.id}')\" class=\"text-tan hover:text-red-400\">\r\n          <span class=\"material-symbols-outlined text-[14px]\">delete</span>\r\n        </button>\r\n      </div>`;\r\n    }).join('');\r\n  }\r\n\r\n  // -- Active Filters Display --\r\n  function renderActiveFilters() {\r\n    const el = document.getElementById('search-active-filters');\r\n    if (!el) return;\r\n    const entries = Object.entries(filters);\r\n    if (entries.length === 0) { el.innerHTML = ''; return; }\r\n    el.innerHTML = entries.map(([k, v]) => {\r\n      const label = Array.isArray(v) ? v.join(', ') : v;\r\n      if (!label) return '';\r\n      return `\r\n      <span class=\"px-3 py-1.5 text-[10px] font-bold rounded-full neu-ins text-lmdr-blue flex items-center gap-1\">\r\n        ${escapeHtml(String(label))}\r\n        <span class=\"material-symbols-outlined text-[12px] cursor-pointer hover:text-red-400\" onclick=\"ROS.views._search.removeFilter('${k}')\">close</span>\r\n      </span>`;\r\n    }).filter(Boolean).join('');\r\n  }\r\n\r\n  // -- No Carrier Alert (side-sliding) --\r\n  function renderNoCarrierState() {\r\n    if (document.getElementById('no-carrier-alert')) return;\r\n    const alert = document.createElement('div');\r\n    alert.id = 'no-carrier-alert';\r\n    alert.className = 'no-carrier-alert';\r\n    alert.innerHTML = `\r\n      <div class=\"neu-s rounded-2xl p-4 border-l-4 border-amber-400\" style=\"background:#F5F5DC\">\r\n        <div class=\"flex items-start gap-3\">\r\n          <span class=\"material-symbols-outlined text-amber-400 text-[24px] shrink-0 mt-0.5\">warning</span>\r\n          <div class=\"flex-1 min-w-0\">\r\n            <h4 class=\"text-[13px] font-bold text-lmdr-dark leading-tight\">No Carrier Assigned</h4>\r\n            <p class=\"text-[11px] text-tan mt-1 leading-snug\">Add a carrier (DOT number) to start searching for drivers.</p>\r\n            <button onclick=\"ROS.views.showView('carriers');var a=document.getElementById('no-carrier-alert');if(a)a.remove()\"\r\n                    class=\"mt-2.5 px-4 py-2 rounded-xl bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-[11px] font-bold shadow-md hover:shadow-lg transition-shadow inline-flex items-center gap-1.5\">\r\n              <span class=\"material-symbols-outlined text-[14px]\">add_business</span>Add Carrier\r\n            </button>\r\n          </div>\r\n          <button onclick=\"document.getElementById('no-carrier-alert').remove()\" class=\"text-tan hover:text-lmdr-dark shrink-0 mt-0.5\">\r\n            <span class=\"material-symbols-outlined text-[16px]\">close</span>\r\n          </button>\r\n        </div>\r\n      </div>`;\r\n    document.body.appendChild(alert);\r\n  }\r\n\r\n  // -- Weight Preferences (floating orb with donut chart) --\r\n  const WEIGHT_META = {\r\n    qualifications: { name: 'Qualifications', icon: 'verified', color: 'text-lmdr-blue', hex: '#2563eb' },\r\n    experience:     { name: 'Experience',     icon: 'work_history', color: 'text-violet-500', hex: '#8b5cf6' },\r\n    location:       { name: 'Location',       icon: 'location_on', color: 'text-emerald-500', hex: '#10b981' },\r\n    availability:   { name: 'Availability',   icon: 'event_available', color: 'text-amber-500', hex: '#f59e0b' },\r\n    salary_fit:     { name: 'Salary Fit',     icon: 'payments', color: 'text-teal-500', hex: '#14b8a6' },\r\n    engagement:     { name: 'Engagement',     icon: 'trending_up', color: 'text-rose-400', hex: '#fb7185' }\r\n  };\r\n\r\n  function renderDonutChart() {\r\n    const entries = Object.entries(weights);\r\n    const total = entries.reduce((s, [, v]) => s + v, 0);\r\n    const r = 36, cx = 48, cy = 48, sw = 10;\r\n    const C = 2 * Math.PI * r;\r\n    let arcs = '', offset = 0;\r\n    for (const [key, val] of entries) {\r\n      if (val <= 0) continue;\r\n      const dash = (val / (total || 1)) * C;\r\n      arcs += `<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"${WEIGHT_META[key].hex}\"\r\n        stroke-width=\"${sw}\" stroke-dasharray=\"${dash} ${C - dash}\" stroke-dashoffset=\"${-offset}\"\r\n        stroke-linecap=\"butt\" transform=\"rotate(-90 ${cx} ${cy})\"/>`;\r\n      offset += dash;\r\n    }\r\n    const fill = total === 100 ? '#10b981' : total > 100 ? '#f87171' : '#f59e0b';\r\n    return `<svg width=\"96\" height=\"96\" viewBox=\"0 0 96 96\">\r\n      <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"#E8E0C8\" stroke-width=\"${sw}\"/>\r\n      ${arcs}\r\n      <text x=\"${cx}\" y=\"${cy}\" text-anchor=\"middle\" dominant-baseline=\"central\"\r\n            font-size=\"14\" font-weight=\"800\" fill=\"${fill}\">${total}%</text>\r\n    </svg>`;\r\n  }\r\n\r\n  function buildWeightsOrbHTML() {\r\n    const total = Object.values(weights).reduce((a, b) => a + b, 0);\r\n    const sliders = Object.entries(weights).map(([key, val]) => {\r\n      const m = WEIGHT_META[key];\r\n      return `<div class=\"flex items-center gap-2\">\r\n        <span class=\"material-symbols-outlined ${m.color} text-[14px] w-4\">${m.icon}</span>\r\n        <span class=\"text-[10px] font-bold text-lmdr-dark w-[68px] truncate\">${m.name}</span>\r\n        <input type=\"range\" min=\"0\" max=\"100\" value=\"${val}\" class=\"flex-1 accent-blue-600 h-1\"\r\n               id=\"wslider-${key}\" oninput=\"ROS.views._search.updateWeight('${key}',this.value)\"/>\r\n        <span class=\"text-[10px] font-bold text-lmdr-blue w-[28px] text-right\" id=\"wval-${key}\">${val}%</span>\r\n      </div>`;\r\n    }).join('');\r\n\r\n    return `\r\n      <div class=\"flex items-center justify-between mb-3\">\r\n        <div class=\"flex items-center gap-2\">\r\n          <span class=\"material-symbols-outlined text-lmdr-blue text-[16px]\">tune</span>\r\n          <span class=\"text-[12px] font-bold text-lmdr-dark\">Match Weights</span>\r\n        </div>\r\n        <button onclick=\"document.getElementById('weights-orb').remove()\" class=\"text-tan hover:text-lmdr-dark\">\r\n          <span class=\"material-symbols-outlined text-[16px]\">close</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"flex gap-3 items-start\">\r\n        <div id=\"weights-donut\" class=\"shrink-0\">${renderDonutChart()}</div>\r\n        <div class=\"flex-1 space-y-1.5\">${sliders}</div>\r\n      </div>\r\n      <div class=\"flex items-center justify-between mt-3 pt-2 border-t border-tan/10\">\r\n        <div class=\"flex items-center gap-3\">\r\n          <span class=\"text-[10px] font-bold ${total === 100 ? 'text-emerald-500' : 'text-red-400'}\" id=\"weights-total\">Total: ${total}%</span>\r\n          <button onclick=\"ROS.views._search.resetWeights()\" class=\"text-[9px] font-bold text-tan hover:text-lmdr-dark underline\">Reset</button>\r\n        </div>\r\n        <button onclick=\"ROS.views._search.saveWeights()\" id=\"save-weights-btn\"\r\n                class=\"px-3 py-1.5 rounded-lg bg-gradient-to-br from-lmdr-blue to-lmdr-deep text-white text-[10px] font-bold shadow-md\">Save</button>\r\n      </div>`;\r\n  }\r\n\r\n  function refreshWeightsOrb() {\r\n    const orb = document.getElementById('weights-orb');\r\n    if (orb) orb.innerHTML = buildWeightsOrbHTML();\r\n  }\r\n\r\n  function updateWeightsTotal() {\r\n    const total = Object.values(weights).reduce((a, b) => a + b, 0);\r\n    const el = document.getElementById('weights-total');\r\n    if (el) {\r\n      el.textContent = `Total: ${total}%`;\r\n      el.className = total === 100 ? 'text-[10px] font-bold text-emerald-500' : 'text-[10px] font-bold text-red-400';\r\n    }\r\n    const donut = document.getElementById('weights-donut');\r\n    if (donut) donut.innerHTML = renderDonutChart();\r\n  }\r\n\r\n  function loadWeightsFromVelo(prefs) {\r\n    if (prefs.weight_qualifications !== undefined) weights.qualifications = prefs.weight_qualifications;\r\n    if (prefs.weight_experience !== undefined) weights.experience = prefs.weight_experience;\r\n    if (prefs.weight_location !== undefined) weights.location = prefs.weight_location;\r\n    if (prefs.weight_availability !== undefined) weights.availability = prefs.weight_availability;\r\n    if (prefs.weight_salary_fit !== undefined) weights.salary_fit = prefs.weight_salary_fit;\r\n    if (prefs.weight_engagement !== undefined) weights.engagement = prefs.weight_engagement;\r\n    refreshWeightsOrb();\r\n  }\r\n\r\n  function handleWeightSaveResult(data) {\r\n    const btn = document.getElementById('save-weights-btn');\r\n    if (!btn) return;\r\n    if (data && data.success) {\r\n      btn.textContent = 'Saved!';\r\n      btn.classList.remove('from-lmdr-blue', 'to-lmdr-deep');\r\n      btn.classList.add('from-emerald-400', 'to-emerald-600');\r\n      setTimeout(() => {\r\n        btn.textContent = 'Save';\r\n        btn.classList.add('from-lmdr-blue', 'to-lmdr-deep');\r\n        btn.classList.remove('from-emerald-400', 'to-emerald-600');\r\n      }, 1500);\r\n      showToast('Weight preferences saved');\r\n    } else {\r\n      showToast(data && data.error ? data.error : 'Failed to save', 'error');\r\n      btn.textContent = 'Save';\r\n      btn.disabled = false;\r\n    }\r\n  }\r\n\r\n  // -- Close Modal --\r\n  function closeModal(id) {\r\n    const existing = document.getElementById(id);\r\n    if (existing) existing.remove();\r\n  }\r\n\r\n  // -- Collect Filters --\r\n  function getFilters() {\r\n    const f = {};\r\n\r\n    // CDL Classes\r\n    const cdlOrbs = document.querySelectorAll('[data-filter-group=\"cdlClass\"].filter-orb-active');\r\n    if (cdlOrbs.length) f.cdlClasses = Array.from(cdlOrbs).map(o => o.dataset.filterValue);\r\n\r\n    // Endorsements\r\n    const endOrbs = document.querySelectorAll('[data-filter-group=\"endorsements\"].filter-orb-active');\r\n    if (endOrbs.length) f.endorsements = Array.from(endOrbs).map(o => o.dataset.filterValue);\r\n\r\n    // Experience (radio)\r\n    const expOrb = document.querySelector('[data-filter-group=\"experience\"].filter-orb-active');\r\n    if (expOrb && expOrb.dataset.filterValue) f.minExperience = Number(expOrb.dataset.filterValue);\r\n\r\n    // Availability (radio)\r\n    const availOrb = document.querySelector('[data-filter-group=\"availability\"].filter-orb-active');\r\n    if (availOrb && availOrb.dataset.filterValue) f.availability = availOrb.dataset.filterValue;\r\n\r\n    // Equipment\r\n    const equipOrbs = document.querySelectorAll('[data-filter-group=\"equipment\"].filter-orb-active');\r\n    if (equipOrbs.length) f.equipment = Array.from(equipOrbs).map(o => o.dataset.filterValue);\r\n\r\n    // ZIP + Radius\r\n    const zipEl = document.getElementById('filter-zip');\r\n    const radiusEl = document.getElementById('filter-radius');\r\n    if (zipEl && zipEl.value.trim()) {\r\n      f.zip = zipEl.value.trim();\r\n      if (radiusEl && radiusEl.value) f.radius = Number(radiusEl.value);\r\n    }\r\n\r\n    return f;\r\n  }\r\n\r\n  // -- Public API --\r\n  ROS.views._search = {\r\n    doSearch: function() {\r\n      if (!hasCarrier) {\r\n        renderNoCarrierState();\r\n        return;\r\n      }\r\n      filters = getFilters();\r\n      renderActiveFilters();\r\n      isSearching = true;\r\n      const container = document.getElementById('search-results');\r\n      if (container) container.innerHTML = renderSkeletons(3);\r\n\r\n      const input = document.getElementById('search-input');\r\n      const query = input ? input.value.trim() : '';\r\n      const searchData = { ...filters, query, limit: 500, usePreferences: true, includeMutualMatches: true };\r\n      ROS.bridge.sendToVelo('searchDrivers', searchData);\r\n    },\r\n\r\n    doSort: function() {\r\n      const sel = document.getElementById('search-sort');\r\n      sortField = sel ? sel.value : 'matchScore';\r\n      if (allDrivers.length) {\r\n        currentPage = 0;\r\n        applySortAndPaginate();\r\n      }\r\n    },\r\n\r\n    toggleOrb: function(btn, group, value) {\r\n      btn.classList.toggle('filter-orb-active');\r\n      btn.classList.toggle('neu-x');\r\n    },\r\n\r\n    selectRadioOrb: function(btn, group, value) {\r\n      // Deselect all in group\r\n      document.querySelectorAll(`[data-filter-group=\"${group}\"]`).forEach(o => {\r\n        o.classList.remove('filter-orb-active');\r\n        o.classList.add('neu-x');\r\n      });\r\n      btn.classList.add('filter-orb-active');\r\n      btn.classList.remove('neu-x');\r\n    },\r\n\r\n    clearFilters: function() {\r\n      document.querySelectorAll('.filter-orb-active').forEach(o => {\r\n        o.classList.remove('filter-orb-active');\r\n        o.classList.add('neu-x');\r\n      });\r\n      // Reset radio \"Any\" buttons\r\n      ['experience', 'availability'].forEach(group => {\r\n        const anyBtn = document.querySelector(`[data-filter-group=\"${group}\"][data-filter-value=\"\"]`);\r\n        if (anyBtn) {\r\n          anyBtn.classList.add('filter-orb-active');\r\n          anyBtn.classList.remove('neu-x');\r\n        }\r\n      });\r\n      const zipEl = document.getElementById('filter-zip');\r\n      const radiusEl = document.getElementById('filter-radius');\r\n      if (zipEl) zipEl.value = '';\r\n      if (radiusEl) radiusEl.value = '50';\r\n      filters = {};\r\n      renderActiveFilters();\r\n    },\r\n\r\n    removeFilter: function(key) {\r\n      delete filters[key];\r\n      renderActiveFilters();\r\n    },\r\n\r\n    viewProfile: function(id, score) {\r\n      selectedDriver = id;\r\n      // Show loading state in results\r\n      ROS.bridge.sendToVelo('viewDriverProfile', { driverId: id, matchScore: score });\r\n    },\r\n\r\n    saveDriver: function(id, score) {\r\n      if (!viewedDriverIds.has(id)) {\r\n        showToast('View the driver\\'s profile first before saving', 'error');\r\n        return;\r\n      }\r\n      ROS.bridge.sendToVelo('saveDriver', { driverId: id, matchScore: score || 0 });\r\n    },\r\n\r\n    saveDriverFromModal: function() {\r\n      if (selectedDriver) {\r\n        viewedDriverIds.add(selectedDriver);\r\n        const score = selectedDriverData ? (selectedDriverData.matchScore || selectedDriverData.match_score || 0) : 0;\r\n        ROS.bridge.sendToVelo('saveDriver', { driverId: selectedDriver, matchScore: score });\r\n      }\r\n    },\r\n\r\n    openMessageModal: function(mode) {\r\n      openMessageModal(mode);\r\n    },\r\n\r\n    generateAIDraft: function() {\r\n      if (!selectedDriverData) {\r\n        showToast('No driver selected', 'error');\r\n        return;\r\n      }\r\n      const btn = document.getElementById('ai-draft-btn');\r\n      const btnText = document.getElementById('ai-draft-btn-text');\r\n      if (btn) {\r\n        btn.disabled = true;\r\n        btn.classList.add('opacity-50');\r\n      }\r\n      if (btnText) btnText.textContent = 'Generating...';\r\n\r\n      ROS.bridge.sendToVelo('generateAIDraft', {\r\n        driverId: selectedDriver,\r\n        driver: selectedDriverData,\r\n        mode: messageMode\r\n      });\r\n    },\r\n\r\n    sendMessage: function() {\r\n      const textarea = document.getElementById('msg-textarea');\r\n      const message = textarea ? textarea.value.trim() : '';\r\n      if (!message) {\r\n        showToast('Please enter a message', 'error');\r\n        return;\r\n      }\r\n      if (!selectedDriver) {\r\n        showToast('No driver selected', 'error');\r\n        return;\r\n      }\r\n      ROS.bridge.sendToVelo('contactDriver', { driverId: selectedDriver, message });\r\n    },\r\n\r\n    closeModal: function(id) {\r\n      closeModal(id);\r\n    },\r\n\r\n    goToPage: function(n) {\r\n      const totalPages = Math.ceil(totalCount / PAGE_SIZE);\r\n      if (n < 0 || n >= totalPages) return;\r\n      currentPage = n;\r\n      applySortAndPaginate();\r\n      // Scroll results into view\r\n      const results = document.getElementById('search-results');\r\n      if (results) results.scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n    },\r\n\r\n    openSaveModal: function() {\r\n      openSaveSearchModal();\r\n    },\r\n\r\n    submitSaveSearch: function() {\r\n      const nameEl = document.getElementById('save-search-name');\r\n      const freqEl = document.getElementById('save-search-freq');\r\n      const channelEl = document.querySelector('input[name=\"save-alert-ch\"]:checked');\r\n      const name = nameEl ? nameEl.value.trim() : '';\r\n      if (!name) {\r\n        showToast('Please enter a search name', 'error');\r\n        return;\r\n      }\r\n      ROS.bridge.sendToVelo('saveSearch', {\r\n        searchName: name,\r\n        criteria: getFilters(),\r\n        alertFrequency: freqEl ? freqEl.value : 'daily',\r\n        alertChannel: channelEl ? channelEl.value : 'in_app'\r\n      });\r\n    },\r\n\r\n    loadSaved: function() {\r\n      ROS.bridge.sendToVelo('loadSavedSearches', {});\r\n    },\r\n\r\n    runSaved: function(id) {\r\n      ROS.bridge.sendToVelo('runSavedSearch', { searchId: id });\r\n    },\r\n\r\n    deleteSaved: function(id) {\r\n      ROS.bridge.sendToVelo('deleteSavedSearch', { searchId: id });\r\n    },\r\n\r\n    toggleWeights: function() {\r\n      const existing = document.getElementById('weights-orb');\r\n      if (existing) { existing.remove(); return; }\r\n      const orb = document.createElement('div');\r\n      orb.id = 'weights-orb';\r\n      orb.className = 'weights-float-orb neu rounded-2xl p-4';\r\n      orb.style.animation = 'fadeUp .3s ease';\r\n      orb.innerHTML = buildWeightsOrbHTML();\r\n      document.body.appendChild(orb);\r\n    },\r\n\r\n    updateWeight: function(key, val) {\r\n      const raw = parseInt(val) || 0;\r\n      const otherTotal = Object.entries(weights).filter(([k]) => k !== key).reduce((s, [, v]) => s + v, 0);\r\n      const clamped = Math.min(Math.max(raw, 0), 100 - otherTotal);\r\n      weights[key] = clamped;\r\n      const slider = document.getElementById('wslider-' + key);\r\n      if (slider && clamped !== raw) slider.value = clamped;\r\n      const valEl = document.getElementById('wval-' + key);\r\n      if (valEl) valEl.textContent = clamped + '%';\r\n      updateWeightsTotal();\r\n    },\r\n\r\n    resetWeights: function() {\r\n      weights = { qualifications: 25, experience: 20, location: 20, availability: 15, salary_fit: 10, engagement: 10 };\r\n      refreshWeightsOrb();\r\n    },\r\n\r\n    saveWeights: function() {\r\n      const btn = document.getElementById('save-weights-btn');\r\n      if (btn) { btn.textContent = 'Saving\\u2026'; btn.disabled = true; }\r\n      ROS.bridge.sendToVelo('saveWeightPreferences', {\r\n        weight_qualifications: weights.qualifications,\r\n        weight_experience: weights.experience,\r\n        weight_location: weights.location,\r\n        weight_availability: weights.availability,\r\n        weight_salary_fit: weights.salary_fit,\r\n        weight_engagement: weights.engagement\r\n      });\r\n    },\r\n\r\n    upgrade: function() {\r\n      ROS.bridge.sendToVelo('navigateTo', { page: '/pricing' });\r\n    }\r\n  };\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\recruiter\\os\\js\\views\\ros-view-telemetry.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'analytics' is assigned a value but never used.","line":12,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ============================================================================\r\n// ROS-VIEW-TELEMETRY  Call Telemetry Dashboard\r\n// Total calls, avg duration, success rate, recent calls, log call\r\n// ============================================================================\r\n\r\n(function() {\r\n  'use strict';\r\n\r\n  const VIEW_ID = 'telemetry';\r\n  const MESSAGES = ['callAnalyticsLoaded', 'recentCallsLoaded', 'callOutcomeLogged', 'driverCallHistoryLoaded'];\r\n\r\n  let analytics = null;\r\n  let recentCalls = [];\r\n\r\n  function render() {\r\n    return `\r\n      <div class=\"flex items-center gap-3\">\r\n        <button onclick=\"ROS.views.showView('home')\" class=\"w-8 h-8 neu-s rounded-lg flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-tan text-[16px]\">arrow_back</span>\r\n        </button>\r\n        <div class=\"w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center\">\r\n          <span class=\"material-symbols-outlined text-white text-[16px]\">phone_in_talk</span>\r\n        </div>\r\n        <h2 class=\"text-lg font-bold text-lmdr-dark\">Call Telemetry</h2>\r\n        <button onclick=\"ROS.views._telemetry.openLogCall()\" class=\"ml-auto px-4 py-2 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 text-white text-[11px] font-bold shadow-lg shadow-orange-500/20 hover:shadow-orange-500/40 transition-shadow flex items-center gap-1.5\">\r\n          <span class=\"material-symbols-outlined text-[14px]\">add_call</span> Log Call\r\n        </button>\r\n      </div>\r\n\r\n      <!-- Stats Row -->\r\n      <div class=\"grid grid-cols-4 gap-4 mt-4\">\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Total Calls</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-dark mt-1\" id=\"tel-total\">--</h3>\r\n          <span class=\"text-[11px] text-sg font-bold\" id=\"tel-total-trend\"></span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Avg Duration</p>\r\n          <h3 class=\"text-[28px] font-black text-lmdr-blue mt-1\" id=\"tel-duration\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">minutes</span>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Success Rate</p>\r\n          <h3 class=\"text-[28px] font-black text-sg mt-1\" id=\"tel-success\">--</h3>\r\n          <div class=\"h-1.5 w-full neu-ins rounded-full overflow-hidden mt-2\">\r\n            <div class=\"h-full bg-sg rounded-full transition-all\" id=\"tel-success-bar\" style=\"width:0%\"></div>\r\n          </div>\r\n        </div>\r\n        <div class=\"neu-s p-5 rounded-xl\">\r\n          <p class=\"text-[10px] font-bold uppercase tracking-widest text-tan\">Callbacks</p>\r\n          <h3 class=\"text-[28px] font-black text-amber-500 mt-1\" id=\"tel-callbacks\">--</h3>\r\n          <span class=\"text-[11px] text-tan font-medium\">pending</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Recent Calls List -->\r\n      <div class=\"neu rounded-2xl p-5 mt-4 flex-1\">\r\n        <div class=\"flex items-center justify-between mb-4\">\r\n          <h3 class=\"text-[14px] font-bold text-lmdr-dark\">Recent Calls</h3>\r\n          <span class=\"text-[10px] text-tan font-medium\" id=\"tel-call-count\">0 calls</span>\r\n        </div>\r\n        <div class=\"flex flex-col gap-2\" id=\"tel-calls-list\">\r\n          <div class=\"text-center py-8 text-tan text-[13px]\">Loading call data...</div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Log Call Modal (hidden by default) -->\r\n      <div id=\"tel-log-modal\" style=\"display:none\" class=\"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40\">\r\n        <div class=\"neu-s rounded-2xl p-6 w-[400px] max-w-[90vw] bg-beige\">\r\n          <div class=\"flex items-center justify-between mb-4\">\r\n            <h3 class=\"text-[16px] font-bold text-lmdr-dark\">Log a Call</h3>\r\n            <button onclick=\"ROS.views._telemetry.closeLogCall()\" class=\"text-tan hover:text-lmdr-dark\">\r\n              <span class=\"material-symbols-outlined text-[18px]\">close</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"flex flex-col gap-3\">\r\n            <input id=\"tel-log-driver\" class=\"px-4 py-3 neu-in rounded-xl text-base text-lmdr-dark placeholder-tan/50 outline-none font-medium\" placeholder=\"Driver name or ID\" />\r\n            <select id=\"tel-log-outcome\" class=\"px-4 py-3 neu-in rounded-xl text-base text-lmdr-dark outline-none font-medium\">\r\n              <option value=\"\">Select outcome...</option>\r\n              <option value=\"connected\">Connected</option>\r\n              <option value=\"voicemail\">Voicemail</option>\r\n              <option value=\"no_answer\">No Answer</option>\r\n              <option value=\"interested\">Interested</option>\r\n              <option value=\"not_interested\">Not Interested</option>\r\n              <option value=\"callback\">Callback Requested</option>\r\n            </select>\r\n            <input id=\"tel-log-duration\" type=\"number\" class=\"px-4 py-3 neu-in rounded-xl text-base text-lmdr-dark placeholder-tan/50 outline-none font-medium\" placeholder=\"Duration (minutes)\" />\r\n            <textarea id=\"tel-log-notes\" class=\"px-4 py-3 neu-in rounded-xl text-base text-lmdr-dark placeholder-tan/50 outline-none font-medium resize-none h-20\" placeholder=\"Notes...\"></textarea>\r\n            <button onclick=\"ROS.views._telemetry.submitLogCall()\" class=\"px-5 py-3 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 text-white text-sm font-bold shadow-lg\">\r\n              Log Call\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  function onMount() {\r\n    ROS.bridge.sendToVelo('getCallAnalytics', {});\r\n    ROS.bridge.sendToVelo('getRecentCalls', {});\r\n  }\r\n\r\n  function onUnmount() {\r\n    analytics = null;\r\n    recentCalls = [];\r\n    closeLogCallModal();\r\n  }\r\n\r\n  function onMessage(type, data) {\r\n    switch (type) {\r\n      case 'callAnalyticsLoaded':\r\n        analytics = data;\r\n        renderAnalytics(data);\r\n        break;\r\n\r\n      case 'recentCallsLoaded':\r\n        recentCalls = (data && data.calls) || data || [];\r\n        if (Array.isArray(recentCalls)) renderRecentCalls();\r\n        break;\r\n\r\n      case 'callOutcomeLogged':\r\n        showToast(data && data.success ? 'Call logged successfully' : 'Failed to log call');\r\n        closeLogCallModal();\r\n        ROS.bridge.sendToVelo('getCallAnalytics', {});\r\n        ROS.bridge.sendToVelo('getRecentCalls', {});\r\n        break;\r\n\r\n      case 'driverCallHistoryLoaded':\r\n        // Future: show call history for specific driver\r\n        break;\r\n    }\r\n  }\r\n\r\n  function renderAnalytics(data) {\r\n    if (!data) return;\r\n    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };\r\n\r\n    setText('tel-total', data.totalCalls || '0');\r\n    setText('tel-total-trend', data.totalTrend || '');\r\n    setText('tel-duration', data.avgDuration ? data.avgDuration.toFixed(1) : '--');\r\n    setText('tel-callbacks', data.pendingCallbacks || '0');\r\n\r\n    // Success rate\r\n    const rate = data.successRate || 0;\r\n    setText('tel-success', rate + '%');\r\n    const bar = document.getElementById('tel-success-bar');\r\n    if (bar) bar.style.width = rate + '%';\r\n  }\r\n\r\n  function renderRecentCalls() {\r\n    const list = document.getElementById('tel-calls-list');\r\n    const countEl = document.getElementById('tel-call-count');\r\n    if (!list) return;\r\n\r\n    if (countEl) countEl.textContent = recentCalls.length + ' calls';\r\n\r\n    if (recentCalls.length === 0) {\r\n      list.innerHTML = '<div class=\"text-center py-8 text-tan text-[13px]\">No recent calls</div>';\r\n      return;\r\n    }\r\n\r\n    const outcomeConfig = {\r\n      'connected':      { icon: 'call',          color: 'text-sg' },\r\n      'voicemail':      { icon: 'voicemail',     color: 'text-amber-500' },\r\n      'no_answer':      { icon: 'call_missed',   color: 'text-red-400' },\r\n      'interested':     { icon: 'thumb_up',      color: 'text-sg' },\r\n      'not_interested': { icon: 'thumb_down',    color: 'text-red-400' },\r\n      'callback':       { icon: 'schedule',      color: 'text-lmdr-blue' }\r\n    };\r\n\r\n    list.innerHTML = recentCalls.map(c => {\r\n      const name = c.driver_name || c.name || 'Unknown';\r\n      const outcome = c.outcome || c.status || 'connected';\r\n      const config = outcomeConfig[outcome] || outcomeConfig['connected'];\r\n      const duration = c.duration ? c.duration + ' min' : '';\r\n      const time = c.time || c.created_at || '';\r\n      const notes = c.notes || '';\r\n\r\n      return `\r\n        <div class=\"flex items-center gap-3 p-3 neu-x rounded-xl\">\r\n          <span class=\"material-symbols-outlined ${config.color} text-[20px]\">${config.icon}</span>\r\n          <div class=\"flex-1\">\r\n            <div class=\"text-[12px] font-bold text-lmdr-dark\">${escapeHtml(name)}</div>\r\n            <div class=\"text-[10px] text-tan\">${escapeHtml(outcome.replace(/_/g, ' '))} ${duration ? '\\u00b7 ' + duration : ''} ${notes ? '\\u00b7 ' + escapeHtml(notes.substring(0, 40)) : ''}</div>\r\n          </div>\r\n          <span class=\"text-[10px] text-tan font-medium\">${escapeHtml(time)}</span>\r\n        </div>`;\r\n    }).join('');\r\n  }\r\n\r\n  function closeLogCallModal() {\r\n    const modal = document.getElementById('tel-log-modal');\r\n    if (modal) modal.style.display = 'none';\r\n  }\r\n\r\n  function showToast(msg) {\r\n    const t = document.createElement('div');\r\n    t.className = 'fixed top-16 right-4 z-[9999] px-4 py-2.5 rounded-xl neu-s text-[12px] font-bold text-lmdr-dark';\r\n    t.style.animation = 'fadeUp .3s ease';\r\n    t.textContent = msg;\r\n    document.body.appendChild(t);\r\n    setTimeout(() => t.remove(), 3000);\r\n  }\r\n\r\n  function escapeHtml(s) { if (!s) return ''; const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }\r\n\r\n  // Public API\r\n  ROS.views._telemetry = {\r\n    openLogCall: function() {\r\n      const modal = document.getElementById('tel-log-modal');\r\n      if (modal) modal.style.display = 'flex';\r\n    },\r\n    closeLogCall: function() {\r\n      closeLogCallModal();\r\n    },\r\n    submitLogCall: function() {\r\n      const driver = document.getElementById('tel-log-driver');\r\n      const outcome = document.getElementById('tel-log-outcome');\r\n      const duration = document.getElementById('tel-log-duration');\r\n      const notes = document.getElementById('tel-log-notes');\r\n\r\n      if (!outcome || !outcome.value) {\r\n        showToast('Please select an outcome');\r\n        return;\r\n      }\r\n\r\n      ROS.bridge.sendToVelo('logCallOutcome', {\r\n        driverName: driver ? driver.value.trim() : '',\r\n        outcome: outcome.value,\r\n        duration: duration ? Number(duration.value) || 0 : 0,\r\n        notes: notes ? notes.value.trim() : ''\r\n      });\r\n    }\r\n  };\r\n\r\n  ROS.views.registerView(VIEW_ID, { render, onMount, onUnmount, onMessage, messages: MESSAGES });\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\src\\public\\theme-utils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\LastMileStaffingHtml.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\__mocks__\\wix-data.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\__mocks__\\wix-members-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\__mocks__\\wix-secrets-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\__mocks__\\wix-users-backend.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\complianceCalendarService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\csaMonitorService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\documentCollectionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\documentVaultService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\dqFileService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\featureAdoptionService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\fixtures\\featureAdoptionFixtures.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\fuelService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\incidentService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\onboardingWorkflowService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\parkingService.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\nolan\\LMDR_WEBSITE_V2\\LMDR-_-WEBSITE-V2\\tests\\public\\setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]
